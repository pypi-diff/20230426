# Comparing `tmp/mlrun-1.3.1rc4-py3-none-any.whl.zip` & `tmp/mlrun-1.4.0rc1-py3-none-any.whl.zip`

## zipinfo {}

```diff
@@ -1,395 +1,396 @@
-Zip file size: 1157132 bytes, number of entries: 393
--rw-r--r--  2.0 unx     8727 b- defN 23-Apr-25 18:27 mlrun/__init__.py
--rw-r--r--  2.0 unx    47778 b- defN 23-Apr-25 18:27 mlrun/__main__.py
--rw-r--r--  2.0 unx    24314 b- defN 23-Apr-25 18:27 mlrun/builder.py
--rw-r--r--  2.0 unx    49992 b- defN 23-Apr-25 18:27 mlrun/config.py
--rw-r--r--  2.0 unx     6780 b- defN 23-Apr-25 18:27 mlrun/errors.py
--rw-r--r--  2.0 unx    38928 b- defN 23-Apr-25 18:27 mlrun/execution.py
--rw-r--r--  2.0 unx    15624 b- defN 23-Apr-25 18:27 mlrun/features.py
--rw-r--r--  2.0 unx    31384 b- defN 23-Apr-25 18:27 mlrun/k8s_utils.py
--rw-r--r--  2.0 unx    29645 b- defN 23-Apr-25 18:27 mlrun/kfpops.py
--rw-r--r--  2.0 unx     8360 b- defN 23-Apr-25 18:27 mlrun/lists.py
--rw-r--r--  2.0 unx    52194 b- defN 23-Apr-25 18:27 mlrun/model.py
--rw-r--r--  2.0 unx    11828 b- defN 23-Apr-25 18:27 mlrun/render.py
--rw-r--r--  2.0 unx    64321 b- defN 23-Apr-25 18:27 mlrun/run.py
--rw-r--r--  2.0 unx     7731 b- defN 23-Apr-25 18:27 mlrun/secrets.py
--rw-r--r--  2.0 unx      571 b- defN 23-Apr-25 18:27 mlrun/api/__init__.py
--rw-r--r--  2.0 unx     2105 b- defN 23-Apr-25 18:27 mlrun/api/alembic.ini
--rw-r--r--  2.0 unx      685 b- defN 23-Apr-25 18:27 mlrun/api/constants.py
--rw-r--r--  2.0 unx    23530 b- defN 23-Apr-25 18:27 mlrun/api/initial_data.py
--rw-r--r--  2.0 unx    24019 b- defN 23-Apr-25 18:27 mlrun/api/main.py
--rw-r--r--  2.0 unx     5235 b- defN 23-Apr-25 18:27 mlrun/api/middlewares.py
--rw-r--r--  2.0 unx      571 b- defN 23-Apr-25 18:27 mlrun/api/api/__init__.py
--rw-r--r--  2.0 unx     4267 b- defN 23-Apr-25 18:27 mlrun/api/api/api.py
--rw-r--r--  2.0 unx     3143 b- defN 23-Apr-25 18:27 mlrun/api/api/deps.py
--rw-r--r--  2.0 unx    32788 b- defN 23-Apr-25 18:27 mlrun/api/api/utils.py
--rw-r--r--  2.0 unx      571 b- defN 23-Apr-25 18:27 mlrun/api/api/endpoints/__init__.py
--rw-r--r--  2.0 unx     9458 b- defN 23-Apr-25 18:27 mlrun/api/api/endpoints/artifacts.py
--rw-r--r--  2.0 unx     1190 b- defN 23-Apr-25 18:27 mlrun/api/api/endpoints/auth.py
--rw-r--r--  2.0 unx     3588 b- defN 23-Apr-25 18:27 mlrun/api/api/endpoints/background_tasks.py
--rw-r--r--  2.0 unx     1202 b- defN 23-Apr-25 18:27 mlrun/api/api/endpoints/client_spec.py
--rw-r--r--  2.0 unx     1160 b- defN 23-Apr-25 18:27 mlrun/api/api/endpoints/clusterization_spec.py
--rw-r--r--  2.0 unx    28813 b- defN 23-Apr-25 18:27 mlrun/api/api/endpoints/feature_store.py
--rw-r--r--  2.0 unx     6065 b- defN 23-Apr-25 18:27 mlrun/api/api/endpoints/files.py
--rw-r--r--  2.0 unx     5690 b- defN 23-Apr-25 18:27 mlrun/api/api/endpoints/frontend_spec.py
--rw-r--r--  2.0 unx    33894 b- defN 23-Apr-25 18:27 mlrun/api/api/endpoints/functions.py
--rw-r--r--  2.0 unx     5798 b- defN 23-Apr-25 18:27 mlrun/api/api/endpoints/grafana_proxy.py
--rw-r--r--  2.0 unx     1163 b- defN 23-Apr-25 18:27 mlrun/api/api/endpoints/healthz.py
--rw-r--r--  2.0 unx     2429 b- defN 23-Apr-25 18:27 mlrun/api/api/endpoints/logs.py
--rw-r--r--  2.0 unx     8283 b- defN 23-Apr-25 18:27 mlrun/api/api/endpoints/marketplace.py
--rw-r--r--  2.0 unx    15724 b- defN 23-Apr-25 18:27 mlrun/api/api/endpoints/model_endpoints.py
--rw-r--r--  2.0 unx     3700 b- defN 23-Apr-25 18:27 mlrun/api/api/endpoints/operations.py
--rw-r--r--  2.0 unx     9099 b- defN 23-Apr-25 18:27 mlrun/api/api/endpoints/pipelines.py
--rw-r--r--  2.0 unx    11392 b- defN 23-Apr-25 18:27 mlrun/api/api/endpoints/projects.py
--rw-r--r--  2.0 unx     8956 b- defN 23-Apr-25 18:27 mlrun/api/api/endpoints/runs.py
--rw-r--r--  2.0 unx     8988 b- defN 23-Apr-25 18:27 mlrun/api/api/endpoints/runtime_resources.py
--rw-r--r--  2.0 unx    10579 b- defN 23-Apr-25 18:27 mlrun/api/api/endpoints/schedules.py
--rw-r--r--  2.0 unx     6057 b- defN 23-Apr-25 18:27 mlrun/api/api/endpoints/secrets.py
--rw-r--r--  2.0 unx     5265 b- defN 23-Apr-25 18:27 mlrun/api/api/endpoints/submit.py
--rw-r--r--  2.0 unx     4843 b- defN 23-Apr-25 18:27 mlrun/api/api/endpoints/tags.py
--rw-r--r--  2.0 unx     1203 b- defN 23-Apr-25 18:27 mlrun/api/api/endpoints/internal/__init__.py
--rw-r--r--  2.0 unx     1043 b- defN 23-Apr-25 18:27 mlrun/api/api/endpoints/internal/config.py
--rw-r--r--  2.0 unx     1709 b- defN 23-Apr-25 18:27 mlrun/api/api/endpoints/internal/memory_reports.py
--rw-r--r--  2.0 unx     1184 b- defN 23-Apr-25 18:27 mlrun/api/crud/__init__.py
--rw-r--r--  2.0 unx     5433 b- defN 23-Apr-25 18:27 mlrun/api/crud/artifacts.py
--rw-r--r--  2.0 unx     7341 b- defN 23-Apr-25 18:27 mlrun/api/crud/client_spec.py
--rw-r--r--  2.0 unx     1049 b- defN 23-Apr-25 18:27 mlrun/api/crud/clusterization_spec.py
--rw-r--r--  2.0 unx    18449 b- defN 23-Apr-25 18:27 mlrun/api/crud/feature_store.py
--rw-r--r--  2.0 unx     3550 b- defN 23-Apr-25 18:27 mlrun/api/crud/functions.py
--rw-r--r--  2.0 unx     9578 b- defN 23-Apr-25 18:27 mlrun/api/crud/logs.py
--rw-r--r--  2.0 unx     8180 b- defN 23-Apr-25 18:27 mlrun/api/crud/marketplace.py
--rw-r--r--  2.0 unx    13982 b- defN 23-Apr-25 18:27 mlrun/api/crud/pipelines.py
--rw-r--r--  2.0 unx    13326 b- defN 23-Apr-25 18:27 mlrun/api/crud/projects.py
--rw-r--r--  2.0 unx     5931 b- defN 23-Apr-25 18:27 mlrun/api/crud/runs.py
--rw-r--r--  2.0 unx     5539 b- defN 23-Apr-25 18:27 mlrun/api/crud/runtime_resources.py
--rw-r--r--  2.0 unx    19885 b- defN 23-Apr-25 18:27 mlrun/api/crud/secrets.py
--rw-r--r--  2.0 unx     3265 b- defN 23-Apr-25 18:27 mlrun/api/crud/tags.py
--rw-r--r--  2.0 unx      722 b- defN 23-Apr-25 18:27 mlrun/api/crud/model_monitoring/__init__.py
--rw-r--r--  2.0 unx    14943 b- defN 23-Apr-25 18:27 mlrun/api/crud/model_monitoring/grafana.py
--rw-r--r--  2.0 unx    40998 b- defN 23-Apr-25 18:27 mlrun/api/crud/model_monitoring/model_endpoints.py
--rw-r--r--  2.0 unx      571 b- defN 23-Apr-25 18:27 mlrun/api/db/__init__.py
--rw-r--r--  2.0 unx    13684 b- defN 23-Apr-25 18:27 mlrun/api/db/base.py
--rw-r--r--  2.0 unx      870 b- defN 23-Apr-25 18:27 mlrun/api/db/init_db.py
--rw-r--r--  2.0 unx     1226 b- defN 23-Apr-25 18:27 mlrun/api/db/session.py
--rw-r--r--  2.0 unx      571 b- defN 23-Apr-25 18:27 mlrun/api/db/filedb/__init__.py
--rw-r--r--  2.0 unx    14555 b- defN 23-Apr-25 18:27 mlrun/api/db/filedb/db.py
--rw-r--r--  2.0 unx      571 b- defN 23-Apr-25 18:27 mlrun/api/db/sqldb/__init__.py
--rw-r--r--  2.0 unx   136433 b- defN 23-Apr-25 18:27 mlrun/api/db/sqldb/db.py
--rw-r--r--  2.0 unx     2340 b- defN 23-Apr-25 18:27 mlrun/api/db/sqldb/helpers.py
--rw-r--r--  2.0 unx     2542 b- defN 23-Apr-25 18:27 mlrun/api/db/sqldb/session.py
--rw-r--r--  2.0 unx     1063 b- defN 23-Apr-25 18:27 mlrun/api/db/sqldb/models/__init__.py
--rw-r--r--  2.0 unx    18687 b- defN 23-Apr-25 18:27 mlrun/api/db/sqldb/models/models_mysql.py
--rw-r--r--  2.0 unx    16908 b- defN 23-Apr-25 18:27 mlrun/api/db/sqldb/models/models_sqlite.py
--rw-r--r--  2.0 unx     2906 b- defN 23-Apr-25 18:27 mlrun/api/migrations_mysql/env.py
--rw-r--r--  2.0 unx     4614 b- defN 23-Apr-25 18:27 mlrun/api/migrations_mysql/versions/32bae1b0e29c_increase_timestamp_fields_precision.py
--rw-r--r--  2.0 unx     1936 b- defN 23-Apr-25 18:27 mlrun/api/migrations_mysql/versions/4903aef6a91d_tag_foreign_key_and_cascades.py
--rw-r--r--  2.0 unx     1909 b- defN 23-Apr-25 18:27 mlrun/api/migrations_mysql/versions/5f1351c88a19_adding_background_tasks_table.py
--rw-r--r--  2.0 unx     1415 b- defN 23-Apr-25 18:27 mlrun/api/migrations_mysql/versions/88e656800d6a_add_requested_logs_column_and_index_to_.py
--rw-r--r--  2.0 unx     1504 b- defN 23-Apr-25 18:27 mlrun/api/migrations_mysql/versions/9d16de5f03a7_adding_data_versions_table.py
--rw-r--r--  2.0 unx     1649 b- defN 23-Apr-25 18:27 mlrun/api/migrations_mysql/versions/b86f5b53f3d7_adding_name_and_updated_to_runs_table.py
--rw-r--r--  2.0 unx    24057 b- defN 23-Apr-25 18:27 mlrun/api/migrations_mysql/versions/c4af40b0bf61_init.py
--rw-r--r--  2.0 unx     1351 b- defN 23-Apr-25 18:27 mlrun/api/migrations_mysql/versions/ee041e8fdaa0_adding_next_run_time_column_to_schedule_.py
--rw-r--r--  2.0 unx     2906 b- defN 23-Apr-25 18:27 mlrun/api/migrations_sqlite/env.py
--rw-r--r--  2.0 unx    11473 b- defN 23-Apr-25 18:27 mlrun/api/migrations_sqlite/versions/11f8dd2dc9fe_init.py
--rw-r--r--  2.0 unx     1348 b- defN 23-Apr-25 18:27 mlrun/api/migrations_sqlite/versions/1c954f8cb32d_schedule_last_run_uri.py
--rw-r--r--  2.0 unx     5180 b- defN 23-Apr-25 18:27 mlrun/api/migrations_sqlite/versions/2b6d23c715aa_adding_feature_sets.py
--rw-r--r--  2.0 unx     1388 b- defN 23-Apr-25 18:27 mlrun/api/migrations_sqlite/versions/6401142f2d7c_adding_next_run_time_column_to_schedule_.py
--rw-r--r--  2.0 unx     1767 b- defN 23-Apr-25 18:27 mlrun/api/migrations_sqlite/versions/64d90a1a69bc_adding_background_tasks_table.py
--rw-r--r--  2.0 unx     1360 b- defN 23-Apr-25 18:27 mlrun/api/migrations_sqlite/versions/803438ecd005_add_requested_logs_column_to_runs.py
--rw-r--r--  2.0 unx     1259 b- defN 23-Apr-25 18:27 mlrun/api/migrations_sqlite/versions/863114f0c659_refactoring_feature_set.py
--rw-r--r--  2.0 unx     1482 b- defN 23-Apr-25 18:27 mlrun/api/migrations_sqlite/versions/accf9fc83d38_adding_data_versions_table.py
--rw-r--r--  2.0 unx     1892 b- defN 23-Apr-25 18:27 mlrun/api/migrations_sqlite/versions/b68e8e897a28_schedule_labels.py
--rw-r--r--  2.0 unx     1882 b- defN 23-Apr-25 18:27 mlrun/api/migrations_sqlite/versions/bcd0c1f9720c_adding_project_labels.py
--rw-r--r--  2.0 unx     1420 b- defN 23-Apr-25 18:27 mlrun/api/migrations_sqlite/versions/cf21882f938e_schedule_id.py
--rw-r--r--  2.0 unx     2034 b- defN 23-Apr-25 18:27 mlrun/api/migrations_sqlite/versions/d781f58f607f_tag_object_name_string.py
--rw-r--r--  2.0 unx     1828 b- defN 23-Apr-25 18:27 mlrun/api/migrations_sqlite/versions/deac06871ace_adding_marketplace_sources_table.py
--rw-r--r--  2.0 unx     1380 b- defN 23-Apr-25 18:27 mlrun/api/migrations_sqlite/versions/e1dd5983c06b_schedule_concurrency_limit.py
--rw-r--r--  2.0 unx     1831 b- defN 23-Apr-25 18:27 mlrun/api/migrations_sqlite/versions/e5594ed3ab53_adding_name_and_updated_to_runs_table.py
--rw-r--r--  2.0 unx     3936 b- defN 23-Apr-25 18:27 mlrun/api/migrations_sqlite/versions/f4249b4ba6fa_adding_feature_vectors.py
--rw-r--r--  2.0 unx     2588 b- defN 23-Apr-25 18:27 mlrun/api/migrations_sqlite/versions/f7b5a1a03629_adding_feature_labels.py
--rw-r--r--  2.0 unx     3962 b- defN 23-Apr-25 18:27 mlrun/api/schemas/__init__.py
--rw-r--r--  2.0 unx     2070 b- defN 23-Apr-25 18:27 mlrun/api/schemas/artifact.py
--rw-r--r--  2.0 unx     5311 b- defN 23-Apr-25 18:27 mlrun/api/schemas/auth.py
--rw-r--r--  2.0 unx     1563 b- defN 23-Apr-25 18:27 mlrun/api/schemas/background_task.py
--rw-r--r--  2.0 unx     2751 b- defN 23-Apr-25 18:27 mlrun/api/schemas/client_spec.py
--rw-r--r--  2.0 unx      898 b- defN 23-Apr-25 18:27 mlrun/api/schemas/clusterization_spec.py
--rw-r--r--  2.0 unx     6278 b- defN 23-Apr-25 18:27 mlrun/api/schemas/constants.py
--rw-r--r--  2.0 unx     3671 b- defN 23-Apr-25 18:27 mlrun/api/schemas/feature_store.py
--rw-r--r--  2.0 unx     2571 b- defN 23-Apr-25 18:27 mlrun/api/schemas/frontend_spec.py
--rw-r--r--  2.0 unx     3991 b- defN 23-Apr-25 18:27 mlrun/api/schemas/function.py
--rw-r--r--  2.0 unx      715 b- defN 23-Apr-25 18:27 mlrun/api/schemas/http.py
--rw-r--r--  2.0 unx     1405 b- defN 23-Apr-25 18:27 mlrun/api/schemas/k8s.py
--rw-r--r--  2.0 unx     4258 b- defN 23-Apr-25 18:27 mlrun/api/schemas/marketplace.py
--rw-r--r--  2.0 unx      920 b- defN 23-Apr-25 18:27 mlrun/api/schemas/memory_reports.py
--rw-r--r--  2.0 unx    12343 b- defN 23-Apr-25 18:27 mlrun/api/schemas/model_endpoints.py
--rw-r--r--  2.0 unx     1965 b- defN 23-Apr-25 18:27 mlrun/api/schemas/object.py
--rw-r--r--  2.0 unx     1194 b- defN 23-Apr-25 18:27 mlrun/api/schemas/pipeline.py
--rw-r--r--  2.0 unx     3935 b- defN 23-Apr-25 18:27 mlrun/api/schemas/project.py
--rw-r--r--  2.0 unx     1646 b- defN 23-Apr-25 18:27 mlrun/api/schemas/runtime_resource.py
--rw-r--r--  2.0 unx     4192 b- defN 23-Apr-25 18:27 mlrun/api/schemas/schedule.py
--rw-r--r--  2.0 unx     1494 b- defN 23-Apr-25 18:27 mlrun/api/schemas/secret.py
--rw-r--r--  2.0 unx      919 b- defN 23-Apr-25 18:27 mlrun/api/schemas/tag.py
--rw-r--r--  2.0 unx      571 b- defN 23-Apr-25 18:27 mlrun/api/utils/__init__.py
--rw-r--r--  2.0 unx     1092 b- defN 23-Apr-25 18:27 mlrun/api/utils/asyncio.py
--rw-r--r--  2.0 unx     7302 b- defN 23-Apr-25 18:27 mlrun/api/utils/background_tasks.py
--rw-r--r--  2.0 unx     2413 b- defN 23-Apr-25 18:27 mlrun/api/utils/helpers.py
--rw-r--r--  2.0 unx     3728 b- defN 23-Apr-25 18:27 mlrun/api/utils/memory_reports.py
--rw-r--r--  2.0 unx     2599 b- defN 23-Apr-25 18:27 mlrun/api/utils/periodic.py
--rw-r--r--  2.0 unx    38822 b- defN 23-Apr-25 18:27 mlrun/api/utils/scheduler.py
--rw-r--r--  2.0 unx      571 b- defN 23-Apr-25 18:27 mlrun/api/utils/auth/__init__.py
--rw-r--r--  2.0 unx    12249 b- defN 23-Apr-25 18:27 mlrun/api/utils/auth/verifier.py
--rw-r--r--  2.0 unx      571 b- defN 23-Apr-25 18:27 mlrun/api/utils/auth/providers/__init__.py
--rw-r--r--  2.0 unx     1363 b- defN 23-Apr-25 18:27 mlrun/api/utils/auth/providers/base.py
--rw-r--r--  2.0 unx     1470 b- defN 23-Apr-25 18:27 mlrun/api/utils/auth/providers/nop.py
--rw-r--r--  2.0 unx    10835 b- defN 23-Apr-25 18:27 mlrun/api/utils/auth/providers/opa.py
--rw-r--r--  2.0 unx      571 b- defN 23-Apr-25 18:27 mlrun/api/utils/clients/__init__.py
--rw-r--r--  2.0 unx    13232 b- defN 23-Apr-25 18:27 mlrun/api/utils/clients/chief.py
--rw-r--r--  2.0 unx    30488 b- defN 23-Apr-25 18:27 mlrun/api/utils/clients/iguazio.py
--rw-r--r--  2.0 unx    10775 b- defN 23-Apr-25 18:27 mlrun/api/utils/clients/log_collector.py
--rw-r--r--  2.0 unx     9841 b- defN 23-Apr-25 18:27 mlrun/api/utils/clients/nuclio.py
--rw-r--r--  2.0 unx      571 b- defN 23-Apr-25 18:27 mlrun/api/utils/clients/protocols/__init__.py
--rw-r--r--  2.0 unx     2564 b- defN 23-Apr-25 18:27 mlrun/api/utils/clients/protocols/grpc.py
--rw-r--r--  2.0 unx      571 b- defN 23-Apr-25 18:27 mlrun/api/utils/db/__init__.py
--rw-r--r--  2.0 unx     3305 b- defN 23-Apr-25 18:27 mlrun/api/utils/db/alembic.py
--rw-r--r--  2.0 unx     8214 b- defN 23-Apr-25 18:27 mlrun/api/utils/db/backup.py
--rw-r--r--  2.0 unx     3795 b- defN 23-Apr-25 18:27 mlrun/api/utils/db/mysql.py
--rw-r--r--  2.0 unx      992 b- defN 23-Apr-25 18:27 mlrun/api/utils/db/sql_collation.py
--rw-r--r--  2.0 unx     3855 b- defN 23-Apr-25 18:27 mlrun/api/utils/db/sqlite_migration.py
--rw-r--r--  2.0 unx      571 b- defN 23-Apr-25 18:27 mlrun/api/utils/projects/__init__.py
--rw-r--r--  2.0 unx    17315 b- defN 23-Apr-25 18:27 mlrun/api/utils/projects/follower.py
--rw-r--r--  2.0 unx    19424 b- defN 23-Apr-25 18:27 mlrun/api/utils/projects/leader.py
--rw-r--r--  2.0 unx     7040 b- defN 23-Apr-25 18:27 mlrun/api/utils/projects/member.py
--rw-r--r--  2.0 unx      571 b- defN 23-Apr-25 18:27 mlrun/api/utils/projects/remotes/__init__.py
--rw-r--r--  2.0 unx     2614 b- defN 23-Apr-25 18:27 mlrun/api/utils/projects/remotes/follower.py
--rw-r--r--  2.0 unx     2064 b- defN 23-Apr-25 18:27 mlrun/api/utils/projects/remotes/leader.py
--rw-r--r--  2.0 unx     4601 b- defN 23-Apr-25 18:27 mlrun/api/utils/projects/remotes/nop_follower.py
--rw-r--r--  2.0 unx     3801 b- defN 23-Apr-25 18:27 mlrun/api/utils/projects/remotes/nop_leader.py
--rw-r--r--  2.0 unx      571 b- defN 23-Apr-25 18:27 mlrun/api/utils/singletons/__init__.py
--rw-r--r--  2.0 unx     1439 b- defN 23-Apr-25 18:27 mlrun/api/utils/singletons/db.py
--rw-r--r--  2.0 unx      694 b- defN 23-Apr-25 18:27 mlrun/api/utils/singletons/k8s.py
--rw-r--r--  2.0 unx      840 b- defN 23-Apr-25 18:27 mlrun/api/utils/singletons/logs_dir.py
--rw-r--r--  2.0 unx     1279 b- defN 23-Apr-25 18:27 mlrun/api/utils/singletons/project_member.py
--rw-r--r--  2.0 unx     1063 b- defN 23-Apr-25 18:27 mlrun/api/utils/singletons/scheduler.py
--rw-r--r--  2.0 unx     1091 b- defN 23-Apr-25 18:27 mlrun/artifacts/__init__.py
--rw-r--r--  2.0 unx    30849 b- defN 23-Apr-25 18:27 mlrun/artifacts/base.py
--rw-r--r--  2.0 unx    20366 b- defN 23-Apr-25 18:27 mlrun/artifacts/dataset.py
--rw-r--r--  2.0 unx    12110 b- defN 23-Apr-25 18:27 mlrun/artifacts/manager.py
--rw-r--r--  2.0 unx    23673 b- defN 23-Apr-25 18:27 mlrun/artifacts/model.py
--rw-r--r--  2.0 unx    15383 b- defN 23-Apr-25 18:27 mlrun/artifacts/plots.py
--rw-r--r--  2.0 unx     1087 b- defN 23-Apr-25 18:27 mlrun/data_types/__init__.py
--rw-r--r--  2.0 unx     4647 b- defN 23-Apr-25 18:27 mlrun/data_types/data_types.py
--rw-r--r--  2.0 unx     5813 b- defN 23-Apr-25 18:27 mlrun/data_types/infer.py
--rw-r--r--  2.0 unx     9118 b- defN 23-Apr-25 18:27 mlrun/data_types/spark.py
--rw-r--r--  2.0 unx     3300 b- defN 23-Apr-25 18:27 mlrun/datastore/__init__.py
--rw-r--r--  2.0 unx     6946 b- defN 23-Apr-25 18:27 mlrun/datastore/azure_blob.py
--rw-r--r--  2.0 unx    17304 b- defN 23-Apr-25 18:27 mlrun/datastore/base.py
--rw-r--r--  2.0 unx     7995 b- defN 23-Apr-25 18:27 mlrun/datastore/datastore.py
--rw-r--r--  2.0 unx     3791 b- defN 23-Apr-25 18:27 mlrun/datastore/filestore.py
--rw-r--r--  2.0 unx     5114 b- defN 23-Apr-25 18:27 mlrun/datastore/google_cloud_storage.py
--rw-r--r--  2.0 unx     2627 b- defN 23-Apr-25 18:27 mlrun/datastore/inmem.py
--rw-r--r--  2.0 unx     4873 b- defN 23-Apr-25 18:27 mlrun/datastore/redis.py
--rw-r--r--  2.0 unx     7035 b- defN 23-Apr-25 18:27 mlrun/datastore/s3.py
--rw-r--r--  2.0 unx    34025 b- defN 23-Apr-25 18:27 mlrun/datastore/sources.py
--rw-r--r--  2.0 unx     1402 b- defN 23-Apr-25 18:27 mlrun/datastore/spark_udf.py
--rw-r--r--  2.0 unx     6889 b- defN 23-Apr-25 18:27 mlrun/datastore/store_resources.py
--rw-r--r--  2.0 unx    62054 b- defN 23-Apr-25 18:27 mlrun/datastore/targets.py
--rw-r--r--  2.0 unx     1660 b- defN 23-Apr-25 18:27 mlrun/datastore/utils.py
--rw-r--r--  2.0 unx     8097 b- defN 23-Apr-25 18:27 mlrun/datastore/v3io.py
--rw-r--r--  2.0 unx     1343 b- defN 23-Apr-25 18:27 mlrun/datastore/wasbfs/__init__.py
--rw-r--r--  2.0 unx     6152 b- defN 23-Apr-25 18:27 mlrun/datastore/wasbfs/fs.py
--rw-r--r--  2.0 unx     2810 b- defN 23-Apr-25 18:27 mlrun/db/__init__.py
--rw-r--r--  2.0 unx    14796 b- defN 23-Apr-25 18:27 mlrun/db/base.py
--rw-r--r--  2.0 unx    28411 b- defN 23-Apr-25 18:27 mlrun/db/filedb.py
--rw-r--r--  2.0 unx   128262 b- defN 23-Apr-25 18:27 mlrun/db/httpdb.py
--rw-r--r--  2.0 unx    24292 b- defN 23-Apr-25 18:27 mlrun/db/sqldb.py
--rw-r--r--  2.0 unx     1501 b- defN 23-Apr-25 18:27 mlrun/feature_store/__init__.py
--rw-r--r--  2.0 unx    43335 b- defN 23-Apr-25 18:27 mlrun/feature_store/api.py
--rw-r--r--  2.0 unx    12807 b- defN 23-Apr-25 18:27 mlrun/feature_store/common.py
--rw-r--r--  2.0 unx    47059 b- defN 23-Apr-25 18:27 mlrun/feature_store/feature_set.py
--rw-r--r--  2.0 unx    21937 b- defN 23-Apr-25 18:27 mlrun/feature_store/feature_vector.py
--rw-r--r--  2.0 unx    11813 b- defN 23-Apr-25 18:27 mlrun/feature_store/ingestion.py
--rw-r--r--  2.0 unx    23868 b- defN 23-Apr-25 18:27 mlrun/feature_store/steps.py
--rw-r--r--  2.0 unx     1232 b- defN 23-Apr-25 18:27 mlrun/feature_store/retrieval/__init__.py
--rw-r--r--  2.0 unx    25911 b- defN 23-Apr-25 18:27 mlrun/feature_store/retrieval/base.py
--rw-r--r--  2.0 unx     4261 b- defN 23-Apr-25 18:27 mlrun/feature_store/retrieval/dask_merger.py
--rw-r--r--  2.0 unx     7106 b- defN 23-Apr-25 18:27 mlrun/feature_store/retrieval/job.py
--rw-r--r--  2.0 unx     4765 b- defN 23-Apr-25 18:27 mlrun/feature_store/retrieval/local_merger.py
--rw-r--r--  2.0 unx     3352 b- defN 23-Apr-25 18:27 mlrun/feature_store/retrieval/online.py
--rw-r--r--  2.0 unx     9661 b- defN 23-Apr-25 18:27 mlrun/feature_store/retrieval/spark_merger.py
--rw-r--r--  2.0 unx      743 b- defN 23-Apr-25 18:27 mlrun/frameworks/__init__.py
--rw-r--r--  2.0 unx    11466 b- defN 23-Apr-25 18:27 mlrun/frameworks/parallel_coordinates.py
--rw-r--r--  2.0 unx      962 b- defN 23-Apr-25 18:27 mlrun/frameworks/_common/__init__.py
--rw-r--r--  2.0 unx     8515 b- defN 23-Apr-25 18:27 mlrun/frameworks/_common/artifacts_library.py
--rw-r--r--  2.0 unx    21018 b- defN 23-Apr-25 18:27 mlrun/frameworks/_common/mlrun_interface.py
--rw-r--r--  2.0 unx    55376 b- defN 23-Apr-25 18:27 mlrun/frameworks/_common/model_handler.py
--rw-r--r--  2.0 unx     3469 b- defN 23-Apr-25 18:27 mlrun/frameworks/_common/plan.py
--rw-r--r--  2.0 unx     5757 b- defN 23-Apr-25 18:27 mlrun/frameworks/_common/producer.py
--rw-r--r--  2.0 unx     9209 b- defN 23-Apr-25 18:27 mlrun/frameworks/_common/utils.py
--rw-r--r--  2.0 unx      750 b- defN 23-Apr-25 18:27 mlrun/frameworks/_dl_common/__init__.py
--rw-r--r--  2.0 unx     1151 b- defN 23-Apr-25 18:27 mlrun/frameworks/_dl_common/model_handler.py
--rw-r--r--  2.0 unx      996 b- defN 23-Apr-25 18:27 mlrun/frameworks/_dl_common/utils.py
--rw-r--r--  2.0 unx      787 b- defN 23-Apr-25 18:27 mlrun/frameworks/_dl_common/loggers/__init__.py
--rw-r--r--  2.0 unx    11531 b- defN 23-Apr-25 18:27 mlrun/frameworks/_dl_common/loggers/logger.py
--rw-r--r--  2.0 unx    14777 b- defN 23-Apr-25 18:27 mlrun/frameworks/_dl_common/loggers/mlrun_logger.py
--rw-r--r--  2.0 unx    28414 b- defN 23-Apr-25 18:27 mlrun/frameworks/_dl_common/loggers/tensorboard_logger.py
--rw-r--r--  2.0 unx      956 b- defN 23-Apr-25 18:27 mlrun/frameworks/_ml_common/__init__.py
--rw-r--r--  2.0 unx     3169 b- defN 23-Apr-25 18:27 mlrun/frameworks/_ml_common/artifacts_library.py
--rw-r--r--  2.0 unx    16957 b- defN 23-Apr-25 18:27 mlrun/frameworks/_ml_common/model_handler.py
--rw-r--r--  2.0 unx     2368 b- defN 23-Apr-25 18:27 mlrun/frameworks/_ml_common/pkl_model_server.py
--rw-r--r--  2.0 unx     4881 b- defN 23-Apr-25 18:27 mlrun/frameworks/_ml_common/plan.py
--rw-r--r--  2.0 unx     4061 b- defN 23-Apr-25 18:27 mlrun/frameworks/_ml_common/producer.py
--rw-r--r--  2.0 unx    10490 b- defN 23-Apr-25 18:27 mlrun/frameworks/_ml_common/utils.py
--rw-r--r--  2.0 unx      737 b- defN 23-Apr-25 18:27 mlrun/frameworks/_ml_common/loggers/__init__.py
--rw-r--r--  2.0 unx     5684 b- defN 23-Apr-25 18:27 mlrun/frameworks/_ml_common/loggers/logger.py
--rw-r--r--  2.0 unx     6453 b- defN 23-Apr-25 18:27 mlrun/frameworks/_ml_common/loggers/mlrun_logger.py
--rw-r--r--  2.0 unx      922 b- defN 23-Apr-25 18:27 mlrun/frameworks/_ml_common/plans/__init__.py
--rw-r--r--  2.0 unx     5212 b- defN 23-Apr-25 18:27 mlrun/frameworks/_ml_common/plans/calibration_curve_plan.py
--rw-r--r--  2.0 unx     6078 b- defN 23-Apr-25 18:27 mlrun/frameworks/_ml_common/plans/confusion_matrix_plan.py
--rw-r--r--  2.0 unx     6658 b- defN 23-Apr-25 18:27 mlrun/frameworks/_ml_common/plans/dataset_plan.py
--rw-r--r--  2.0 unx     5318 b- defN 23-Apr-25 18:27 mlrun/frameworks/_ml_common/plans/feature_importance_plan.py
--rw-r--r--  2.0 unx     6993 b- defN 23-Apr-25 18:27 mlrun/frameworks/_ml_common/plans/roc_curve_plan.py
--rw-r--r--  2.0 unx      706 b- defN 23-Apr-25 18:27 mlrun/frameworks/auto_mlrun/__init__.py
--rw-r--r--  2.0 unx    23796 b- defN 23-Apr-25 18:27 mlrun/frameworks/auto_mlrun/auto_mlrun.py
--rw-r--r--  2.0 unx      721 b- defN 23-Apr-25 18:27 mlrun/frameworks/huggingface/__init__.py
--rw-r--r--  2.0 unx     6083 b- defN 23-Apr-25 18:27 mlrun/frameworks/huggingface/model_server.py
--rw-r--r--  2.0 unx    15883 b- defN 23-Apr-25 18:27 mlrun/frameworks/lgbm/__init__.py
--rw-r--r--  2.0 unx    13891 b- defN 23-Apr-25 18:27 mlrun/frameworks/lgbm/model_handler.py
--rw-r--r--  2.0 unx     9189 b- defN 23-Apr-25 18:27 mlrun/frameworks/lgbm/model_server.py
--rw-r--r--  2.0 unx     8278 b- defN 23-Apr-25 18:27 mlrun/frameworks/lgbm/utils.py
--rw-r--r--  2.0 unx      857 b- defN 23-Apr-25 18:27 mlrun/frameworks/lgbm/callbacks/__init__.py
--rw-r--r--  2.0 unx     4081 b- defN 23-Apr-25 18:27 mlrun/frameworks/lgbm/callbacks/callback.py
--rw-r--r--  2.0 unx     5156 b- defN 23-Apr-25 18:27 mlrun/frameworks/lgbm/callbacks/logging_callback.py
--rw-r--r--  2.0 unx     4137 b- defN 23-Apr-25 18:27 mlrun/frameworks/lgbm/callbacks/mlrun_logging_callback.py
--rw-r--r--  2.0 unx      842 b- defN 23-Apr-25 18:27 mlrun/frameworks/lgbm/mlrun_interfaces/__init__.py
--rw-r--r--  2.0 unx     1624 b- defN 23-Apr-25 18:27 mlrun/frameworks/lgbm/mlrun_interfaces/booster_mlrun_interface.py
--rw-r--r--  2.0 unx    14256 b- defN 23-Apr-25 18:27 mlrun/frameworks/lgbm/mlrun_interfaces/mlrun_interface.py
--rw-r--r--  2.0 unx     1333 b- defN 23-Apr-25 18:27 mlrun/frameworks/lgbm/mlrun_interfaces/model_mlrun_interface.py
--rw-r--r--  2.0 unx      791 b- defN 23-Apr-25 18:27 mlrun/frameworks/onnx/__init__.py
--rw-r--r--  2.0 unx     6098 b- defN 23-Apr-25 18:27 mlrun/frameworks/onnx/dataset.py
--rw-r--r--  2.0 unx     2405 b- defN 23-Apr-25 18:27 mlrun/frameworks/onnx/mlrun_interface.py
--rw-r--r--  2.0 unx     6203 b- defN 23-Apr-25 18:27 mlrun/frameworks/onnx/model_handler.py
--rw-r--r--  2.0 unx     7061 b- defN 23-Apr-25 18:27 mlrun/frameworks/onnx/model_server.py
--rw-r--r--  2.0 unx    22056 b- defN 23-Apr-25 18:27 mlrun/frameworks/pytorch/__init__.py
--rw-r--r--  2.0 unx    27904 b- defN 23-Apr-25 18:27 mlrun/frameworks/pytorch/callbacks_handler.py
--rw-r--r--  2.0 unx    44639 b- defN 23-Apr-25 18:27 mlrun/frameworks/pytorch/mlrun_interface.py
--rw-r--r--  2.0 unx    22465 b- defN 23-Apr-25 18:27 mlrun/frameworks/pytorch/model_handler.py
--rw-r--r--  2.0 unx    10136 b- defN 23-Apr-25 18:27 mlrun/frameworks/pytorch/model_server.py
--rw-r--r--  2.0 unx     4515 b- defN 23-Apr-25 18:27 mlrun/frameworks/pytorch/utils.py
--rw-r--r--  2.0 unx      896 b- defN 23-Apr-25 18:27 mlrun/frameworks/pytorch/callbacks/__init__.py
--rw-r--r--  2.0 unx    11524 b- defN 23-Apr-25 18:27 mlrun/frameworks/pytorch/callbacks/callback.py
--rw-r--r--  2.0 unx    23166 b- defN 23-Apr-25 18:27 mlrun/frameworks/pytorch/callbacks/logging_callback.py
--rw-r--r--  2.0 unx     9310 b- defN 23-Apr-25 18:27 mlrun/frameworks/pytorch/callbacks/mlrun_logging_callback.py
--rw-r--r--  2.0 unx    26661 b- defN 23-Apr-25 18:27 mlrun/frameworks/pytorch/callbacks/tensorboard_logging_callback.py
--rw-r--r--  2.0 unx    10892 b- defN 23-Apr-25 18:27 mlrun/frameworks/sklearn/__init__.py
--rw-r--r--  2.0 unx     5852 b- defN 23-Apr-25 18:27 mlrun/frameworks/sklearn/estimator.py
--rw-r--r--  2.0 unx     7117 b- defN 23-Apr-25 18:27 mlrun/frameworks/sklearn/metric.py
--rw-r--r--  2.0 unx    12215 b- defN 23-Apr-25 18:27 mlrun/frameworks/sklearn/metrics_library.py
--rw-r--r--  2.0 unx    14126 b- defN 23-Apr-25 18:27 mlrun/frameworks/sklearn/mlrun_interface.py
--rw-r--r--  2.0 unx     4745 b- defN 23-Apr-25 18:27 mlrun/frameworks/sklearn/model_handler.py
--rw-r--r--  2.0 unx     1209 b- defN 23-Apr-25 18:27 mlrun/frameworks/sklearn/utils.py
--rw-r--r--  2.0 unx    10455 b- defN 23-Apr-25 18:27 mlrun/frameworks/tf_keras/__init__.py
--rw-r--r--  2.0 unx    16627 b- defN 23-Apr-25 18:27 mlrun/frameworks/tf_keras/mlrun_interface.py
--rw-r--r--  2.0 unx    28247 b- defN 23-Apr-25 18:27 mlrun/frameworks/tf_keras/model_handler.py
--rw-r--r--  2.0 unx     9565 b- defN 23-Apr-25 18:27 mlrun/frameworks/tf_keras/model_server.py
--rw-r--r--  2.0 unx     4284 b- defN 23-Apr-25 18:27 mlrun/frameworks/tf_keras/utils.py
--rw-r--r--  2.0 unx      844 b- defN 23-Apr-25 18:27 mlrun/frameworks/tf_keras/callbacks/__init__.py
--rw-r--r--  2.0 unx    21886 b- defN 23-Apr-25 18:27 mlrun/frameworks/tf_keras/callbacks/logging_callback.py
--rw-r--r--  2.0 unx     8791 b- defN 23-Apr-25 18:27 mlrun/frameworks/tf_keras/callbacks/mlrun_logging_callback.py
--rw-r--r--  2.0 unx    28728 b- defN 23-Apr-25 18:27 mlrun/frameworks/tf_keras/callbacks/tensorboard_logging_callback.py
--rw-r--r--  2.0 unx    10287 b- defN 23-Apr-25 18:27 mlrun/frameworks/xgboost/__init__.py
--rw-r--r--  2.0 unx      878 b- defN 23-Apr-25 18:27 mlrun/frameworks/xgboost/mlrun_interface.py
--rw-r--r--  2.0 unx    11617 b- defN 23-Apr-25 18:27 mlrun/frameworks/xgboost/model_handler.py
--rw-r--r--  2.0 unx     1069 b- defN 23-Apr-25 18:27 mlrun/frameworks/xgboost/utils.py
--rw-r--r--  2.0 unx      760 b- defN 23-Apr-25 18:27 mlrun/mlutils/__init__.py
--rw-r--r--  2.0 unx     5325 b- defN 23-Apr-25 18:27 mlrun/mlutils/data.py
--rw-r--r--  2.0 unx     2598 b- defN 23-Apr-25 18:27 mlrun/mlutils/models.py
--rw-r--r--  2.0 unx    30120 b- defN 23-Apr-25 18:27 mlrun/mlutils/plots.py
--rw-r--r--  2.0 unx     1307 b- defN 23-Apr-25 18:27 mlrun/model_monitoring/__init__.py
--rw-r--r--  2.0 unx     2962 b- defN 23-Apr-25 18:27 mlrun/model_monitoring/common.py
--rw-r--r--  2.0 unx     3117 b- defN 23-Apr-25 18:27 mlrun/model_monitoring/constants.py
--rw-r--r--  2.0 unx    23948 b- defN 23-Apr-25 18:27 mlrun/model_monitoring/features_drift_table.py
--rw-r--r--  2.0 unx     5935 b- defN 23-Apr-25 18:27 mlrun/model_monitoring/helpers.py
--rw-r--r--  2.0 unx     5176 b- defN 23-Apr-25 18:27 mlrun/model_monitoring/model_endpoint.py
--rw-r--r--  2.0 unx    36191 b- defN 23-Apr-25 18:27 mlrun/model_monitoring/model_monitoring_batch.py
--rw-r--r--  2.0 unx    43025 b- defN 23-Apr-25 18:27 mlrun/model_monitoring/stream_processing_fs.py
--rw-r--r--  2.0 unx     4240 b- defN 23-Apr-25 18:27 mlrun/model_monitoring/stores/__init__.py
--rw-r--r--  2.0 unx    16926 b- defN 23-Apr-25 18:27 mlrun/model_monitoring/stores/kv_model_endpoint_store.py
--rw-r--r--  2.0 unx     5695 b- defN 23-Apr-25 18:27 mlrun/model_monitoring/stores/model_endpoint_store.py
--rw-r--r--  2.0 unx    15700 b- defN 23-Apr-25 18:27 mlrun/model_monitoring/stores/sql_model_endpoint_store.py
--rw-r--r--  2.0 unx      884 b- defN 23-Apr-25 18:27 mlrun/model_monitoring/stores/models/__init__.py
--rw-r--r--  2.0 unx      655 b- defN 23-Apr-25 18:27 mlrun/model_monitoring/stores/models/base.py
--rw-r--r--  2.0 unx     3744 b- defN 23-Apr-25 18:27 mlrun/model_monitoring/stores/models/mysql.py
--rw-r--r--  2.0 unx     3661 b- defN 23-Apr-25 18:27 mlrun/model_monitoring/stores/models/sqlite.py
--rw-r--r--  2.0 unx     2400 b- defN 23-Apr-25 18:27 mlrun/platforms/__init__.py
--rw-r--r--  2.0 unx    23113 b- defN 23-Apr-25 18:27 mlrun/platforms/iguazio.py
--rw-r--r--  2.0 unx    11852 b- defN 23-Apr-25 18:27 mlrun/platforms/other.py
--rw-r--r--  2.0 unx     1153 b- defN 23-Apr-25 18:27 mlrun/projects/__init__.py
--rw-r--r--  2.0 unx    17302 b- defN 23-Apr-25 18:27 mlrun/projects/operations.py
--rw-r--r--  2.0 unx    37882 b- defN 23-Apr-25 18:27 mlrun/projects/pipelines.py
--rw-r--r--  2.0 unx   103146 b- defN 23-Apr-25 18:27 mlrun/projects/project.py
--rw-r--r--  2.0 unx     8973 b- defN 23-Apr-25 18:27 mlrun/runtimes/__init__.py
--rw-r--r--  2.0 unx   107571 b- defN 23-Apr-25 18:27 mlrun/runtimes/base.py
--rw-r--r--  2.0 unx     6689 b- defN 23-Apr-25 18:27 mlrun/runtimes/constants.py
--rw-r--r--  2.0 unx    30403 b- defN 23-Apr-25 18:27 mlrun/runtimes/daskjob.py
--rw-r--r--  2.0 unx     9190 b- defN 23-Apr-25 18:27 mlrun/runtimes/funcdoc.py
--rw-r--r--  2.0 unx    69047 b- defN 23-Apr-25 18:27 mlrun/runtimes/function.py
--rw-r--r--  2.0 unx     4911 b- defN 23-Apr-25 18:27 mlrun/runtimes/function_reference.py
--rw-r--r--  2.0 unx     6530 b- defN 23-Apr-25 18:27 mlrun/runtimes/generators.py
--rw-r--r--  2.0 unx    17034 b- defN 23-Apr-25 18:27 mlrun/runtimes/kubejob.py
--rw-r--r--  2.0 unx    18005 b- defN 23-Apr-25 18:27 mlrun/runtimes/local.py
--rw-r--r--  2.0 unx     2885 b- defN 23-Apr-25 18:27 mlrun/runtimes/nuclio.py
--rw-r--r--  2.0 unx    60648 b- defN 23-Apr-25 18:27 mlrun/runtimes/pod.py
--rw-r--r--  2.0 unx     7695 b- defN 23-Apr-25 18:27 mlrun/runtimes/remotesparkjob.py
--rw-r--r--  2.0 unx    29852 b- defN 23-Apr-25 18:27 mlrun/runtimes/serving.py
--rw-r--r--  2.0 unx    21249 b- defN 23-Apr-25 18:27 mlrun/runtimes/utils.py
--rw-r--r--  2.0 unx      790 b- defN 23-Apr-25 18:27 mlrun/runtimes/mpijob/__init__.py
--rw-r--r--  2.0 unx    14782 b- defN 23-Apr-25 18:27 mlrun/runtimes/mpijob/abstract.py
--rw-r--r--  2.0 unx    13845 b- defN 23-Apr-25 18:27 mlrun/runtimes/mpijob/v1.py
--rw-r--r--  2.0 unx     8460 b- defN 23-Apr-25 18:27 mlrun/runtimes/mpijob/v1alpha1.py
--rw-r--r--  2.0 unx      673 b- defN 23-Apr-25 18:27 mlrun/runtimes/package/__init__.py
--rw-r--r--  2.0 unx    27044 b- defN 23-Apr-25 18:27 mlrun/runtimes/package/context_handler.py
--rw-r--r--  2.0 unx      788 b- defN 23-Apr-25 18:27 mlrun/runtimes/sparkjob/__init__.py
--rw-r--r--  2.0 unx    35976 b- defN 23-Apr-25 18:27 mlrun/runtimes/sparkjob/abstract.py
--rw-r--r--  2.0 unx     2033 b- defN 23-Apr-25 18:27 mlrun/runtimes/sparkjob/spark2job.py
--rw-r--r--  2.0 unx    28722 b- defN 23-Apr-25 18:27 mlrun/runtimes/sparkjob/spark3job.py
--rw-r--r--  2.0 unx     1078 b- defN 23-Apr-25 18:27 mlrun/serving/__init__.py
--rw-r--r--  2.0 unx     6116 b- defN 23-Apr-25 18:27 mlrun/serving/merger.py
--rw-r--r--  2.0 unx    18038 b- defN 23-Apr-25 18:27 mlrun/serving/remote.py
--rw-r--r--  2.0 unx    55209 b- defN 23-Apr-25 18:27 mlrun/serving/routers.py
--rw-r--r--  2.0 unx    19005 b- defN 23-Apr-25 18:27 mlrun/serving/server.py
--rw-r--r--  2.0 unx      836 b- defN 23-Apr-25 18:27 mlrun/serving/serving_wrapper.py
--rw-r--r--  2.0 unx    53922 b- defN 23-Apr-25 18:27 mlrun/serving/states.py
--rw-r--r--  2.0 unx     3468 b- defN 23-Apr-25 18:27 mlrun/serving/utils.py
--rw-r--r--  2.0 unx    11814 b- defN 23-Apr-25 18:27 mlrun/serving/v1_serving.py
--rw-r--r--  2.0 unx    21441 b- defN 23-Apr-25 18:27 mlrun/serving/v2_serving.py
--rw-r--r--  2.0 unx      855 b- defN 23-Apr-25 18:27 mlrun/utils/__init__.py
--rw-r--r--  2.0 unx    10397 b- defN 23-Apr-25 18:27 mlrun/utils/async_http.py
--rw-r--r--  2.0 unx     3456 b- defN 23-Apr-25 18:27 mlrun/utils/azure_vault.py
--rw-r--r--  2.0 unx     6245 b- defN 23-Apr-25 18:27 mlrun/utils/clones.py
--rw-r--r--  2.0 unx     1662 b- defN 23-Apr-25 18:27 mlrun/utils/db.py
--rw-r--r--  2.0 unx    41426 b- defN 23-Apr-25 18:27 mlrun/utils/helpers.py
--rw-r--r--  2.0 unx     7093 b- defN 23-Apr-25 18:27 mlrun/utils/http.py
--rw-r--r--  2.0 unx     5637 b- defN 23-Apr-25 18:27 mlrun/utils/logger.py
--rw-r--r--  2.0 unx     7875 b- defN 23-Apr-25 18:27 mlrun/utils/model_monitoring.py
--rw-r--r--  2.0 unx     3954 b- defN 23-Apr-25 18:27 mlrun/utils/regex.py
--rw-r--r--  2.0 unx      883 b- defN 23-Apr-25 18:27 mlrun/utils/singleton.py
--rw-r--r--  2.0 unx     1319 b- defN 23-Apr-25 18:27 mlrun/utils/v3io_clients.py
--rw-r--r--  2.0 unx     9957 b- defN 23-Apr-25 18:27 mlrun/utils/vault.py
--rw-r--r--  2.0 unx      990 b- defN 23-Apr-25 18:27 mlrun/utils/notifications/__init__.py
--rw-r--r--  2.0 unx     7093 b- defN 23-Apr-25 18:27 mlrun/utils/notifications/notification_pusher.py
--rw-r--r--  2.0 unx     1833 b- defN 23-Apr-25 18:27 mlrun/utils/notifications/notification/__init__.py
--rw-r--r--  2.0 unx     2067 b- defN 23-Apr-25 18:27 mlrun/utils/notifications/notification/base.py
--rw-r--r--  2.0 unx     1901 b- defN 23-Apr-25 18:27 mlrun/utils/notifications/notification/console.py
--rw-r--r--  2.0 unx     4510 b- defN 23-Apr-25 18:27 mlrun/utils/notifications/notification/git.py
--rw-r--r--  2.0 unx     1951 b- defN 23-Apr-25 18:27 mlrun/utils/notifications/notification/ipython.py
--rw-r--r--  2.0 unx     3650 b- defN 23-Apr-25 18:27 mlrun/utils/notifications/notification/slack.py
--rw-r--r--  2.0 unx      614 b- defN 23-Apr-25 18:27 mlrun/utils/version/__init__.py
--rw-r--r--  2.0 unx       88 b- defN 23-Apr-25 18:27 mlrun/utils/version/version.json
--rw-r--r--  2.0 unx     1970 b- defN 23-Apr-25 18:27 mlrun/utils/version/version.py
--rw-r--r--  2.0 unx    11357 b- defN 23-Apr-25 18:27 mlrun-1.3.1rc4.dist-info/LICENSE
--rw-r--r--  2.0 unx    16975 b- defN 23-Apr-25 18:27 mlrun-1.3.1rc4.dist-info/METADATA
--rw-r--r--  2.0 unx       92 b- defN 23-Apr-25 18:27 mlrun-1.3.1rc4.dist-info/WHEEL
--rw-r--r--  2.0 unx       47 b- defN 23-Apr-25 18:27 mlrun-1.3.1rc4.dist-info/entry_points.txt
--rw-r--r--  2.0 unx        6 b- defN 23-Apr-25 18:27 mlrun-1.3.1rc4.dist-info/top_level.txt
--rw-rw-r--  2.0 unx    36828 b- defN 23-Apr-25 18:27 mlrun-1.3.1rc4.dist-info/RECORD
-393 files, 4324500 bytes uncompressed, 1098412 bytes compressed:  74.6%
+Zip file size: 1162558 bytes, number of entries: 394
+-rw-r--r--  2.0 unx     8727 b- defN 23-Apr-25 18:56 mlrun/__init__.py
+-rw-r--r--  2.0 unx    49967 b- defN 23-Apr-25 18:56 mlrun/__main__.py
+-rw-r--r--  2.0 unx    24965 b- defN 23-Apr-25 18:56 mlrun/builder.py
+-rw-r--r--  2.0 unx    50570 b- defN 23-Apr-25 18:56 mlrun/config.py
+-rw-r--r--  2.0 unx     6780 b- defN 23-Apr-25 18:56 mlrun/errors.py
+-rw-r--r--  2.0 unx    39096 b- defN 23-Apr-25 18:56 mlrun/execution.py
+-rw-r--r--  2.0 unx    15624 b- defN 23-Apr-25 18:56 mlrun/features.py
+-rw-r--r--  2.0 unx    31688 b- defN 23-Apr-25 18:56 mlrun/k8s_utils.py
+-rw-r--r--  2.0 unx    29645 b- defN 23-Apr-25 18:56 mlrun/kfpops.py
+-rw-r--r--  2.0 unx     8360 b- defN 23-Apr-25 18:56 mlrun/lists.py
+-rw-r--r--  2.0 unx    53402 b- defN 23-Apr-25 18:56 mlrun/model.py
+-rw-r--r--  2.0 unx    11828 b- defN 23-Apr-25 18:56 mlrun/render.py
+-rw-r--r--  2.0 unx    64451 b- defN 23-Apr-25 18:56 mlrun/run.py
+-rw-r--r--  2.0 unx     7731 b- defN 23-Apr-25 18:56 mlrun/secrets.py
+-rw-r--r--  2.0 unx      571 b- defN 23-Apr-25 18:56 mlrun/api/__init__.py
+-rw-r--r--  2.0 unx     2105 b- defN 23-Apr-25 18:56 mlrun/api/alembic.ini
+-rw-r--r--  2.0 unx      685 b- defN 23-Apr-25 18:56 mlrun/api/constants.py
+-rw-r--r--  2.0 unx    23530 b- defN 23-Apr-25 18:56 mlrun/api/initial_data.py
+-rw-r--r--  2.0 unx    26180 b- defN 23-Apr-25 18:56 mlrun/api/main.py
+-rw-r--r--  2.0 unx     5235 b- defN 23-Apr-25 18:56 mlrun/api/middlewares.py
+-rw-r--r--  2.0 unx      571 b- defN 23-Apr-25 18:56 mlrun/api/api/__init__.py
+-rw-r--r--  2.0 unx     4267 b- defN 23-Apr-25 18:56 mlrun/api/api/api.py
+-rw-r--r--  2.0 unx     3143 b- defN 23-Apr-25 18:56 mlrun/api/api/deps.py
+-rw-r--r--  2.0 unx    36224 b- defN 23-Apr-25 18:56 mlrun/api/api/utils.py
+-rw-r--r--  2.0 unx      571 b- defN 23-Apr-25 18:56 mlrun/api/api/endpoints/__init__.py
+-rw-r--r--  2.0 unx     9458 b- defN 23-Apr-25 18:56 mlrun/api/api/endpoints/artifacts.py
+-rw-r--r--  2.0 unx     1190 b- defN 23-Apr-25 18:56 mlrun/api/api/endpoints/auth.py
+-rw-r--r--  2.0 unx     3588 b- defN 23-Apr-25 18:56 mlrun/api/api/endpoints/background_tasks.py
+-rw-r--r--  2.0 unx     1202 b- defN 23-Apr-25 18:56 mlrun/api/api/endpoints/client_spec.py
+-rw-r--r--  2.0 unx     1160 b- defN 23-Apr-25 18:56 mlrun/api/api/endpoints/clusterization_spec.py
+-rw-r--r--  2.0 unx    28813 b- defN 23-Apr-25 18:56 mlrun/api/api/endpoints/feature_store.py
+-rw-r--r--  2.0 unx     6065 b- defN 23-Apr-25 18:56 mlrun/api/api/endpoints/files.py
+-rw-r--r--  2.0 unx     5690 b- defN 23-Apr-25 18:56 mlrun/api/api/endpoints/frontend_spec.py
+-rw-r--r--  2.0 unx    33894 b- defN 23-Apr-25 18:56 mlrun/api/api/endpoints/functions.py
+-rw-r--r--  2.0 unx     5798 b- defN 23-Apr-25 18:56 mlrun/api/api/endpoints/grafana_proxy.py
+-rw-r--r--  2.0 unx     1163 b- defN 23-Apr-25 18:56 mlrun/api/api/endpoints/healthz.py
+-rw-r--r--  2.0 unx     2429 b- defN 23-Apr-25 18:56 mlrun/api/api/endpoints/logs.py
+-rw-r--r--  2.0 unx    10035 b- defN 23-Apr-25 18:56 mlrun/api/api/endpoints/marketplace.py
+-rw-r--r--  2.0 unx    15724 b- defN 23-Apr-25 18:56 mlrun/api/api/endpoints/model_endpoints.py
+-rw-r--r--  2.0 unx     3700 b- defN 23-Apr-25 18:56 mlrun/api/api/endpoints/operations.py
+-rw-r--r--  2.0 unx     9099 b- defN 23-Apr-25 18:56 mlrun/api/api/endpoints/pipelines.py
+-rw-r--r--  2.0 unx    11392 b- defN 23-Apr-25 18:56 mlrun/api/api/endpoints/projects.py
+-rw-r--r--  2.0 unx     9076 b- defN 23-Apr-25 18:56 mlrun/api/api/endpoints/runs.py
+-rw-r--r--  2.0 unx     8988 b- defN 23-Apr-25 18:56 mlrun/api/api/endpoints/runtime_resources.py
+-rw-r--r--  2.0 unx    10579 b- defN 23-Apr-25 18:56 mlrun/api/api/endpoints/schedules.py
+-rw-r--r--  2.0 unx     6057 b- defN 23-Apr-25 18:56 mlrun/api/api/endpoints/secrets.py
+-rw-r--r--  2.0 unx     5265 b- defN 23-Apr-25 18:56 mlrun/api/api/endpoints/submit.py
+-rw-r--r--  2.0 unx     4843 b- defN 23-Apr-25 18:56 mlrun/api/api/endpoints/tags.py
+-rw-r--r--  2.0 unx     1203 b- defN 23-Apr-25 18:56 mlrun/api/api/endpoints/internal/__init__.py
+-rw-r--r--  2.0 unx     1043 b- defN 23-Apr-25 18:56 mlrun/api/api/endpoints/internal/config.py
+-rw-r--r--  2.0 unx     1709 b- defN 23-Apr-25 18:56 mlrun/api/api/endpoints/internal/memory_reports.py
+-rw-r--r--  2.0 unx     1225 b- defN 23-Apr-25 18:56 mlrun/api/crud/__init__.py
+-rw-r--r--  2.0 unx     5433 b- defN 23-Apr-25 18:56 mlrun/api/crud/artifacts.py
+-rw-r--r--  2.0 unx     7341 b- defN 23-Apr-25 18:56 mlrun/api/crud/client_spec.py
+-rw-r--r--  2.0 unx     1049 b- defN 23-Apr-25 18:56 mlrun/api/crud/clusterization_spec.py
+-rw-r--r--  2.0 unx    18449 b- defN 23-Apr-25 18:56 mlrun/api/crud/feature_store.py
+-rw-r--r--  2.0 unx     3550 b- defN 23-Apr-25 18:56 mlrun/api/crud/functions.py
+-rw-r--r--  2.0 unx     9578 b- defN 23-Apr-25 18:56 mlrun/api/crud/logs.py
+-rw-r--r--  2.0 unx    11769 b- defN 23-Apr-25 18:56 mlrun/api/crud/marketplace.py
+-rw-r--r--  2.0 unx     2751 b- defN 23-Apr-25 18:56 mlrun/api/crud/notifications.py
+-rw-r--r--  2.0 unx    13982 b- defN 23-Apr-25 18:56 mlrun/api/crud/pipelines.py
+-rw-r--r--  2.0 unx    13326 b- defN 23-Apr-25 18:56 mlrun/api/crud/projects.py
+-rw-r--r--  2.0 unx     6005 b- defN 23-Apr-25 18:56 mlrun/api/crud/runs.py
+-rw-r--r--  2.0 unx     5539 b- defN 23-Apr-25 18:56 mlrun/api/crud/runtime_resources.py
+-rw-r--r--  2.0 unx    19921 b- defN 23-Apr-25 18:56 mlrun/api/crud/secrets.py
+-rw-r--r--  2.0 unx     3265 b- defN 23-Apr-25 18:56 mlrun/api/crud/tags.py
+-rw-r--r--  2.0 unx      722 b- defN 23-Apr-25 18:56 mlrun/api/crud/model_monitoring/__init__.py
+-rw-r--r--  2.0 unx    14943 b- defN 23-Apr-25 18:56 mlrun/api/crud/model_monitoring/grafana.py
+-rw-r--r--  2.0 unx    40998 b- defN 23-Apr-25 18:56 mlrun/api/crud/model_monitoring/model_endpoints.py
+-rw-r--r--  2.0 unx      571 b- defN 23-Apr-25 18:56 mlrun/api/db/__init__.py
+-rw-r--r--  2.0 unx    14365 b- defN 23-Apr-25 18:56 mlrun/api/db/base.py
+-rw-r--r--  2.0 unx      870 b- defN 23-Apr-25 18:56 mlrun/api/db/init_db.py
+-rw-r--r--  2.0 unx      993 b- defN 23-Apr-25 18:56 mlrun/api/db/session.py
+-rw-r--r--  2.0 unx      571 b- defN 23-Apr-25 18:56 mlrun/api/db/sqldb/__init__.py
+-rw-r--r--  2.0 unx   142645 b- defN 23-Apr-25 18:56 mlrun/api/db/sqldb/db.py
+-rw-r--r--  2.0 unx     2340 b- defN 23-Apr-25 18:56 mlrun/api/db/sqldb/helpers.py
+-rw-r--r--  2.0 unx     2542 b- defN 23-Apr-25 18:56 mlrun/api/db/sqldb/session.py
+-rw-r--r--  2.0 unx     1063 b- defN 23-Apr-25 18:56 mlrun/api/db/sqldb/models/__init__.py
+-rw-r--r--  2.0 unx    20624 b- defN 23-Apr-25 18:56 mlrun/api/db/sqldb/models/models_mysql.py
+-rw-r--r--  2.0 unx    18286 b- defN 23-Apr-25 18:56 mlrun/api/db/sqldb/models/models_sqlite.py
+-rw-r--r--  2.0 unx     2906 b- defN 23-Apr-25 18:56 mlrun/api/migrations_mysql/env.py
+-rw-r--r--  2.0 unx     4614 b- defN 23-Apr-25 18:56 mlrun/api/migrations_mysql/versions/32bae1b0e29c_increase_timestamp_fields_precision.py
+-rw-r--r--  2.0 unx     1936 b- defN 23-Apr-25 18:56 mlrun/api/migrations_mysql/versions/4903aef6a91d_tag_foreign_key_and_cascades.py
+-rw-r--r--  2.0 unx     1909 b- defN 23-Apr-25 18:56 mlrun/api/migrations_mysql/versions/5f1351c88a19_adding_background_tasks_table.py
+-rw-r--r--  2.0 unx     1415 b- defN 23-Apr-25 18:56 mlrun/api/migrations_mysql/versions/88e656800d6a_add_requested_logs_column_and_index_to_.py
+-rw-r--r--  2.0 unx     1504 b- defN 23-Apr-25 18:56 mlrun/api/migrations_mysql/versions/9d16de5f03a7_adding_data_versions_table.py
+-rw-r--r--  2.0 unx     1649 b- defN 23-Apr-25 18:56 mlrun/api/migrations_mysql/versions/b86f5b53f3d7_adding_name_and_updated_to_runs_table.py
+-rw-r--r--  2.0 unx    24057 b- defN 23-Apr-25 18:56 mlrun/api/migrations_mysql/versions/c4af40b0bf61_init.py
+-rw-r--r--  2.0 unx     2457 b- defN 23-Apr-25 18:56 mlrun/api/migrations_mysql/versions/c905d15bd91d_notifications.py
+-rw-r--r--  2.0 unx     1351 b- defN 23-Apr-25 18:56 mlrun/api/migrations_mysql/versions/ee041e8fdaa0_adding_next_run_time_column_to_schedule_.py
+-rw-r--r--  2.0 unx     2906 b- defN 23-Apr-25 18:56 mlrun/api/migrations_sqlite/env.py
+-rw-r--r--  2.0 unx    11473 b- defN 23-Apr-25 18:56 mlrun/api/migrations_sqlite/versions/11f8dd2dc9fe_init.py
+-rw-r--r--  2.0 unx     1348 b- defN 23-Apr-25 18:56 mlrun/api/migrations_sqlite/versions/1c954f8cb32d_schedule_last_run_uri.py
+-rw-r--r--  2.0 unx     5180 b- defN 23-Apr-25 18:56 mlrun/api/migrations_sqlite/versions/2b6d23c715aa_adding_feature_sets.py
+-rw-r--r--  2.0 unx     1388 b- defN 23-Apr-25 18:56 mlrun/api/migrations_sqlite/versions/6401142f2d7c_adding_next_run_time_column_to_schedule_.py
+-rw-r--r--  2.0 unx     1767 b- defN 23-Apr-25 18:56 mlrun/api/migrations_sqlite/versions/64d90a1a69bc_adding_background_tasks_table.py
+-rw-r--r--  2.0 unx     1360 b- defN 23-Apr-25 18:56 mlrun/api/migrations_sqlite/versions/803438ecd005_add_requested_logs_column_to_runs.py
+-rw-r--r--  2.0 unx     1259 b- defN 23-Apr-25 18:56 mlrun/api/migrations_sqlite/versions/863114f0c659_refactoring_feature_set.py
+-rw-r--r--  2.0 unx     2147 b- defN 23-Apr-25 18:56 mlrun/api/migrations_sqlite/versions/959ae00528ad_notifications.py
+-rw-r--r--  2.0 unx     1482 b- defN 23-Apr-25 18:56 mlrun/api/migrations_sqlite/versions/accf9fc83d38_adding_data_versions_table.py
+-rw-r--r--  2.0 unx     1892 b- defN 23-Apr-25 18:56 mlrun/api/migrations_sqlite/versions/b68e8e897a28_schedule_labels.py
+-rw-r--r--  2.0 unx     1882 b- defN 23-Apr-25 18:56 mlrun/api/migrations_sqlite/versions/bcd0c1f9720c_adding_project_labels.py
+-rw-r--r--  2.0 unx     1420 b- defN 23-Apr-25 18:56 mlrun/api/migrations_sqlite/versions/cf21882f938e_schedule_id.py
+-rw-r--r--  2.0 unx     2034 b- defN 23-Apr-25 18:56 mlrun/api/migrations_sqlite/versions/d781f58f607f_tag_object_name_string.py
+-rw-r--r--  2.0 unx     1828 b- defN 23-Apr-25 18:56 mlrun/api/migrations_sqlite/versions/deac06871ace_adding_marketplace_sources_table.py
+-rw-r--r--  2.0 unx     1380 b- defN 23-Apr-25 18:56 mlrun/api/migrations_sqlite/versions/e1dd5983c06b_schedule_concurrency_limit.py
+-rw-r--r--  2.0 unx     1831 b- defN 23-Apr-25 18:56 mlrun/api/migrations_sqlite/versions/e5594ed3ab53_adding_name_and_updated_to_runs_table.py
+-rw-r--r--  2.0 unx     3936 b- defN 23-Apr-25 18:56 mlrun/api/migrations_sqlite/versions/f4249b4ba6fa_adding_feature_vectors.py
+-rw-r--r--  2.0 unx     2588 b- defN 23-Apr-25 18:56 mlrun/api/migrations_sqlite/versions/f7b5a1a03629_adding_feature_labels.py
+-rw-r--r--  2.0 unx     4029 b- defN 23-Apr-25 18:56 mlrun/api/schemas/__init__.py
+-rw-r--r--  2.0 unx     2070 b- defN 23-Apr-25 18:56 mlrun/api/schemas/artifact.py
+-rw-r--r--  2.0 unx     5311 b- defN 23-Apr-25 18:56 mlrun/api/schemas/auth.py
+-rw-r--r--  2.0 unx     1563 b- defN 23-Apr-25 18:56 mlrun/api/schemas/background_task.py
+-rw-r--r--  2.0 unx     2751 b- defN 23-Apr-25 18:56 mlrun/api/schemas/client_spec.py
+-rw-r--r--  2.0 unx      898 b- defN 23-Apr-25 18:56 mlrun/api/schemas/clusterization_spec.py
+-rw-r--r--  2.0 unx     6278 b- defN 23-Apr-25 18:56 mlrun/api/schemas/constants.py
+-rw-r--r--  2.0 unx     3671 b- defN 23-Apr-25 18:56 mlrun/api/schemas/feature_store.py
+-rw-r--r--  2.0 unx     2571 b- defN 23-Apr-25 18:56 mlrun/api/schemas/frontend_spec.py
+-rw-r--r--  2.0 unx     3991 b- defN 23-Apr-25 18:56 mlrun/api/schemas/function.py
+-rw-r--r--  2.0 unx      715 b- defN 23-Apr-25 18:56 mlrun/api/schemas/http.py
+-rw-r--r--  2.0 unx     1405 b- defN 23-Apr-25 18:56 mlrun/api/schemas/k8s.py
+-rw-r--r--  2.0 unx     4592 b- defN 23-Apr-25 18:56 mlrun/api/schemas/marketplace.py
+-rw-r--r--  2.0 unx      920 b- defN 23-Apr-25 18:56 mlrun/api/schemas/memory_reports.py
+-rw-r--r--  2.0 unx    12343 b- defN 23-Apr-25 18:56 mlrun/api/schemas/model_endpoints.py
+-rw-r--r--  2.0 unx      894 b- defN 23-Apr-25 18:56 mlrun/api/schemas/notification.py
+-rw-r--r--  2.0 unx     1965 b- defN 23-Apr-25 18:56 mlrun/api/schemas/object.py
+-rw-r--r--  2.0 unx     1194 b- defN 23-Apr-25 18:56 mlrun/api/schemas/pipeline.py
+-rw-r--r--  2.0 unx     3935 b- defN 23-Apr-25 18:56 mlrun/api/schemas/project.py
+-rw-r--r--  2.0 unx     1646 b- defN 23-Apr-25 18:56 mlrun/api/schemas/runtime_resource.py
+-rw-r--r--  2.0 unx     4192 b- defN 23-Apr-25 18:56 mlrun/api/schemas/schedule.py
+-rw-r--r--  2.0 unx     1494 b- defN 23-Apr-25 18:56 mlrun/api/schemas/secret.py
+-rw-r--r--  2.0 unx      919 b- defN 23-Apr-25 18:56 mlrun/api/schemas/tag.py
+-rw-r--r--  2.0 unx      571 b- defN 23-Apr-25 18:56 mlrun/api/utils/__init__.py
+-rw-r--r--  2.0 unx     1092 b- defN 23-Apr-25 18:56 mlrun/api/utils/asyncio.py
+-rw-r--r--  2.0 unx     7302 b- defN 23-Apr-25 18:56 mlrun/api/utils/background_tasks.py
+-rw-r--r--  2.0 unx     2413 b- defN 23-Apr-25 18:56 mlrun/api/utils/helpers.py
+-rw-r--r--  2.0 unx     3728 b- defN 23-Apr-25 18:56 mlrun/api/utils/memory_reports.py
+-rw-r--r--  2.0 unx     2599 b- defN 23-Apr-25 18:56 mlrun/api/utils/periodic.py
+-rw-r--r--  2.0 unx    38822 b- defN 23-Apr-25 18:56 mlrun/api/utils/scheduler.py
+-rw-r--r--  2.0 unx      571 b- defN 23-Apr-25 18:56 mlrun/api/utils/auth/__init__.py
+-rw-r--r--  2.0 unx    12249 b- defN 23-Apr-25 18:56 mlrun/api/utils/auth/verifier.py
+-rw-r--r--  2.0 unx      571 b- defN 23-Apr-25 18:56 mlrun/api/utils/auth/providers/__init__.py
+-rw-r--r--  2.0 unx     1363 b- defN 23-Apr-25 18:56 mlrun/api/utils/auth/providers/base.py
+-rw-r--r--  2.0 unx     1470 b- defN 23-Apr-25 18:56 mlrun/api/utils/auth/providers/nop.py
+-rw-r--r--  2.0 unx    10835 b- defN 23-Apr-25 18:56 mlrun/api/utils/auth/providers/opa.py
+-rw-r--r--  2.0 unx      571 b- defN 23-Apr-25 18:56 mlrun/api/utils/clients/__init__.py
+-rw-r--r--  2.0 unx    13232 b- defN 23-Apr-25 18:56 mlrun/api/utils/clients/chief.py
+-rw-r--r--  2.0 unx    30488 b- defN 23-Apr-25 18:56 mlrun/api/utils/clients/iguazio.py
+-rw-r--r--  2.0 unx    10775 b- defN 23-Apr-25 18:56 mlrun/api/utils/clients/log_collector.py
+-rw-r--r--  2.0 unx     9841 b- defN 23-Apr-25 18:56 mlrun/api/utils/clients/nuclio.py
+-rw-r--r--  2.0 unx      571 b- defN 23-Apr-25 18:56 mlrun/api/utils/clients/protocols/__init__.py
+-rw-r--r--  2.0 unx     2564 b- defN 23-Apr-25 18:56 mlrun/api/utils/clients/protocols/grpc.py
+-rw-r--r--  2.0 unx      571 b- defN 23-Apr-25 18:56 mlrun/api/utils/db/__init__.py
+-rw-r--r--  2.0 unx     3305 b- defN 23-Apr-25 18:56 mlrun/api/utils/db/alembic.py
+-rw-r--r--  2.0 unx     8214 b- defN 23-Apr-25 18:56 mlrun/api/utils/db/backup.py
+-rw-r--r--  2.0 unx     3795 b- defN 23-Apr-25 18:56 mlrun/api/utils/db/mysql.py
+-rw-r--r--  2.0 unx      992 b- defN 23-Apr-25 18:56 mlrun/api/utils/db/sql_collation.py
+-rw-r--r--  2.0 unx     3855 b- defN 23-Apr-25 18:56 mlrun/api/utils/db/sqlite_migration.py
+-rw-r--r--  2.0 unx      571 b- defN 23-Apr-25 18:56 mlrun/api/utils/projects/__init__.py
+-rw-r--r--  2.0 unx    17315 b- defN 23-Apr-25 18:56 mlrun/api/utils/projects/follower.py
+-rw-r--r--  2.0 unx    19424 b- defN 23-Apr-25 18:56 mlrun/api/utils/projects/leader.py
+-rw-r--r--  2.0 unx     7040 b- defN 23-Apr-25 18:56 mlrun/api/utils/projects/member.py
+-rw-r--r--  2.0 unx      571 b- defN 23-Apr-25 18:56 mlrun/api/utils/projects/remotes/__init__.py
+-rw-r--r--  2.0 unx     2614 b- defN 23-Apr-25 18:56 mlrun/api/utils/projects/remotes/follower.py
+-rw-r--r--  2.0 unx     2064 b- defN 23-Apr-25 18:56 mlrun/api/utils/projects/remotes/leader.py
+-rw-r--r--  2.0 unx     4601 b- defN 23-Apr-25 18:56 mlrun/api/utils/projects/remotes/nop_follower.py
+-rw-r--r--  2.0 unx     3801 b- defN 23-Apr-25 18:56 mlrun/api/utils/projects/remotes/nop_leader.py
+-rw-r--r--  2.0 unx      571 b- defN 23-Apr-25 18:56 mlrun/api/utils/singletons/__init__.py
+-rw-r--r--  2.0 unx     1202 b- defN 23-Apr-25 18:56 mlrun/api/utils/singletons/db.py
+-rw-r--r--  2.0 unx      694 b- defN 23-Apr-25 18:56 mlrun/api/utils/singletons/k8s.py
+-rw-r--r--  2.0 unx      840 b- defN 23-Apr-25 18:56 mlrun/api/utils/singletons/logs_dir.py
+-rw-r--r--  2.0 unx     1279 b- defN 23-Apr-25 18:56 mlrun/api/utils/singletons/project_member.py
+-rw-r--r--  2.0 unx     1063 b- defN 23-Apr-25 18:56 mlrun/api/utils/singletons/scheduler.py
+-rw-r--r--  2.0 unx     1091 b- defN 23-Apr-25 18:56 mlrun/artifacts/__init__.py
+-rw-r--r--  2.0 unx    30849 b- defN 23-Apr-25 18:56 mlrun/artifacts/base.py
+-rw-r--r--  2.0 unx    20366 b- defN 23-Apr-25 18:56 mlrun/artifacts/dataset.py
+-rw-r--r--  2.0 unx    12110 b- defN 23-Apr-25 18:56 mlrun/artifacts/manager.py
+-rw-r--r--  2.0 unx    23673 b- defN 23-Apr-25 18:56 mlrun/artifacts/model.py
+-rw-r--r--  2.0 unx    15383 b- defN 23-Apr-25 18:56 mlrun/artifacts/plots.py
+-rw-r--r--  2.0 unx     1087 b- defN 23-Apr-25 18:56 mlrun/data_types/__init__.py
+-rw-r--r--  2.0 unx     4647 b- defN 23-Apr-25 18:56 mlrun/data_types/data_types.py
+-rw-r--r--  2.0 unx     5813 b- defN 23-Apr-25 18:56 mlrun/data_types/infer.py
+-rw-r--r--  2.0 unx     9426 b- defN 23-Apr-25 18:56 mlrun/data_types/spark.py
+-rw-r--r--  2.0 unx     3300 b- defN 23-Apr-25 18:56 mlrun/datastore/__init__.py
+-rw-r--r--  2.0 unx     6946 b- defN 23-Apr-25 18:56 mlrun/datastore/azure_blob.py
+-rw-r--r--  2.0 unx    17575 b- defN 23-Apr-25 18:56 mlrun/datastore/base.py
+-rw-r--r--  2.0 unx     7995 b- defN 23-Apr-25 18:56 mlrun/datastore/datastore.py
+-rw-r--r--  2.0 unx     3791 b- defN 23-Apr-25 18:56 mlrun/datastore/filestore.py
+-rw-r--r--  2.0 unx     5114 b- defN 23-Apr-25 18:56 mlrun/datastore/google_cloud_storage.py
+-rw-r--r--  2.0 unx     2627 b- defN 23-Apr-25 18:56 mlrun/datastore/inmem.py
+-rw-r--r--  2.0 unx     4873 b- defN 23-Apr-25 18:56 mlrun/datastore/redis.py
+-rw-r--r--  2.0 unx     7035 b- defN 23-Apr-25 18:56 mlrun/datastore/s3.py
+-rw-r--r--  2.0 unx    34023 b- defN 23-Apr-25 18:56 mlrun/datastore/sources.py
+-rw-r--r--  2.0 unx     1402 b- defN 23-Apr-25 18:56 mlrun/datastore/spark_udf.py
+-rw-r--r--  2.0 unx     6889 b- defN 23-Apr-25 18:56 mlrun/datastore/store_resources.py
+-rw-r--r--  2.0 unx    62054 b- defN 23-Apr-25 18:56 mlrun/datastore/targets.py
+-rw-r--r--  2.0 unx     1660 b- defN 23-Apr-25 18:56 mlrun/datastore/utils.py
+-rw-r--r--  2.0 unx     8097 b- defN 23-Apr-25 18:56 mlrun/datastore/v3io.py
+-rw-r--r--  2.0 unx     1343 b- defN 23-Apr-25 18:56 mlrun/datastore/wasbfs/__init__.py
+-rw-r--r--  2.0 unx     6152 b- defN 23-Apr-25 18:56 mlrun/datastore/wasbfs/fs.py
+-rw-r--r--  2.0 unx     2816 b- defN 23-Apr-25 18:56 mlrun/db/__init__.py
+-rw-r--r--  2.0 unx    14771 b- defN 23-Apr-25 18:56 mlrun/db/base.py
+-rw-r--r--  2.0 unx   129128 b- defN 23-Apr-25 18:56 mlrun/db/httpdb.py
+-rw-r--r--  2.0 unx    12257 b- defN 23-Apr-25 18:56 mlrun/db/nopdb.py
+-rw-r--r--  2.0 unx    25370 b- defN 23-Apr-25 18:56 mlrun/db/sqldb.py
+-rw-r--r--  2.0 unx     1501 b- defN 23-Apr-25 18:56 mlrun/feature_store/__init__.py
+-rw-r--r--  2.0 unx    43761 b- defN 23-Apr-25 18:56 mlrun/feature_store/api.py
+-rw-r--r--  2.0 unx    12807 b- defN 23-Apr-25 18:56 mlrun/feature_store/common.py
+-rw-r--r--  2.0 unx    47059 b- defN 23-Apr-25 18:56 mlrun/feature_store/feature_set.py
+-rw-r--r--  2.0 unx    21937 b- defN 23-Apr-25 18:56 mlrun/feature_store/feature_vector.py
+-rw-r--r--  2.0 unx    11813 b- defN 23-Apr-25 18:56 mlrun/feature_store/ingestion.py
+-rw-r--r--  2.0 unx    28635 b- defN 23-Apr-25 18:56 mlrun/feature_store/steps.py
+-rw-r--r--  2.0 unx     1232 b- defN 23-Apr-25 18:56 mlrun/feature_store/retrieval/__init__.py
+-rw-r--r--  2.0 unx    25911 b- defN 23-Apr-25 18:56 mlrun/feature_store/retrieval/base.py
+-rw-r--r--  2.0 unx     4261 b- defN 23-Apr-25 18:56 mlrun/feature_store/retrieval/dask_merger.py
+-rw-r--r--  2.0 unx     7106 b- defN 23-Apr-25 18:56 mlrun/feature_store/retrieval/job.py
+-rw-r--r--  2.0 unx     4765 b- defN 23-Apr-25 18:56 mlrun/feature_store/retrieval/local_merger.py
+-rw-r--r--  2.0 unx     3352 b- defN 23-Apr-25 18:56 mlrun/feature_store/retrieval/online.py
+-rw-r--r--  2.0 unx     9661 b- defN 23-Apr-25 18:56 mlrun/feature_store/retrieval/spark_merger.py
+-rw-r--r--  2.0 unx      743 b- defN 23-Apr-25 18:56 mlrun/frameworks/__init__.py
+-rw-r--r--  2.0 unx    11466 b- defN 23-Apr-25 18:56 mlrun/frameworks/parallel_coordinates.py
+-rw-r--r--  2.0 unx      962 b- defN 23-Apr-25 18:56 mlrun/frameworks/_common/__init__.py
+-rw-r--r--  2.0 unx     8515 b- defN 23-Apr-25 18:56 mlrun/frameworks/_common/artifacts_library.py
+-rw-r--r--  2.0 unx    21018 b- defN 23-Apr-25 18:56 mlrun/frameworks/_common/mlrun_interface.py
+-rw-r--r--  2.0 unx    55376 b- defN 23-Apr-25 18:56 mlrun/frameworks/_common/model_handler.py
+-rw-r--r--  2.0 unx     3469 b- defN 23-Apr-25 18:56 mlrun/frameworks/_common/plan.py
+-rw-r--r--  2.0 unx     5757 b- defN 23-Apr-25 18:56 mlrun/frameworks/_common/producer.py
+-rw-r--r--  2.0 unx     9209 b- defN 23-Apr-25 18:56 mlrun/frameworks/_common/utils.py
+-rw-r--r--  2.0 unx      750 b- defN 23-Apr-25 18:56 mlrun/frameworks/_dl_common/__init__.py
+-rw-r--r--  2.0 unx     1151 b- defN 23-Apr-25 18:56 mlrun/frameworks/_dl_common/model_handler.py
+-rw-r--r--  2.0 unx      996 b- defN 23-Apr-25 18:56 mlrun/frameworks/_dl_common/utils.py
+-rw-r--r--  2.0 unx      787 b- defN 23-Apr-25 18:56 mlrun/frameworks/_dl_common/loggers/__init__.py
+-rw-r--r--  2.0 unx    11531 b- defN 23-Apr-25 18:56 mlrun/frameworks/_dl_common/loggers/logger.py
+-rw-r--r--  2.0 unx    14777 b- defN 23-Apr-25 18:56 mlrun/frameworks/_dl_common/loggers/mlrun_logger.py
+-rw-r--r--  2.0 unx    28414 b- defN 23-Apr-25 18:56 mlrun/frameworks/_dl_common/loggers/tensorboard_logger.py
+-rw-r--r--  2.0 unx      956 b- defN 23-Apr-25 18:56 mlrun/frameworks/_ml_common/__init__.py
+-rw-r--r--  2.0 unx     3169 b- defN 23-Apr-25 18:56 mlrun/frameworks/_ml_common/artifacts_library.py
+-rw-r--r--  2.0 unx    16957 b- defN 23-Apr-25 18:56 mlrun/frameworks/_ml_common/model_handler.py
+-rw-r--r--  2.0 unx     2368 b- defN 23-Apr-25 18:56 mlrun/frameworks/_ml_common/pkl_model_server.py
+-rw-r--r--  2.0 unx     4881 b- defN 23-Apr-25 18:56 mlrun/frameworks/_ml_common/plan.py
+-rw-r--r--  2.0 unx     4061 b- defN 23-Apr-25 18:56 mlrun/frameworks/_ml_common/producer.py
+-rw-r--r--  2.0 unx    10490 b- defN 23-Apr-25 18:56 mlrun/frameworks/_ml_common/utils.py
+-rw-r--r--  2.0 unx      737 b- defN 23-Apr-25 18:56 mlrun/frameworks/_ml_common/loggers/__init__.py
+-rw-r--r--  2.0 unx     5684 b- defN 23-Apr-25 18:56 mlrun/frameworks/_ml_common/loggers/logger.py
+-rw-r--r--  2.0 unx     6453 b- defN 23-Apr-25 18:56 mlrun/frameworks/_ml_common/loggers/mlrun_logger.py
+-rw-r--r--  2.0 unx      922 b- defN 23-Apr-25 18:56 mlrun/frameworks/_ml_common/plans/__init__.py
+-rw-r--r--  2.0 unx     5212 b- defN 23-Apr-25 18:56 mlrun/frameworks/_ml_common/plans/calibration_curve_plan.py
+-rw-r--r--  2.0 unx     6078 b- defN 23-Apr-25 18:56 mlrun/frameworks/_ml_common/plans/confusion_matrix_plan.py
+-rw-r--r--  2.0 unx     6658 b- defN 23-Apr-25 18:56 mlrun/frameworks/_ml_common/plans/dataset_plan.py
+-rw-r--r--  2.0 unx     5318 b- defN 23-Apr-25 18:56 mlrun/frameworks/_ml_common/plans/feature_importance_plan.py
+-rw-r--r--  2.0 unx     6993 b- defN 23-Apr-25 18:56 mlrun/frameworks/_ml_common/plans/roc_curve_plan.py
+-rw-r--r--  2.0 unx      706 b- defN 23-Apr-25 18:56 mlrun/frameworks/auto_mlrun/__init__.py
+-rw-r--r--  2.0 unx    23796 b- defN 23-Apr-25 18:56 mlrun/frameworks/auto_mlrun/auto_mlrun.py
+-rw-r--r--  2.0 unx      721 b- defN 23-Apr-25 18:56 mlrun/frameworks/huggingface/__init__.py
+-rw-r--r--  2.0 unx     6083 b- defN 23-Apr-25 18:56 mlrun/frameworks/huggingface/model_server.py
+-rw-r--r--  2.0 unx    15883 b- defN 23-Apr-25 18:56 mlrun/frameworks/lgbm/__init__.py
+-rw-r--r--  2.0 unx    13891 b- defN 23-Apr-25 18:56 mlrun/frameworks/lgbm/model_handler.py
+-rw-r--r--  2.0 unx     9189 b- defN 23-Apr-25 18:56 mlrun/frameworks/lgbm/model_server.py
+-rw-r--r--  2.0 unx     8278 b- defN 23-Apr-25 18:56 mlrun/frameworks/lgbm/utils.py
+-rw-r--r--  2.0 unx      857 b- defN 23-Apr-25 18:56 mlrun/frameworks/lgbm/callbacks/__init__.py
+-rw-r--r--  2.0 unx     4081 b- defN 23-Apr-25 18:56 mlrun/frameworks/lgbm/callbacks/callback.py
+-rw-r--r--  2.0 unx     5156 b- defN 23-Apr-25 18:56 mlrun/frameworks/lgbm/callbacks/logging_callback.py
+-rw-r--r--  2.0 unx     4137 b- defN 23-Apr-25 18:56 mlrun/frameworks/lgbm/callbacks/mlrun_logging_callback.py
+-rw-r--r--  2.0 unx      842 b- defN 23-Apr-25 18:56 mlrun/frameworks/lgbm/mlrun_interfaces/__init__.py
+-rw-r--r--  2.0 unx     1624 b- defN 23-Apr-25 18:56 mlrun/frameworks/lgbm/mlrun_interfaces/booster_mlrun_interface.py
+-rw-r--r--  2.0 unx    14256 b- defN 23-Apr-25 18:56 mlrun/frameworks/lgbm/mlrun_interfaces/mlrun_interface.py
+-rw-r--r--  2.0 unx     1333 b- defN 23-Apr-25 18:56 mlrun/frameworks/lgbm/mlrun_interfaces/model_mlrun_interface.py
+-rw-r--r--  2.0 unx      791 b- defN 23-Apr-25 18:56 mlrun/frameworks/onnx/__init__.py
+-rw-r--r--  2.0 unx     6098 b- defN 23-Apr-25 18:56 mlrun/frameworks/onnx/dataset.py
+-rw-r--r--  2.0 unx     2405 b- defN 23-Apr-25 18:56 mlrun/frameworks/onnx/mlrun_interface.py
+-rw-r--r--  2.0 unx     6203 b- defN 23-Apr-25 18:56 mlrun/frameworks/onnx/model_handler.py
+-rw-r--r--  2.0 unx     7061 b- defN 23-Apr-25 18:56 mlrun/frameworks/onnx/model_server.py
+-rw-r--r--  2.0 unx    22056 b- defN 23-Apr-25 18:56 mlrun/frameworks/pytorch/__init__.py
+-rw-r--r--  2.0 unx    27904 b- defN 23-Apr-25 18:56 mlrun/frameworks/pytorch/callbacks_handler.py
+-rw-r--r--  2.0 unx    44639 b- defN 23-Apr-25 18:56 mlrun/frameworks/pytorch/mlrun_interface.py
+-rw-r--r--  2.0 unx    22465 b- defN 23-Apr-25 18:56 mlrun/frameworks/pytorch/model_handler.py
+-rw-r--r--  2.0 unx    10136 b- defN 23-Apr-25 18:56 mlrun/frameworks/pytorch/model_server.py
+-rw-r--r--  2.0 unx     4515 b- defN 23-Apr-25 18:56 mlrun/frameworks/pytorch/utils.py
+-rw-r--r--  2.0 unx      896 b- defN 23-Apr-25 18:56 mlrun/frameworks/pytorch/callbacks/__init__.py
+-rw-r--r--  2.0 unx    11524 b- defN 23-Apr-25 18:56 mlrun/frameworks/pytorch/callbacks/callback.py
+-rw-r--r--  2.0 unx    23166 b- defN 23-Apr-25 18:56 mlrun/frameworks/pytorch/callbacks/logging_callback.py
+-rw-r--r--  2.0 unx     9310 b- defN 23-Apr-25 18:56 mlrun/frameworks/pytorch/callbacks/mlrun_logging_callback.py
+-rw-r--r--  2.0 unx    26661 b- defN 23-Apr-25 18:56 mlrun/frameworks/pytorch/callbacks/tensorboard_logging_callback.py
+-rw-r--r--  2.0 unx    10892 b- defN 23-Apr-25 18:56 mlrun/frameworks/sklearn/__init__.py
+-rw-r--r--  2.0 unx     5852 b- defN 23-Apr-25 18:56 mlrun/frameworks/sklearn/estimator.py
+-rw-r--r--  2.0 unx     7117 b- defN 23-Apr-25 18:56 mlrun/frameworks/sklearn/metric.py
+-rw-r--r--  2.0 unx    12215 b- defN 23-Apr-25 18:56 mlrun/frameworks/sklearn/metrics_library.py
+-rw-r--r--  2.0 unx    14126 b- defN 23-Apr-25 18:56 mlrun/frameworks/sklearn/mlrun_interface.py
+-rw-r--r--  2.0 unx     4745 b- defN 23-Apr-25 18:56 mlrun/frameworks/sklearn/model_handler.py
+-rw-r--r--  2.0 unx     1209 b- defN 23-Apr-25 18:56 mlrun/frameworks/sklearn/utils.py
+-rw-r--r--  2.0 unx    10455 b- defN 23-Apr-25 18:56 mlrun/frameworks/tf_keras/__init__.py
+-rw-r--r--  2.0 unx    16627 b- defN 23-Apr-25 18:56 mlrun/frameworks/tf_keras/mlrun_interface.py
+-rw-r--r--  2.0 unx    28247 b- defN 23-Apr-25 18:56 mlrun/frameworks/tf_keras/model_handler.py
+-rw-r--r--  2.0 unx     9565 b- defN 23-Apr-25 18:56 mlrun/frameworks/tf_keras/model_server.py
+-rw-r--r--  2.0 unx     4284 b- defN 23-Apr-25 18:56 mlrun/frameworks/tf_keras/utils.py
+-rw-r--r--  2.0 unx      844 b- defN 23-Apr-25 18:56 mlrun/frameworks/tf_keras/callbacks/__init__.py
+-rw-r--r--  2.0 unx    21886 b- defN 23-Apr-25 18:56 mlrun/frameworks/tf_keras/callbacks/logging_callback.py
+-rw-r--r--  2.0 unx     8791 b- defN 23-Apr-25 18:56 mlrun/frameworks/tf_keras/callbacks/mlrun_logging_callback.py
+-rw-r--r--  2.0 unx    28728 b- defN 23-Apr-25 18:56 mlrun/frameworks/tf_keras/callbacks/tensorboard_logging_callback.py
+-rw-r--r--  2.0 unx    10287 b- defN 23-Apr-25 18:56 mlrun/frameworks/xgboost/__init__.py
+-rw-r--r--  2.0 unx      878 b- defN 23-Apr-25 18:56 mlrun/frameworks/xgboost/mlrun_interface.py
+-rw-r--r--  2.0 unx    11617 b- defN 23-Apr-25 18:56 mlrun/frameworks/xgboost/model_handler.py
+-rw-r--r--  2.0 unx     1069 b- defN 23-Apr-25 18:56 mlrun/frameworks/xgboost/utils.py
+-rw-r--r--  2.0 unx      760 b- defN 23-Apr-25 18:56 mlrun/mlutils/__init__.py
+-rw-r--r--  2.0 unx     5325 b- defN 23-Apr-25 18:56 mlrun/mlutils/data.py
+-rw-r--r--  2.0 unx     2598 b- defN 23-Apr-25 18:56 mlrun/mlutils/models.py
+-rw-r--r--  2.0 unx    30120 b- defN 23-Apr-25 18:56 mlrun/mlutils/plots.py
+-rw-r--r--  2.0 unx     1307 b- defN 23-Apr-25 18:56 mlrun/model_monitoring/__init__.py
+-rw-r--r--  2.0 unx     2962 b- defN 23-Apr-25 18:56 mlrun/model_monitoring/common.py
+-rw-r--r--  2.0 unx     3117 b- defN 23-Apr-25 18:56 mlrun/model_monitoring/constants.py
+-rw-r--r--  2.0 unx    23948 b- defN 23-Apr-25 18:56 mlrun/model_monitoring/features_drift_table.py
+-rw-r--r--  2.0 unx     5935 b- defN 23-Apr-25 18:56 mlrun/model_monitoring/helpers.py
+-rw-r--r--  2.0 unx     5176 b- defN 23-Apr-25 18:56 mlrun/model_monitoring/model_endpoint.py
+-rw-r--r--  2.0 unx    36191 b- defN 23-Apr-25 18:56 mlrun/model_monitoring/model_monitoring_batch.py
+-rw-r--r--  2.0 unx    43025 b- defN 23-Apr-25 18:56 mlrun/model_monitoring/stream_processing_fs.py
+-rw-r--r--  2.0 unx     4240 b- defN 23-Apr-25 18:56 mlrun/model_monitoring/stores/__init__.py
+-rw-r--r--  2.0 unx    16926 b- defN 23-Apr-25 18:56 mlrun/model_monitoring/stores/kv_model_endpoint_store.py
+-rw-r--r--  2.0 unx     5695 b- defN 23-Apr-25 18:56 mlrun/model_monitoring/stores/model_endpoint_store.py
+-rw-r--r--  2.0 unx    15700 b- defN 23-Apr-25 18:56 mlrun/model_monitoring/stores/sql_model_endpoint_store.py
+-rw-r--r--  2.0 unx      884 b- defN 23-Apr-25 18:56 mlrun/model_monitoring/stores/models/__init__.py
+-rw-r--r--  2.0 unx      655 b- defN 23-Apr-25 18:56 mlrun/model_monitoring/stores/models/base.py
+-rw-r--r--  2.0 unx     3744 b- defN 23-Apr-25 18:56 mlrun/model_monitoring/stores/models/mysql.py
+-rw-r--r--  2.0 unx     3661 b- defN 23-Apr-25 18:56 mlrun/model_monitoring/stores/models/sqlite.py
+-rw-r--r--  2.0 unx     2400 b- defN 23-Apr-25 18:56 mlrun/platforms/__init__.py
+-rw-r--r--  2.0 unx    23113 b- defN 23-Apr-25 18:56 mlrun/platforms/iguazio.py
+-rw-r--r--  2.0 unx    11852 b- defN 23-Apr-25 18:56 mlrun/platforms/other.py
+-rw-r--r--  2.0 unx     1153 b- defN 23-Apr-25 18:56 mlrun/projects/__init__.py
+-rw-r--r--  2.0 unx    17485 b- defN 23-Apr-25 18:56 mlrun/projects/operations.py
+-rw-r--r--  2.0 unx    37899 b- defN 23-Apr-25 18:56 mlrun/projects/pipelines.py
+-rw-r--r--  2.0 unx   104532 b- defN 23-Apr-25 18:56 mlrun/projects/project.py
+-rw-r--r--  2.0 unx     8773 b- defN 23-Apr-25 18:56 mlrun/runtimes/__init__.py
+-rw-r--r--  2.0 unx   109502 b- defN 23-Apr-25 18:56 mlrun/runtimes/base.py
+-rw-r--r--  2.0 unx     6689 b- defN 23-Apr-25 18:56 mlrun/runtimes/constants.py
+-rw-r--r--  2.0 unx    30403 b- defN 23-Apr-25 18:56 mlrun/runtimes/daskjob.py
+-rw-r--r--  2.0 unx     9190 b- defN 23-Apr-25 18:56 mlrun/runtimes/funcdoc.py
+-rw-r--r--  2.0 unx    70153 b- defN 23-Apr-25 18:56 mlrun/runtimes/function.py
+-rw-r--r--  2.0 unx     4911 b- defN 23-Apr-25 18:56 mlrun/runtimes/function_reference.py
+-rw-r--r--  2.0 unx     6530 b- defN 23-Apr-25 18:56 mlrun/runtimes/generators.py
+-rw-r--r--  2.0 unx    16895 b- defN 23-Apr-25 18:56 mlrun/runtimes/kubejob.py
+-rw-r--r--  2.0 unx    18005 b- defN 23-Apr-25 18:56 mlrun/runtimes/local.py
+-rw-r--r--  2.0 unx     2885 b- defN 23-Apr-25 18:56 mlrun/runtimes/nuclio.py
+-rw-r--r--  2.0 unx    60648 b- defN 23-Apr-25 18:56 mlrun/runtimes/pod.py
+-rw-r--r--  2.0 unx     7695 b- defN 23-Apr-25 18:56 mlrun/runtimes/remotesparkjob.py
+-rw-r--r--  2.0 unx    29852 b- defN 23-Apr-25 18:56 mlrun/runtimes/serving.py
+-rw-r--r--  2.0 unx    21249 b- defN 23-Apr-25 18:56 mlrun/runtimes/utils.py
+-rw-r--r--  2.0 unx      790 b- defN 23-Apr-25 18:56 mlrun/runtimes/mpijob/__init__.py
+-rw-r--r--  2.0 unx    14782 b- defN 23-Apr-25 18:56 mlrun/runtimes/mpijob/abstract.py
+-rw-r--r--  2.0 unx    13845 b- defN 23-Apr-25 18:56 mlrun/runtimes/mpijob/v1.py
+-rw-r--r--  2.0 unx     8460 b- defN 23-Apr-25 18:56 mlrun/runtimes/mpijob/v1alpha1.py
+-rw-r--r--  2.0 unx      673 b- defN 23-Apr-25 18:56 mlrun/runtimes/package/__init__.py
+-rw-r--r--  2.0 unx    27044 b- defN 23-Apr-25 18:56 mlrun/runtimes/package/context_handler.py
+-rw-r--r--  2.0 unx      751 b- defN 23-Apr-25 18:56 mlrun/runtimes/sparkjob/__init__.py
+-rw-r--r--  2.0 unx    35869 b- defN 23-Apr-25 18:56 mlrun/runtimes/sparkjob/abstract.py
+-rw-r--r--  2.0 unx    28722 b- defN 23-Apr-25 18:56 mlrun/runtimes/sparkjob/spark3job.py
+-rw-r--r--  2.0 unx     1078 b- defN 23-Apr-25 18:56 mlrun/serving/__init__.py
+-rw-r--r--  2.0 unx     6116 b- defN 23-Apr-25 18:56 mlrun/serving/merger.py
+-rw-r--r--  2.0 unx    18038 b- defN 23-Apr-25 18:56 mlrun/serving/remote.py
+-rw-r--r--  2.0 unx    55209 b- defN 23-Apr-25 18:56 mlrun/serving/routers.py
+-rw-r--r--  2.0 unx    19005 b- defN 23-Apr-25 18:56 mlrun/serving/server.py
+-rw-r--r--  2.0 unx      836 b- defN 23-Apr-25 18:56 mlrun/serving/serving_wrapper.py
+-rw-r--r--  2.0 unx    53940 b- defN 23-Apr-25 18:56 mlrun/serving/states.py
+-rw-r--r--  2.0 unx     3468 b- defN 23-Apr-25 18:56 mlrun/serving/utils.py
+-rw-r--r--  2.0 unx    11814 b- defN 23-Apr-25 18:56 mlrun/serving/v1_serving.py
+-rw-r--r--  2.0 unx    21441 b- defN 23-Apr-25 18:56 mlrun/serving/v2_serving.py
+-rw-r--r--  2.0 unx      855 b- defN 23-Apr-25 18:56 mlrun/utils/__init__.py
+-rw-r--r--  2.0 unx    10397 b- defN 23-Apr-25 18:56 mlrun/utils/async_http.py
+-rw-r--r--  2.0 unx     3456 b- defN 23-Apr-25 18:56 mlrun/utils/azure_vault.py
+-rw-r--r--  2.0 unx     6245 b- defN 23-Apr-25 18:56 mlrun/utils/clones.py
+-rw-r--r--  2.0 unx     1662 b- defN 23-Apr-25 18:56 mlrun/utils/db.py
+-rw-r--r--  2.0 unx    41425 b- defN 23-Apr-25 18:56 mlrun/utils/helpers.py
+-rw-r--r--  2.0 unx     7093 b- defN 23-Apr-25 18:56 mlrun/utils/http.py
+-rw-r--r--  2.0 unx     5637 b- defN 23-Apr-25 18:56 mlrun/utils/logger.py
+-rw-r--r--  2.0 unx     7875 b- defN 23-Apr-25 18:56 mlrun/utils/model_monitoring.py
+-rw-r--r--  2.0 unx     3954 b- defN 23-Apr-25 18:56 mlrun/utils/regex.py
+-rw-r--r--  2.0 unx      883 b- defN 23-Apr-25 18:56 mlrun/utils/singleton.py
+-rw-r--r--  2.0 unx     1319 b- defN 23-Apr-25 18:56 mlrun/utils/v3io_clients.py
+-rw-r--r--  2.0 unx     9957 b- defN 23-Apr-25 18:56 mlrun/utils/vault.py
+-rw-r--r--  2.0 unx      990 b- defN 23-Apr-25 18:56 mlrun/utils/notifications/__init__.py
+-rw-r--r--  2.0 unx    12297 b- defN 23-Apr-25 18:56 mlrun/utils/notifications/notification_pusher.py
+-rw-r--r--  2.0 unx     1803 b- defN 23-Apr-25 18:56 mlrun/utils/notifications/notification/__init__.py
+-rw-r--r--  2.0 unx     2162 b- defN 23-Apr-25 18:56 mlrun/utils/notifications/notification/base.py
+-rw-r--r--  2.0 unx     1962 b- defN 23-Apr-25 18:56 mlrun/utils/notifications/notification/console.py
+-rw-r--r--  2.0 unx     4733 b- defN 23-Apr-25 18:56 mlrun/utils/notifications/notification/git.py
+-rw-r--r--  2.0 unx     2012 b- defN 23-Apr-25 18:56 mlrun/utils/notifications/notification/ipython.py
+-rw-r--r--  2.0 unx     3736 b- defN 23-Apr-25 18:56 mlrun/utils/notifications/notification/slack.py
+-rw-r--r--  2.0 unx      614 b- defN 23-Apr-25 18:56 mlrun/utils/version/__init__.py
+-rw-r--r--  2.0 unx       88 b- defN 23-Apr-25 18:56 mlrun/utils/version/version.json
+-rw-r--r--  2.0 unx     1970 b- defN 23-Apr-25 18:56 mlrun/utils/version/version.py
+-rw-r--r--  2.0 unx    11357 b- defN 23-Apr-25 18:56 mlrun-1.4.0rc1.dist-info/LICENSE
+-rw-r--r--  2.0 unx    17177 b- defN 23-Apr-25 18:56 mlrun-1.4.0rc1.dist-info/METADATA
+-rw-r--r--  2.0 unx       92 b- defN 23-Apr-25 18:56 mlrun-1.4.0rc1.dist-info/WHEEL
+-rw-r--r--  2.0 unx       47 b- defN 23-Apr-25 18:56 mlrun-1.4.0rc1.dist-info/entry_points.txt
+-rw-r--r--  2.0 unx        6 b- defN 23-Apr-25 18:56 mlrun-1.4.0rc1.dist-info/top_level.txt
+-rw-rw-r--  2.0 unx    36988 b- defN 23-Apr-25 18:56 mlrun-1.4.0rc1.dist-info/RECORD
+394 files, 4343926 bytes uncompressed, 1103558 bytes compressed:  74.6%
```

## zipnote {}

```diff
@@ -171,14 +171,17 @@
 
 Filename: mlrun/api/crud/logs.py
 Comment: 
 
 Filename: mlrun/api/crud/marketplace.py
 Comment: 
 
+Filename: mlrun/api/crud/notifications.py
+Comment: 
+
 Filename: mlrun/api/crud/pipelines.py
 Comment: 
 
 Filename: mlrun/api/crud/projects.py
 Comment: 
 
 Filename: mlrun/api/crud/runs.py
@@ -210,20 +213,14 @@
 
 Filename: mlrun/api/db/init_db.py
 Comment: 
 
 Filename: mlrun/api/db/session.py
 Comment: 
 
-Filename: mlrun/api/db/filedb/__init__.py
-Comment: 
-
-Filename: mlrun/api/db/filedb/db.py
-Comment: 
-
 Filename: mlrun/api/db/sqldb/__init__.py
 Comment: 
 
 Filename: mlrun/api/db/sqldb/db.py
 Comment: 
 
 Filename: mlrun/api/db/sqldb/helpers.py
@@ -261,14 +258,17 @@
 
 Filename: mlrun/api/migrations_mysql/versions/b86f5b53f3d7_adding_name_and_updated_to_runs_table.py
 Comment: 
 
 Filename: mlrun/api/migrations_mysql/versions/c4af40b0bf61_init.py
 Comment: 
 
+Filename: mlrun/api/migrations_mysql/versions/c905d15bd91d_notifications.py
+Comment: 
+
 Filename: mlrun/api/migrations_mysql/versions/ee041e8fdaa0_adding_next_run_time_column_to_schedule_.py
 Comment: 
 
 Filename: mlrun/api/migrations_sqlite/env.py
 Comment: 
 
 Filename: mlrun/api/migrations_sqlite/versions/11f8dd2dc9fe_init.py
@@ -288,14 +288,17 @@
 
 Filename: mlrun/api/migrations_sqlite/versions/803438ecd005_add_requested_logs_column_to_runs.py
 Comment: 
 
 Filename: mlrun/api/migrations_sqlite/versions/863114f0c659_refactoring_feature_set.py
 Comment: 
 
+Filename: mlrun/api/migrations_sqlite/versions/959ae00528ad_notifications.py
+Comment: 
+
 Filename: mlrun/api/migrations_sqlite/versions/accf9fc83d38_adding_data_versions_table.py
 Comment: 
 
 Filename: mlrun/api/migrations_sqlite/versions/b68e8e897a28_schedule_labels.py
 Comment: 
 
 Filename: mlrun/api/migrations_sqlite/versions/bcd0c1f9720c_adding_project_labels.py
@@ -363,14 +366,17 @@
 
 Filename: mlrun/api/schemas/memory_reports.py
 Comment: 
 
 Filename: mlrun/api/schemas/model_endpoints.py
 Comment: 
 
+Filename: mlrun/api/schemas/notification.py
+Comment: 
+
 Filename: mlrun/api/schemas/object.py
 Comment: 
 
 Filename: mlrun/api/schemas/pipeline.py
 Comment: 
 
 Filename: mlrun/api/schemas/project.py
@@ -594,18 +600,18 @@
 
 Filename: mlrun/db/__init__.py
 Comment: 
 
 Filename: mlrun/db/base.py
 Comment: 
 
-Filename: mlrun/db/filedb.py
+Filename: mlrun/db/httpdb.py
 Comment: 
 
-Filename: mlrun/db/httpdb.py
+Filename: mlrun/db/nopdb.py
 Comment: 
 
 Filename: mlrun/db/sqldb.py
 Comment: 
 
 Filename: mlrun/feature_store/__init__.py
 Comment: 
@@ -1047,17 +1053,14 @@
 
 Filename: mlrun/runtimes/sparkjob/__init__.py
 Comment: 
 
 Filename: mlrun/runtimes/sparkjob/abstract.py
 Comment: 
 
-Filename: mlrun/runtimes/sparkjob/spark2job.py
-Comment: 
-
 Filename: mlrun/runtimes/sparkjob/spark3job.py
 Comment: 
 
 Filename: mlrun/serving/__init__.py
 Comment: 
 
 Filename: mlrun/serving/merger.py
@@ -1155,26 +1158,26 @@
 
 Filename: mlrun/utils/version/version.json
 Comment: 
 
 Filename: mlrun/utils/version/version.py
 Comment: 
 
-Filename: mlrun-1.3.1rc4.dist-info/LICENSE
+Filename: mlrun-1.4.0rc1.dist-info/LICENSE
 Comment: 
 
-Filename: mlrun-1.3.1rc4.dist-info/METADATA
+Filename: mlrun-1.4.0rc1.dist-info/METADATA
 Comment: 
 
-Filename: mlrun-1.3.1rc4.dist-info/WHEEL
+Filename: mlrun-1.4.0rc1.dist-info/WHEEL
 Comment: 
 
-Filename: mlrun-1.3.1rc4.dist-info/entry_points.txt
+Filename: mlrun-1.4.0rc1.dist-info/entry_points.txt
 Comment: 
 
-Filename: mlrun-1.3.1rc4.dist-info/top_level.txt
+Filename: mlrun-1.4.0rc1.dist-info/top_level.txt
 Comment: 
 
-Filename: mlrun-1.3.1rc4.dist-info/RECORD
+Filename: mlrun-1.4.0rc1.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## mlrun/__main__.py

```diff
@@ -1048,14 +1048,23 @@
     help="Overwrite a schedule when submitting a new one with the same name.",
 )
 @click.option(
     "--save-secrets",
     is_flag=True,
     help="Store the project secrets as k8s secrets",
 )
+@click.option(
+    "--notifications",
+    "--notification",
+    "-nt",
+    multiple=True,
+    help="To have a notification for the run set notification file "
+    "destination define: file=notification.json or a "
+    'dictionary configuration e.g \'{"slack":{"webhook":"<webhook>"}}\'',
+)
 def project(
     context,
     name,
     url,
     run,
     arguments,
     artifact_path,
@@ -1073,14 +1082,15 @@
     handler,
     engine,
     local,
     env_file,
     timeout,
     ensure_project,
     schedule,
+    notifications,
     overwrite_schedule,
     save_secrets,
     save,
 ):
     """load and/or run a project"""
     if env_file:
         mlrun.set_env_from_file(env_file)
@@ -1148,14 +1158,16 @@
                 "git",
                 {
                     "repo": git_repo,
                     "issue": git_issue,
                     "token": proj.get_param("GIT_TOKEN"),
                 },
             )
+        if notifications:
+            load_notification(notifications, proj)
         try:
             proj.run(
                 name=run,
                 workflow_path=workflow_path,
                 arguments=args,
                 artifact_path=artifact_path,
                 namespace=namespace,
@@ -1165,19 +1177,17 @@
                 workflow_handler=handler,
                 engine=engine,
                 local=local,
                 schedule=schedule,
                 timeout=timeout,
                 overwrite=overwrite_schedule,
             )
-
-        except Exception as exc:
+        except Exception as err:
             print(traceback.format_exc())
-            message = f"failed to run pipeline, {err_to_str(exc)}"
-            proj.notifiers.push(message, "error")
+            send_workflow_error_notification(run, proj, err)
             exit(1)
 
     elif sync:
         print("saving project functions to db ..")
         proj.sync_functions(save=True)
 
 
@@ -1446,9 +1456,52 @@
     if not runtime:
         logger.error(f"function {func_url} not found or is null")
         return None
 
     return runtime
 
 
+def load_notification(notifications: str, project: mlrun.projects.MlrunProject):
+    """
+    A dictionary or json file containing notification dictionaries can be used by the user to set notifications.
+    Each notification is stored in a tuple called notifications.
+    The code then goes through each value in the notifications tuple and check
+    if the notification starts with "file=", such as "file=notification.json," in those cases it loads the
+    notification.json file and uses add_notification_to_project to add the notifications from the file to
+    the project. If not, it adds the notification dictionary to the project.
+    :param notifications:  Notifications file or a dictionary to be added to the project
+    :param project: The object to which the notifications will be added
+    :return:
+    """
+    for notification in notifications:
+        if notification.startswith("file="):
+            file_path = notification.split("=")[-1]
+            notification = open(file_path, "r")
+            notification = json.load(notification)
+        else:
+            notification = json.loads(notification)
+        add_notification_to_project(notification, project)
+
+
+def add_notification_to_project(
+    notification: str, project: mlrun.projects.MlrunProject
+):
+    for notification_type, notification_params in notification.items():
+        project.notifiers.add_notification(
+            notification_type=notification_type, params=notification_params
+        )
+
+
+def send_workflow_error_notification(
+    run_id: str, project: mlrun.projects.MlrunProject, error: KeyError
+):
+    message = (
+        f":x: Failed to run scheduled workflow {run_id} in Project {project.name} !\n"
+        f"error: ```{err_to_str(error)}```"
+    )
+    project.notifiers.push(
+        message=message, severity=mlrun.api.schemas.NotificationSeverity.ERROR
+    )
+
+
 if __name__ == "__main__":
     main()
```

## mlrun/builder.py

```diff
@@ -31,22 +31,22 @@
 from .k8s_utils import BasePod, get_k8s_helper
 from .utils import enrich_image_url, get_parsed_docker_registry, logger, normalize_name
 
 IMAGE_NAME_ENRICH_REGISTRY_PREFIX = "."
 
 
 def make_dockerfile(
-    base_image,
-    commands=None,
-    source=None,
-    requirements=None,
-    workdir="/mlrun",
-    extra="",
-    user_unix_id=None,
-    enriched_group_id=None,
+    base_image: str,
+    commands: list = None,
+    source: str = None,
+    requirements_path: str = None,
+    workdir: str = "/mlrun",
+    extra: str = "",
+    user_unix_id: int = None,
+    enriched_group_id: int = None,
 ):
     dock = f"FROM {base_image}\n"
 
     if config.is_pip_ca_configured():
         dock += f"COPY ./{pathlib.Path(config.httpdb.builder.pip_ca_path).name} {config.httpdb.builder.pip_ca_path}\n"
         dock += f"ARG PIP_CERT={config.httpdb.builder.pip_ca_path}\n"
 
@@ -72,18 +72,21 @@
         else:
             dock += f"ADD {source} {workdir}\n"
 
         if user_unix_id is not None and enriched_group_id is not None:
             dock += f"RUN chown -R {user_unix_id}:{enriched_group_id} {workdir}\n"
 
         dock += f"ENV PYTHONPATH {workdir}\n"
-    if requirements:
-        dock += f"RUN python -m pip install -r {requirements}\n"
     if commands:
         dock += "".join([f"RUN {command}\n" for command in commands])
+    if requirements_path:
+        dock += (
+            f"RUN echo 'Installing {requirements_path}...'; cat {requirements_path}\n"
+        )
+        dock += f"RUN python -m pip install -r {requirements_path}\n"
     if extra:
         dock += extra
     logger.debug("Resolved dockerfile", dockfile_contents=dock)
     return dock
 
 
 def make_kaniko_pod(
@@ -91,14 +94,15 @@
     context,
     dest,
     dockerfile=None,
     dockertext=None,
     inline_code=None,
     inline_path=None,
     requirements=None,
+    requirements_path=None,
     secret_name=None,
     name="",
     verbose=False,
     builder_env=None,
     runtime_spec=None,
     registry=None,
 ):
@@ -189,27 +193,31 @@
         )
 
     if dockertext or inline_code or requirements:
         kpod.mount_empty()
         commands = []
         env = {}
         if dockertext:
-            commands.append("echo ${DOCKERFILE} | base64 -d > /empty/Dockerfile")
+            # set and encode docker content to the DOCKERFILE environment variable in the kaniko pod
             env["DOCKERFILE"] = b64encode(dockertext.encode("utf-8")).decode("utf-8")
+            # dump dockerfile content and decode to Dockerfile destination
+            commands.append("echo ${DOCKERFILE} | base64 -d > /empty/Dockerfile")
         if inline_code:
             name = inline_path or "main.py"
-            commands.append("echo ${CODE} | base64 -d > /empty/" + name)
             env["CODE"] = b64encode(inline_code.encode("utf-8")).decode("utf-8")
+            commands.append("echo ${CODE} | base64 -d > /empty/" + name)
         if requirements:
-            commands.append(
-                "echo ${REQUIREMENTS} | base64 -d > /empty/requirements.txt"
-            )
+            # set and encode requirements to the REQUIREMENTS environment variable in the kaniko pod
             env["REQUIREMENTS"] = b64encode(
                 "\n".join(requirements).encode("utf-8")
             ).decode("utf-8")
+            # dump requirement content and decode to the requirement.txt destination
+            commands.append(
+                "echo ${REQUIREMENTS}" + " | " + f"base64 -d > {requirements_path}"
+            )
 
         kpod.append_init_container(
             config.httpdb.builder.kaniko_init_container_image,
             args=["sh", "-c", "; ".join(commands)],
             env=env,
             name="create-dockerfile",
         )
@@ -308,15 +316,14 @@
 
 def build_image(
     auth_info: mlrun.api.schemas.AuthInfo,
     project: str,
     image_target,
     commands=None,
     source="",
-    mounter="v3io",
     base_image=None,
     requirements=None,
     inline_code=None,
     inline_path=None,
     secret_name=None,
     namespace=None,
     with_mlrun=True,
@@ -331,38 +338,35 @@
     runtime=None,
 ):
     runtime_spec = runtime.spec if runtime else None
     builder_env = builder_env or {}
     image_target, secret_name = _resolve_image_target_and_registry_secret(
         image_target, registry, secret_name
     )
-
-    if isinstance(requirements, list):
+    if requirements and isinstance(requirements, list):
         requirements_list = requirements
-        requirements_path = "requirements.txt"
-        if source:
-            raise ValueError("requirements list only works with inline code")
+        requirements_path = "/empty/requirements.txt"
     else:
         requirements_list = None
-        requirements_path = requirements
+        requirements_path = requirements or ""
 
     commands = commands or []
     if with_mlrun:
         # mlrun prerequisite - upgrade pip
         upgrade_pip_command = resolve_upgrade_pip_command(commands)
         if upgrade_pip_command:
             commands.append(upgrade_pip_command)
 
         mlrun_command = resolve_mlrun_install_command(
             mlrun_version_specifier, client_version, commands
         )
         if mlrun_command:
             commands.append(mlrun_command)
 
-    if not inline_code and not source and not commands:
+    if not inline_code and not source and not commands and not requirements:
         logger.info("skipping build, nothing to add")
         return "skipped"
 
     context = "/context"
     to_mount = False
     v3io = (
         source.startswith("v3io://") or source.startswith("v3ios://")
@@ -427,29 +431,30 @@
 
         runtime.spec.clone_target_dir = path.join(tmpdir, "mlrun", relative_workdir)
 
     dock = make_dockerfile(
         base_image,
         commands,
         source=source_to_copy,
-        requirements=requirements_path,
+        requirements_path=requirements_path,
         extra=extra,
         user_unix_id=user_unix_id,
         enriched_group_id=enriched_group_id,
         workdir=runtime.spec.clone_target_dir,
     )
 
     kpod = make_kaniko_pod(
         project,
         context,
         image_target,
         dockertext=dock,
         inline_code=inline_code,
         inline_path=inline_path,
         requirements=requirements_list,
+        requirements_path=requirements_path,
         secret_name=secret_name,
         name=name,
         verbose=verbose,
         builder_env=builder_env,
         runtime_spec=runtime_spec,
         registry=registry,
     )
@@ -551,15 +556,21 @@
             "mlrun/ml-base",
             "mlrun/ml-models",
             "mlrun/ml-models-gpu",
         ]
         # if the base is one of mlrun images - no need to install mlrun
         if any([image in build.base_image for image in mlrun_images]):
             with_mlrun = False
-    if not build.source and not build.commands and not build.extra and not with_mlrun:
+    if (
+        not build.source
+        and not build.commands
+        and not build.requirements
+        and not build.extra
+        and not with_mlrun
+    ):
         if not runtime.spec.image:
             if build.base_image:
                 runtime.spec.image = build.base_image
             elif runtime.kind in mlrun.mlconf.function_defaults.image_by_kind.to_dict():
                 runtime.spec.image = (
                     mlrun.mlconf.function_defaults.image_by_kind.to_dict()[runtime.kind]
                 )
@@ -595,16 +606,16 @@
 
     status = build_image(
         auth_info,
         project,
         image_target=build.image,
         base_image=enriched_base_image,
         commands=build.commands,
+        requirements=build.requirements,
         namespace=namespace,
-        # inline_code=inline,
         source=build.source,
         secret_name=build.secret,
         interactive=interactive,
         name=name,
         with_mlrun=with_mlrun,
         mlrun_version_specifier=mlrun_version_specifier,
         extra=build.extra,
```

## mlrun/config.py

```diff
@@ -368,14 +368,23 @@
             # template for the prefix that the function target image will be enforced to have (as long as it's targeted
             # to be in the configured registry). Supported template values are: {project} {name}
             "function_target_image_name_prefix_template": "func-{project}-{name}",
             "pip_version": "~=23.0",
         },
         "v3io_api": "",
         "v3io_framesd": "",
+        # If running from sdk and MLRUN_DBPATH is not set, the db will fallback to a nop db which will not preform any
+        # run db operations.
+        "nop_db": {
+            # if set to true, will raise an error for trying to use run db functionality
+            # if set to false, will use a nop db which will not preform any run db operations
+            "raise_error": False,
+            # if set to true, will log a warning for trying to use run db functionality while in nop db mode
+            "verbose": True,
+        },
     },
     "model_endpoint_monitoring": {
         "serving_stream_args": {"shard_count": 1, "retention_period_hours": 24},
         "drift_thresholds": {"default": {"possible_drift": 0.5, "drift_detected": 0.7}},
         "store_prefixes": {
             "default": "v3io:///users/pipelines/{project}/model-endpoints/{kind}",
             "user_space": "v3io:///projects/{project}/model-endpoints/{kind}",
@@ -428,19 +437,20 @@
         "projects_prefix": "projects",  # The UI link prefix for projects
         "url": "",  # remote/external mlrun UI url (for hyperlinks)
     },
     "marketplace": {
         "k8s_secrets_project_name": "-marketplace-secrets",
         "catalog_filename": "catalog.json",
         "default_source": {
-            # Set to false to avoid creating a global source (for example in a dark site)
+            # Set false to avoid creating a global source (for example in a dark site)
             "create": True,
             "name": "mlrun_global_hub",
             "description": "MLRun global function hub",
-            "url": "https://raw.githubusercontent.com/mlrun/marketplace",
+            "url": "https://raw.githubusercontent.com/mlrun/marketplace/master",
+            "object_type": "functions",
             "channel": "master",
         },
     },
     "storage": {
         # What type of auto-mount to use for functions. One of: none, auto, v3io_credentials, v3io_fuse, pvc, s3, env.
         # Default is auto - which is v3io_credentials when running on Iguazio. If not Iguazio: pvc if the
         # MLRUN_PVC_MOUNT env is configured or auto_mount_params contain "pvc_name". Otherwise will do nothing (none).
```

## mlrun/execution.py

```diff
@@ -76,14 +76,15 @@
         # runtime db service interfaces
         self._rundb = None
         self._tmpfile = tmp
         self._logger = log_stream or logger
         self._log_level = "info"
         self._matrics_db = None
         self._autocommit = autocommit
+        self._notifications = []
 
         self._labels = {}
         self._annotations = {}
 
         self._function = ""
         self._parameters = {}
         self._hyperparams = {}
@@ -295,14 +296,15 @@
             self._outputs = spec.get("outputs", self._outputs)
             self._allow_empty_resources = spec.get(
                 "allow_empty_resources", self._allow_empty_resources
             )
             self.artifact_path = spec.get(run_keys.output_path, self.artifact_path)
             self._in_path = spec.get(run_keys.input_path, self._in_path)
             inputs = spec.get(run_keys.inputs)
+            self._notifications = spec.get("notifications", self._notifications)
 
         self._init_dbs(rundb)
 
         if spec and not is_api:
             # init data related objects (require DB & Secrets to be set first), skip when running in the api service
             self._data_stores.from_dict(spec)
             if inputs and isinstance(inputs, dict):
@@ -940,14 +942,15 @@
                 "function": self._function,
                 "log_level": self._log_level,
                 "parameters": self._parameters,
                 "handler": self._handler,
                 "outputs": self._outputs,
                 run_keys.output_path: self.artifact_path,
                 run_keys.inputs: {k: v.artifact_url for k, v in self._inputs.items()},
+                "notifications": self._notifications,
             },
             "status": {
                 "results": self._results,
                 "start_time": to_date_str(self._start_time),
                 "last_update": to_date_str(self._last_update),
             },
         }
```

## mlrun/k8s_utils.py

```diff
@@ -504,14 +504,24 @@
         secret_data = k8s_secret.data.copy()
         for key, value in secrets.items():
             secret_data[key] = base64.b64encode(value.encode()).decode("utf-8")
 
         k8s_secret.data = secret_data
         self.v1api.replace_namespaced_secret(secret_name, namespace, k8s_secret)
 
+    def load_secret(self, secret_name, namespace=""):
+        namespace = namespace or self.resolve_namespace(namespace)
+
+        try:
+            k8s_secret = self.v1api.read_namespaced_secret(secret_name, namespace)
+        except ApiException:
+            return None
+
+        return k8s_secret.data
+
     def delete_project_secrets(self, project, secrets, namespace=""):
         secret_name = self.get_project_secret_name(project)
         self.delete_secrets(secret_name, secrets, namespace)
 
     def delete_auth_secret(self, secret_ref: str, namespace=""):
         self.delete_secrets(secret_ref, {}, namespace)
```

## mlrun/model.py

```diff
@@ -334,14 +334,15 @@
         secret=None,
         code_origin=None,
         registry=None,
         load_source_on_run=None,
         origin_filename=None,
         with_mlrun=None,
         auto_build=None,
+        requirements: list = None,
     ):
         self.functionSourceCode = functionSourceCode  #: functionSourceCode
         self.codeEntryType = ""  #: codeEntryType
         self.codeEntryAttributes = ""  #: codeEntryAttributes
         self.source = source  #: source
         self.code_origin = code_origin  #: code_origin
         self.origin_filename = origin_filename
@@ -351,14 +352,15 @@
         self.extra = extra  #: extra
         self.secret = secret  #: secret
         self.registry = registry  #: registry
         self.load_source_on_run = load_source_on_run  #: load_source_on_run
         self.with_mlrun = with_mlrun  #: with_mlrun
         self.auto_build = auto_build  #: auto_build
         self.build_pod = None
+        self.requirements = requirements or []  #: pip requirements
 
     @property
     def source(self):
         return self._source
 
     @source.setter
     def source(self, source):
@@ -372,14 +374,40 @@
                 "source must be a compressed (tar.gz / zip) file, a git repo, "
                 "a file path or in the project's context (.)"
             )
 
         self._source = source
 
 
+class Notification(ModelObj):
+    """Notification specification"""
+
+    def __init__(
+        self,
+        kind=None,
+        name=None,
+        message=None,
+        severity=None,
+        when=None,
+        condition=None,
+        params=None,
+        status=None,
+        sent_time=None,
+    ):
+        self.kind = kind
+        self.name = name
+        self.message = message
+        self.severity = severity
+        self.when = when
+        self.condition = condition
+        self.params = params or {}
+        self.status = status
+        self.sent_time = sent_time
+
+
 class RunMetadata(ModelObj):
     """Run metadata"""
 
     def __init__(
         self,
         uid=None,
         name=None,
@@ -488,14 +516,15 @@
         strategy=None,
         verbose=None,
         scrape_metrics=None,
         hyper_param_options=None,
         allow_empty_resources=None,
         inputs_type_hints=None,
         returns=None,
+        notifications=None,
     ):
         # A dictionary of parsing configurations that will be read from the inputs the user set. The keys are the inputs
         # keys (parameter names) and the values are the type hint given in the input keys after the colon.
         # Notice: We set it first as empty dictionary as setting the inputs will set it as well in case the type hints
         # were passed in the input keys.
         self._inputs_type_hints = {}
 
@@ -522,14 +551,15 @@
         self.output_path = output_path
         self.function = function
         self._secret_sources = secret_sources or []
         self._data_stores = data_stores
         self.verbose = verbose
         self.scrape_metrics = scrape_metrics
         self.allow_empty_resources = allow_empty_resources
+        self._notifications = notifications or []
 
     def to_dict(self, fields=None, exclude=None):
         struct = super().to_dict(fields, exclude=["handler"])
         if self.handler and isinstance(self.handler, str):
             struct["handler"] = self.handler
         return struct
 
@@ -674,14 +704,27 @@
         if self.handler:
             if inspect.isfunction(self.handler):
                 return self.handler.__name__
             else:
                 return str(self.handler)
         return ""
 
+    @property
+    def notifications(self):
+        return self._notifications
+
+    @notifications.setter
+    def notifications(self, notifications):
+        if isinstance(notifications, list):
+            self._notifications = ObjectList.from_list(Notification, notifications)
+        elif isinstance(notifications, ObjectList):
+            self._notifications = notifications
+        else:
+            raise ValueError("Notifications must be a list")
+
     def extract_type_hints_from_inputs(self):
         """
         This method extracts the type hints from the inputs keys in the input dictionary.
 
         As a result, after the method ran the inputs dictionary - a dictionary of parameter names as keys and paths as
         values, will be cleared from type hints and the extracted type hints will be saved in the spec's inputs type
         hints dictionary - a dictionary of parameter names as keys and their type hints as values. If a parameter is
```

## mlrun/run.py

```diff
@@ -53,15 +53,14 @@
     LocalRuntime,
     MpiRuntimeV1,
     MpiRuntimeV1Alpha1,
     RemoteRuntime,
     RemoteSparkRuntime,
     RuntimeKinds,
     ServingRuntime,
-    Spark2Runtime,
     Spark3Runtime,
     get_runtime_class,
 )
 from .runtimes.funcdoc import update_function_entry_points
 from .runtimes.package.context_handler import ArtifactType, ContextHandler
 from .runtimes.serving import serving_subkind
 from .runtimes.utils import add_code_metadata, global_context
@@ -123,14 +122,15 @@
     secrets=None,
     handler=None,
     params: dict = None,
     inputs: dict = None,
     artifact_path: str = "",
     mode: str = None,
     allow_empty_resources=None,
+    notifications: List[mlrun.model.Notification] = None,
     returns: list = None,
 ):
     """Run a task on function/code (.py, .ipynb or .yaml) locally,
 
     example::
 
         # define a task
@@ -212,14 +212,15 @@
         task,
         name=name,
         handler=handler,
         params=params,
         inputs=inputs,
         returns=returns,
         artifact_path=artifact_path,
+        notifications=notifications,
     )
 
 
 def function_to_module(code="", workdir=None, secrets=None, silent=False):
     """Load code, notebook or mlrun function as .py module
     this function can import a local/remote py file or notebook
     or load an mlrun function object as a module, you can use this
@@ -231,15 +232,15 @@
 
         mod = mlrun.function_to_module('./examples/training.py')
         task = mlrun.new_task(inputs={'infile.txt': '../examples/infile.txt'})
         context = mlrun.get_or_create_ctx('myfunc', spec=task)
         mod.my_job(context, p1=1, p2='x')
         print(context.to_yaml())
 
-        fn = mlrun.import_function('hub://open_archive')
+        fn = mlrun.import_function('hub://open-archive')
         mod = mlrun.function_to_module(fn)
         data = mlrun.run.get_dataitem("https://fpsignals-public.s3.amazonaws.com/catsndogs.tar.gz")
         context = mlrun.get_or_create_ctx('myfunc')
         mod.open_archive(context, archive_url=data)
         print(context.to_yaml())
 
     :param code:    path/url to function (.py or .ipynb or .yaml)
@@ -453,15 +454,15 @@
     special URLs::
 
         function hub: hub://{name}[:{tag}]
         local mlrun db:       db://{project-name}/{name}[:{tag}]
 
     examples::
 
-        function = mlrun.import_function("hub://auto_trainer")
+        function = mlrun.import_function("hub://auto-trainer")
         function = mlrun.import_function("./func.yaml")
         function = mlrun.import_function("https://raw.githubusercontent.com/org/repo/func.yaml")
 
     :param url: path/url to Function Hub, db or function YAML file
     :param secrets: optional, credentials dict for DB or URL (s3, v3io, ...)
     :param db: optional, mlrun api/db path
     :param project: optional, target project for the function
@@ -696,15 +697,14 @@
     MpiRuntimeV1Alpha1,
     MpiRuntimeV1,
     RemoteRuntime,
     ServingRuntime,
     DaskCluster,
     KubejobRuntime,
     LocalRuntime,
-    Spark2Runtime,
     Spark3Runtime,
     RemoteSparkRuntime,
 ]:
     """Convenience function to insert code and configure an mlrun runtime.
 
     Easiest way to construct a runtime type object. Provides the most often
     used configuration options for all runtimes as parameters.
@@ -789,14 +789,15 @@
         name = filename or (name + ".ipynb")
         if not origin:
             return name
         return f"{origin}:{name}"
 
     def update_common(fn, spec):
         fn.spec.image = image or get_in(spec, "spec.image", "")
+        fn.spec.filename = filename or get_in(spec, "spec.filename", "")
         fn.spec.build.base_image = get_in(spec, "spec.build.baseImage")
         fn.spec.build.commands = get_in(spec, "spec.build.commands")
         fn.spec.build.secret = get_in(spec, "spec.build.secret")
 
         if requirements:
             fn.with_requirements(requirements)
```

## mlrun/api/main.py

```diff
@@ -20,20 +20,22 @@
 
 import fastapi
 import fastapi.concurrency
 import sqlalchemy.orm
 import uvicorn
 from fastapi.exception_handlers import http_exception_handler
 
+import mlrun.api.db.base
 import mlrun.api.schemas
 import mlrun.api.utils.clients.chief
 import mlrun.api.utils.clients.log_collector
 import mlrun.errors
 import mlrun.lists
 import mlrun.utils
+import mlrun.utils.notifications
 import mlrun.utils.version
 from mlrun.api.api.api import api_router
 from mlrun.api.db.session import close_session, create_session
 from mlrun.api.initial_data import init_data
 from mlrun.api.middlewares import init_middlewares
 from mlrun.api.utils.periodic import (
     cancel_all_periodic_functions,
@@ -52,14 +54,22 @@
 from mlrun.k8s_utils import get_k8s_helper
 from mlrun.runtimes import RuntimeClassMode, RuntimeKinds, get_runtime_handler
 from mlrun.utils import logger
 
 API_PREFIX = "/api"
 BASE_VERSIONED_API_PREFIX = f"{API_PREFIX}/v1"
 
+# When pushing notifications, push notifications only for runs that entered a terminal state
+# since the last time we pushed notifications.
+# On the first time we push notifications, we'll push notifications for all runs that are in a terminal state
+# and their notifications haven't been sent yet.
+# TODO: find better solution than a global variable for chunking the list of runs
+#      for which to push notifications
+_last_notification_push_time: datetime.datetime = None
+
 
 app = fastapi.FastAPI(
     title="MLRun",
     description="Machine Learning automation and tracking",
     version=config.version,
     debug=config.httpdb.debug,
     # adding /api prefix
@@ -508,26 +518,28 @@
     config.httpdb.state = chief_state
     # if reached terminal state we cancel the periodic function
     # assumption: we can't get out of a terminal api state, so no need to continue pulling when reached one
     cancel_periodic_function(_synchronize_with_chief_clusterization_spec.__name__)
 
 
 def _monitor_runs():
+    db = get_db()
     db_session = create_session()
     try:
         for kind in RuntimeKinds.runtime_with_handlers():
             try:
                 runtime_handler = get_runtime_handler(kind)
-                runtime_handler.monitor_runs(get_db(), db_session)
+                runtime_handler.monitor_runs(db, db_session)
             except Exception as exc:
                 logger.warning(
                     "Failed monitoring runs. Ignoring",
                     exc=err_to_str(exc),
                     kind=kind,
                 )
+        _push_terminal_run_notifications(db, db_session)
     finally:
         close_session(db_session)
 
 
 def _cleanup_runtimes():
     db_session = create_session()
     try:
@@ -541,14 +553,55 @@
                     exc=err_to_str(exc),
                     kind=kind,
                 )
     finally:
         close_session(db_session)
 
 
+def _push_terminal_run_notifications(db: mlrun.api.db.base.DBInterface, db_session):
+    """
+    Get all runs with notification configs which became terminal since the last call to the function
+    and push their notifications if they haven't been pushed yet.
+    """
+
+    # Import here to avoid circular import
+    import mlrun.api.api.utils
+
+    # When pushing notifications, push notifications only for runs that entered a terminal state
+    # since the last time we pushed notifications.
+    # On the first time we push notifications, we'll push notifications for all runs that are in a terminal state
+    # and their notifications haven't been sent yet.
+    global _last_notification_push_time
+
+    runs = db.list_runs(
+        db_session,
+        project="*",
+        states=mlrun.runtimes.constants.RunStates.terminal_states(),
+        last_update_time_from=_last_notification_push_time,
+        with_notifications=True,
+    )
+
+    if not len(runs):
+        return
+
+    # Unmasking the run parameters from secrets before handing them over to the notification handler
+    # as importing the `Secrets` crud in the notification handler will cause a circular import
+    unmasked_runs = [
+        mlrun.api.api.utils.unmask_notification_params_secret_on_task(run)
+        for run in runs
+    ]
+
+    logger.debug(
+        "Got terminal runs with configured notifications", runs_amount=len(runs)
+    )
+    mlrun.utils.notifications.NotificationPusher(unmasked_runs).push(db)
+
+    _last_notification_push_time = datetime.datetime.now(datetime.timezone.utc)
+
+
 async def _stop_logs():
     """
     Stop logs for runs that are in terminal state and last updated in the previous interval
     """
     logger.debug(
         "Getting all runs which reached terminal state in the previous interval and have logs requested",
         interval_seconds=int(config.log_collector.stop_logs_interval),
```

## mlrun/api/api/utils.py

```diff
@@ -9,14 +9,15 @@
 # Unless required by applicable law or agreed to in writing, software
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 #
 import collections
+import json
 import re
 import traceback
 import typing
 from hashlib import sha1
 from http import HTTPStatus
 from os import environ
 from pathlib import Path
@@ -25,14 +26,15 @@
 from fastapi import HTTPException
 from fastapi.concurrency import run_in_threadpool
 from sqlalchemy.orm import Session
 
 import mlrun.api.crud
 import mlrun.api.utils.auth.verifier
 import mlrun.api.utils.clients.iguazio
+import mlrun.api.utils.singletons.k8s
 import mlrun.errors
 import mlrun.runtimes.pod
 import mlrun.utils.helpers
 from mlrun.api import schemas
 from mlrun.api.db.sqldb.db import SQLDB
 from mlrun.api.schemas import SecretProviderName, SecurityContextEnrichmentModes
 from mlrun.api.utils.singletons.db import get_db
@@ -181,25 +183,125 @@
         if function_dict:
             # The purpose of the function dict is to enable the user to override configurations of the existing function
             # without modifying it - to do that we're creating a function object from the request function dict and
             # assign values from it to the main function object
             function = enrich_function_from_dict(function, function_dict)
 
     apply_enrichment_and_validation_on_function(function, auth_info)
+    apply_enrichment_and_validation_on_task(task)
 
     return function, task
 
 
 async def submit_run(db_session: Session, auth_info: mlrun.api.schemas.AuthInfo, data):
     _, _, _, response = await run_in_threadpool(
         submit_run_sync, db_session, auth_info, data
     )
     return response
 
 
+def apply_enrichment_and_validation_on_task(task):
+
+    # Masking notification config params from the task object
+    mask_notification_params_on_task(task)
+
+
+def mask_notification_params_on_task(task):
+    run_uid = get_in(task, "metadata.uid")
+    project = get_in(task, "metadata.project")
+    notifications = task.get("spec", {}).get("notifications", [])
+    if notifications:
+        for notification in notifications:
+            notification_object = mlrun.model.Notification.from_dict(notification)
+            mask_notification_params_with_secret(project, run_uid, notification_object)
+
+
+def mask_notification_params_with_secret(
+    project: str, run_uid: str, notification_object: mlrun.model.Notification
+) -> mlrun.model.Notification:
+    if notification_object.params and "secret" not in notification_object.params:
+        secret_key = mlrun.api.crud.Secrets().generate_client_project_secret_key(
+            mlrun.api.crud.SecretsClientType.notifications,
+            run_uid,
+            notification_object.name,
+        )
+        mlrun.api.crud.Secrets().store_project_secrets(
+            project,
+            mlrun.api.schemas.SecretsData(
+                provider=mlrun.api.schemas.SecretProviderName.kubernetes,
+                secrets={secret_key: json.dumps(notification_object.params)},
+            ),
+            allow_internal_secrets=True,
+        )
+        notification_object.params = {"secret": secret_key}
+
+    return notification_object
+
+
+def unmask_notification_params_secret_on_task(run):
+    if isinstance(run, dict):
+        run = mlrun.model.RunObject.from_dict(run)
+
+    run.spec.notifications = [
+        unmask_notification_params_secret(run.metadata.project, notification)
+        for notification in run.spec.notifications
+    ]
+    return run
+
+
+def unmask_notification_params_secret(
+    project: str, notification_object: mlrun.model.Notification
+) -> mlrun.model.Notification:
+    params = notification_object.params or {}
+    params_secret = params.get("secret", "")
+    if not params_secret:
+        return notification_object
+
+    k8s = mlrun.api.utils.singletons.k8s.get_k8s()
+    if not k8s:
+        raise mlrun.errors.MLRunRuntimeError(
+            "Not running in k8s environment, cannot load notification params secret"
+        )
+
+    notification_object.params = json.loads(
+        mlrun.api.crud.Secrets().get_project_secret(
+            project,
+            mlrun.api.schemas.SecretProviderName.kubernetes,
+            secret_key=params_secret,
+            allow_internal_secrets=True,
+            allow_secrets_from_k8s=True,
+        )
+    )
+
+    return notification_object
+
+
+def delete_notification_params_secret(
+    project: str, notification_object: mlrun.model.Notification
+) -> None:
+    params = notification_object.params or {}
+    params_secret = params.get("secret", "")
+    if not params_secret:
+        return
+
+    k8s = mlrun.api.utils.singletons.k8s.get_k8s()
+    if not k8s:
+        raise mlrun.errors.MLRunRuntimeError(
+            "Not running in k8s environment, cannot delete notification params secret"
+        )
+
+    mlrun.api.crud.Secrets().delete_project_secret(
+        project,
+        mlrun.api.schemas.SecretProviderName.kubernetes,
+        secret_key=params_secret,
+        allow_internal_secrets=True,
+        allow_secrets_from_k8s=True,
+    )
+
+
 def apply_enrichment_and_validation_on_function(
     function,
     auth_info: mlrun.api.schemas.AuthInfo,
     ensure_auth: bool = True,
     perform_auto_mount: bool = True,
     validate_service_account: bool = True,
     mask_sensitive_data: bool = True,
```

## mlrun/api/api/endpoints/marketplace.py

```diff
@@ -155,15 +155,14 @@
 
 @router.get(
     path="/marketplace/sources/{source_name}/items",
     response_model=MarketplaceCatalog,
 )
 async def get_catalog(
     source_name: str,
-    channel: Optional[str] = Query(None),
     version: Optional[str] = Query(None),
     tag: Optional[str] = Query(None),
     force_refresh: Optional[bool] = Query(False, alias="force-refresh"),
     db_session: Session = Depends(mlrun.api.api.deps.get_db_session),
     auth_info: mlrun.api.schemas.AuthInfo = Depends(
         mlrun.api.api.deps.authenticate_request
     ),
@@ -176,29 +175,27 @@
         AuthorizationAction.read,
         auth_info,
     )
 
     return await run_in_threadpool(
         mlrun.api.crud.Marketplace().get_source_catalog,
         ordered_source.source,
-        channel,
         version,
         tag,
         force_refresh,
     )
 
 
 @router.get(
     "/marketplace/sources/{source_name}/items/{item_name}",
     response_model=MarketplaceItem,
 )
 async def get_item(
     source_name: str,
     item_name: str,
-    channel: Optional[str] = Query("development"),
     version: Optional[str] = Query(None),
     tag: Optional[str] = Query("latest"),
     force_refresh: Optional[bool] = Query(False, alias="force-refresh"),
     db_session: Session = Depends(mlrun.api.api.deps.get_db_session),
     auth_info: mlrun.api.schemas.AuthInfo = Depends(
         mlrun.api.api.deps.authenticate_request
     ),
@@ -212,15 +209,14 @@
         auth_info,
     )
 
     return await run_in_threadpool(
         mlrun.api.crud.Marketplace().get_item,
         ordered_source.source,
         item_name,
-        channel,
         version,
         tag,
         force_refresh,
     )
 
 
 @router.get(
@@ -251,7 +247,64 @@
     if url.endswith("/"):
         return object_data
 
     ctype, _ = mimetypes.guess_type(url)
     if not ctype:
         ctype = "application/octet-stream"
     return Response(content=object_data, media_type=ctype)
+
+
+@router.get("/marketplace/sources/{source_name}/items/{item_name}/assets/{asset_name}")
+async def get_asset(
+    source_name: str,
+    item_name: str,
+    asset_name: str,
+    tag: Optional[str] = Query("latest"),
+    version: Optional[str] = Query(None),
+    db_session: Session = Depends(mlrun.api.api.deps.get_db_session),
+    auth_info: mlrun.api.schemas.AuthInfo = Depends(
+        mlrun.api.api.deps.authenticate_request
+    ),
+):
+    """
+    Retrieve asset from a specific item in specific marketplace source.
+
+    :param source_name: marketplace source name
+    :param item_name:   the name of the item
+    :param asset_name:  the name of the asset to retrieve
+    :param tag:         tag of item - latest or version number
+    :param version:     item version
+    :param db_session:  a session that manages the current dialog with the database
+    :param auth_info:   the auth info of the request
+
+    :return: fastapi response with the asset in content
+    """
+    source = await run_in_threadpool(
+        get_db().get_marketplace_source, db_session, source_name
+    )
+
+    await mlrun.api.utils.auth.verifier.AuthVerifier().query_global_resource_permissions(
+        mlrun.api.schemas.AuthorizationResourceTypes.marketplace_source,
+        AuthorizationAction.read,
+        auth_info,
+    )
+    # Getting the relevant item which hold the asset information
+    item = await run_in_threadpool(
+        mlrun.api.crud.Marketplace().get_item,
+        source.source,
+        item_name,
+        version,
+        tag,
+    )
+
+    # Getting the asset from the item
+    asset, url = await run_in_threadpool(
+        mlrun.api.crud.Marketplace().get_asset,
+        source.source,
+        item,
+        asset_name,
+    )
+
+    ctype, _ = mimetypes.guess_type(url)
+    if not ctype:
+        ctype = "application/octet-stream"
+    return Response(content=asset, media_type=ctype)
```

## mlrun/api/api/endpoints/runs.py

```diff
@@ -174,14 +174,15 @@
     partition_sort_by: mlrun.api.schemas.SortField = Query(
         None, alias="partition-sort-by"
     ),
     partition_order: mlrun.api.schemas.OrderType = Query(
         mlrun.api.schemas.OrderType.desc, alias="partition-order"
     ),
     max_partitions: int = Query(0, alias="max-partitions", ge=0),
+    with_notifications: bool = Query(False, alias="with-notifications"),
     auth_info: mlrun.api.schemas.AuthInfo = Depends(deps.authenticate_request),
     db_session: Session = Depends(deps.get_db_session),
 ):
     if project != "*":
         await mlrun.api.utils.auth.verifier.AuthVerifier().query_project_permissions(
             project,
             mlrun.api.schemas.AuthorizationAction.read,
@@ -203,14 +204,15 @@
         datetime_from_iso(last_update_time_from),
         datetime_from_iso(last_update_time_to),
         partition_by,
         rows_per_partition,
         partition_sort_by,
         partition_order,
         max_partitions,
+        with_notifications=with_notifications,
     )
     filtered_runs = await mlrun.api.utils.auth.verifier.AuthVerifier().filter_project_resources_by_permissions(
         mlrun.api.schemas.AuthorizationResourceTypes.run,
         runs,
         lambda run: (
             run.get("metadata", {}).get("project", mlrun.mlconf.default_project),
             run.get("metadata", {}).get("uid"),
```

## mlrun/api/crud/__init__.py

```diff
@@ -18,13 +18,14 @@
 from .client_spec import ClientSpec
 from .clusterization_spec import ClusterizationSpec
 from .feature_store import FeatureStore
 from .functions import Functions
 from .logs import Logs
 from .marketplace import Marketplace
 from .model_monitoring import ModelEndpoints
+from .notifications import Notifications
 from .pipelines import Pipelines
 from .projects import Projects
 from .runs import Runs
 from .runtime_resources import RuntimeResources
 from .secrets import Secrets, SecretsClientType
 from .tags import Tags
```

## mlrun/api/crud/marketplace.py

```diff
@@ -9,14 +9,15 @@
 # Unless required by applicable law or agreed to in writing, software
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 #
 import json
+from typing import Any, Dict, List, Optional, Tuple
 
 import mlrun.errors
 import mlrun.utils.singleton
 from mlrun.api.schemas.marketplace import (
     MarketplaceCatalog,
     MarketplaceItem,
     MarketplaceItemMetadata,
@@ -117,95 +118,161 @@
         for key, value in secrets.items():
             if key.startswith(secret_prefix):
                 source_secrets[key[len(secret_prefix) :]] = value
 
         return source_secrets
 
     @staticmethod
-    def _transform_catalog_dict_to_schema(source, catalog_dict):
-        catalog_dict = catalog_dict.get("functions")
-        if not catalog_dict:
-            raise mlrun.errors.MLRunInternalServerError(
-                "Invalid catalog file - no 'functions' section found."
-            )
-
-        catalog = MarketplaceCatalog(catalog=[])
-        # Loop over channels, then per function extract versions.
-        for channel_name in catalog_dict:
-            channel_dict = catalog_dict[channel_name]
-            for function_name in channel_dict:
-                function_dict = channel_dict[function_name]
-                for version_tag in function_dict:
-                    version_dict = function_dict[version_tag]
-                    function_details_dict = version_dict.copy()
-                    spec_dict = function_details_dict.pop("spec", None)
-                    metadata = MarketplaceItemMetadata(
-                        channel=channel_name, tag=version_tag, **function_details_dict
-                    )
-                    item_uri = source.get_full_uri(metadata.get_relative_path())
-                    spec = MarketplaceItemSpec(item_uri=item_uri, **spec_dict)
-                    item = MarketplaceItem(
-                        metadata=metadata, spec=spec, status=ObjectStatus()
-                    )
-                    catalog.catalog.append(item)
+    def _get_asset_full_path(
+        source: MarketplaceSource, item: MarketplaceItem, asset: str
+    ):
+        """
+        Combining the item path with the asset path.
+
+        :param source:  Marketplace source object.
+        :param item:    The relevant item to get the asset from.
+        :param asset:   The asset name
+        :return:    Full path to the asset, relative to the item directory.
+        """
+        asset_path = item.spec.assets.get(asset, None)
+        if not asset_path:
+            raise mlrun.errors.MLRunNotFoundError(
+                f"Asset={asset} not found. "
+                f"item={item.metadata.name}, version={item.metadata.version}, tag={item.metadata.tag}"
+            )
+        item_path = item.metadata.get_relative_path()
+        return source.get_full_uri(item_path + asset_path)
+
+    @staticmethod
+    def _transform_catalog_dict_to_schema(
+        source: MarketplaceSource, catalog_dict: Dict[str, Any]
+    ) -> MarketplaceCatalog:
+        """
+        Transforms catalog dictionary to MarketplaceCatalog schema
+        :param source:          Marketplace source object.
+        :param catalog_dict:    raw catalog dict, top level keys are item names,
+                                second level keys are version tags ("latest, "1.1.0", ...) and
+                                bottom level keys include spec as a dict and all the rest is considered as metadata.
+        :return: catalog object
+        """
+        catalog = MarketplaceCatalog(catalog=[], channel=source.spec.channel)
+        # Loop over objects, then over object versions.
+        for object_name, object_dict in catalog_dict.items():
+            for version_tag, version_dict in object_dict.items():
+                object_details_dict = version_dict.copy()
+                spec_dict = object_details_dict.pop("spec", {})
+                assets = object_details_dict.pop("assets", {})
+                metadata = MarketplaceItemMetadata(
+                    tag=version_tag, **object_details_dict
+                )
+                item_uri = source.get_full_uri(metadata.get_relative_path())
+                spec = MarketplaceItemSpec(
+                    item_uri=item_uri, assets=assets, **spec_dict
+                )
+                item = MarketplaceItem(
+                    metadata=metadata,
+                    spec=spec,
+                    status=ObjectStatus(),
+                )
+                catalog.catalog.append(item)
 
         return catalog
 
     def get_source_catalog(
         self,
         source: MarketplaceSource,
-        channel=None,
-        version=None,
-        tag=None,
-        force_refresh=False,
+        version: Optional[str] = None,
+        tag: Optional[str] = None,
+        force_refresh: bool = False,
     ) -> MarketplaceCatalog:
+        """
+        Getting the catalog object by source.
+        If version and/or tag are given, the catalog will be filtered accordingly.
+
+        :param source:          Marketplace source object.
+        :param version:         version of items to filter by
+        :param tag:             tag of items to filter by
+        :param force_refresh:   if True, the catalog will be loaded from source always,
+                                otherwise will be pulled from db (if loaded before)
+        :return: catalog object
+        """
         source_name = source.metadata.name
         if not self._catalogs.get(source_name) or force_refresh:
             url = source.get_catalog_uri()
             credentials = self._get_source_credentials(source_name)
             catalog_data = mlrun.run.get_object(url=url, secrets=credentials)
             catalog_dict = json.loads(catalog_data)
             catalog = self._transform_catalog_dict_to_schema(source, catalog_dict)
             self._catalogs[source_name] = catalog
         else:
             catalog = self._catalogs[source_name]
 
-        result_catalog = MarketplaceCatalog(catalog=[])
+        result_catalog = MarketplaceCatalog(catalog=[], channel=source.spec.channel)
         for item in catalog.catalog:
-            if (
-                (channel is None or item.metadata.channel == channel)
-                and (tag is None or item.metadata.tag == tag)
-                and (version is None or item.metadata.version == version)
+            # Because tag and version are optionals,
+            # we filter the catalog by one of them with priority to tag
+            if (tag is None or item.metadata.tag == tag) and (
+                version is None or item.metadata.version == version
             ):
                 result_catalog.catalog.append(item)
 
         return result_catalog
 
     def get_item(
         self,
         source: MarketplaceSource,
-        item_name,
-        channel,
-        version=None,
-        tag=None,
-        force_refresh=False,
+        item_name: str,
+        version: Optional[str] = None,
+        tag: Optional[str] = None,
+        force_refresh: bool = False,
     ) -> MarketplaceItem:
-        catalog = self.get_source_catalog(source, channel, version, tag, force_refresh)
-        items = [item for item in catalog.catalog if item.metadata.name == item_name]
-        if not items:
+        """
+        Retrieve item from source. The item is filtered by tag and version.
+
+        :param source:          Marketplace source object
+        :param item_name:       name of the item to retrieve
+        :param version:         version of the item
+        :param tag:             tag of the item
+        :param force_refresh:   if True, the catalog will be loaded from source always,
+                                otherwise will be pulled from db (if loaded before)
+
+        :return: marketplace item object
+
+        :raise if the number of collected items from catalog is not exactly one.
+        """
+        catalog = self.get_source_catalog(source, version, tag, force_refresh)
+        items = self._get_catalog_items_filtered_by_name(catalog.catalog, item_name)
+        num_items = len(items)
+
+        if not num_items:
             raise mlrun.errors.MLRunNotFoundError(
-                f"Item not found. source={item_name}, channel={channel}, version={version}"
+                f"Item not found. source={item_name}, version={version}"
             )
-        if len(items) > 1:
+        if num_items > 1:
             raise mlrun.errors.MLRunInvalidArgumentError(
                 "Query resulted in more than 1 catalog items. "
-                + f"source={item_name}, channel={channel}, version={version}, tag={tag}"
+                + f"source={item_name}, version={version}, tag={tag}"
             )
         return items[0]
 
+    @staticmethod
+    def _get_catalog_items_filtered_by_name(
+        catalog: List[MarketplaceItem],
+        item_name: str,
+    ) -> List[MarketplaceItem]:
+        """
+        Retrieve items from catalog filtered by name
+
+        :param catalog:     list of items
+        :param item_name:   item name to filter by
+
+        :return:   list of item objects from catalog
+        """
+        return [item for item in catalog if item.metadata.name == item_name]
+
     def get_item_object_using_source_credentials(self, source: MarketplaceSource, url):
         credentials = self._get_source_credentials(source.metadata.name)
 
         if not url.startswith(source.spec.path):
             raise mlrun.errors.MLRunInvalidArgumentError(
                 "URL to retrieve must be located in the source filesystem tree"
             )
@@ -215,7 +282,29 @@
             listdir = obj.listdir()
             return {
                 "listdir": listdir,
             }
         else:
             catalog_data = mlrun.run.get_object(url=url, secrets=credentials)
         return catalog_data
+
+    def get_asset(
+        self,
+        source: MarketplaceSource,
+        item: MarketplaceItem,
+        asset_name: str,
+    ) -> Tuple[bytes, str]:
+        """
+        Retrieve asset object from marketplace source.
+
+        :param source:      marketplace source
+        :param item:        marketplace item which contains the assets
+        :param asset_name:  asset name, like source, example, etc.
+
+        :return: tuple of asset as bytes and url of asset
+        """
+        credentials = self._get_source_credentials(source.metadata.name)
+        asset_path = self._get_asset_full_path(source, item, asset_name)
+        return (
+            mlrun.run.get_object(url=asset_path, secrets=credentials),
+            asset_path,
+        )
```

## mlrun/api/crud/runs.py

```diff
@@ -123,14 +123,15 @@
         partition_by: mlrun.api.schemas.RunPartitionByField = None,
         rows_per_partition: int = 1,
         partition_sort_by: mlrun.api.schemas.SortField = None,
         partition_order: mlrun.api.schemas.OrderType = mlrun.api.schemas.OrderType.desc,
         max_partitions: int = 0,
         requested_logs: bool = None,
         return_as_run_structs: bool = True,
+        with_notifications: bool = False,
     ):
         project = project or mlrun.mlconf.default_project
         return mlrun.api.utils.singletons.db.get_db().list_runs(
             db_session,
             name,
             uid,
             project,
@@ -146,14 +147,15 @@
             partition_by,
             rows_per_partition,
             partition_sort_by,
             partition_order,
             max_partitions,
             requested_logs,
             return_as_run_structs,
+            with_notifications,
         )
 
     def delete_run(
         self,
         db_session: sqlalchemy.orm.Session,
         uid: str,
         iter: int,
```

## mlrun/api/crud/secrets.py

```diff
@@ -27,14 +27,15 @@
 
 
 class SecretsClientType(str, enum.Enum):
     schedules = "schedules"
     model_monitoring = "model-monitoring"
     service_accounts = "service-accounts"
     marketplace = "marketplace"
+    notifications = "notifications"
 
 
 class Secrets(
     metaclass=mlrun.utils.singleton.Singleton,
 ):
     internal_secrets_key_prefix = "mlrun."
     # make it a subset of internal since key map are by definition internal
```

## mlrun/api/db/base.py

```diff
@@ -8,18 +8,20 @@
 #
 # Unless required by applicable law or agreed to in writing, software
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 import datetime
+import typing
 import warnings
 from abc import ABC, abstractmethod
 from typing import Any, Dict, List, Optional, Tuple, Union
 
+import mlrun.model
 from mlrun.api import schemas
 
 
 class DBError(Exception):
     pass
 
 
@@ -99,14 +101,15 @@
         partition_by: schemas.RunPartitionByField = None,
         rows_per_partition: int = 1,
         partition_sort_by: schemas.SortField = None,
         partition_order: schemas.OrderType = schemas.OrderType.desc,
         max_partitions: int = 0,
         requested_logs: bool = None,
         return_as_run_structs: bool = True,
+        with_notifications: bool = False,
     ):
         pass
 
     @abstractmethod
     def del_run(self, session, uid, project="", iter=0):
         pass
 
@@ -571,7 +574,36 @@
     ):
         pass
 
     def get_background_task(
         self, session, name: str, project: str
     ) -> schemas.BackgroundTask:
         pass
+
+    @abstractmethod
+    def store_run_notifications(
+        self,
+        session,
+        notification_objects: typing.List[mlrun.model.Notification],
+        run_uid: str,
+        project: str,
+    ):
+        pass
+
+    @abstractmethod
+    def list_run_notifications(
+        self,
+        session,
+        run_uid: str,
+        project: str,
+    ) -> typing.List[mlrun.model.Notification]:
+        pass
+
+    def delete_run_notifications(
+        self,
+        session,
+        name: str = None,
+        run_uid: str = None,
+        project: str = None,
+        commit: bool = True,
+    ):
+        pass
```

## mlrun/api/db/session.py

```diff
@@ -11,30 +11,22 @@
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 #
 from sqlalchemy.orm import Session
 
 from mlrun.api.db.sqldb.session import create_session as sqldb_create_session
-from mlrun.config import config
 
 
-def create_session(db_type=None) -> Session:
-    db_type = db_type or config.httpdb.db_type
-    if db_type == "filedb":
-        return None
-    else:
-        return sqldb_create_session()
+def create_session() -> Session:
+    return sqldb_create_session()
 
 
 def close_session(db_session):
-
-    # will be None when it's filedb session
-    if db_session is not None:
-        db_session.close()
+    db_session.close()
 
 
 def run_function_with_new_db_session(func):
     session = create_session()
     try:
         result = func(session)
         return result
```

## mlrun/api/db/sqldb/db.py

```diff
@@ -27,15 +27,17 @@
 from sqlalchemy import and_, distinct, func, or_
 from sqlalchemy.exc import SQLAlchemyError
 from sqlalchemy.orm import Session, aliased
 
 import mlrun
 import mlrun.api.db.session
 import mlrun.api.utils.projects.remotes.follower
+import mlrun.api.utils.singletons.k8s
 import mlrun.errors
+import mlrun.model
 from mlrun.api import schemas
 from mlrun.api.db.base import DBInterface
 from mlrun.api.db.sqldb.helpers import (
     generate_query_predicate_for_name,
     label_set,
     run_labels,
     run_start_time,
@@ -49,14 +51,15 @@
     Entity,
     Feature,
     FeatureSet,
     FeatureVector,
     Function,
     Log,
     MarketplaceSource,
+    Notification,
     Project,
     Run,
     Schedule,
     User,
     _labeled,
     _tagged,
 )
@@ -321,14 +324,15 @@
         partition_by: schemas.RunPartitionByField = None,
         rows_per_partition: int = 1,
         partition_sort_by: schemas.SortField = None,
         partition_order: schemas.OrderType = schemas.OrderType.desc,
         max_partitions: int = 0,
         requested_logs: bool = None,
         return_as_run_structs: bool = True,
+        with_notifications: bool = False,
     ):
         project = project or config.default_project
         query = self._find_runs(session, uid, project, labels)
         if name is not None:
             query = self._add_run_name_query(query, name)
         if states is not None:
             query = query.filter(Run.state.in_(states))
@@ -365,17 +369,36 @@
                 partition_sort_by,
                 partition_order,
                 max_partitions,
             )
         if not return_as_run_structs:
             return query.all()
 
+        # Purposefully not using outer join to avoid returning runs without notifications
+        if with_notifications:
+            query = query.join(Notification, Run.id == Notification.run)
+
         runs = RunList()
         for run in query:
-            runs.append(run.struct)
+            run_struct = run.struct
+            if with_notifications:
+                run_struct.setdefault("spec", {}).setdefault("notifications", [])
+                run_struct.setdefault("status", {}).setdefault("notifications", {})
+                for notification in run.notifications:
+                    (
+                        notification_spec,
+                        notification_status,
+                    ) = self._transform_notification_record_to_spec_and_status(
+                        notification
+                    )
+                    run_struct["spec"]["notifications"].append(notification_spec)
+                    run_struct["status"]["notifications"][
+                        notification.name
+                    ] = notification_status
+            runs.append(run_struct)
 
         return runs
 
     def del_run(self, session, uid, project=None, iter=0):
         project = project or config.default_project
         # We currently delete *all* iterations
         self._delete(session, Run, uid=uid, project=project)
@@ -1685,14 +1708,18 @@
         self._verify_empty_list_of_project_related_resources(
             name, artifacts, "artifacts"
         )
         logs = self._list_logs(session, name)
         self._verify_empty_list_of_project_related_resources(name, logs, "logs")
         runs = self._find_runs(session, None, name, []).all()
         self._verify_empty_list_of_project_related_resources(name, runs, "runs")
+        notifications = self._get_db_notifications(session, project=name)
+        self._verify_empty_list_of_project_related_resources(
+            name, notifications, "notifications"
+        )
         schedules = self.list_schedules(session, project=name)
         self._verify_empty_list_of_project_related_resources(
             name, schedules, "schedules"
         )
         functions = self._list_project_function_names(session, name)
         self._verify_empty_list_of_project_related_resources(
             name, functions, "functions"
@@ -1705,14 +1732,15 @@
         self._verify_empty_list_of_project_related_resources(
             name, feature_vectors, "feature_vectors"
         )
 
     def delete_project_related_resources(self, session: Session, name: str):
         self.del_artifacts(session, project=name)
         self._delete_logs(session, name)
+        self.delete_run_notifications(session, project=name)
         self.del_runs(session, project=name)
         self.delete_schedules(session, name)
         self._delete_functions(session, name)
         self._delete_feature_sets(session, name)
         self._delete_feature_vectors(session, name)
         self._delete_background_tasks(session, project=name)
 
@@ -2828,14 +2856,21 @@
         query = self._query(session, Run, project=project)
         if uid:
             # uid may be either a single uid (string) or a list of uids
             uid = mlrun.utils.helpers.as_list(uid)
             query = query.filter(Run.uid.in_(uid))
         return self._add_labels_filter(session, query, Run, labels)
 
+    def _get_db_notifications(
+        self, session, name: str = None, run_id: int = None, project: str = None
+    ):
+        return self._query(
+            session, Notification, name=name, run=run_id, project=project
+        ).all()
+
     def _latest_uid_filter(self, session, query):
         # Create a sub query of latest uid (by updated) per (project,key)
         subq = (
             session.query(
                 Artifact.uid,
                 Artifact.project,
                 Artifact.key,
@@ -3164,14 +3199,43 @@
                 ),
             )
             self.store_project(session, project_record.name, project)
             return project
         # TODO: handle transforming the functions/workflows/artifacts references to real objects
         return schemas.Project(**project_record.full_object)
 
+    def _transform_notification_record_to_spec_and_status(
+        self,
+        notification_record: Notification,
+    ) -> typing.Tuple[dict, dict]:
+        notification_spec = self._transform_notification_record_to_schema(
+            notification_record
+        ).to_dict()
+        notification_status = {
+            "status": notification_spec.pop("status", None),
+            "sent_time": notification_spec.pop("sent_time", None),
+        }
+        return notification_spec, notification_status
+
+    @staticmethod
+    def _transform_notification_record_to_schema(
+        notification_record: Notification,
+    ) -> mlrun.model.Notification:
+        return mlrun.model.Notification(
+            kind=notification_record.kind,
+            name=notification_record.name,
+            message=notification_record.message,
+            severity=notification_record.severity,
+            when=notification_record.when.split(","),
+            condition=notification_record.condition,
+            params=notification_record.params,
+            status=notification_record.status,
+            sent_time=notification_record.sent_time,
+        )
+
     def _move_and_reorder_table_items(
         self, session, moved_object, move_to=None, move_from=None
     ):
         # If move_to is None - delete object. If move_from is None - insert a new object
         moved_object.index = move_to
 
         if move_from == move_to:
@@ -3539,7 +3603,104 @@
             and background_task_record.state
             not in mlrun.api.schemas.BackgroundTaskState.terminal_states()
             and datetime.utcnow()
             > timedelta(seconds=int(timeout)) + background_task_record.updated
         ):
             return True
         return False
+
+    def store_run_notifications(
+        self,
+        session,
+        notification_objects: typing.List[mlrun.model.Notification],
+        run_uid: str,
+        project: str,
+    ):
+        # iteration is 0, as we don't support multiple notifications per hyper param run, only for the whole run
+        run = self._get_run(session, run_uid, project, 0)
+        if not run:
+            raise mlrun.errors.MLRunNotFoundError(
+                f"Run not found: uid={run_uid}, project={project}"
+            )
+
+        run_notifications = {
+            notification.name: notification
+            for notification in self._get_db_notifications(session, run_id=run.id)
+        }
+        notifications = []
+        for notification_model in notification_objects:
+            new_notification = False
+            notification = run_notifications.get(notification_model.name, None)
+            if not notification:
+                new_notification = True
+                notification = Notification(
+                    name=notification_model.name, run=run.id, project=project
+                )
+
+            notification.kind = notification_model.kind
+            notification.message = notification_model.message
+            notification.severity = notification_model.severity
+            notification.when = ",".join(notification_model.when)
+            notification.condition = notification_model.condition
+            notification.params = notification_model.params
+            notification.status = (
+                notification_model.status
+                or mlrun.api.schemas.NotificationStatus.PENDING
+            )
+            notification.sent_time = notification_model.sent_time
+
+            logger.debug(
+                f"Storing {'new' if new_notification else 'existing'} notification",
+                notification_name=notification.name,
+                run_uid=run_uid,
+                project=project,
+            )
+            notifications.append(notification)
+
+        self._upsert(session, notifications)
+
+    def list_run_notifications(
+        self,
+        session,
+        run_uid: str,
+        project: str = "",
+    ) -> typing.List[mlrun.model.Notification]:
+
+        # iteration is 0, as we don't support multiple notifications per hyper param run, only for the whole run
+        run = self._get_run(session, run_uid, project, 0)
+        if not run:
+            return []
+
+        return [
+            self._transform_notification_record_to_schema(notification)
+            for notification in self._query(session, Notification, run=run.id).all()
+        ]
+
+    def delete_run_notifications(
+        self,
+        session,
+        name: str = None,
+        run_uid: str = None,
+        project: str = None,
+        commit: bool = True,
+    ):
+        run_id = None
+        if run_uid:
+
+            # iteration is 0, as we don't support multiple notifications per hyper param run, only for the whole run
+            run = self._get_run(session, run_uid, project, 0)
+            if not run:
+                raise mlrun.errors.MLRunNotFoundError(
+                    f"Run not found: uid={run_uid}, project={project}"
+                )
+            run_id = run.id
+
+        project = project or config.default_project
+        if project == "*":
+            project = None
+
+        query = self._get_db_notifications(session, name, run_id, project)
+        for notification in query:
+            session.delete(notification)
+
+        if commit:
+            session.commit()
```

## mlrun/api/db/sqldb/models/models_mysql.py

```diff
@@ -135,14 +135,54 @@
 
         labels = relationship(Label, cascade="all, delete-orphan")
         tags = relationship(Tag, cascade="all, delete-orphan")
 
         def get_identifier_string(self) -> str:
             return f"{self.project}/{self.name}/{self.uid}"
 
+    class Notification(Base, mlrun.utils.db.BaseModel):
+        __tablename__ = "notifications"
+        __table_args__ = (UniqueConstraint("name", "run", name="_notifications_uc"),)
+
+        id = Column(Integer, primary_key=True)
+        project = Column(String(255, collation=SQLCollationUtil.collation()))
+        name = Column(
+            String(255, collation=SQLCollationUtil.collation()), nullable=False
+        )
+        kind = Column(
+            String(255, collation=SQLCollationUtil.collation()), nullable=False
+        )
+        message = Column(
+            String(255, collation=SQLCollationUtil.collation()), nullable=False
+        )
+        severity = Column(
+            String(255, collation=SQLCollationUtil.collation()), nullable=False
+        )
+        when = Column(
+            String(255, collation=SQLCollationUtil.collation()), nullable=False
+        )
+        condition = Column(
+            String(255, collation=SQLCollationUtil.collation()), nullable=False
+        )
+        params = Column("params", JSON)
+        run = Column(Integer, ForeignKey("runs.id"))
+
+        # TODO: Separate table for notification state.
+        #   Currently, we are only supporting one notification being sent per DB row (either on completion or on error).
+        #   In the future, we might want to support multiple notifications per DB row, and we might want to support on
+        #   start, therefore we need to separate the state from the notification itself (e.g. this table can be  table
+        #   with notification_id, state, when, last_sent, etc.). This will require some refactoring in the code.
+        sent_time = Column(
+            sqlalchemy.dialects.mysql.TIMESTAMP(fsp=3),
+            nullable=True,
+        )
+        status = Column(
+            String(255, collation=SQLCollationUtil.collation()), nullable=False
+        )
+
     class Log(Base, mlrun.utils.db.BaseModel):
         __tablename__ = "logs"
 
         id = Column(Integer, primary_key=True)
         uid = Column(String(255, collation=SQLCollationUtil.collation()))
         project = Column(String(255, collation=SQLCollationUtil.collation()))
         # TODO: change to JSON, see mlrun/api/schemas/function.py::FunctionState for reasoning
@@ -178,14 +218,15 @@
         # None - old runs prior to the column addition, logs were already collected for them, so no need to collect them
         # False - logs were not requested for this run
         # True - logs were requested for this run
         requested_logs = Column(BOOLEAN, default=False, index=True)
 
         labels = relationship(Label, cascade="all, delete-orphan")
         tags = relationship(Tag, cascade="all, delete-orphan")
+        notifications = relationship(Notification, cascade="all, delete-orphan")
 
         def get_identifier_string(self) -> str:
             return f"{self.project}/{self.uid}/{self.iteration}"
 
     class BackgroundTask(Base, mlrun.utils.db.BaseModel):
         __tablename__ = "background_tasks"
         __table_args__ = (
```

## mlrun/api/db/sqldb/models/models_sqlite.py

```diff
@@ -147,14 +147,48 @@
         project = Column(String(255, collation=SQLCollationUtil.collation()))
         # TODO: change to JSON, see mlrun/api/schemas/function.py::FunctionState for reasoning
         body = Column(BLOB)
 
         def get_identifier_string(self) -> str:
             return f"{self.project}/{self.uid}"
 
+    class Notification(Base, mlrun.utils.db.BaseModel):
+        __tablename__ = "notifications"
+        __table_args__ = (UniqueConstraint("name", "run", name="_notifications_uc"),)
+
+        id = Column(Integer, primary_key=True)
+        project = Column(String(255, collation=SQLCollationUtil.collation()))
+        name = Column(
+            String(255, collation=SQLCollationUtil.collation()), nullable=False
+        )
+        kind = Column(
+            String(255, collation=SQLCollationUtil.collation()), nullable=False
+        )
+        message = Column(
+            String(255, collation=SQLCollationUtil.collation()), nullable=False
+        )
+        severity = Column(
+            String(255, collation=SQLCollationUtil.collation()), nullable=False
+        )
+        when = Column(
+            String(255, collation=SQLCollationUtil.collation()), nullable=False
+        )
+        condition = Column(
+            String(255, collation=SQLCollationUtil.collation()), nullable=False
+        )
+        params = Column("params", JSON)
+        run = Column(Integer, ForeignKey("runs.id"))
+        sent_time = Column(
+            TIMESTAMP(),
+            nullable=True,
+        )
+        status = Column(
+            String(255, collation=SQLCollationUtil.collation()), nullable=False
+        )
+
     class Run(Base, mlrun.utils.db.HasStruct):
         __tablename__ = "runs"
         __table_args__ = (
             UniqueConstraint("uid", "project", "iteration", name="_runs_uc"),
         )
 
         Label = make_label(__tablename__)
@@ -174,14 +208,15 @@
         # requested logs column indicates whether logs were requested for this run
         # None - old runs prior to the column addition, logs were already collected for them, so no need to collect them
         # False - logs were not requested for this run
         # True - logs were requested for this run
         requested_logs = Column(BOOLEAN)
         updated = Column(TIMESTAMP, default=datetime.utcnow)
         labels = relationship(Label)
+        notifications = relationship(Notification, cascade="all, delete-orphan")
 
         def get_identifier_string(self) -> str:
             return f"{self.project}/{self.uid}/{self.iteration}"
 
     class BackgroundTask(Base, mlrun.utils.db.BaseModel):
         __tablename__ = "background_tasks"
         __table_args__ = (
```

## mlrun/api/schemas/__init__.py

```diff
@@ -103,14 +103,15 @@
     ModelEndpoint,
     ModelEndpointList,
     ModelEndpointMetadata,
     ModelEndpointSpec,
     ModelEndpointStatus,
     ModelMonitoringStoreKinds,
 )
+from .notification import NotificationSeverity, NotificationStatus
 from .object import ObjectKind, ObjectMetadata, ObjectSpec, ObjectStatus
 from .pipeline import PipelinesFormat, PipelinesOutput, PipelinesPagination
 from .project import (
     IguazioProject,
     Project,
     ProjectDesiredState,
     ProjectMetadata,
```

## mlrun/api/schemas/marketplace.py

```diff
@@ -9,25 +9,25 @@
 # Unless required by applicable law or agreed to in writing, software
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 #
 from datetime import datetime, timezone
-from typing import List, Optional
+from typing import Dict, List, Optional
 
 from pydantic import BaseModel, Extra, Field
 
 import mlrun.api.utils.helpers
 import mlrun.errors
 from mlrun.api.schemas.object import ObjectKind, ObjectSpec, ObjectStatus
 from mlrun.config import config
 
 
-# Defining a different base class (not ObjectMetadata), as there's no project and it differs enough to
+# Defining a different base class (not ObjectMetadata), as there's no project, and it differs enough to
 # justify a new class
 class MarketplaceObjectMetadata(BaseModel):
     name: str
     description: str = ""
     labels: Optional[dict] = {}
     updated: Optional[datetime]
     created: Optional[datetime]
@@ -42,25 +42,31 @@
 
 
 # Sources-related objects
 class MarketplaceSourceSpec(ObjectSpec):
     path: str  # URL to base directory, should include schema (s3://, etc...)
     channel: str
     credentials: Optional[dict] = {}
+    object_type: MarketplaceSourceType = Field(
+        MarketplaceSourceType.functions, const=True
+    )
 
 
 class MarketplaceSource(BaseModel):
     kind: ObjectKind = Field(ObjectKind.marketplace_source, const=True)
     metadata: MarketplaceObjectMetadata
     spec: MarketplaceSourceSpec
     status: Optional[ObjectStatus] = ObjectStatus(state="created")
 
     def get_full_uri(self, relative_path):
-        return "{base}/{channel}/{relative_path}".format(
-            base=self.spec.path, channel=self.spec.channel, relative_path=relative_path
+        return "{base}/{object_type}/{channel}/{relative_path}".format(
+            base=self.spec.path,
+            object_type=self.spec.object_type,
+            channel=self.spec.channel,
+            relative_path=relative_path,
         )
 
     def get_catalog_uri(self):
         return self.get_full_uri(config.marketplace.catalog_filename)
 
     @classmethod
     def generate_default_source(cls):
@@ -75,54 +81,58 @@
             updated=now,
         )
         return cls(
             metadata=hub_metadata,
             spec=MarketplaceSourceSpec(
                 path=config.marketplace.default_source.url,
                 channel=config.marketplace.default_source.channel,
+                object_type=MarketplaceSourceType(
+                    config.marketplace.default_source.object_type
+                ),
             ),
             status=ObjectStatus(state="created"),
         )
 
 
 last_source_index = -1
 
 
 class IndexedMarketplaceSource(BaseModel):
-    index: int = last_source_index  # Default last. Otherwise must be > 0
+    index: int = last_source_index  # Default last. Otherwise, must be > 0
     source: MarketplaceSource
 
 
 # Item-related objects
 class MarketplaceItemMetadata(MarketplaceObjectMetadata):
     source: MarketplaceSourceType = Field(MarketplaceSourceType.functions, const=True)
-    channel: str
     version: str
     tag: Optional[str]
 
     def get_relative_path(self) -> str:
         if self.source == MarketplaceSourceType.functions:
             # This is needed since the marketplace deployment script modifies the paths to use _ instead of -.
             modified_name = self.name.replace("-", "_")
-            # Prefer using the tag if exists. Otherwise use version.
+            # Prefer using the tag if exists. Otherwise, use version.
             version = self.tag or self.version
-            return f"{self.source.value}/{self.channel}/{modified_name}/{version}/"
+            return f"{modified_name}/{version}/"
         else:
             raise mlrun.errors.MLRunInvalidArgumentError(
                 f"Bad source for marketplace item - {self.source}"
             )
 
 
 class MarketplaceItemSpec(ObjectSpec):
     item_uri: str
+    assets: Dict[str, str] = {}
 
 
 class MarketplaceItem(BaseModel):
     kind: ObjectKind = Field(ObjectKind.marketplace_item, const=True)
     metadata: MarketplaceItemMetadata
     spec: MarketplaceItemSpec
     status: ObjectStatus
 
 
 class MarketplaceCatalog(BaseModel):
     kind: ObjectKind = Field(ObjectKind.marketplace_catalog, const=True)
+    channel: str
     catalog: List[MarketplaceItem]
```

## mlrun/api/utils/singletons/db.py

```diff
@@ -9,15 +9,14 @@
 # Unless required by applicable law or agreed to in writing, software
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 #
 from mlrun.api.db.base import DBInterface
-from mlrun.api.db.filedb.db import FileDB
 from mlrun.api.db.sqldb.db import SQLDB
 from mlrun.api.db.sqldb.session import create_session
 from mlrun.config import config
 from mlrun.utils import logger
 
 # TODO: something nicer
 db: DBInterface = None
@@ -29,20 +28,15 @@
 
 
 def initialize_db(override_db=None):
     global db
     if override_db:
         db = override_db
         return
-    if config.httpdb.db_type == "filedb":
-        logger.info("Creating file db")
-        db = FileDB(config.httpdb.dirpath)
-        db.initialize(None)
-    else:
-        logger.info("Creating sql db")
-        db = SQLDB(config.httpdb.dsn)
-        db_session = None
-        try:
-            db_session = create_session()
-            db.initialize(db_session)
-        finally:
-            db_session.close()
+    logger.info("Creating sql db")
+    db = SQLDB(config.httpdb.dsn)
+    db_session = None
+    try:
+        db_session = create_session()
+        db.initialize(db_session)
+    finally:
+        db_session.close()
```

## mlrun/data_types/spark.py

```diff
@@ -12,14 +12,16 @@
 # See the License for the specific language governing permissions and
 # limitations under the License.
 #
 from datetime import datetime
 from os import environ
 
 import numpy as np
+import pytz
+from pyspark.sql.functions import to_utc_timestamp
 from pyspark.sql.types import BooleanType, DoubleType, TimestampType
 
 from mlrun.utils import logger
 
 from .data_types import InferOptions, spark_to_value_type
 
 try:
@@ -139,14 +141,17 @@
     df_after_type_casts = df
     timestamp_columns = set()
     boolean_columns = set()
     for field in df_after_type_casts.schema.fields:
         is_timestamp = isinstance(field.dataType, TimestampType)
         is_boolean = isinstance(field.dataType, BooleanType)
         if is_timestamp:
+            df_after_type_casts = df_after_type_casts.withColumn(
+                field.name, to_utc_timestamp(df_after_type_casts[field.name], "UTC")
+            )
             timestamp_columns.add(field.name)
         if is_boolean:
             boolean_columns.add(field.name)
         if is_timestamp or is_boolean:
             df_after_type_casts = df_after_type_casts.withColumn(
                 field.name,
                 df_after_type_casts[field.name].cast(DoubleType()),
@@ -206,19 +211,21 @@
 
     # convert values back to timestamp and boolean where appropriate
     original_type_stats = {"min", "max", "25%", "50%", "75%"}
     for col, stats in results_dict.items():
         if col in timestamp_columns:
             for stat, val in stats.items():
                 if stat == "mean" or stat in original_type_stats:
-                    stats[stat] = datetime.fromtimestamp(val).isoformat()
+                    stats[stat] = datetime.fromtimestamp(val, tz=pytz.UTC).isoformat()
                 elif stat == "hist":
                     values = stats[stat][1]
                     for i in range(len(values)):
-                        values[i] = datetime.fromtimestamp(values[i]).isoformat()
+                        values[i] = datetime.fromtimestamp(
+                            values[i], tz=pytz.UTC
+                        ).isoformat()
         # for boolean values, keep mean and histogram values numeric (0 to 1 representation)
         if col in boolean_columns:
             for stat, val in stats.items():
                 if stat in original_type_stats:
                     stats[stat] = bool(val)
 
     return results_dict
```

## mlrun/datastore/base.py

```diff
@@ -379,28 +379,37 @@
         return self._store.listdir(self._path)
 
     def listdir(self):
         """return a list of child file names"""
         return self._store.listdir(self._path)
 
     def local(self):
-        """get the local path of the file, download to tmp first if its a remote object"""
+        """get the local path of the file, download to tmp first if it's a remote object"""
         if self.kind == "file":
             return self._path
         if self._local_path:
             return self._local_path
 
         dot = self._path.rfind(".")
         suffix = "" if dot == -1 else self._path[dot:]
         temp_file = tempfile.NamedTemporaryFile(suffix=suffix, delete=False)
         self._local_path = temp_file.name
         logger.info(f"downloading {self.url} to local temp file")
         self.download(self._local_path)
         return self._local_path
 
+    def remove_local(self):
+        """remove the local file if it exists and was downloaded from a remote object"""
+        if self.kind == "file":
+            return
+
+        if self._local_path:
+            remove(self._local_path)
+            self._local_path = ""
+
     def as_df(
         self,
         columns=None,
         df_module=None,
         format="",
         **kwargs,
     ):
```

## mlrun/datastore/sources.py

```diff
@@ -881,15 +881,15 @@
         spark_options: dict = None,
         time_fields: List[str] = None,
     ):
         """
         Reads SqlDB as input source for a flow.
         example::
             db_path = "mysql+pymysql://<username>:<password>@<host>:<port>/<db_name>"
-            source = SqlDBSource(
+            source = SQLSource(
                 collection_name='source_name', db_path=self.db, key_field='key'
             )
         :param name:            source name
         :param chunksize:       number of rows per chunk (default large single chunk)
         :param key_field:       the column to be used as the key for the collection.
         :param time_field:      the column to be parsed as timestamp for events. Defaults to None
         :param start_time:      filters out data before this time
```

## mlrun/db/__init__.py

```diff
@@ -14,15 +14,15 @@
 from os import environ
 from urllib.parse import urlparse
 
 from ..config import config
 from ..platforms import add_or_refresh_credentials
 from ..utils import logger
 from .base import RunDBError, RunDBInterface  # noqa
-from .filedb import FileRunDB
+from .nopdb import NopDB
 from .sqldb import SQLDB
 
 
 def get_or_set_dburl(default=""):
     if not config.dbpath and default:
         config.dbpath = default
         environ["MLRUN_DBPATH"] = default
@@ -65,20 +65,22 @@
     _last_db_url = url
 
     parsed_url = urlparse(url)
     scheme = parsed_url.scheme.lower()
     kwargs = {}
     if "://" not in str(url) or scheme in ["file", "s3", "v3io", "v3ios"]:
         logger.warning(
-            "Could not detect path to API server, Using Deprecated client interface"
+            "Could not detect path to API server, not connected to API server!"
         )
         logger.warning(
-            "Please make sure your env variable MLRUN_DBPATH is configured correctly to point to the API server!"
+            "MLRUN_DBPATH is not set. Set this environment variable to the URL of the API server"
+            " in order to connect"
         )
-        cls = FileRunDB
+        cls = NopDB
+
     elif scheme in ("http", "https"):
         # import here to avoid circular imports
         from .httpdb import HTTPRunDB
 
         cls = HTTPRunDB
         kwargs = get_httpdb_kwargs(
             parsed_url.hostname, parsed_url.username, parsed_url.password
```

## mlrun/db/base.py

```diff
@@ -72,14 +72,15 @@
         last_update_time_from: datetime.datetime = None,
         last_update_time_to: datetime.datetime = None,
         partition_by: Union[schemas.RunPartitionByField, str] = None,
         rows_per_partition: int = 1,
         partition_sort_by: Union[schemas.SortField, str] = None,
         partition_order: Union[schemas.OrderType, str] = schemas.OrderType.desc,
         max_partitions: int = 0,
+        with_notifications: bool = False,
     ):
         pass
 
     @abstractmethod
     def del_run(self, uid, project="", iter=0):
         pass
 
@@ -551,27 +552,25 @@
     def delete_marketplace_source(self, source_name: str):
         pass
 
     @abstractmethod
     def get_marketplace_catalog(
         self,
         source_name: str,
-        channel: str = None,
         version: str = None,
         tag: str = None,
         force_refresh: bool = False,
     ):
         pass
 
     @abstractmethod
     def get_marketplace_item(
         self,
         source_name: str,
         item_name: str,
-        channel: str = "development",
         version: str = None,
         tag: str = "latest",
         force_refresh: bool = False,
     ):
         pass
 
     @abstractmethod
```

## mlrun/db/httpdb.py

```diff
@@ -1522,6496 +1522,6550 @@
 00005f10: 2020 2020 2070 6172 7469 7469 6f6e 5f6f       partition_o
 00005f20: 7264 6572 3a20 556e 696f 6e5b 7363 6865  rder: Union[sche
 00005f30: 6d61 732e 4f72 6465 7254 7970 652c 2073  mas.OrderType, s
 00005f40: 7472 5d20 3d20 7363 6865 6d61 732e 4f72  tr] = schemas.Or
 00005f50: 6465 7254 7970 652e 6465 7363 2c0a 2020  derType.desc,.  
 00005f60: 2020 2020 2020 6d61 785f 7061 7274 6974        max_partit
 00005f70: 696f 6e73 3a20 696e 7420 3d20 302c 0a20  ions: int = 0,. 
-00005f80: 2020 2029 202d 3e20 5275 6e4c 6973 743a     ) -> RunList:
-00005f90: 0a20 2020 2020 2020 2022 2222 5265 7472  .        """Retr
-00005fa0: 6965 7665 2061 206c 6973 7420 6f66 2072  ieve a list of r
-00005fb0: 756e 732c 2066 696c 7465 7265 6420 6279  uns, filtered by
-00005fc0: 2076 6172 696f 7573 206f 7074 696f 6e73   various options
-00005fd0: 2e0a 2020 2020 2020 2020 4578 616d 706c  ..        Exampl
-00005fe0: 653a 3a0a 0a20 2020 2020 2020 2020 2020  e::..           
-00005ff0: 2072 756e 7320 3d20 6462 2e6c 6973 745f   runs = db.list_
-00006000: 7275 6e73 286e 616d 653d 2764 6f77 6e6c  runs(name='downl
-00006010: 6f61 6427 2c20 7072 6f6a 6563 743d 2769  oad', project='i
-00006020: 7269 7327 2c20 6c61 6265 6c73 3d27 6f77  ris', labels='ow
-00006030: 6e65 723d 6164 6d69 6e27 290a 2020 2020  ner=admin').    
-00006040: 2020 2020 2020 2020 2320 4966 2072 756e          # If run
-00006050: 6e69 6e67 2069 6e20 4a75 7079 7465 722c  ning in Jupyter,
-00006060: 2063 616e 2075 7365 2074 6865 202e 7368   can use the .sh
-00006070: 6f77 2829 2066 756e 6374 696f 6e20 746f  ow() function to
-00006080: 2064 6973 706c 6179 2074 6865 2072 6573   display the res
-00006090: 756c 7473 0a20 2020 2020 2020 2020 2020  ults.           
-000060a0: 2064 622e 6c69 7374 5f72 756e 7328 6e61   db.list_runs(na
-000060b0: 6d65 3d27 272c 2070 726f 6a65 6374 3d70  me='', project=p
-000060c0: 726f 6a65 6374 5f6e 616d 6529 2e73 686f  roject_name).sho
-000060d0: 7728 290a 0a0a 2020 2020 2020 2020 3a70  w()...        :p
-000060e0: 6172 616d 206e 616d 653a 204e 616d 6520  aram name: Name 
-000060f0: 6f66 2074 6865 2072 756e 2074 6f20 7265  of the run to re
-00006100: 7472 6965 7665 2e0a 2020 2020 2020 2020  trieve..        
-00006110: 3a70 6172 616d 2075 6964 3a20 556e 6971  :param uid: Uniq
-00006120: 7565 2049 4420 6f66 2074 6865 2072 756e  ue ID of the run
-00006130: 2c20 6f72 2061 206c 6973 7420 6f66 2072  , or a list of r
-00006140: 756e 2055 4944 732e 0a20 2020 2020 2020  un UIDs..       
-00006150: 203a 7061 7261 6d20 7072 6f6a 6563 743a   :param project:
-00006160: 2050 726f 6a65 6374 2074 6861 7420 7468   Project that th
-00006170: 6520 7275 6e73 2062 656c 6f6e 6773 2074  e runs belongs t
-00006180: 6f2e 0a20 2020 2020 2020 203a 7061 7261  o..        :para
-00006190: 6d20 6c61 6265 6c73 3a20 4c69 7374 2072  m labels: List r
-000061a0: 756e 7320 7468 6174 2068 6176 6520 6120  uns that have a 
-000061b0: 7370 6563 6966 6963 206c 6162 656c 2061  specific label a
-000061c0: 7373 6967 6e65 642e 2043 7572 7265 6e74  ssigned. Current
-000061d0: 6c79 206f 6e6c 7920 6120 7369 6e67 6c65  ly only a single
-000061e0: 206c 6162 656c 2066 696c 7465 7220 6361   label filter ca
-000061f0: 6e20 6265 0a20 2020 2020 2020 2020 2020  n be.           
-00006200: 2061 7070 6c69 6564 2c20 6f74 6865 7277   applied, otherw
-00006210: 6973 6520 7265 7375 6c74 2077 696c 6c20  ise result will 
-00006220: 6265 2065 6d70 7479 2e0a 2020 2020 2020  be empty..      
-00006230: 2020 3a70 6172 616d 2073 7461 7465 3a20    :param state: 
-00006240: 4c69 7374 206f 6e6c 7920 7275 6e73 2077  List only runs w
-00006250: 686f 7365 2073 7461 7465 2069 7320 7370  hose state is sp
-00006260: 6563 6966 6965 642e 0a20 2020 2020 2020  ecified..       
-00006270: 203a 7061 7261 6d20 736f 7274 3a20 5768   :param sort: Wh
-00006280: 6574 6865 7220 746f 2073 6f72 7420 7468  ether to sort th
-00006290: 6520 7265 7375 6c74 2061 6363 6f72 6469  e result accordi
-000062a0: 6e67 2074 6f20 7468 6569 7220 7374 6172  ng to their star
-000062b0: 7420 7469 6d65 2e20 4f74 6865 7277 6973  t time. Otherwis
-000062c0: 652c 2072 6573 756c 7473 2077 696c 6c20  e, results will 
-000062d0: 6265 0a20 2020 2020 2020 2020 2020 2072  be.            r
-000062e0: 6574 7572 6e65 6420 6279 2074 6865 6972  eturned by their
-000062f0: 2069 6e74 6572 6e61 6c20 6f72 6465 7220   internal order 
-00006300: 696e 2074 6865 2044 4220 286f 7264 6572  in the DB (order
-00006310: 2077 696c 6c20 6e6f 7420 6265 2067 7561   will not be gua
-00006320: 7261 6e74 6565 6429 2e0a 2020 2020 2020  ranteed)..      
-00006330: 2020 3a70 6172 616d 206c 6173 743a 2044    :param last: D
-00006340: 6570 7265 6361 7465 6420 2d20 6375 7272  eprecated - curr
-00006350: 656e 746c 7920 6e6f 7420 7573 6564 2e0a  ently not used..
-00006360: 2020 2020 2020 2020 3a70 6172 616d 2069          :param i
-00006370: 7465 723a 2049 6620 6060 5472 7565 6060  ter: If ``True``
-00006380: 2072 6574 7572 6e20 7275 6e73 2066 726f   return runs fro
-00006390: 6d20 616c 6c20 6974 6572 6174 696f 6e73  m all iterations
-000063a0: 2e20 4f74 6865 7277 6973 652c 2072 6574  . Otherwise, ret
-000063b0: 7572 6e20 6f6e 6c79 2072 756e 7320 7768  urn only runs wh
-000063c0: 6f73 6520 6060 6974 6572 6060 2069 7320  ose ``iter`` is 
-000063d0: 302e 0a20 2020 2020 2020 203a 7061 7261  0..        :para
-000063e0: 6d20 7374 6172 745f 7469 6d65 5f66 726f  m start_time_fro
-000063f0: 6d3a 2046 696c 7465 7220 6279 2072 756e  m: Filter by run
-00006400: 2073 7461 7274 2074 696d 6520 696e 2060   start time in `
-00006410: 605b 7374 6172 745f 7469 6d65 5f66 726f  `[start_time_fro
-00006420: 6d2c 2073 7461 7274 5f74 696d 655f 746f  m, start_time_to
-00006430: 5d60 602e 0a20 2020 2020 2020 203a 7061  ]``..        :pa
-00006440: 7261 6d20 7374 6172 745f 7469 6d65 5f74  ram start_time_t
-00006450: 6f3a 2046 696c 7465 7220 6279 2072 756e  o: Filter by run
-00006460: 2073 7461 7274 2074 696d 6520 696e 2060   start time in `
-00006470: 605b 7374 6172 745f 7469 6d65 5f66 726f  `[start_time_fro
-00006480: 6d2c 2073 7461 7274 5f74 696d 655f 746f  m, start_time_to
-00006490: 5d60 602e 0a20 2020 2020 2020 203a 7061  ]``..        :pa
-000064a0: 7261 6d20 6c61 7374 5f75 7064 6174 655f  ram last_update_
-000064b0: 7469 6d65 5f66 726f 6d3a 2046 696c 7465  time_from: Filte
-000064c0: 7220 6279 2072 756e 206c 6173 7420 7570  r by run last up
-000064d0: 6461 7465 2074 696d 6520 696e 2060 6028  date time in ``(
-000064e0: 6c61 7374 5f75 7064 6174 655f 7469 6d65  last_update_time
-000064f0: 5f66 726f 6d2c 0a20 2020 2020 2020 2020  _from,.         
-00006500: 2020 206c 6173 745f 7570 6461 7465 5f74     last_update_t
-00006510: 696d 655f 746f 2960 602e 0a20 2020 2020  ime_to)``..     
-00006520: 2020 203a 7061 7261 6d20 6c61 7374 5f75     :param last_u
-00006530: 7064 6174 655f 7469 6d65 5f74 6f3a 2046  pdate_time_to: F
-00006540: 696c 7465 7220 6279 2072 756e 206c 6173  ilter by run las
-00006550: 7420 7570 6461 7465 2074 696d 6520 696e  t update time in
-00006560: 2060 6028 6c61 7374 5f75 7064 6174 655f   ``(last_update_
-00006570: 7469 6d65 5f66 726f 6d2c 206c 6173 745f  time_from, last_
-00006580: 7570 6461 7465 5f74 696d 655f 746f 2960  update_time_to)`
-00006590: 602e 0a20 2020 2020 2020 203a 7061 7261  `..        :para
-000065a0: 6d20 7061 7274 6974 696f 6e5f 6279 3a20  m partition_by: 
-000065b0: 4669 656c 6420 746f 2067 726f 7570 2072  Field to group r
-000065c0: 6573 756c 7473 2062 792e 204f 6e6c 7920  esults by. Only 
-000065d0: 616c 6c6f 7765 6420 7661 6c75 6520 6973  allowed value is
-000065e0: 2060 6e61 6d65 602e 2057 6865 6e20 6070   `name`. When `p
-000065f0: 6172 7469 7469 6f6e 5f62 7960 2069 7320  artition_by` is 
-00006600: 7370 6563 6966 6965 642c 0a20 2020 2020  specified,.     
-00006610: 2020 2020 2020 2074 6865 2060 7061 7274         the `part
-00006620: 6974 696f 6e5f 736f 7274 5f62 7960 2070  ition_sort_by` p
-00006630: 6172 616d 6574 6572 206d 7573 7420 6265  arameter must be
-00006640: 2070 726f 7669 6465 6420 6173 2077 656c   provided as wel
-00006650: 6c2e 0a20 2020 2020 2020 203a 7061 7261  l..        :para
-00006660: 6d20 726f 7773 5f70 6572 5f70 6172 7469  m rows_per_parti
-00006670: 7469 6f6e 3a20 486f 7720 6d61 6e79 2074  tion: How many t
-00006680: 6f70 2072 6f77 7320 2870 6572 2073 6f72  op rows (per sor
-00006690: 7469 6e67 2064 6566 696e 6564 2062 7920  ting defined by 
-000066a0: 6070 6172 7469 7469 6f6e 5f73 6f72 745f  `partition_sort_
-000066b0: 6279 6020 616e 6420 6070 6172 7469 7469  by` and `partiti
-000066c0: 6f6e 5f6f 7264 6572 6029 0a20 2020 2020  on_order`).     
-000066d0: 2020 2020 2020 2074 6f20 7265 7475 726e         to return
-000066e0: 2070 6572 2067 726f 7570 2e20 4465 6661   per group. Defa
-000066f0: 756c 7420 7661 6c75 6520 6973 2031 2e0a  ult value is 1..
-00006700: 2020 2020 2020 2020 3a70 6172 616d 2070          :param p
-00006710: 6172 7469 7469 6f6e 5f73 6f72 745f 6279  artition_sort_by
-00006720: 3a20 5768 6174 2066 6965 6c64 2074 6f20  : What field to 
-00006730: 736f 7274 2074 6865 2072 6573 756c 7473  sort the results
-00006740: 2062 792c 2077 6974 6869 6e20 6561 6368   by, within each
-00006750: 2070 6172 7469 7469 6f6e 2064 6566 696e   partition defin
-00006760: 6564 2062 7920 6070 6172 7469 7469 6f6e  ed by `partition
-00006770: 5f62 7960 2e0a 2020 2020 2020 2020 2020  _by`..          
-00006780: 2020 4375 7272 656e 746c 7920 7468 6520    Currently the 
-00006790: 6f6e 6c79 2061 6c6c 6f77 6564 2076 616c  only allowed val
-000067a0: 7565 7320 6172 6520 6063 7265 6174 6564  ues are `created
-000067b0: 6020 616e 6420 6075 7064 6174 6564 602e  ` and `updated`.
-000067c0: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
-000067d0: 7061 7274 6974 696f 6e5f 6f72 6465 723a  partition_order:
-000067e0: 204f 7264 6572 206f 6620 736f 7274 696e   Order of sortin
-000067f0: 6720 7769 7468 696e 2070 6172 7469 7469  g within partiti
-00006800: 6f6e 7320 2d20 6061 7363 6020 6f72 2060  ons - `asc` or `
-00006810: 6465 7363 602e 2044 6566 6175 6c74 2069  desc`. Default i
-00006820: 7320 6064 6573 6360 2e0a 2020 2020 2020  s `desc`..      
-00006830: 2020 3a70 6172 616d 206d 6178 5f70 6172    :param max_par
-00006840: 7469 7469 6f6e 733a 204d 6178 696d 616c  titions: Maximal
-00006850: 206e 756d 6265 7220 6f66 2070 6172 7469   number of parti
-00006860: 7469 6f6e 7320 746f 2069 6e63 6c75 6465  tions to include
-00006870: 2069 6e20 7468 6520 7265 7375 6c74 2e20   in the result. 
-00006880: 4465 6661 756c 7420 6973 2060 3060 2077  Default is `0` w
-00006890: 6869 6368 206d 6561 6e73 206e 6f0a 2020  hich means no.  
-000068a0: 2020 2020 2020 2020 2020 6c69 6d69 742e            limit.
-000068b0: 0a20 2020 2020 2020 2022 2222 0a0a 2020  .        """..  
-000068c0: 2020 2020 2020 7072 6f6a 6563 7420 3d20        project = 
-000068d0: 7072 6f6a 6563 7420 6f72 2063 6f6e 6669  project or confi
-000068e0: 672e 6465 6661 756c 745f 7072 6f6a 6563  g.default_projec
-000068f0: 740a 2020 2020 2020 2020 7061 7261 6d73  t.        params
-00006900: 203d 207b 0a20 2020 2020 2020 2020 2020   = {.           
-00006910: 2022 6e61 6d65 223a 206e 616d 652c 0a20   "name": name,. 
-00006920: 2020 2020 2020 2020 2020 2022 7569 6422             "uid"
-00006930: 3a20 7569 642c 0a20 2020 2020 2020 2020  : uid,.         
-00006940: 2020 2022 7072 6f6a 6563 7422 3a20 7072     "project": pr
-00006950: 6f6a 6563 742c 0a20 2020 2020 2020 2020  oject,.         
-00006960: 2020 2022 6c61 6265 6c22 3a20 6c61 6265     "label": labe
-00006970: 6c73 206f 7220 5b5d 2c0a 2020 2020 2020  ls or [],.      
-00006980: 2020 2020 2020 2273 7461 7465 223a 2073        "state": s
-00006990: 7461 7465 2c0a 2020 2020 2020 2020 2020  tate,.          
-000069a0: 2020 2273 6f72 7422 3a20 626f 6f6c 3273    "sort": bool2s
-000069b0: 7472 2873 6f72 7429 2c0a 2020 2020 2020  tr(sort),.      
-000069c0: 2020 2020 2020 2269 7465 7222 3a20 626f        "iter": bo
-000069d0: 6f6c 3273 7472 2869 7465 7229 2c0a 2020  ol2str(iter),.  
-000069e0: 2020 2020 2020 2020 2020 2273 7461 7274            "start
-000069f0: 5f74 696d 655f 6672 6f6d 223a 2064 6174  _time_from": dat
-00006a00: 6574 696d 655f 746f 5f69 736f 2873 7461  etime_to_iso(sta
-00006a10: 7274 5f74 696d 655f 6672 6f6d 292c 0a20  rt_time_from),. 
-00006a20: 2020 2020 2020 2020 2020 2022 7374 6172             "star
-00006a30: 745f 7469 6d65 5f74 6f22 3a20 6461 7465  t_time_to": date
-00006a40: 7469 6d65 5f74 6f5f 6973 6f28 7374 6172  time_to_iso(star
-00006a50: 745f 7469 6d65 5f74 6f29 2c0a 2020 2020  t_time_to),.    
-00006a60: 2020 2020 2020 2020 226c 6173 745f 7570          "last_up
-00006a70: 6461 7465 5f74 696d 655f 6672 6f6d 223a  date_time_from":
-00006a80: 2064 6174 6574 696d 655f 746f 5f69 736f   datetime_to_iso
-00006a90: 286c 6173 745f 7570 6461 7465 5f74 696d  (last_update_tim
-00006aa0: 655f 6672 6f6d 292c 0a20 2020 2020 2020  e_from),.       
-00006ab0: 2020 2020 2022 6c61 7374 5f75 7064 6174       "last_updat
-00006ac0: 655f 7469 6d65 5f74 6f22 3a20 6461 7465  e_time_to": date
-00006ad0: 7469 6d65 5f74 6f5f 6973 6f28 6c61 7374  time_to_iso(last
-00006ae0: 5f75 7064 6174 655f 7469 6d65 5f74 6f29  _update_time_to)
-00006af0: 2c0a 2020 2020 2020 2020 7d0a 0a20 2020  ,.        }..   
-00006b00: 2020 2020 2069 6620 7061 7274 6974 696f       if partitio
-00006b10: 6e5f 6279 3a0a 2020 2020 2020 2020 2020  n_by:.          
-00006b20: 2020 7061 7261 6d73 2e75 7064 6174 6528    params.update(
-00006b30: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00006b40: 2073 656c 662e 5f67 656e 6572 6174 655f   self._generate_
-00006b50: 7061 7274 6974 696f 6e5f 6279 5f70 6172  partition_by_par
-00006b60: 616d 7328 0a20 2020 2020 2020 2020 2020  ams(.           
-00006b70: 2020 2020 2020 2020 2073 6368 656d 6173           schemas
-00006b80: 2e52 756e 5061 7274 6974 696f 6e42 7946  .RunPartitionByF
-00006b90: 6965 6c64 2c0a 2020 2020 2020 2020 2020  ield,.          
-00006ba0: 2020 2020 2020 2020 2020 7061 7274 6974            partit
-00006bb0: 696f 6e5f 6279 2c0a 2020 2020 2020 2020  ion_by,.        
-00006bc0: 2020 2020 2020 2020 2020 2020 726f 7773              rows
-00006bd0: 5f70 6572 5f70 6172 7469 7469 6f6e 2c0a  _per_partition,.
-00006be0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006bf0: 2020 2020 7061 7274 6974 696f 6e5f 736f      partition_so
-00006c00: 7274 5f62 792c 0a20 2020 2020 2020 2020  rt_by,.         
-00006c10: 2020 2020 2020 2020 2020 2070 6172 7469             parti
-00006c20: 7469 6f6e 5f6f 7264 6572 2c0a 2020 2020  tion_order,.    
-00006c30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006c40: 6d61 785f 7061 7274 6974 696f 6e73 2c0a  max_partitions,.
-00006c50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006c60: 290a 2020 2020 2020 2020 2020 2020 290a  ).            ).
-00006c70: 2020 2020 2020 2020 6572 726f 7220 3d20          error = 
-00006c80: 226c 6973 7420 7275 6e73 220a 2020 2020  "list runs".    
-00006c90: 2020 2020 7265 7370 203d 2073 656c 662e      resp = self.
-00006ca0: 6170 695f 6361 6c6c 2822 4745 5422 2c20  api_call("GET", 
-00006cb0: 2272 756e 7322 2c20 6572 726f 722c 2070  "runs", error, p
-00006cc0: 6172 616d 733d 7061 7261 6d73 290a 2020  arams=params).  
-00006cd0: 2020 2020 2020 7265 7475 726e 2052 756e        return Run
-00006ce0: 4c69 7374 2872 6573 702e 6a73 6f6e 2829  List(resp.json()
-00006cf0: 5b22 7275 6e73 225d 290a 0a20 2020 2064  ["runs"])..    d
-00006d00: 6566 2064 656c 5f72 756e 7328 7365 6c66  ef del_runs(self
-00006d10: 2c20 6e61 6d65 3d4e 6f6e 652c 2070 726f  , name=None, pro
-00006d20: 6a65 6374 3d4e 6f6e 652c 206c 6162 656c  ject=None, label
-00006d30: 733d 4e6f 6e65 2c20 7374 6174 653d 4e6f  s=None, state=No
-00006d40: 6e65 2c20 6461 7973 5f61 676f 3d30 293a  ne, days_ago=0):
-00006d50: 0a20 2020 2020 2020 2022 2222 4465 6c65  .        """Dele
-00006d60: 7465 2061 2067 726f 7570 206f 6620 7275  te a group of ru
-00006d70: 6e73 2069 6465 6e74 6966 6965 6420 6279  ns identified by
-00006d80: 2074 6865 2070 6172 616d 6574 6572 7320   the parameters 
-00006d90: 6f66 2074 6865 2066 756e 6374 696f 6e2e  of the function.
-00006da0: 0a0a 2020 2020 2020 2020 4578 616d 706c  ..        Exampl
-00006db0: 653a 3a0a 0a20 2020 2020 2020 2020 2020  e::..           
-00006dc0: 2064 622e 6465 6c5f 7275 6e73 2873 7461   db.del_runs(sta
-00006dd0: 7465 3d27 636f 6d70 6c65 7465 6427 290a  te='completed').
-00006de0: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
-00006df0: 6e61 6d65 3a20 4e61 6d65 206f 6620 7468  name: Name of th
-00006e00: 6520 7461 736b 2077 6869 6368 2074 6865  e task which the
-00006e10: 2072 756e 7320 6265 6c6f 6e67 2074 6f2e   runs belong to.
-00006e20: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
-00006e30: 7072 6f6a 6563 743a 2050 726f 6a65 6374  project: Project
-00006e40: 2074 6f20 7768 6963 6820 7468 6520 7275   to which the ru
-00006e50: 6e73 2062 656c 6f6e 672e 0a20 2020 2020  ns belong..     
-00006e60: 2020 203a 7061 7261 6d20 6c61 6265 6c73     :param labels
-00006e70: 3a20 4669 6c74 6572 2072 756e 7320 7468  : Filter runs th
-00006e80: 6174 2061 7265 206c 6162 656c 6564 2075  at are labeled u
-00006e90: 7369 6e67 2074 6865 7365 2073 7065 6369  sing these speci
-00006ea0: 6669 6320 6c61 6265 6c20 7661 6c75 6573  fic label values
-00006eb0: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
-00006ec0: 2073 7461 7465 3a20 4669 6c74 6572 206f   state: Filter o
-00006ed0: 6e6c 7920 7275 6e73 2077 6869 6368 2061  nly runs which a
-00006ee0: 7265 2069 6e20 7468 6973 2073 7461 7465  re in this state
-00006ef0: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
-00006f00: 2064 6179 735f 6167 6f3a 2046 696c 7465   days_ago: Filte
-00006f10: 7220 7275 6e73 2077 686f 7365 2073 7461  r runs whose sta
-00006f20: 7274 2074 696d 6520 6973 206e 6577 6572  rt time is newer
-00006f30: 2074 6861 6e20 7468 6973 2070 6172 616d   than this param
-00006f40: 6574 6572 2e0a 2020 2020 2020 2020 2222  eter..        ""
-00006f50: 220a 0a20 2020 2020 2020 2070 726f 6a65  "..        proje
-00006f60: 6374 203d 2070 726f 6a65 6374 206f 7220  ct = project or 
-00006f70: 636f 6e66 6967 2e64 6566 6175 6c74 5f70  config.default_p
-00006f80: 726f 6a65 6374 0a20 2020 2020 2020 2070  roject.        p
-00006f90: 6172 616d 7320 3d20 7b0a 2020 2020 2020  arams = {.      
-00006fa0: 2020 2020 2020 226e 616d 6522 3a20 6e61        "name": na
-00006fb0: 6d65 2c0a 2020 2020 2020 2020 2020 2020  me,.            
-00006fc0: 2270 726f 6a65 6374 223a 2070 726f 6a65  "project": proje
-00006fd0: 6374 2c0a 2020 2020 2020 2020 2020 2020  ct,.            
-00006fe0: 226c 6162 656c 223a 206c 6162 656c 7320  "label": labels 
-00006ff0: 6f72 205b 5d2c 0a20 2020 2020 2020 2020  or [],.         
-00007000: 2020 2022 7374 6174 6522 3a20 7374 6174     "state": stat
-00007010: 652c 0a20 2020 2020 2020 2020 2020 2022  e,.            "
-00007020: 6461 7973 5f61 676f 223a 2073 7472 2864  days_ago": str(d
-00007030: 6179 735f 6167 6f29 2c0a 2020 2020 2020  ays_ago),.      
-00007040: 2020 7d0a 2020 2020 2020 2020 6572 726f    }.        erro
-00007050: 7220 3d20 2264 656c 2072 756e 7322 0a20  r = "del runs". 
-00007060: 2020 2020 2020 2073 656c 662e 6170 695f         self.api_
-00007070: 6361 6c6c 2822 4445 4c45 5445 222c 2022  call("DELETE", "
-00007080: 7275 6e73 222c 2065 7272 6f72 2c20 7061  runs", error, pa
-00007090: 7261 6d73 3d70 6172 616d 7329 0a0a 2020  rams=params)..  
-000070a0: 2020 6465 6620 7374 6f72 655f 6172 7469    def store_arti
-000070b0: 6661 6374 2873 656c 662c 206b 6579 2c20  fact(self, key, 
-000070c0: 6172 7469 6661 6374 2c20 7569 642c 2069  artifact, uid, i
-000070d0: 7465 723d 4e6f 6e65 2c20 7461 673d 4e6f  ter=None, tag=No
-000070e0: 6e65 2c20 7072 6f6a 6563 743d 2222 293a  ne, project=""):
-000070f0: 0a20 2020 2020 2020 2022 2222 5374 6f72  .        """Stor
-00007100: 6520 616e 2061 7274 6966 6163 7420 696e  e an artifact in
-00007110: 2074 6865 2044 422e 0a0a 2020 2020 2020   the DB...      
-00007120: 2020 3a70 6172 616d 206b 6579 3a20 4964    :param key: Id
-00007130: 656e 7469 6679 696e 6720 6b65 7920 6f66  entifying key of
-00007140: 2074 6865 2061 7274 6966 6163 742e 0a20   the artifact.. 
-00007150: 2020 2020 2020 203a 7061 7261 6d20 6172         :param ar
-00007160: 7469 6661 6374 3a20 5468 6520 6163 7475  tifact: The actu
-00007170: 616c 2061 7274 6966 6163 7420 746f 2073  al artifact to s
-00007180: 746f 7265 2e0a 2020 2020 2020 2020 3a70  tore..        :p
-00007190: 6172 616d 2075 6964 3a20 4120 756e 6971  aram uid: A uniq
-000071a0: 7565 2049 4420 666f 7220 7468 6973 2073  ue ID for this s
-000071b0: 7065 6369 6669 6320 7665 7273 696f 6e20  pecific version 
-000071c0: 6f66 2074 6865 2061 7274 6966 6163 742e  of the artifact.
-000071d0: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
-000071e0: 6974 6572 3a20 5468 6520 7461 736b 2069  iter: The task i
-000071f0: 7465 7261 7469 6f6e 2077 6869 6368 2067  teration which g
-00007200: 656e 6572 6174 6564 2074 6869 7320 6172  enerated this ar
-00007210: 7469 6661 6374 2e20 4966 2060 6069 7465  tifact. If ``ite
-00007220: 7260 6020 6973 206e 6f74 2060 604e 6f6e  r`` is not ``Non
-00007230: 6560 6020 7468 6520 6974 6572 6174 696f  e`` the iteratio
-00007240: 6e20 7769 6c6c 0a20 2020 2020 2020 2020  n will.         
-00007250: 2020 2062 6520 6164 6465 6420 746f 2074     be added to t
-00007260: 6865 206b 6579 2070 726f 7669 6465 6420  he key provided 
-00007270: 746f 2067 656e 6572 6174 6520 6120 756e  to generate a un
-00007280: 6971 7565 206b 6579 2066 6f72 2074 6865  ique key for the
-00007290: 2061 7274 6966 6163 7420 6f66 2074 6865   artifact of the
-000072a0: 2073 7065 6369 6669 6320 6974 6572 6174   specific iterat
-000072b0: 696f 6e2e 0a20 2020 2020 2020 203a 7061  ion..        :pa
-000072c0: 7261 6d20 7461 673a 2054 6167 206f 6620  ram tag: Tag of 
-000072d0: 7468 6520 6172 7469 6661 6374 2e0a 2020  the artifact..  
-000072e0: 2020 2020 2020 3a70 6172 616d 2070 726f        :param pro
-000072f0: 6a65 6374 3a20 5072 6f6a 6563 7420 7468  ject: Project th
-00007300: 6174 2074 6865 2061 7274 6966 6163 7420  at the artifact 
-00007310: 6265 6c6f 6e67 7320 746f 2e0a 2020 2020  belongs to..    
-00007320: 2020 2020 2222 220a 0a20 2020 2020 2020      """..       
-00007330: 2065 6e64 706f 696e 745f 7061 7468 203d   endpoint_path =
-00007340: 2066 2270 726f 6a65 6374 732f 7b70 726f   f"projects/{pro
-00007350: 6a65 6374 7d2f 6172 7469 6661 6374 732f  ject}/artifacts/
-00007360: 7b75 6964 7d2f 7b6b 6579 7d22 0a20 2020  {uid}/{key}".   
-00007370: 2020 2020 2070 6172 616d 7320 3d20 7b0a       params = {.
-00007380: 2020 2020 2020 2020 2020 2020 2274 6167              "tag
-00007390: 223a 2074 6167 2c0a 2020 2020 2020 2020  ": tag,.        
-000073a0: 7d0a 2020 2020 2020 2020 6966 2069 7465  }.        if ite
-000073b0: 723a 0a20 2020 2020 2020 2020 2020 2070  r:.            p
-000073c0: 6172 616d 735b 2269 7465 7222 5d20 3d20  arams["iter"] = 
-000073d0: 7374 7228 6974 6572 290a 0a20 2020 2020  str(iter)..     
-000073e0: 2020 2065 7272 6f72 203d 2066 2273 746f     error = f"sto
-000073f0: 7265 2061 7274 6966 6163 7420 7b70 726f  re artifact {pro
-00007400: 6a65 6374 7d2f 7b75 6964 7d2f 7b6b 6579  ject}/{uid}/{key
-00007410: 7d22 0a0a 2020 2020 2020 2020 626f 6479  }"..        body
-00007420: 203d 205f 6173 5f6a 736f 6e28 6172 7469   = _as_json(arti
-00007430: 6661 6374 290a 2020 2020 2020 2020 7365  fact).        se
-00007440: 6c66 2e61 7069 5f63 616c 6c28 2250 4f53  lf.api_call("POS
-00007450: 5422 2c20 656e 6470 6f69 6e74 5f70 6174  T", endpoint_pat
-00007460: 682c 2065 7272 6f72 2c20 7061 7261 6d73  h, error, params
-00007470: 3d70 6172 616d 732c 2062 6f64 793d 626f  =params, body=bo
-00007480: 6479 290a 0a20 2020 2064 6566 2072 6561  dy)..    def rea
-00007490: 645f 6172 7469 6661 6374 2873 656c 662c  d_artifact(self,
-000074a0: 206b 6579 2c20 7461 673d 4e6f 6e65 2c20   key, tag=None, 
-000074b0: 6974 6572 3d4e 6f6e 652c 2070 726f 6a65  iter=None, proje
-000074c0: 6374 3d22 2229 3a0a 2020 2020 2020 2020  ct=""):.        
-000074d0: 2222 2252 6561 6420 616e 2061 7274 6966  """Read an artif
-000074e0: 6163 742c 2069 6465 6e74 6966 6965 6420  act, identified 
-000074f0: 6279 2069 7473 206b 6579 2c20 7461 6720  by its key, tag 
-00007500: 616e 6420 6974 6572 6174 696f 6e2e 2222  and iteration.""
-00007510: 220a 0a20 2020 2020 2020 2070 726f 6a65  "..        proje
-00007520: 6374 203d 2070 726f 6a65 6374 206f 7220  ct = project or 
-00007530: 636f 6e66 6967 2e64 6566 6175 6c74 5f70  config.default_p
-00007540: 726f 6a65 6374 0a20 2020 2020 2020 2074  roject.        t
-00007550: 6167 203d 2074 6167 206f 7220 226c 6174  ag = tag or "lat
-00007560: 6573 7422 0a20 2020 2020 2020 2065 6e64  est".        end
-00007570: 706f 696e 745f 7061 7468 203d 2066 2270  point_path = f"p
-00007580: 726f 6a65 6374 732f 7b70 726f 6a65 6374  rojects/{project
-00007590: 7d2f 6172 7469 6661 6374 732f 7b6b 6579  }/artifacts/{key
-000075a0: 7d3f 7461 673d 7b74 6167 7d22 0a20 2020  }?tag={tag}".   
-000075b0: 2020 2020 2065 7272 6f72 203d 2066 2272       error = f"r
-000075c0: 6561 6420 6172 7469 6661 6374 207b 7072  ead artifact {pr
-000075d0: 6f6a 6563 747d 2f7b 6b65 797d 220a 2020  oject}/{key}".  
-000075e0: 2020 2020 2020 2320 6578 706c 6963 6974        # explicit
-000075f0: 6c79 2073 6574 2061 7274 6966 6163 7473  ly set artifacts
-00007600: 2066 6f72 6d61 7420 746f 2027 6675 6c6c   format to 'full
-00007610: 2720 7369 6e63 6520 6f6c 6420 7365 7276  ' since old serv
-00007620: 6572 7320 6d61 7920 6465 6661 756c 7420  ers may default 
-00007630: 746f 2027 6c65 6761 6379 270a 2020 2020  to 'legacy'.    
-00007640: 2020 2020 7061 7261 6d73 203d 207b 2266      params = {"f
-00007650: 6f72 6d61 7422 3a20 7363 6865 6d61 732e  ormat": schemas.
-00007660: 4172 7469 6661 6374 7346 6f72 6d61 742e  ArtifactsFormat.
-00007670: 6675 6c6c 2e76 616c 7565 7d0a 2020 2020  full.value}.    
-00007680: 2020 2020 6966 2069 7465 723a 0a20 2020      if iter:.   
-00007690: 2020 2020 2020 2020 2070 6172 616d 735b           params[
-000076a0: 2269 7465 7222 5d20 3d20 7374 7228 6974  "iter"] = str(it
-000076b0: 6572 290a 2020 2020 2020 2020 7265 7370  er).        resp
-000076c0: 203d 2073 656c 662e 6170 695f 6361 6c6c   = self.api_call
-000076d0: 2822 4745 5422 2c20 656e 6470 6f69 6e74  ("GET", endpoint
-000076e0: 5f70 6174 682c 2065 7272 6f72 2c20 7061  _path, error, pa
-000076f0: 7261 6d73 3d70 6172 616d 7329 0a20 2020  rams=params).   
-00007700: 2020 2020 2072 6574 7572 6e20 7265 7370       return resp
-00007710: 2e6a 736f 6e28 295b 2264 6174 6122 5d0a  .json()["data"].
-00007720: 0a20 2020 2064 6566 2064 656c 5f61 7274  .    def del_art
-00007730: 6966 6163 7428 7365 6c66 2c20 6b65 792c  ifact(self, key,
-00007740: 2074 6167 3d4e 6f6e 652c 2070 726f 6a65   tag=None, proje
-00007750: 6374 3d22 2229 3a0a 2020 2020 2020 2020  ct=""):.        
-00007760: 2222 2244 656c 6574 6520 616e 2061 7274  """Delete an art
-00007770: 6966 6163 742e 2222 220a 0a20 2020 2020  ifact."""..     
-00007780: 2020 2065 6e64 706f 696e 745f 7061 7468     endpoint_path
-00007790: 203d 2066 2270 726f 6a65 6374 732f 7b70   = f"projects/{p
-000077a0: 726f 6a65 6374 7d2f 6172 7469 6661 6374  roject}/artifact
-000077b0: 732f 7b6b 6579 7d22 0a20 2020 2020 2020  s/{key}".       
-000077c0: 2070 6172 616d 7320 3d20 7b0a 2020 2020   params = {.    
-000077d0: 2020 2020 2020 2020 226b 6579 223a 206b          "key": k
-000077e0: 6579 2c0a 2020 2020 2020 2020 2020 2020  ey,.            
-000077f0: 2274 6167 223a 2074 6167 2c0a 2020 2020  "tag": tag,.    
-00007800: 2020 2020 7d0a 2020 2020 2020 2020 6572      }.        er
-00007810: 726f 7220 3d20 6622 6465 6c20 6172 7469  ror = f"del arti
-00007820: 6661 6374 207b 7072 6f6a 6563 747d 2f7b  fact {project}/{
-00007830: 6b65 797d 220a 2020 2020 2020 2020 7365  key}".        se
-00007840: 6c66 2e61 7069 5f63 616c 6c28 2244 454c  lf.api_call("DEL
-00007850: 4554 4522 2c20 656e 6470 6f69 6e74 5f70  ETE", endpoint_p
-00007860: 6174 682c 2065 7272 6f72 2c20 7061 7261  ath, error, para
-00007870: 6d73 3d70 6172 616d 7329 0a0a 2020 2020  ms=params)..    
-00007880: 6465 6620 6c69 7374 5f61 7274 6966 6163  def list_artifac
-00007890: 7473 280a 2020 2020 2020 2020 7365 6c66  ts(.        self
-000078a0: 2c0a 2020 2020 2020 2020 6e61 6d65 3d4e  ,.        name=N
-000078b0: 6f6e 652c 0a20 2020 2020 2020 2070 726f  one,.        pro
-000078c0: 6a65 6374 3d4e 6f6e 652c 0a20 2020 2020  ject=None,.     
-000078d0: 2020 2074 6167 3d4e 6f6e 652c 0a20 2020     tag=None,.   
-000078e0: 2020 2020 206c 6162 656c 733a 204f 7074       labels: Opt
-000078f0: 696f 6e61 6c5b 556e 696f 6e5b 4469 6374  ional[Union[Dict
-00007900: 5b73 7472 2c20 7374 725d 2c20 4c69 7374  [str, str], List
-00007910: 5b73 7472 5d5d 5d20 3d20 4e6f 6e65 2c0a  [str]]] = None,.
-00007920: 2020 2020 2020 2020 7369 6e63 653d 4e6f          since=No
-00007930: 6e65 2c0a 2020 2020 2020 2020 756e 7469  ne,.        unti
-00007940: 6c3d 4e6f 6e65 2c0a 2020 2020 2020 2020  l=None,.        
-00007950: 6974 6572 3a20 696e 7420 3d20 4e6f 6e65  iter: int = None
-00007960: 2c0a 2020 2020 2020 2020 6265 7374 5f69  ,.        best_i
-00007970: 7465 7261 7469 6f6e 3a20 626f 6f6c 203d  teration: bool =
-00007980: 2046 616c 7365 2c0a 2020 2020 2020 2020   False,.        
-00007990: 6b69 6e64 3a20 7374 7220 3d20 4e6f 6e65  kind: str = None
-000079a0: 2c0a 2020 2020 2020 2020 6361 7465 676f  ,.        catego
-000079b0: 7279 3a20 556e 696f 6e5b 7374 722c 2073  ry: Union[str, s
-000079c0: 6368 656d 6173 2e41 7274 6966 6163 7443  chemas.ArtifactC
-000079d0: 6174 6567 6f72 6965 735d 203d 204e 6f6e  ategories] = Non
-000079e0: 652c 0a20 2020 2029 202d 3e20 4172 7469  e,.    ) -> Arti
-000079f0: 6661 6374 4c69 7374 3a0a 2020 2020 2020  factList:.      
-00007a00: 2020 2222 224c 6973 7420 6172 7469 6661    """List artifa
-00007a10: 6374 7320 6669 6c74 6572 6564 2062 7920  cts filtered by 
-00007a20: 7661 7269 6f75 7320 7061 7261 6d65 7465  various paramete
-00007a30: 7273 2e0a 0a20 2020 2020 2020 2045 7861  rs...        Exa
-00007a40: 6d70 6c65 733a 3a0a 0a20 2020 2020 2020  mples::..       
-00007a50: 2020 2020 2023 2053 686f 7720 6c61 7465       # Show late
-00007a60: 7374 2076 6572 7369 6f6e 206f 6620 616c  st version of al
-00007a70: 6c20 6172 7469 6661 6374 7320 696e 2070  l artifacts in p
-00007a80: 726f 6a65 6374 0a20 2020 2020 2020 2020  roject.         
-00007a90: 2020 206c 6174 6573 745f 6172 7469 6661     latest_artifa
-00007aa0: 6374 7320 3d20 6462 2e6c 6973 745f 6172  cts = db.list_ar
-00007ab0: 7469 6661 6374 7328 2727 2c20 7461 673d  tifacts('', tag=
-00007ac0: 276c 6174 6573 7427 2c20 7072 6f6a 6563  'latest', projec
-00007ad0: 743d 2769 7269 7327 290a 2020 2020 2020  t='iris').      
-00007ae0: 2020 2020 2020 2320 6368 6563 6b20 6469        # check di
-00007af0: 6666 6572 656e 7420 6172 7469 6661 6374  fferent artifact
-00007b00: 2076 6572 7369 6f6e 7320 666f 7220 6120   versions for a 
-00007b10: 7370 6563 6966 6963 2061 7274 6966 6163  specific artifac
-00007b20: 740a 2020 2020 2020 2020 2020 2020 7265  t.            re
-00007b30: 7375 6c74 5f76 6572 7369 6f6e 7320 3d20  sult_versions = 
-00007b40: 6462 2e6c 6973 745f 6172 7469 6661 6374  db.list_artifact
-00007b50: 7328 2772 6573 756c 7473 272c 2074 6167  s('results', tag
-00007b60: 3d27 2a27 2c20 7072 6f6a 6563 743d 2769  ='*', project='i
-00007b70: 7269 7327 290a 2020 2020 2020 2020 2020  ris').          
-00007b80: 2020 2320 5368 6f77 2061 7274 6966 6163    # Show artifac
-00007b90: 7473 2077 6974 6820 6c61 6265 6c20 6669  ts with label fi
-00007ba0: 6c74 6572 7320 2d20 626f 7468 2075 706c  lters - both upl
-00007bb0: 6f61 6465 6420 616e 6420 6f66 2062 696e  oaded and of bin
-00007bc0: 6172 7920 7479 7065 0a20 2020 2020 2020  ary type.       
-00007bd0: 2020 2020 2072 6573 756c 745f 6c61 6265       result_labe
-00007be0: 6c73 203d 2064 622e 6c69 7374 5f61 7274  ls = db.list_art
-00007bf0: 6966 6163 7473 2827 7265 7375 6c74 7327  ifacts('results'
-00007c00: 2c20 7461 673d 272a 272c 2070 726f 6a65  , tag='*', proje
-00007c10: 6374 3d27 6972 6973 272c 206c 6162 656c  ct='iris', label
-00007c20: 733d 5b27 7570 6c6f 6164 6564 272c 2027  s=['uploaded', '
-00007c30: 7479 7065 3d62 696e 6172 7927 5d29 0a0a  type=binary'])..
-00007c40: 2020 2020 2020 2020 3a70 6172 616d 206e          :param n
-00007c50: 616d 653a 204e 616d 6520 6f66 2061 7274  ame: Name of art
-00007c60: 6966 6163 7473 2074 6f20 7265 7472 6965  ifacts to retrie
-00007c70: 7665 2e20 4e61 6d65 2069 7320 7573 6564  ve. Name is used
-00007c80: 2061 7320 6120 6c69 6b65 2071 7565 7279   as a like query
-00007c90: 2c20 616e 6420 6973 206e 6f74 2063 6173  , and is not cas
-00007ca0: 652d 7365 6e73 6974 6976 652e 2054 6869  e-sensitive. Thi
-00007cb0: 7320 6d65 616e 730a 2020 2020 2020 2020  s means.        
-00007cc0: 2020 2020 7468 6174 2071 7565 7279 696e      that queryin
-00007cd0: 6720 666f 7220 6060 6e61 6d65 6060 206d  g for ``name`` m
-00007ce0: 6179 2072 6574 7572 6e20 6172 7469 6661  ay return artifa
-00007cf0: 6374 7320 6e61 6d65 6420 6060 6d79 5f4e  cts named ``my_N
-00007d00: 616d 655f 3160 6020 6f72 2060 6073 7572  ame_1`` or ``sur
-00007d10: 6e61 6d65 6060 2e0a 2020 2020 2020 2020  name``..        
-00007d20: 3a70 6172 616d 2070 726f 6a65 6374 3a20  :param project: 
-00007d30: 5072 6f6a 6563 7420 6e61 6d65 2e0a 2020  Project name..  
-00007d40: 2020 2020 2020 3a70 6172 616d 2074 6167        :param tag
-00007d50: 3a20 5265 7475 726e 2061 7274 6966 6163  : Return artifac
-00007d60: 7473 2061 7373 6967 6e65 6420 7468 6973  ts assigned this
-00007d70: 2074 6167 2e0a 2020 2020 2020 2020 3a70   tag..        :p
-00007d80: 6172 616d 206c 6162 656c 733a 2052 6574  aram labels: Ret
-00007d90: 7572 6e20 6172 7469 6661 6374 7320 7468  urn artifacts th
-00007da0: 6174 2068 6176 6520 7468 6573 6520 6c61  at have these la
-00007db0: 6265 6c73 2e20 4c61 6265 6c73 2063 616e  bels. Labels can
-00007dc0: 2065 6974 6865 7220 6265 2061 2064 6963   either be a dic
-00007dd0: 7469 6f6e 6172 7920 7b22 6c61 6265 6c22  tionary {"label"
-00007de0: 3a20 2276 616c 7565 227d 206f 720a 2020  : "value"} or.  
-00007df0: 2020 2020 2020 2020 2020 6120 6c69 7374            a list
-00007e00: 206f 6620 226c 6162 656c 3d76 616c 7565   of "label=value
-00007e10: 2220 286d 6174 6368 206c 6162 656c 206b  " (match label k
-00007e20: 6579 2061 6e64 2076 616c 7565 2920 6f72  ey and value) or
-00007e30: 2022 6c61 6265 6c22 2028 6d61 7463 6820   "label" (match 
-00007e40: 6a75 7374 206c 6162 656c 206b 6579 2920  just label key) 
-00007e50: 7374 7269 6e67 732e 0a20 2020 2020 2020  strings..       
-00007e60: 203a 7061 7261 6d20 7369 6e63 653a 204e   :param since: N
-00007e70: 6f74 2069 6e20 7573 6520 696e 203a 7079  ot in use in :py
-00007e80: 3a63 6c61 7373 3a60 4854 5450 5275 6e44  :class:`HTTPRunD
-00007e90: 4260 2e0a 2020 2020 2020 2020 3a70 6172  B`..        :par
-00007ea0: 616d 2075 6e74 696c 3a20 4e6f 7420 696e  am until: Not in
-00007eb0: 2075 7365 2069 6e20 3a70 793a 636c 6173   use in :py:clas
-00007ec0: 733a 6048 5454 5052 756e 4442 602e 0a20  s:`HTTPRunDB`.. 
-00007ed0: 2020 2020 2020 203a 7061 7261 6d20 6974         :param it
-00007ee0: 6572 3a20 5265 7475 726e 2061 7274 6966  er: Return artif
-00007ef0: 6163 7473 2066 726f 6d20 6120 7370 6563  acts from a spec
-00007f00: 6966 6963 2069 7465 7261 7469 6f6e 2028  ific iteration (
-00007f10: 7768 6572 6520 6060 6974 6572 3d30 6060  where ``iter=0``
-00007f20: 206d 6561 6e73 2074 6865 2072 6f6f 7420   means the root 
-00007f30: 6974 6572 6174 696f 6e29 2e20 4966 0a20  iteration). If. 
-00007f40: 2020 2020 2020 2020 2020 2060 604e 6f6e             ``Non
-00007f50: 6560 6020 2864 6566 6175 6c74 2920 7265  e`` (default) re
-00007f60: 7475 726e 2061 7274 6966 6163 7473 2066  turn artifacts f
-00007f70: 726f 6d20 616c 6c20 6974 6572 6174 696f  rom all iteratio
-00007f80: 6e73 2e0a 2020 2020 2020 2020 3a70 6172  ns..        :par
-00007f90: 616d 2062 6573 745f 6974 6572 6174 696f  am best_iteratio
-00007fa0: 6e3a 2052 6574 7572 6e73 2074 6865 2061  n: Returns the a
-00007fb0: 7274 6966 6163 7420 7768 6963 6820 6265  rtifact which be
-00007fc0: 6c6f 6e67 7320 746f 2074 6865 2062 6573  longs to the bes
-00007fd0: 7420 6974 6572 6174 696f 6e20 6f66 2061  t iteration of a
-00007fe0: 2067 6976 656e 2072 756e 2c20 696e 2074   given run, in t
-00007ff0: 6865 2063 6173 6520 6f66 0a20 2020 2020  he case of.     
-00008000: 2020 2020 2020 2061 7274 6966 6163 7473         artifacts
-00008010: 2067 656e 6572 6174 6564 2066 726f 6d20   generated from 
-00008020: 6120 6879 7065 722d 7061 7261 6d20 7275  a hyper-param ru
-00008030: 6e2e 2049 6620 6f6e 6c79 2061 2073 696e  n. If only a sin
-00008040: 676c 6520 6974 6572 6174 696f 6e20 6578  gle iteration ex
-00008050: 6973 7473 2c20 7769 6c6c 2072 6574 7572  ists, will retur
-00008060: 6e20 7468 6520 6172 7469 6661 6374 0a20  n the artifact. 
-00008070: 2020 2020 2020 2020 2020 2066 726f 6d20             from 
-00008080: 7468 6174 2069 7465 7261 7469 6f6e 2e20  that iteration. 
-00008090: 4966 2075 7369 6e67 2060 6062 6573 745f  If using ``best_
-000080a0: 6974 6572 6060 2c20 7468 6520 6060 6974  iter``, the ``it
-000080b0: 6572 6060 2070 6172 616d 6574 6572 206d  er`` parameter m
-000080c0: 7573 7420 6e6f 7420 6265 2075 7365 642e  ust not be used.
-000080d0: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
-000080e0: 6b69 6e64 3a20 5265 7475 726e 2061 7274  kind: Return art
-000080f0: 6966 6163 7473 206f 6620 7468 6520 7265  ifacts of the re
-00008100: 7175 6573 7465 6420 6b69 6e64 2e0a 2020  quested kind..  
-00008110: 2020 2020 2020 3a70 6172 616d 2063 6174        :param cat
-00008120: 6567 6f72 793a 2052 6574 7572 6e20 6172  egory: Return ar
-00008130: 7469 6661 6374 7320 6f66 2074 6865 2072  tifacts of the r
-00008140: 6571 7565 7374 6564 2063 6174 6567 6f72  equested categor
-00008150: 792e 0a20 2020 2020 2020 2022 2222 0a0a  y..        """..
-00008160: 2020 2020 2020 2020 7072 6f6a 6563 7420          project 
-00008170: 3d20 7072 6f6a 6563 7420 6f72 2063 6f6e  = project or con
-00008180: 6669 672e 6465 6661 756c 745f 7072 6f6a  fig.default_proj
-00008190: 6563 740a 0a20 2020 2020 2020 206c 6162  ect..        lab
-000081a0: 656c 7320 3d20 6c61 6265 6c73 206f 7220  els = labels or 
-000081b0: 5b5d 0a20 2020 2020 2020 2069 6620 6973  [].        if is
-000081c0: 696e 7374 616e 6365 286c 6162 656c 732c  instance(labels,
-000081d0: 2064 6963 7429 3a0a 2020 2020 2020 2020   dict):.        
-000081e0: 2020 2020 6c61 6265 6c73 203d 205b 6622      labels = [f"
-000081f0: 7b6b 6579 7d3d 7b76 616c 7565 7d22 2066  {key}={value}" f
-00008200: 6f72 206b 6579 2c20 7661 6c75 6520 696e  or key, value in
-00008210: 206c 6162 656c 732e 6974 656d 7328 295d   labels.items()]
-00008220: 0a0a 2020 2020 2020 2020 7061 7261 6d73  ..        params
-00008230: 203d 207b 0a20 2020 2020 2020 2020 2020   = {.           
-00008240: 2022 6e61 6d65 223a 206e 616d 652c 0a20   "name": name,. 
-00008250: 2020 2020 2020 2020 2020 2022 7461 6722             "tag"
-00008260: 3a20 7461 672c 0a20 2020 2020 2020 2020  : tag,.         
-00008270: 2020 2022 6c61 6265 6c22 3a20 6c61 6265     "label": labe
-00008280: 6c73 2c0a 2020 2020 2020 2020 2020 2020  ls,.            
-00008290: 2269 7465 7222 3a20 6974 6572 2c0a 2020  "iter": iter,.  
-000082a0: 2020 2020 2020 2020 2020 2262 6573 742d            "best-
-000082b0: 6974 6572 6174 696f 6e22 3a20 6265 7374  iteration": best
-000082c0: 5f69 7465 7261 7469 6f6e 2c0a 2020 2020  _iteration,.    
-000082d0: 2020 2020 2020 2020 226b 696e 6422 3a20          "kind": 
-000082e0: 6b69 6e64 2c0a 2020 2020 2020 2020 2020  kind,.          
-000082f0: 2020 2263 6174 6567 6f72 7922 3a20 6361    "category": ca
-00008300: 7465 676f 7279 2c0a 2020 2020 2020 2020  tegory,.        
-00008310: 2020 2020 2266 6f72 6d61 7422 3a20 7363      "format": sc
-00008320: 6865 6d61 732e 4172 7469 6661 6374 7346  hemas.ArtifactsF
-00008330: 6f72 6d61 742e 6675 6c6c 2e76 616c 7565  ormat.full.value
-00008340: 2c0a 2020 2020 2020 2020 7d0a 2020 2020  ,.        }.    
-00008350: 2020 2020 6572 726f 7220 3d20 226c 6973      error = "lis
-00008360: 7420 6172 7469 6661 6374 7322 0a20 2020  t artifacts".   
-00008370: 2020 2020 2065 6e64 706f 696e 745f 7061       endpoint_pa
-00008380: 7468 203d 2066 2270 726f 6a65 6374 732f  th = f"projects/
-00008390: 7b70 726f 6a65 6374 7d2f 6172 7469 6661  {project}/artifa
-000083a0: 6374 7322 0a20 2020 2020 2020 2072 6573  cts".        res
-000083b0: 7020 3d20 7365 6c66 2e61 7069 5f63 616c  p = self.api_cal
-000083c0: 6c28 2247 4554 222c 2065 6e64 706f 696e  l("GET", endpoin
-000083d0: 745f 7061 7468 2c20 6572 726f 722c 2070  t_path, error, p
-000083e0: 6172 616d 733d 7061 7261 6d73 290a 2020  arams=params).  
-000083f0: 2020 2020 2020 7661 6c75 6573 203d 2041        values = A
-00008400: 7274 6966 6163 744c 6973 7428 7265 7370  rtifactList(resp
-00008410: 2e6a 736f 6e28 295b 2261 7274 6966 6163  .json()["artifac
-00008420: 7473 225d 290a 2020 2020 2020 2020 7661  ts"]).        va
-00008430: 6c75 6573 2e74 6167 203d 2074 6167 0a20  lues.tag = tag. 
-00008440: 2020 2020 2020 2072 6574 7572 6e20 7661         return va
-00008450: 6c75 6573 0a0a 2020 2020 6465 6620 6465  lues..    def de
-00008460: 6c5f 6172 7469 6661 6374 7328 7365 6c66  l_artifacts(self
-00008470: 2c20 6e61 6d65 3d4e 6f6e 652c 2070 726f  , name=None, pro
-00008480: 6a65 6374 3d4e 6f6e 652c 2074 6167 3d4e  ject=None, tag=N
-00008490: 6f6e 652c 206c 6162 656c 733d 4e6f 6e65  one, labels=None
-000084a0: 2c20 6461 7973 5f61 676f 3d30 293a 0a20  , days_ago=0):. 
-000084b0: 2020 2020 2020 2022 2222 4465 6c65 7465         """Delete
-000084c0: 2061 7274 6966 6163 7473 2072 6566 6572   artifacts refer
-000084d0: 656e 6365 6420 6279 2074 6865 2070 6172  enced by the par
-000084e0: 616d 6574 6572 732e 0a0a 2020 2020 2020  ameters...      
-000084f0: 2020 3a70 6172 616d 206e 616d 653a 204e    :param name: N
-00008500: 616d 6520 6f66 2061 7274 6966 6163 7473  ame of artifacts
-00008510: 2074 6f20 6465 6c65 7465 2e20 4e6f 7465   to delete. Note
-00008520: 2074 6861 7420 7468 6973 2069 7320 6120   that this is a 
-00008530: 6c69 6b65 2071 7565 7279 2c20 616e 6420  like query, and 
-00008540: 6973 2063 6173 652d 696e 7365 6e73 6974  is case-insensit
-00008550: 6976 652e 2053 6565 0a20 2020 2020 2020  ive. See.       
-00008560: 2020 2020 203a 7079 3a66 756e 633a 607e       :py:func:`~
-00008570: 6c69 7374 5f61 7274 6966 6163 7473 6020  list_artifacts` 
-00008580: 666f 7220 6d6f 7265 2064 6574 6169 6c73  for more details
-00008590: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
-000085a0: 2070 726f 6a65 6374 3a20 5072 6f6a 6563   project: Projec
-000085b0: 7420 7468 6174 2061 7274 6966 6163 7473  t that artifacts
-000085c0: 2062 656c 6f6e 6720 746f 2e0a 2020 2020   belong to..    
-000085d0: 2020 2020 3a70 6172 616d 2074 6167 3a20      :param tag: 
-000085e0: 4368 6f6f 7365 2061 7274 6966 6163 7473  Choose artifacts
-000085f0: 2077 686f 2061 7265 2061 7373 6967 6e65   who are assigne
-00008600: 6420 7468 6973 2074 6167 2e0a 2020 2020  d this tag..    
-00008610: 2020 2020 3a70 6172 616d 206c 6162 656c      :param label
-00008620: 733a 2043 686f 6f73 6520 6172 7469 6661  s: Choose artifa
-00008630: 6374 7320 7768 6963 6820 6172 6520 6c61  cts which are la
-00008640: 6265 6c65 642e 0a20 2020 2020 2020 203a  beled..        :
-00008650: 7061 7261 6d20 6461 7973 5f61 676f 3a20  param days_ago: 
-00008660: 5468 6973 2070 6172 616d 6574 6572 2069  This parameter i
-00008670: 7320 6465 7072 6563 6174 6564 2061 6e64  s deprecated and
-00008680: 206e 6f74 2075 7365 642e 0a20 2020 2020   not used..     
-00008690: 2020 2022 2222 0a20 2020 2020 2020 2070     """.        p
-000086a0: 726f 6a65 6374 203d 2070 726f 6a65 6374  roject = project
-000086b0: 206f 7220 636f 6e66 6967 2e64 6566 6175   or config.defau
-000086c0: 6c74 5f70 726f 6a65 6374 0a20 2020 2020  lt_project.     
-000086d0: 2020 2070 6172 616d 7320 3d20 7b0a 2020     params = {.  
-000086e0: 2020 2020 2020 2020 2020 226e 616d 6522            "name"
-000086f0: 3a20 6e61 6d65 2c0a 2020 2020 2020 2020  : name,.        
-00008700: 2020 2020 2274 6167 223a 2074 6167 2c0a      "tag": tag,.
-00008710: 2020 2020 2020 2020 2020 2020 226c 6162              "lab
-00008720: 656c 223a 206c 6162 656c 7320 6f72 205b  el": labels or [
-00008730: 5d2c 0a20 2020 2020 2020 2020 2020 2022  ],.            "
-00008740: 6461 7973 5f61 676f 223a 2073 7472 2864  days_ago": str(d
-00008750: 6179 735f 6167 6f29 2c0a 2020 2020 2020  ays_ago),.      
-00008760: 2020 7d0a 2020 2020 2020 2020 6572 726f    }.        erro
-00008770: 7220 3d20 2264 656c 2061 7274 6966 6163  r = "del artifac
-00008780: 7473 220a 2020 2020 2020 2020 656e 6470  ts".        endp
-00008790: 6f69 6e74 5f70 6174 6820 3d20 6622 7072  oint_path = f"pr
-000087a0: 6f6a 6563 7473 2f7b 7072 6f6a 6563 747d  ojects/{project}
-000087b0: 2f61 7274 6966 6163 7473 220a 2020 2020  /artifacts".    
-000087c0: 2020 2020 7365 6c66 2e61 7069 5f63 616c      self.api_cal
-000087d0: 6c28 2244 454c 4554 4522 2c20 656e 6470  l("DELETE", endp
-000087e0: 6f69 6e74 5f70 6174 682c 2065 7272 6f72  oint_path, error
-000087f0: 2c20 7061 7261 6d73 3d70 6172 616d 7329  , params=params)
-00008800: 0a0a 2020 2020 6465 6620 6c69 7374 5f61  ..    def list_a
-00008810: 7274 6966 6163 745f 7461 6773 280a 2020  rtifact_tags(.  
-00008820: 2020 2020 2020 7365 6c66 2c0a 2020 2020        self,.    
-00008830: 2020 2020 7072 6f6a 6563 743d 4e6f 6e65      project=None
-00008840: 2c0a 2020 2020 2020 2020 6361 7465 676f  ,.        catego
-00008850: 7279 3a20 556e 696f 6e5b 7374 722c 2073  ry: Union[str, s
-00008860: 6368 656d 6173 2e41 7274 6966 6163 7443  chemas.ArtifactC
-00008870: 6174 6567 6f72 6965 735d 203d 204e 6f6e  ategories] = Non
-00008880: 652c 0a20 2020 2029 202d 3e20 4c69 7374  e,.    ) -> List
-00008890: 5b73 7472 5d3a 0a20 2020 2020 2020 2022  [str]:.        "
-000088a0: 2222 5265 7475 726e 2061 206c 6973 7420  ""Return a list 
-000088b0: 6f66 2061 6c6c 2074 6865 2074 6167 7320  of all the tags 
-000088c0: 6173 7369 676e 6564 2074 6f20 6172 7469  assigned to arti
-000088d0: 6661 6374 7320 696e 2074 6865 2073 636f  facts in the sco
-000088e0: 7065 206f 6620 7468 6520 6769 7665 6e20  pe of the given 
-000088f0: 7072 6f6a 6563 742e 2222 220a 0a20 2020  project."""..   
-00008900: 2020 2020 2070 726f 6a65 6374 203d 2070       project = p
-00008910: 726f 6a65 6374 206f 7220 636f 6e66 6967  roject or config
-00008920: 2e64 6566 6175 6c74 5f70 726f 6a65 6374  .default_project
-00008930: 0a20 2020 2020 2020 2065 7272 6f72 5f6d  .        error_m
-00008940: 6573 7361 6765 203d 2066 2246 6169 6c65  essage = f"Faile
-00008950: 6420 6c69 7374 696e 6720 6172 7469 6661  d listing artifa
-00008960: 6374 2074 6167 732e 2070 726f 6a65 6374  ct tags. project
-00008970: 3d7b 7072 6f6a 6563 747d 220a 2020 2020  ={project}".    
-00008980: 2020 2020 7061 7261 6d73 203d 207b 2263      params = {"c
-00008990: 6174 6567 6f72 7922 3a20 6361 7465 676f  ategory": catego
-000089a0: 7279 7d20 6966 2063 6174 6567 6f72 7920  ry} if category 
-000089b0: 656c 7365 207b 7d0a 0a20 2020 2020 2020  else {}..       
-000089c0: 2072 6573 706f 6e73 6520 3d20 7365 6c66   response = self
-000089d0: 2e61 7069 5f63 616c 6c28 0a20 2020 2020  .api_call(.     
-000089e0: 2020 2020 2020 2022 4745 5422 2c20 6622         "GET", f"
-000089f0: 7072 6f6a 6563 7473 2f7b 7072 6f6a 6563  projects/{projec
-00008a00: 747d 2f61 7274 6966 6163 742d 7461 6773  t}/artifact-tags
-00008a10: 222c 2065 7272 6f72 5f6d 6573 7361 6765  ", error_message
-00008a20: 2c20 7061 7261 6d73 3d70 6172 616d 730a  , params=params.
-00008a30: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-00008a40: 2020 7265 7475 726e 2072 6573 706f 6e73    return respons
-00008a50: 652e 6a73 6f6e 2829 5b22 7461 6773 225d  e.json()["tags"]
-00008a60: 0a0a 2020 2020 6465 6620 7374 6f72 655f  ..    def store_
-00008a70: 6675 6e63 7469 6f6e 280a 2020 2020 2020  function(.      
-00008a80: 2020 7365 6c66 2c0a 2020 2020 2020 2020    self,.        
-00008a90: 6675 6e63 7469 6f6e 3a20 7479 7069 6e67  function: typing
-00008aa0: 2e55 6e69 6f6e 5b6d 6c72 756e 2e72 756e  .Union[mlrun.run
-00008ab0: 7469 6d65 732e 4261 7365 5275 6e74 696d  times.BaseRuntim
-00008ac0: 652c 2064 6963 745d 2c0a 2020 2020 2020  e, dict],.      
-00008ad0: 2020 6e61 6d65 2c0a 2020 2020 2020 2020    name,.        
-00008ae0: 7072 6f6a 6563 743d 2222 2c0a 2020 2020  project="",.    
-00008af0: 2020 2020 7461 673d 4e6f 6e65 2c0a 2020      tag=None,.  
-00008b00: 2020 2020 2020 7665 7273 696f 6e65 643d        versioned=
-00008b10: 4661 6c73 652c 0a20 2020 2029 3a0a 2020  False,.    ):.  
-00008b20: 2020 2020 2020 2222 2253 746f 7265 2061        """Store a
-00008b30: 2066 756e 6374 696f 6e20 6f62 6a65 6374   function object
-00008b40: 2e20 4675 6e63 7469 6f6e 2069 7320 6964  . Function is id
-00008b50: 656e 7469 6669 6564 2062 7920 6974 7320  entified by its 
-00008b60: 6e61 6d65 2061 6e64 2074 6167 2c20 616e  name and tag, an
-00008b70: 6420 6361 6e20 6265 2076 6572 7369 6f6e  d can be version
-00008b80: 6564 2e22 2222 0a20 2020 2020 2020 206e  ed.""".        n
-00008b90: 616d 6520 3d20 6d6c 7275 6e2e 7574 696c  ame = mlrun.util
-00008ba0: 732e 6e6f 726d 616c 697a 655f 6e61 6d65  s.normalize_name
-00008bb0: 286e 616d 6529 0a20 2020 2020 2020 2069  (name).        i
-00008bc0: 6620 6861 7361 7474 7228 6675 6e63 7469  f hasattr(functi
-00008bd0: 6f6e 2c20 2274 6f5f 6469 6374 2229 3a0a  on, "to_dict"):.
-00008be0: 2020 2020 2020 2020 2020 2020 6675 6e63              func
-00008bf0: 7469 6f6e 203d 2066 756e 6374 696f 6e2e  tion = function.
-00008c00: 746f 5f64 6963 7428 290a 0a20 2020 2020  to_dict()..     
-00008c10: 2020 2070 6172 616d 7320 3d20 7b22 7461     params = {"ta
-00008c20: 6722 3a20 7461 672c 2022 7665 7273 696f  g": tag, "versio
-00008c30: 6e65 6422 3a20 7665 7273 696f 6e65 647d  ned": versioned}
-00008c40: 0a20 2020 2020 2020 2070 726f 6a65 6374  .        project
-00008c50: 203d 2070 726f 6a65 6374 206f 7220 636f   = project or co
-00008c60: 6e66 6967 2e64 6566 6175 6c74 5f70 726f  nfig.default_pro
-00008c70: 6a65 6374 0a20 2020 2020 2020 2070 6174  ject.        pat
-00008c80: 6820 3d20 7365 6c66 2e5f 7061 7468 5f6f  h = self._path_o
-00008c90: 6628 2266 756e 6322 2c20 7072 6f6a 6563  f("func", projec
-00008ca0: 742c 206e 616d 6529 0a0a 2020 2020 2020  t, name)..      
-00008cb0: 2020 6572 726f 7220 3d20 6622 7374 6f72    error = f"stor
-00008cc0: 6520 6675 6e63 7469 6f6e 207b 7072 6f6a  e function {proj
-00008cd0: 6563 747d 2f7b 6e61 6d65 7d22 0a20 2020  ect}/{name}".   
-00008ce0: 2020 2020 2072 6573 7020 3d20 7365 6c66       resp = self
-00008cf0: 2e61 7069 5f63 616c 6c28 0a20 2020 2020  .api_call(.     
-00008d00: 2020 2020 2020 2022 504f 5354 222c 2070         "POST", p
-00008d10: 6174 682c 2065 7272 6f72 2c20 7061 7261  ath, error, para
-00008d20: 6d73 3d70 6172 616d 732c 2062 6f64 793d  ms=params, body=
-00008d30: 6469 6374 5f74 6f5f 6a73 6f6e 2866 756e  dict_to_json(fun
-00008d40: 6374 696f 6e29 0a20 2020 2020 2020 2029  ction).        )
-00008d50: 0a0a 2020 2020 2020 2020 2320 6861 7368  ..        # hash
-00008d60: 206b 6579 206f 7074 696f 6e61 6c20 746f   key optional to
-00008d70: 2062 6520 6261 636b 7761 7264 7320 636f   be backwards co
-00008d80: 6d70 6174 6962 6c65 2074 6f20 4150 4920  mpatible to API 
-00008d90: 763c 302e 342e 3130 2069 6e20 7768 6963  v<0.4.10 in whic
-00008da0: 6820 6974 2077 6173 6e27 7420 696e 2074  h it wasn't in t
-00008db0: 6865 2072 6573 706f 6e73 650a 2020 2020  he response.    
-00008dc0: 2020 2020 7265 7475 726e 2072 6573 702e      return resp.
-00008dd0: 6a73 6f6e 2829 2e67 6574 2822 6861 7368  json().get("hash
-00008de0: 5f6b 6579 2229 0a0a 2020 2020 6465 6620  _key")..    def 
-00008df0: 6765 745f 6675 6e63 7469 6f6e 2873 656c  get_function(sel
-00008e00: 662c 206e 616d 652c 2070 726f 6a65 6374  f, name, project
-00008e10: 3d22 222c 2074 6167 3d4e 6f6e 652c 2068  ="", tag=None, h
-00008e20: 6173 685f 6b65 793d 2222 293a 0a20 2020  ash_key=""):.   
-00008e30: 2020 2020 2022 2222 5265 7472 6965 7665       """Retrieve
-00008e40: 2064 6574 6169 6c73 206f 6620 6120 7370   details of a sp
-00008e50: 6563 6966 6963 2066 756e 6374 696f 6e2c  ecific function,
-00008e60: 2069 6465 6e74 6966 6965 6420 6279 2069   identified by i
-00008e70: 7473 206e 616d 6520 616e 6420 706f 7465  ts name and pote
-00008e80: 6e74 6961 6c6c 7920 6120 7461 6720 6f72  ntially a tag or
-00008e90: 2066 756e 6374 696f 6e20 6861 7368 2e22   function hash."
-00008ea0: 2222 0a0a 2020 2020 2020 2020 7061 7261  ""..        para
-00008eb0: 6d73 203d 207b 2274 6167 223a 2074 6167  ms = {"tag": tag
-00008ec0: 2c20 2268 6173 685f 6b65 7922 3a20 6861  , "hash_key": ha
-00008ed0: 7368 5f6b 6579 7d0a 2020 2020 2020 2020  sh_key}.        
-00008ee0: 7072 6f6a 6563 7420 3d20 7072 6f6a 6563  project = projec
-00008ef0: 7420 6f72 2063 6f6e 6669 672e 6465 6661  t or config.defa
-00008f00: 756c 745f 7072 6f6a 6563 740a 2020 2020  ult_project.    
-00008f10: 2020 2020 7061 7468 203d 2073 656c 662e      path = self.
-00008f20: 5f70 6174 685f 6f66 2822 6675 6e63 222c  _path_of("func",
-00008f30: 2070 726f 6a65 6374 2c20 6e61 6d65 290a   project, name).
-00008f40: 2020 2020 2020 2020 6572 726f 7220 3d20          error = 
-00008f50: 6622 6765 7420 6675 6e63 7469 6f6e 207b  f"get function {
-00008f60: 7072 6f6a 6563 747d 2f7b 6e61 6d65 7d22  project}/{name}"
-00008f70: 0a20 2020 2020 2020 2072 6573 7020 3d20  .        resp = 
-00008f80: 7365 6c66 2e61 7069 5f63 616c 6c28 2247  self.api_call("G
-00008f90: 4554 222c 2070 6174 682c 2065 7272 6f72  ET", path, error
-00008fa0: 2c20 7061 7261 6d73 3d70 6172 616d 7329  , params=params)
-00008fb0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00008fc0: 7265 7370 2e6a 736f 6e28 295b 2266 756e  resp.json()["fun
-00008fd0: 6322 5d0a 0a20 2020 2064 6566 2064 656c  c"]..    def del
-00008fe0: 6574 655f 6675 6e63 7469 6f6e 2873 656c  ete_function(sel
-00008ff0: 662c 206e 616d 653a 2073 7472 2c20 7072  f, name: str, pr
-00009000: 6f6a 6563 743a 2073 7472 203d 2022 2229  oject: str = "")
-00009010: 3a0a 2020 2020 2020 2020 2222 2244 656c  :.        """Del
-00009020: 6574 6520 6120 6675 6e63 7469 6f6e 2062  ete a function b
-00009030: 656c 6f6e 6769 6e67 2074 6f20 6120 7370  elonging to a sp
-00009040: 6563 6966 6963 2070 726f 6a65 6374 2e22  ecific project."
-00009050: 2222 0a0a 2020 2020 2020 2020 7072 6f6a  ""..        proj
-00009060: 6563 7420 3d20 7072 6f6a 6563 7420 6f72  ect = project or
-00009070: 2063 6f6e 6669 672e 6465 6661 756c 745f   config.default_
-00009080: 7072 6f6a 6563 740a 2020 2020 2020 2020  project.        
-00009090: 7061 7468 203d 2066 2270 726f 6a65 6374  path = f"project
-000090a0: 732f 7b70 726f 6a65 6374 7d2f 6675 6e63  s/{project}/func
-000090b0: 7469 6f6e 732f 7b6e 616d 657d 220a 2020  tions/{name}".  
-000090c0: 2020 2020 2020 6572 726f 725f 6d65 7373        error_mess
-000090d0: 6167 6520 3d20 6622 4661 696c 6564 2064  age = f"Failed d
-000090e0: 656c 6574 696e 6720 6675 6e63 7469 6f6e  eleting function
-000090f0: 207b 7072 6f6a 6563 747d 2f7b 6e61 6d65   {project}/{name
-00009100: 7d22 0a20 2020 2020 2020 2073 656c 662e  }".        self.
-00009110: 6170 695f 6361 6c6c 2822 4445 4c45 5445  api_call("DELETE
-00009120: 222c 2070 6174 682c 2065 7272 6f72 5f6d  ", path, error_m
-00009130: 6573 7361 6765 290a 0a20 2020 2064 6566  essage)..    def
-00009140: 206c 6973 745f 6675 6e63 7469 6f6e 7328   list_functions(
-00009150: 7365 6c66 2c20 6e61 6d65 3d4e 6f6e 652c  self, name=None,
-00009160: 2070 726f 6a65 6374 3d4e 6f6e 652c 2074   project=None, t
-00009170: 6167 3d4e 6f6e 652c 206c 6162 656c 733d  ag=None, labels=
-00009180: 4e6f 6e65 293a 0a20 2020 2020 2020 2022  None):.        "
-00009190: 2222 5265 7472 6965 7665 2061 206c 6973  ""Retrieve a lis
-000091a0: 7420 6f66 2066 756e 6374 696f 6e73 2c20  t of functions, 
-000091b0: 6669 6c74 6572 6564 2062 7920 7370 6563  filtered by spec
-000091c0: 6966 6963 2063 7269 7465 7269 612e 0a0a  ific criteria...
-000091d0: 2020 2020 2020 2020 3a70 6172 616d 206e          :param n
-000091e0: 616d 653a 2052 6574 7572 6e20 6f6e 6c79  ame: Return only
-000091f0: 2066 756e 6374 696f 6e73 2077 6974 6820   functions with 
-00009200: 6120 7370 6563 6966 6963 206e 616d 652e  a specific name.
-00009210: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
-00009220: 7072 6f6a 6563 743a 2052 6574 7572 6e20  project: Return 
-00009230: 6675 6e63 7469 6f6e 7320 6265 6c6f 6e67  functions belong
-00009240: 696e 6720 746f 2074 6869 7320 7072 6f6a  ing to this proj
-00009250: 6563 742e 2049 6620 6e6f 7420 7370 6563  ect. If not spec
-00009260: 6966 6965 642c 2074 6865 2064 6566 6175  ified, the defau
-00009270: 6c74 2070 726f 6a65 6374 2069 7320 7573  lt project is us
-00009280: 6564 2e0a 2020 2020 2020 2020 3a70 6172  ed..        :par
-00009290: 616d 2074 6167 3a20 5265 7475 726e 2066  am tag: Return f
-000092a0: 756e 6374 696f 6e20 7665 7273 696f 6e73  unction versions
-000092b0: 2077 6974 6820 7370 6563 6966 6963 2074   with specific t
-000092c0: 6167 732e 0a20 2020 2020 2020 203a 7061  ags..        :pa
-000092d0: 7261 6d20 6c61 6265 6c73 3a20 5265 7475  ram labels: Retu
-000092e0: 726e 2066 756e 6374 696f 6e73 2074 6861  rn functions tha
-000092f0: 7420 6861 7665 2073 7065 6369 6669 6320  t have specific 
-00009300: 6c61 6265 6c73 2061 7373 6967 6e65 6420  labels assigned 
-00009310: 746f 2074 6865 6d2e 0a20 2020 2020 2020  to them..       
-00009320: 203a 7265 7475 726e 733a 204c 6973 7420   :returns: List 
-00009330: 6f66 2066 756e 6374 696f 6e20 6f62 6a65  of function obje
-00009340: 6374 7320 2861 7320 6469 6374 696f 6e61  cts (as dictiona
-00009350: 7279 292e 0a20 2020 2020 2020 2022 2222  ry)..        """
-00009360: 0a0a 2020 2020 2020 2020 7061 7261 6d73  ..        params
-00009370: 203d 207b 0a20 2020 2020 2020 2020 2020   = {.           
-00009380: 2022 7072 6f6a 6563 7422 3a20 7072 6f6a   "project": proj
-00009390: 6563 7420 6f72 2063 6f6e 6669 672e 6465  ect or config.de
-000093a0: 6661 756c 745f 7072 6f6a 6563 742c 0a20  fault_project,. 
-000093b0: 2020 2020 2020 2020 2020 2022 6e61 6d65             "name
-000093c0: 223a 206e 616d 652c 0a20 2020 2020 2020  ": name,.       
-000093d0: 2020 2020 2022 7461 6722 3a20 7461 672c       "tag": tag,
-000093e0: 0a20 2020 2020 2020 2020 2020 2022 6c61  .            "la
-000093f0: 6265 6c22 3a20 6c61 6265 6c73 206f 7220  bel": labels or 
-00009400: 5b5d 2c0a 2020 2020 2020 2020 7d0a 2020  [],.        }.  
-00009410: 2020 2020 2020 6572 726f 7220 3d20 226c        error = "l
-00009420: 6973 7420 6675 6e63 7469 6f6e 7322 0a20  ist functions". 
-00009430: 2020 2020 2020 2072 6573 7020 3d20 7365         resp = se
-00009440: 6c66 2e61 7069 5f63 616c 6c28 2247 4554  lf.api_call("GET
-00009450: 222c 2022 6675 6e63 7322 2c20 6572 726f  ", "funcs", erro
-00009460: 722c 2070 6172 616d 733d 7061 7261 6d73  r, params=params
-00009470: 290a 2020 2020 2020 2020 7265 7475 726e  ).        return
-00009480: 2072 6573 702e 6a73 6f6e 2829 5b22 6675   resp.json()["fu
-00009490: 6e63 7322 5d0a 0a20 2020 2064 6566 206c  ncs"]..    def l
-000094a0: 6973 745f 7275 6e74 696d 655f 7265 736f  ist_runtime_reso
-000094b0: 7572 6365 7328 0a20 2020 2020 2020 2073  urces(.        s
-000094c0: 656c 662c 0a20 2020 2020 2020 2070 726f  elf,.        pro
-000094d0: 6a65 6374 3a20 4f70 7469 6f6e 616c 5b73  ject: Optional[s
-000094e0: 7472 5d20 3d20 4e6f 6e65 2c0a 2020 2020  tr] = None,.    
-000094f0: 2020 2020 6c61 6265 6c5f 7365 6c65 6374      label_select
-00009500: 6f72 3a20 4f70 7469 6f6e 616c 5b73 7472  or: Optional[str
-00009510: 5d20 3d20 4e6f 6e65 2c0a 2020 2020 2020  ] = None,.      
-00009520: 2020 6b69 6e64 3a20 4f70 7469 6f6e 616c    kind: Optional
-00009530: 5b73 7472 5d20 3d20 4e6f 6e65 2c0a 2020  [str] = None,.  
-00009540: 2020 2020 2020 6f62 6a65 6374 5f69 643a        object_id:
-00009550: 204f 7074 696f 6e61 6c5b 7374 725d 203d   Optional[str] =
-00009560: 204e 6f6e 652c 0a20 2020 2020 2020 2067   None,.        g
-00009570: 726f 7570 5f62 793a 204f 7074 696f 6e61  roup_by: Optiona
-00009580: 6c5b 6d6c 7275 6e2e 6170 692e 7363 6865  l[mlrun.api.sche
-00009590: 6d61 732e 4c69 7374 5275 6e74 696d 6552  mas.ListRuntimeR
-000095a0: 6573 6f75 7263 6573 4772 6f75 7042 7946  esourcesGroupByF
-000095b0: 6965 6c64 5d20 3d20 4e6f 6e65 2c0a 2020  ield] = None,.  
-000095c0: 2020 2920 2d3e 2055 6e69 6f6e 5b0a 2020    ) -> Union[.  
-000095d0: 2020 2020 2020 6d6c 7275 6e2e 6170 692e        mlrun.api.
-000095e0: 7363 6865 6d61 732e 5275 6e74 696d 6552  schemas.RuntimeR
-000095f0: 6573 6f75 7263 6573 4f75 7470 7574 2c0a  esourcesOutput,.
-00009600: 2020 2020 2020 2020 6d6c 7275 6e2e 6170          mlrun.ap
-00009610: 692e 7363 6865 6d61 732e 4772 6f75 7065  i.schemas.Groupe
-00009620: 6442 794a 6f62 5275 6e74 696d 6552 6573  dByJobRuntimeRes
-00009630: 6f75 7263 6573 4f75 7470 7574 2c0a 2020  ourcesOutput,.  
-00009640: 2020 2020 2020 6d6c 7275 6e2e 6170 692e        mlrun.api.
-00009650: 7363 6865 6d61 732e 4772 6f75 7065 6442  schemas.GroupedB
-00009660: 7950 726f 6a65 6374 5275 6e74 696d 6552  yProjectRuntimeR
-00009670: 6573 6f75 7263 6573 4f75 7470 7574 2c0a  esourcesOutput,.
-00009680: 2020 2020 5d3a 0a20 2020 2020 2020 2022      ]:.        "
-00009690: 2222 4c69 7374 2063 7572 7265 6e74 2072  ""List current r
-000096a0: 756e 7469 6d65 2072 6573 6f75 7263 6573  untime resources
-000096b0: 2c20 7768 6963 6820 6172 6520 7573 7561  , which are usua
-000096c0: 6c6c 7920 2862 7574 206e 6f74 206c 696d  lly (but not lim
-000096d0: 6974 6564 2074 6f29 204b 7562 6572 6e65  ited to) Kuberne
-000096e0: 7465 7320 706f 6473 206f 7220 4352 4473  tes pods or CRDs
-000096f0: 2e0a 2020 2020 2020 2020 4675 6e63 7469  ..        Functi
-00009700: 6f6e 2061 7070 6c69 6573 2066 6f72 2072  on applies for r
-00009710: 756e 7320 6f66 2074 7970 6520 605b 2764  uns of type `['d
-00009720: 6173 6b27 2c20 276a 6f62 272c 2027 7370  ask', 'job', 'sp
-00009730: 6172 6b27 2c20 2772 656d 6f74 652d 7370  ark', 'remote-sp
-00009740: 6172 6b27 2c20 276d 7069 6a6f 6227 5d60  ark', 'mpijob']`
-00009750: 2c20 616e 6420 7769 6c6c 2072 6574 7572  , and will retur
-00009760: 6e20 7065 720a 2020 2020 2020 2020 7275  n per.        ru
-00009770: 6e74 696d 6520 6b69 6e64 2061 206c 6973  ntime kind a lis
-00009780: 7420 6f66 2074 6865 2072 756e 7469 6d65  t of the runtime
-00009790: 2072 6573 6f75 7263 6573 2028 7768 6963   resources (whic
-000097a0: 6820 6d61 7920 6861 7665 2061 6c72 6561  h may have alrea
-000097b0: 6479 2063 6f6d 706c 6574 6564 2074 6865  dy completed the
-000097c0: 6972 2065 7865 6375 7469 6f6e 292e 0a0a  ir execution)...
-000097d0: 2020 2020 2020 2020 3a70 6172 616d 2070          :param p
-000097e0: 726f 6a65 6374 3a20 4765 7420 6f6e 6c79  roject: Get only
-000097f0: 2072 756e 7469 6d65 2072 6573 6f75 7263   runtime resourc
-00009800: 6573 206f 6620 6120 7370 6563 6966 6963  es of a specific
-00009810: 2070 726f 6a65 6374 2c20 6279 2064 6566   project, by def
-00009820: 6175 6c74 204e 6f6e 652c 2077 6869 6368  ault None, which
-00009830: 2077 696c 6c20 7265 7475 726e 206f 6e6c   will return onl
-00009840: 7920 7468 650a 2020 2020 2020 2020 2020  y the.          
-00009850: 2020 7072 6f6a 6563 7473 2079 6f75 2772    projects you'r
-00009860: 6520 6175 7468 6f72 697a 6564 2074 6f20  e authorized to 
-00009870: 7365 652e 0a20 2020 2020 2020 203a 7061  see..        :pa
-00009880: 7261 6d20 6c61 6265 6c5f 7365 6c65 6374  ram label_select
-00009890: 6f72 3a20 4120 6c61 6265 6c20 6669 6c74  or: A label filt
-000098a0: 6572 2074 6861 7420 7769 6c6c 2062 6520  er that will be 
-000098b0: 7061 7373 6564 2074 6f20 4b75 6265 726e  passed to Kubern
-000098c0: 6574 6573 2066 6f72 2066 696c 7465 7269  etes for filteri
-000098d0: 6e67 2074 6865 2072 6573 756c 7473 2061  ng the results a
-000098e0: 6363 6f72 6469 6e67 0a20 2020 2020 2020  ccording.       
-000098f0: 2020 2020 2074 6f20 7468 6569 7220 6c61       to their la
-00009900: 6265 6c73 2e0a 2020 2020 2020 2020 3a70  bels..        :p
-00009910: 6172 616d 206b 696e 643a 2054 6865 206b  aram kind: The k
-00009920: 696e 6420 6f66 2072 756e 7469 6d65 2074  ind of runtime t
-00009930: 6f20 7175 6572 792e 204d 6179 2062 6520  o query. May be 
-00009940: 6f6e 6520 6f66 2060 5b27 6461 736b 272c  one of `['dask',
-00009950: 2027 6a6f 6227 2c20 2773 7061 726b 272c   'job', 'spark',
-00009960: 2027 7265 6d6f 7465 2d73 7061 726b 272c   'remote-spark',
-00009970: 2027 6d70 696a 6f62 275d 600a 2020 2020   'mpijob']`.    
-00009980: 2020 2020 3a70 6172 616d 206f 626a 6563      :param objec
-00009990: 745f 6964 3a20 5468 6520 6964 656e 7469  t_id: The identi
-000099a0: 6669 6572 206f 6620 7468 6520 6d6c 7275  fier of the mlru
-000099b0: 6e20 6f62 6a65 6374 2074 6f20 7175 6572  n object to quer
-000099c0: 7920 6974 7320 7275 6e74 696d 6520 7265  y its runtime re
-000099d0: 736f 7572 6365 732e 2066 6f72 206d 6f73  sources. for mos
-000099e0: 7420 6675 6e63 7469 6f6e 2072 756e 7469  t function runti
-000099f0: 6d65 732c 0a20 2020 2020 2020 2020 2020  mes,.           
-00009a00: 2072 756e 7469 6d65 2072 6573 6f75 7263   runtime resourc
-00009a10: 6573 2061 7265 2070 6572 2052 756e 2c20  es are per Run, 
-00009a20: 666f 7220 7768 6963 6820 7468 6520 6964  for which the id
-00009a30: 656e 7469 6669 6572 2069 7320 7468 6520  entifier is the 
-00009a40: 5275 6e27 7320 5549 442e 2046 6f72 2064  Run's UID. For d
-00009a50: 6173 6b20 7275 6e74 696d 652c 2074 6865  ask runtime, the
-00009a60: 2072 756e 7469 6d65 0a20 2020 2020 2020   runtime.       
-00009a70: 2020 2020 2072 6573 6f75 7263 6573 2061       resources a
-00009a80: 7265 2070 6572 2046 756e 6374 696f 6e2c  re per Function,
-00009a90: 2066 6f72 2077 6869 6368 2074 6865 2069   for which the i
-00009aa0: 6465 6e74 6966 6965 7220 6973 2074 6865  dentifier is the
-00009ab0: 2046 756e 6374 696f 6e27 7320 6e61 6d65   Function's name
-00009ac0: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
-00009ad0: 2067 726f 7570 5f62 793a 204f 626a 6563   group_by: Objec
-00009ae0: 7420 746f 2067 726f 7570 2072 6573 756c  t to group resul
-00009af0: 7473 2062 792e 2041 6c6c 6f77 6564 2076  ts by. Allowed v
-00009b00: 616c 7565 7320 6172 6520 606a 6f62 6020  alues are `job` 
-00009b10: 616e 6420 6070 726f 6a65 6374 602e 0a20  and `project`.. 
-00009b20: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-00009b30: 2020 2070 6172 616d 7320 3d20 7b0a 2020     params = {.  
-00009b40: 2020 2020 2020 2020 2020 226c 6162 656c            "label
-00009b50: 5f73 656c 6563 746f 7222 3a20 6c61 6265  _selector": labe
-00009b60: 6c5f 7365 6c65 6374 6f72 2c0a 2020 2020  l_selector,.    
-00009b70: 2020 2020 2020 2020 2267 726f 7570 2d62          "group-b
-00009b80: 7922 3a20 6772 6f75 705f 6279 2c0a 2020  y": group_by,.  
-00009b90: 2020 2020 2020 2020 2020 226b 696e 6422            "kind"
-00009ba0: 3a20 6b69 6e64 2c0a 2020 2020 2020 2020  : kind,.        
-00009bb0: 2020 2020 226f 626a 6563 742d 6964 223a      "object-id":
-00009bc0: 206f 626a 6563 745f 6964 2c0a 2020 2020   object_id,.    
-00009bd0: 2020 2020 7d0a 2020 2020 2020 2020 7072      }.        pr
-00009be0: 6f6a 6563 745f 7061 7468 203d 2070 726f  oject_path = pro
-00009bf0: 6a65 6374 2069 6620 7072 6f6a 6563 7420  ject if project 
-00009c00: 656c 7365 2022 2a22 0a20 2020 2020 2020  else "*".       
-00009c10: 2065 7272 6f72 203d 2022 4661 696c 6564   error = "Failed
-00009c20: 206c 6973 7469 6e67 2072 756e 7469 6d65   listing runtime
-00009c30: 2072 6573 6f75 7263 6573 220a 2020 2020   resources".    
-00009c40: 2020 2020 7265 7370 6f6e 7365 203d 2073      response = s
-00009c50: 656c 662e 6170 695f 6361 6c6c 280a 2020  elf.api_call(.  
-00009c60: 2020 2020 2020 2020 2020 2247 4554 222c            "GET",
-00009c70: 2066 2270 726f 6a65 6374 732f 7b70 726f   f"projects/{pro
-00009c80: 6a65 6374 5f70 6174 687d 2f72 756e 7469  ject_path}/runti
-00009c90: 6d65 2d72 6573 6f75 7263 6573 222c 2065  me-resources", e
-00009ca0: 7272 6f72 2c20 7061 7261 6d73 3d70 6172  rror, params=par
-00009cb0: 616d 730a 2020 2020 2020 2020 290a 2020  ams.        ).  
-00009cc0: 2020 2020 2020 6966 2067 726f 7570 5f62        if group_b
-00009cd0: 7920 6973 204e 6f6e 653a 0a20 2020 2020  y is None:.     
-00009ce0: 2020 2020 2020 2073 7472 7563 7475 7265         structure
-00009cf0: 645f 6c69 7374 203d 205b 0a20 2020 2020  d_list = [.     
-00009d00: 2020 2020 2020 2020 2020 206d 6c72 756e             mlrun
-00009d10: 2e61 7069 2e73 6368 656d 6173 2e4b 696e  .api.schemas.Kin
-00009d20: 6452 756e 7469 6d65 5265 736f 7572 6365  dRuntimeResource
-00009d30: 7328 2a2a 6b69 6e64 5f72 756e 7469 6d65  s(**kind_runtime
-00009d40: 5f72 6573 6f75 7263 6573 290a 2020 2020  _resources).    
-00009d50: 2020 2020 2020 2020 2020 2020 666f 7220              for 
-00009d60: 6b69 6e64 5f72 756e 7469 6d65 5f72 6573  kind_runtime_res
-00009d70: 6f75 7263 6573 2069 6e20 7265 7370 6f6e  ources in respon
-00009d80: 7365 2e6a 736f 6e28 290a 2020 2020 2020  se.json().      
-00009d90: 2020 2020 2020 5d0a 2020 2020 2020 2020        ].        
-00009da0: 2020 2020 7265 7475 726e 2073 7472 7563      return struc
-00009db0: 7475 7265 645f 6c69 7374 0a20 2020 2020  tured_list.     
-00009dc0: 2020 2065 6c69 6620 6772 6f75 705f 6279     elif group_by
-00009dd0: 203d 3d20 6d6c 7275 6e2e 6170 692e 7363   == mlrun.api.sc
-00009de0: 6865 6d61 732e 4c69 7374 5275 6e74 696d  hemas.ListRuntim
-00009df0: 6552 6573 6f75 7263 6573 4772 6f75 7042  eResourcesGroupB
-00009e00: 7946 6965 6c64 2e6a 6f62 3a0a 2020 2020  yField.job:.    
-00009e10: 2020 2020 2020 2020 7374 7275 6374 7572          structur
-00009e20: 6564 5f64 6963 7420 3d20 7b7d 0a20 2020  ed_dict = {}.   
-00009e30: 2020 2020 2020 2020 2066 6f72 2070 726f           for pro
-00009e40: 6a65 6374 2c20 6a6f 625f 7275 6e74 696d  ject, job_runtim
-00009e50: 655f 7265 736f 7572 6365 735f 6d61 7020  e_resources_map 
-00009e60: 696e 2072 6573 706f 6e73 652e 6a73 6f6e  in response.json
-00009e70: 2829 2e69 7465 6d73 2829 3a0a 2020 2020  ().items():.    
-00009e80: 2020 2020 2020 2020 2020 2020 666f 7220              for 
-00009e90: 6a6f 625f 6964 2c20 7275 6e74 696d 655f  job_id, runtime_
-00009ea0: 7265 736f 7572 6365 7320 696e 206a 6f62  resources in job
-00009eb0: 5f72 756e 7469 6d65 5f72 6573 6f75 7263  _runtime_resourc
-00009ec0: 6573 5f6d 6170 2e69 7465 6d73 2829 3a0a  es_map.items():.
-00009ed0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009ee0: 2020 2020 7374 7275 6374 7572 6564 5f64      structured_d
-00009ef0: 6963 742e 7365 7464 6566 6175 6c74 2870  ict.setdefault(p
-00009f00: 726f 6a65 6374 2c20 7b7d 295b 0a20 2020  roject, {})[.   
-00009f10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009f20: 2020 2020 206a 6f62 5f69 640a 2020 2020       job_id.    
-00009f30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009f40: 5d20 3d20 6d6c 7275 6e2e 6170 692e 7363  ] = mlrun.api.sc
-00009f50: 6865 6d61 732e 5275 6e74 696d 6552 6573  hemas.RuntimeRes
-00009f60: 6f75 7263 6573 282a 2a72 756e 7469 6d65  ources(**runtime
-00009f70: 5f72 6573 6f75 7263 6573 290a 2020 2020  _resources).    
-00009f80: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-00009f90: 7472 7563 7475 7265 645f 6469 6374 0a20  tructured_dict. 
-00009fa0: 2020 2020 2020 2065 6c69 6620 6772 6f75         elif grou
-00009fb0: 705f 6279 203d 3d20 6d6c 7275 6e2e 6170  p_by == mlrun.ap
-00009fc0: 692e 7363 6865 6d61 732e 4c69 7374 5275  i.schemas.ListRu
-00009fd0: 6e74 696d 6552 6573 6f75 7263 6573 4772  ntimeResourcesGr
-00009fe0: 6f75 7042 7946 6965 6c64 2e70 726f 6a65  oupByField.proje
-00009ff0: 6374 3a0a 2020 2020 2020 2020 2020 2020  ct:.            
-0000a000: 7374 7275 6374 7572 6564 5f64 6963 7420  structured_dict 
-0000a010: 3d20 7b7d 0a20 2020 2020 2020 2020 2020  = {}.           
-0000a020: 2066 6f72 2070 726f 6a65 6374 2c20 6b69   for project, ki
-0000a030: 6e64 5f72 756e 7469 6d65 5f72 6573 6f75  nd_runtime_resou
-0000a040: 7263 6573 5f6d 6170 2069 6e20 7265 7370  rces_map in resp
-0000a050: 6f6e 7365 2e6a 736f 6e28 292e 6974 656d  onse.json().item
-0000a060: 7328 293a 0a20 2020 2020 2020 2020 2020  s():.           
-0000a070: 2020 2020 2066 6f72 206b 696e 642c 2072       for kind, r
-0000a080: 756e 7469 6d65 5f72 6573 6f75 7263 6573  untime_resources
-0000a090: 2069 6e20 6b69 6e64 5f72 756e 7469 6d65   in kind_runtime
-0000a0a0: 5f72 6573 6f75 7263 6573 5f6d 6170 2e69  _resources_map.i
-0000a0b0: 7465 6d73 2829 3a0a 2020 2020 2020 2020  tems():.        
-0000a0c0: 2020 2020 2020 2020 2020 2020 7374 7275              stru
-0000a0d0: 6374 7572 6564 5f64 6963 742e 7365 7464  ctured_dict.setd
-0000a0e0: 6566 6175 6c74 2870 726f 6a65 6374 2c20  efault(project, 
-0000a0f0: 7b7d 295b 0a20 2020 2020 2020 2020 2020  {})[.           
-0000a100: 2020 2020 2020 2020 2020 2020 206b 696e               kin
-0000a110: 640a 2020 2020 2020 2020 2020 2020 2020  d.              
-0000a120: 2020 2020 2020 5d20 3d20 6d6c 7275 6e2e        ] = mlrun.
-0000a130: 6170 692e 7363 6865 6d61 732e 5275 6e74  api.schemas.Runt
-0000a140: 696d 6552 6573 6f75 7263 6573 282a 2a72  imeResources(**r
-0000a150: 756e 7469 6d65 5f72 6573 6f75 7263 6573  untime_resources
-0000a160: 290a 2020 2020 2020 2020 2020 2020 7265  ).            re
-0000a170: 7475 726e 2073 7472 7563 7475 7265 645f  turn structured_
-0000a180: 6469 6374 0a20 2020 2020 2020 2065 6c73  dict.        els
-0000a190: 653a 0a20 2020 2020 2020 2020 2020 2072  e:.            r
-0000a1a0: 6169 7365 204e 6f74 496d 706c 656d 656e  aise NotImplemen
-0000a1b0: 7465 6445 7272 6f72 280a 2020 2020 2020  tedError(.      
-0000a1c0: 2020 2020 2020 2020 2020 6622 5072 6f76            f"Prov
-0000a1d0: 6964 6564 2067 726f 7570 2062 7920 6669  ided group by fi
-0000a1e0: 656c 6420 6973 206e 6f74 2073 7570 706f  eld is not suppo
-0000a1f0: 7274 6564 2e20 6772 6f75 705f 6279 3d7b  rted. group_by={
-0000a200: 6772 6f75 705f 6279 7d22 0a20 2020 2020  group_by}".     
-0000a210: 2020 2020 2020 2029 0a0a 2020 2020 6465         )..    de
-0000a220: 6620 6465 6c65 7465 5f72 756e 7469 6d65  f delete_runtime
-0000a230: 5f72 6573 6f75 7263 6573 280a 2020 2020  _resources(.    
-0000a240: 2020 2020 7365 6c66 2c0a 2020 2020 2020      self,.      
-0000a250: 2020 7072 6f6a 6563 743a 204f 7074 696f    project: Optio
-0000a260: 6e61 6c5b 7374 725d 203d 204e 6f6e 652c  nal[str] = None,
-0000a270: 0a20 2020 2020 2020 206c 6162 656c 5f73  .        label_s
-0000a280: 656c 6563 746f 723a 204f 7074 696f 6e61  elector: Optiona
-0000a290: 6c5b 7374 725d 203d 204e 6f6e 652c 0a20  l[str] = None,. 
-0000a2a0: 2020 2020 2020 206b 696e 643a 204f 7074         kind: Opt
-0000a2b0: 696f 6e61 6c5b 7374 725d 203d 204e 6f6e  ional[str] = Non
-0000a2c0: 652c 0a20 2020 2020 2020 206f 626a 6563  e,.        objec
-0000a2d0: 745f 6964 3a20 4f70 7469 6f6e 616c 5b73  t_id: Optional[s
-0000a2e0: 7472 5d20 3d20 4e6f 6e65 2c0a 2020 2020  tr] = None,.    
-0000a2f0: 2020 2020 666f 7263 653a 2062 6f6f 6c20      force: bool 
-0000a300: 3d20 4661 6c73 652c 0a20 2020 2020 2020  = False,.       
-0000a310: 2067 7261 6365 5f70 6572 696f 643a 2069   grace_period: i
-0000a320: 6e74 203d 204e 6f6e 652c 0a20 2020 2029  nt = None,.    )
-0000a330: 202d 3e20 6d6c 7275 6e2e 6170 692e 7363   -> mlrun.api.sc
-0000a340: 6865 6d61 732e 4772 6f75 7065 6442 7950  hemas.GroupedByP
-0000a350: 726f 6a65 6374 5275 6e74 696d 6552 6573  rojectRuntimeRes
-0000a360: 6f75 7263 6573 4f75 7470 7574 3a0a 2020  ourcesOutput:.  
-0000a370: 2020 2020 2020 2222 2244 656c 6574 6520        """Delete 
-0000a380: 616c 6c20 7275 6e74 696d 6520 7265 736f  all runtime reso
-0000a390: 7572 6365 7320 7768 6963 6820 6172 6520  urces which are 
-0000a3a0: 696e 2074 6572 6d69 6e61 6c20 7374 6174  in terminal stat
-0000a3b0: 652e 0a0a 2020 2020 2020 2020 3a70 6172  e...        :par
-0000a3c0: 616d 2070 726f 6a65 6374 3a20 4465 6c65  am project: Dele
-0000a3d0: 7465 206f 6e6c 7920 7275 6e74 696d 6520  te only runtime 
-0000a3e0: 7265 736f 7572 6365 7320 6f66 2061 2073  resources of a s
-0000a3f0: 7065 6369 6669 6320 7072 6f6a 6563 742c  pecific project,
-0000a400: 2062 7920 6465 6661 756c 7420 4e6f 6e65   by default None
-0000a410: 2c20 7768 6963 6820 7769 6c6c 2064 656c  , which will del
-0000a420: 6574 6520 6f6e 6c79 0a20 2020 2020 2020  ete only.       
-0000a430: 2020 2020 2066 726f 6d20 7468 6520 7072       from the pr
-0000a440: 6f6a 6563 7473 2079 6f75 2772 6520 6175  ojects you're au
-0000a450: 7468 6f72 697a 6564 2074 6f20 6465 6c65  thorized to dele
-0000a460: 7465 2066 726f 6d2e 0a20 2020 2020 2020  te from..       
-0000a470: 203a 7061 7261 6d20 6c61 6265 6c5f 7365   :param label_se
-0000a480: 6c65 6374 6f72 3a20 4465 6c65 7465 206f  lector: Delete o
-0000a490: 6e6c 7920 7275 6e74 696d 6520 7265 736f  nly runtime reso
-0000a4a0: 7572 6365 7320 6d61 7463 6869 6e67 2074  urces matching t
-0000a4b0: 6865 206c 6162 656c 2073 656c 6563 746f  he label selecto
-0000a4c0: 722e 0a20 2020 2020 2020 203a 7061 7261  r..        :para
-0000a4d0: 6d20 6b69 6e64 3a20 5468 6520 6b69 6e64  m kind: The kind
-0000a4e0: 206f 6620 7275 6e74 696d 6520 746f 2064   of runtime to d
-0000a4f0: 656c 6574 652e 204d 6179 2062 6520 6f6e  elete. May be on
-0000a500: 6520 6f66 2060 5b27 6461 736b 272c 2027  e of `['dask', '
-0000a510: 6a6f 6227 2c20 2773 7061 726b 272c 2027  job', 'spark', '
-0000a520: 7265 6d6f 7465 2d73 7061 726b 272c 2027  remote-spark', '
-0000a530: 6d70 696a 6f62 275d 600a 2020 2020 2020  mpijob']`.      
-0000a540: 2020 3a70 6172 616d 206f 626a 6563 745f    :param object_
-0000a550: 6964 3a20 5468 6520 6964 656e 7469 6669  id: The identifi
-0000a560: 6572 206f 6620 7468 6520 6d6c 7275 6e20  er of the mlrun 
-0000a570: 6f62 6a65 6374 2074 6f20 6465 6c65 7465  object to delete
-0000a580: 2069 7473 2072 756e 7469 6d65 2072 6573   its runtime res
-0000a590: 6f75 7263 6573 2e20 666f 7220 6d6f 7374  ources. for most
-0000a5a0: 2066 756e 6374 696f 6e0a 2020 2020 2020   function.      
-0000a5b0: 2020 2020 2020 7275 6e74 696d 6573 2c20        runtimes, 
-0000a5c0: 7275 6e74 696d 6520 7265 736f 7572 6365  runtime resource
-0000a5d0: 7320 6172 6520 7065 7220 5275 6e2c 2066  s are per Run, f
-0000a5e0: 6f72 2077 6869 6368 2074 6865 2069 6465  or which the ide
-0000a5f0: 6e74 6966 6965 7220 6973 2074 6865 2052  ntifier is the R
-0000a600: 756e 2773 2055 4944 2e20 466f 7220 6461  un's UID. For da
-0000a610: 736b 2072 756e 7469 6d65 2c20 7468 650a  sk runtime, the.
-0000a620: 2020 2020 2020 2020 2020 2020 7275 6e74              runt
-0000a630: 696d 6520 7265 736f 7572 6365 7320 6172  ime resources ar
-0000a640: 6520 7065 7220 4675 6e63 7469 6f6e 2c20  e per Function, 
-0000a650: 666f 7220 7768 6963 6820 7468 6520 6964  for which the id
-0000a660: 656e 7469 6669 6572 2069 7320 7468 6520  entifier is the 
-0000a670: 4675 6e63 7469 6f6e 2773 206e 616d 652e  Function's name.
-0000a680: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
-0000a690: 666f 7263 653a 2046 6f72 6365 2064 656c  force: Force del
-0000a6a0: 6574 696f 6e20 2d20 6465 6c65 7465 2074  etion - delete t
-0000a6b0: 6865 2072 756e 7469 6d65 2072 6573 6f75  he runtime resou
-0000a6c0: 7263 6520 6576 656e 2069 6620 6974 2773  rce even if it's
-0000a6d0: 206e 6f74 2069 6e20 7465 726d 696e 616c   not in terminal
-0000a6e0: 2073 7461 7465 206f 7220 6966 2074 6865   state or if the
-0000a6f0: 2067 7261 6365 0a20 2020 2020 2020 2020   grace.         
-0000a700: 2020 2070 6572 696f 6420 6469 646e 2774     period didn't
-0000a710: 2070 6173 732e 0a20 2020 2020 2020 203a   pass..        :
-0000a720: 7061 7261 6d20 6772 6163 655f 7065 7269  param grace_peri
-0000a730: 6f64 3a20 4772 6163 6520 7065 7269 6f64  od: Grace period
-0000a740: 2067 6976 656e 2074 6f20 7468 6520 7275   given to the ru
-0000a750: 6e74 696d 6520 7265 736f 7572 6365 2062  ntime resource b
-0000a760: 6566 6f72 6520 7468 6579 2061 7265 2061  efore they are a
-0000a770: 6374 7561 6c6c 7920 7265 6d6f 7665 642c  ctually removed,
-0000a780: 2063 6f75 6e74 6564 2066 726f 6d0a 2020   counted from.  
-0000a790: 2020 2020 2020 2020 2020 7468 6520 6d6f            the mo
-0000a7a0: 6d65 6e74 2074 6865 7920 6d6f 7665 6420  ment they moved 
-0000a7b0: 746f 2074 6572 6d69 6e61 6c20 7374 6174  to terminal stat
-0000a7c0: 6520 2864 6566 6175 6c74 7320 746f 206d  e (defaults to m
-0000a7d0: 6c72 756e 2e6d 6c63 6f6e 662e 7275 6e74  lrun.mlconf.runt
-0000a7e0: 696d 655f 7265 736f 7572 6365 735f 6465  ime_resources_de
-0000a7f0: 6c65 7469 6f6e 5f67 7261 6365 5f70 6572  letion_grace_per
-0000a800: 696f 6429 2e0a 0a20 2020 2020 2020 203a  iod)...        :
-0000a810: 7265 7475 726e 733a 203a 7079 3a63 6c61  returns: :py:cla
-0000a820: 7373 3a60 7e6d 6c72 756e 2e61 7069 2e73  ss:`~mlrun.api.s
-0000a830: 6368 656d 6173 2e47 726f 7570 6564 4279  chemas.GroupedBy
-0000a840: 5072 6f6a 6563 7452 756e 7469 6d65 5265  ProjectRuntimeRe
-0000a850: 736f 7572 6365 734f 7574 7075 7460 206c  sourcesOutput` l
-0000a860: 6973 7469 6e67 2074 6865 2072 756e 7469  isting the runti
-0000a870: 6d65 2072 6573 6f75 7263 6573 0a20 2020  me resources.   
-0000a880: 2020 2020 2020 2020 2074 6861 7420 7765           that we
-0000a890: 7265 2072 656d 6f76 6564 2e0a 2020 2020  re removed..    
-0000a8a0: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-0000a8b0: 6966 2067 7261 6365 5f70 6572 696f 6420  if grace_period 
-0000a8c0: 6973 204e 6f6e 653a 0a20 2020 2020 2020  is None:.       
-0000a8d0: 2020 2020 2067 7261 6365 5f70 6572 696f       grace_perio
-0000a8e0: 6420 3d20 636f 6e66 6967 2e72 756e 7469  d = config.runti
-0000a8f0: 6d65 5f72 6573 6f75 7263 6573 5f64 656c  me_resources_del
-0000a900: 6574 696f 6e5f 6772 6163 655f 7065 7269  etion_grace_peri
-0000a910: 6f64 0a20 2020 2020 2020 2020 2020 206c  od.            l
-0000a920: 6f67 6765 722e 696e 666f 280a 2020 2020  ogger.info(.    
-0000a930: 2020 2020 2020 2020 2020 2020 2255 7369              "Usi
-0000a940: 6e67 2064 6566 6175 6c74 2067 7261 6365  ng default grace
-0000a950: 2070 6572 696f 6420 666f 7220 7275 6e74   period for runt
-0000a960: 696d 6520 7265 736f 7572 6365 7320 6465  ime resources de
-0000a970: 6c65 7469 6f6e 222c 0a20 2020 2020 2020  letion",.       
-0000a980: 2020 2020 2020 2020 2067 7261 6365 5f70           grace_p
-0000a990: 6572 696f 643d 6772 6163 655f 7065 7269  eriod=grace_peri
-0000a9a0: 6f64 2c0a 2020 2020 2020 2020 2020 2020  od,.            
-0000a9b0: 290a 0a20 2020 2020 2020 2070 6172 616d  )..        param
-0000a9c0: 7320 3d20 7b0a 2020 2020 2020 2020 2020  s = {.          
-0000a9d0: 2020 226c 6162 656c 2d73 656c 6563 746f    "label-selecto
-0000a9e0: 7222 3a20 6c61 6265 6c5f 7365 6c65 6374  r": label_select
-0000a9f0: 6f72 2c0a 2020 2020 2020 2020 2020 2020  or,.            
-0000aa00: 226b 696e 6422 3a20 6b69 6e64 2c0a 2020  "kind": kind,.  
-0000aa10: 2020 2020 2020 2020 2020 226f 626a 6563            "objec
-0000aa20: 742d 6964 223a 206f 626a 6563 745f 6964  t-id": object_id
-0000aa30: 2c0a 2020 2020 2020 2020 2020 2020 2266  ,.            "f
-0000aa40: 6f72 6365 223a 2066 6f72 6365 2c0a 2020  orce": force,.  
-0000aa50: 2020 2020 2020 2020 2020 2267 7261 6365            "grace
-0000aa60: 2d70 6572 696f 6422 3a20 6772 6163 655f  -period": grace_
-0000aa70: 7065 7269 6f64 2c0a 2020 2020 2020 2020  period,.        
-0000aa80: 7d0a 2020 2020 2020 2020 6572 726f 7220  }.        error 
-0000aa90: 3d20 2246 6169 6c65 6420 6465 6c65 7469  = "Failed deleti
-0000aaa0: 6e67 2072 756e 7469 6d65 2072 6573 6f75  ng runtime resou
-0000aab0: 7263 6573 220a 2020 2020 2020 2020 7072  rces".        pr
-0000aac0: 6f6a 6563 745f 7061 7468 203d 2070 726f  oject_path = pro
-0000aad0: 6a65 6374 2069 6620 7072 6f6a 6563 7420  ject if project 
-0000aae0: 656c 7365 2022 2a22 0a20 2020 2020 2020  else "*".       
-0000aaf0: 2072 6573 706f 6e73 6520 3d20 7365 6c66   response = self
-0000ab00: 2e61 7069 5f63 616c 6c28 0a20 2020 2020  .api_call(.     
-0000ab10: 2020 2020 2020 2022 4445 4c45 5445 222c         "DELETE",
-0000ab20: 0a20 2020 2020 2020 2020 2020 2066 2270  .            f"p
-0000ab30: 726f 6a65 6374 732f 7b70 726f 6a65 6374  rojects/{project
-0000ab40: 5f70 6174 687d 2f72 756e 7469 6d65 2d72  _path}/runtime-r
-0000ab50: 6573 6f75 7263 6573 222c 0a20 2020 2020  esources",.     
-0000ab60: 2020 2020 2020 2065 7272 6f72 2c0a 2020         error,.  
-0000ab70: 2020 2020 2020 2020 2020 7061 7261 6d73            params
-0000ab80: 3d70 6172 616d 732c 0a20 2020 2020 2020  =params,.       
-0000ab90: 2029 0a20 2020 2020 2020 2073 7472 7563   ).        struc
-0000aba0: 7475 7265 645f 6469 6374 203d 207b 7d0a  tured_dict = {}.
-0000abb0: 2020 2020 2020 2020 666f 7220 7072 6f6a          for proj
-0000abc0: 6563 742c 206b 696e 645f 7275 6e74 696d  ect, kind_runtim
-0000abd0: 655f 7265 736f 7572 6365 735f 6d61 7020  e_resources_map 
-0000abe0: 696e 2072 6573 706f 6e73 652e 6a73 6f6e  in response.json
-0000abf0: 2829 2e69 7465 6d73 2829 3a0a 2020 2020  ().items():.    
-0000ac00: 2020 2020 2020 2020 666f 7220 6b69 6e64          for kind
-0000ac10: 2c20 7275 6e74 696d 655f 7265 736f 7572  , runtime_resour
-0000ac20: 6365 7320 696e 206b 696e 645f 7275 6e74  ces in kind_runt
-0000ac30: 696d 655f 7265 736f 7572 6365 735f 6d61  ime_resources_ma
-0000ac40: 702e 6974 656d 7328 293a 0a20 2020 2020  p.items():.     
-0000ac50: 2020 2020 2020 2020 2020 2073 7472 7563             struc
-0000ac60: 7475 7265 645f 6469 6374 2e73 6574 6465  tured_dict.setde
-0000ac70: 6661 756c 7428 7072 6f6a 6563 742c 207b  fault(project, {
-0000ac80: 7d29 5b0a 2020 2020 2020 2020 2020 2020  })[.            
-0000ac90: 2020 2020 2020 2020 6b69 6e64 0a20 2020          kind.   
-0000aca0: 2020 2020 2020 2020 2020 2020 205d 203d               ] =
-0000acb0: 206d 6c72 756e 2e61 7069 2e73 6368 656d   mlrun.api.schem
-0000acc0: 6173 2e52 756e 7469 6d65 5265 736f 7572  as.RuntimeResour
-0000acd0: 6365 7328 2a2a 7275 6e74 696d 655f 7265  ces(**runtime_re
-0000ace0: 736f 7572 6365 7329 0a20 2020 2020 2020  sources).       
-0000acf0: 2072 6574 7572 6e20 7374 7275 6374 7572   return structur
-0000ad00: 6564 5f64 6963 740a 0a20 2020 2064 6566  ed_dict..    def
-0000ad10: 2063 7265 6174 655f 7363 6865 6475 6c65   create_schedule
-0000ad20: 2873 656c 662c 2070 726f 6a65 6374 3a20  (self, project: 
-0000ad30: 7374 722c 2073 6368 6564 756c 653a 2073  str, schedule: s
-0000ad40: 6368 656d 6173 2e53 6368 6564 756c 6549  chemas.ScheduleI
-0000ad50: 6e70 7574 293a 0a20 2020 2020 2020 2022  nput):.        "
-0000ad60: 2222 4372 6561 7465 2061 206e 6577 2073  ""Create a new s
-0000ad70: 6368 6564 756c 6520 6f6e 2074 6865 2067  chedule on the g
-0000ad80: 6976 656e 2070 726f 6a65 6374 2e20 5468  iven project. Th
-0000ad90: 6520 6465 7461 696c 7320 6f6e 2074 6865  e details on the
-0000ada0: 2061 6374 7561 6c20 6f62 6a65 6374 2074   actual object t
-0000adb0: 6f20 7363 6865 6475 6c65 2061 7320 7765  o schedule as we
-0000adc0: 6c6c 2061 7320 7468 650a 2020 2020 2020  ll as the.      
-0000add0: 2020 7363 6865 6475 6c65 2069 7473 656c    schedule itsel
-0000ade0: 6620 6172 6520 7769 7468 696e 2074 6865  f are within the
-0000adf0: 2073 6368 6564 756c 6520 6f62 6a65 6374   schedule object
-0000ae00: 2070 726f 7669 6465 642e 0a20 2020 2020   provided..     
-0000ae10: 2020 2054 6865 203a 7079 3a63 6c61 7373     The :py:class
-0000ae20: 3a60 7e53 6368 6564 756c 6543 726f 6e54  :`~ScheduleCronT
-0000ae30: 7269 6767 6572 6020 666f 6c6c 6f77 7320  rigger` follows 
-0000ae40: 7468 6520 6775 6964 656c 696e 6573 2069  the guidelines i
-0000ae50: 6e0a 2020 2020 2020 2020 6874 7470 733a  n.        https:
-0000ae60: 2f2f 6170 7363 6865 6475 6c65 722e 7265  //apscheduler.re
-0000ae70: 6164 7468 6564 6f63 732e 696f 2f65 6e2f  adthedocs.io/en/
-0000ae80: 332e 782f 6d6f 6475 6c65 732f 7472 6967  3.x/modules/trig
-0000ae90: 6765 7273 2f63 726f 6e2e 6874 6d6c 2e0a  gers/cron.html..
-0000aea0: 2020 2020 2020 2020 4974 2061 6c73 6f20          It also 
-0000aeb0: 7375 7070 6f72 7473 2061 203a 7079 3a66  supports a :py:f
-0000aec0: 756e 633a 607e 5363 6865 6475 6c65 4372  unc:`~ScheduleCr
-0000aed0: 6f6e 5472 6967 6765 722e 6672 6f6d 5f63  onTrigger.from_c
-0000aee0: 726f 6e74 6162 6020 6675 6e63 7469 6f6e  rontab` function
-0000aef0: 2074 6861 7420 6163 6365 7074 7320 610a   that accepts a.
-0000af00: 2020 2020 2020 2020 6372 6f6e 7461 622d          crontab-
-0000af10: 666f 726d 6174 7465 6420 7374 7269 6e67  formatted string
-0000af20: 2028 7365 6520 6874 7470 733a 2f2f 656e   (see https://en
-0000af30: 2e77 696b 6970 6564 6961 2e6f 7267 2f77  .wikipedia.org/w
-0000af40: 696b 692f 4372 6f6e 2066 6f72 206d 6f72  iki/Cron for mor
-0000af50: 6520 696e 666f 726d 6174 696f 6e20 6f6e  e information on
-0000af60: 2074 6865 2066 6f72 6d61 7420 616e 640a   the format and.
-0000af70: 2020 2020 2020 2020 6e6f 7465 2074 6861          note tha
-0000af80: 7420 7468 6520 3020 7765 656b 6461 7920  t the 0 weekday 
-0000af90: 6973 2061 6c77 6179 7320 6d6f 6e64 6179  is always monday
-0000afa0: 292e 0a0a 0a20 2020 2020 2020 2045 7861  )....        Exa
-0000afb0: 6d70 6c65 3a3a 0a0a 2020 2020 2020 2020  mple::..        
-0000afc0: 2020 2020 6672 6f6d 206d 6c72 756e 2e61      from mlrun.a
-0000afd0: 7069 2069 6d70 6f72 7420 7363 6865 6d61  pi import schema
-0000afe0: 730a 0a20 2020 2020 2020 2020 2020 2023  s..            #
-0000aff0: 2045 7865 6375 7465 2074 6865 2067 6574   Execute the get
-0000b000: 5f64 6174 615f 6675 6e63 2066 756e 6374  _data_func funct
-0000b010: 696f 6e20 6576 6572 7920 5475 6573 6461  ion every Tuesda
-0000b020: 7920 6174 2031 353a 3330 0a20 2020 2020  y at 15:30.     
-0000b030: 2020 2020 2020 2073 6368 6564 756c 6520         schedule 
-0000b040: 3d20 7363 6865 6d61 732e 5363 6865 6475  = schemas.Schedu
-0000b050: 6c65 496e 7075 7428 0a20 2020 2020 2020  leInput(.       
-0000b060: 2020 2020 2020 2020 206e 616d 653d 2272           name="r
-0000b070: 756e 5f66 756e 635f 6f6e 5f74 7565 7364  un_func_on_tuesd
-0000b080: 6179 7322 2c0a 2020 2020 2020 2020 2020  ays",.          
-0000b090: 2020 2020 2020 6b69 6e64 3d22 6a6f 6222        kind="job"
-0000b0a0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0000b0b0: 2020 7363 6865 6475 6c65 645f 6f62 6a65    scheduled_obje
-0000b0c0: 6374 3d67 6574 5f64 6174 615f 6675 6e63  ct=get_data_func
-0000b0d0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0000b0e0: 2020 6372 6f6e 5f74 7269 6767 6572 3d73    cron_trigger=s
-0000b0f0: 6368 656d 6173 2e53 6368 6564 756c 6543  chemas.ScheduleC
-0000b100: 726f 6e54 7269 6767 6572 2864 6179 5f6f  ronTrigger(day_o
-0000b110: 665f 7765 656b 3d27 7475 6527 2c20 686f  f_week='tue', ho
-0000b120: 7572 3d31 352c 206d 696e 7574 653d 3330  ur=15, minute=30
-0000b130: 292c 0a20 2020 2020 2020 2020 2020 2029  ),.            )
-0000b140: 0a20 2020 2020 2020 2020 2020 2064 622e  .            db.
-0000b150: 6372 6561 7465 5f73 6368 6564 756c 6528  create_schedule(
-0000b160: 7072 6f6a 6563 745f 6e61 6d65 2c20 7363  project_name, sc
-0000b170: 6865 6475 6c65 290a 2020 2020 2020 2020  hedule).        
-0000b180: 2222 220a 0a20 2020 2020 2020 2070 726f  """..        pro
-0000b190: 6a65 6374 203d 2070 726f 6a65 6374 206f  ject = project o
-0000b1a0: 7220 636f 6e66 6967 2e64 6566 6175 6c74  r config.default
-0000b1b0: 5f70 726f 6a65 6374 0a20 2020 2020 2020  _project.       
-0000b1c0: 2070 6174 6820 3d20 6622 7072 6f6a 6563   path = f"projec
-0000b1d0: 7473 2f7b 7072 6f6a 6563 747d 2f73 6368  ts/{project}/sch
-0000b1e0: 6564 756c 6573 220a 0a20 2020 2020 2020  edules"..       
-0000b1f0: 2065 7272 6f72 5f6d 6573 7361 6765 203d   error_message =
-0000b200: 2066 2246 6169 6c65 6420 6372 6561 7469   f"Failed creati
-0000b210: 6e67 2073 6368 6564 756c 6520 7b70 726f  ng schedule {pro
-0000b220: 6a65 6374 7d2f 7b73 6368 6564 756c 652e  ject}/{schedule.
-0000b230: 6e61 6d65 7d22 0a20 2020 2020 2020 2073  name}".        s
-0000b240: 656c 662e 6170 695f 6361 6c6c 2822 504f  elf.api_call("PO
-0000b250: 5354 222c 2070 6174 682c 2065 7272 6f72  ST", path, error
-0000b260: 5f6d 6573 7361 6765 2c20 626f 6479 3d64  _message, body=d
-0000b270: 6963 745f 746f 5f6a 736f 6e28 7363 6865  ict_to_json(sche
-0000b280: 6475 6c65 2e64 6963 7428 2929 290a 0a20  dule.dict())).. 
-0000b290: 2020 2064 6566 2075 7064 6174 655f 7363     def update_sc
-0000b2a0: 6865 6475 6c65 280a 2020 2020 2020 2020  hedule(.        
-0000b2b0: 7365 6c66 2c20 7072 6f6a 6563 743a 2073  self, project: s
-0000b2c0: 7472 2c20 6e61 6d65 3a20 7374 722c 2073  tr, name: str, s
-0000b2d0: 6368 6564 756c 653a 2073 6368 656d 6173  chedule: schemas
-0000b2e0: 2e53 6368 6564 756c 6555 7064 6174 650a  .ScheduleUpdate.
-0000b2f0: 2020 2020 293a 0a20 2020 2020 2020 2022      ):.        "
-0000b300: 2222 5570 6461 7465 2061 6e20 6578 6973  ""Update an exis
-0000b310: 7469 6e67 2073 6368 6564 756c 652c 2072  ting schedule, r
-0000b320: 6570 6c61 6365 2069 7420 7769 7468 2074  eplace it with t
-0000b330: 6865 2064 6574 6169 6c73 2063 6f6e 7461  he details conta
-0000b340: 696e 6564 2069 6e20 7468 6520 7363 6865  ined in the sche
-0000b350: 6475 6c65 206f 626a 6563 742e 2222 220a  dule object.""".
-0000b360: 0a20 2020 2020 2020 2070 726f 6a65 6374  .        project
-0000b370: 203d 2070 726f 6a65 6374 206f 7220 636f   = project or co
-0000b380: 6e66 6967 2e64 6566 6175 6c74 5f70 726f  nfig.default_pro
-0000b390: 6a65 6374 0a20 2020 2020 2020 2070 6174  ject.        pat
-0000b3a0: 6820 3d20 6622 7072 6f6a 6563 7473 2f7b  h = f"projects/{
-0000b3b0: 7072 6f6a 6563 747d 2f73 6368 6564 756c  project}/schedul
-0000b3c0: 6573 2f7b 6e61 6d65 7d22 0a0a 2020 2020  es/{name}"..    
-0000b3d0: 2020 2020 6572 726f 725f 6d65 7373 6167      error_messag
-0000b3e0: 6520 3d20 6622 4661 696c 6564 2075 7064  e = f"Failed upd
-0000b3f0: 6174 696e 6720 7363 6865 6475 6c65 207b  ating schedule {
-0000b400: 7072 6f6a 6563 747d 2f7b 6e61 6d65 7d22  project}/{name}"
-0000b410: 0a20 2020 2020 2020 2073 656c 662e 6170  .        self.ap
-0000b420: 695f 6361 6c6c 2822 5055 5422 2c20 7061  i_call("PUT", pa
-0000b430: 7468 2c20 6572 726f 725f 6d65 7373 6167  th, error_messag
-0000b440: 652c 2062 6f64 793d 6469 6374 5f74 6f5f  e, body=dict_to_
-0000b450: 6a73 6f6e 2873 6368 6564 756c 652e 6469  json(schedule.di
-0000b460: 6374 2829 2929 0a0a 2020 2020 6465 6620  ct()))..    def 
-0000b470: 6765 745f 7363 6865 6475 6c65 280a 2020  get_schedule(.  
-0000b480: 2020 2020 2020 7365 6c66 2c20 7072 6f6a        self, proj
-0000b490: 6563 743a 2073 7472 2c20 6e61 6d65 3a20  ect: str, name: 
-0000b4a0: 7374 722c 2069 6e63 6c75 6465 5f6c 6173  str, include_las
-0000b4b0: 745f 7275 6e3a 2062 6f6f 6c20 3d20 4661  t_run: bool = Fa
-0000b4c0: 6c73 650a 2020 2020 2920 2d3e 2073 6368  lse.    ) -> sch
-0000b4d0: 656d 6173 2e53 6368 6564 756c 654f 7574  emas.ScheduleOut
-0000b4e0: 7075 743a 0a20 2020 2020 2020 2022 2222  put:.        """
-0000b4f0: 5265 7472 6965 7665 2064 6574 6169 6c73  Retrieve details
-0000b500: 206f 6620 7468 6520 7363 6865 6475 6c65   of the schedule
-0000b510: 2069 6e20 7175 6573 7469 6f6e 2e20 4265   in question. Be
-0000b520: 7369 6465 7320 7265 7475 726e 696e 6720  sides returning 
-0000b530: 7468 6520 6465 7461 696c 7320 6f66 2074  the details of t
-0000b540: 6865 2073 6368 6564 756c 6520 6f62 6a65  he schedule obje
-0000b550: 6374 2069 7473 656c 662c 0a20 2020 2020  ct itself,.     
-0000b560: 2020 2074 6869 7320 6675 6e63 7469 6f6e     this function
-0000b570: 2061 6c73 6f20 7265 7475 726e 7320 7468   also returns th
-0000b580: 6520 6e65 7874 2073 6368 6564 756c 6564  e next scheduled
-0000b590: 2072 756e 2066 6f72 2074 6869 7320 7370   run for this sp
-0000b5a0: 6563 6966 6963 2073 6368 6564 756c 652c  ecific schedule,
-0000b5b0: 2061 7320 7765 6c6c 2061 7320 706f 7465   as well as pote
-0000b5c0: 6e74 6961 6c6c 7920 7468 650a 2020 2020  ntially the.    
-0000b5d0: 2020 2020 7265 7375 6c74 7320 6f66 2074      results of t
-0000b5e0: 6865 206c 6173 7420 7275 6e20 6578 6563  he last run exec
-0000b5f0: 7574 6564 2074 6872 6f75 6768 2074 6869  uted through thi
-0000b600: 7320 7363 6865 6475 6c65 2e0a 0a20 2020  s schedule...   
-0000b610: 2020 2020 203a 7061 7261 6d20 7072 6f6a       :param proj
-0000b620: 6563 743a 2050 726f 6a65 6374 206e 616d  ect: Project nam
-0000b630: 652e 0a20 2020 2020 2020 203a 7061 7261  e..        :para
-0000b640: 6d20 6e61 6d65 3a20 4e61 6d65 206f 6620  m name: Name of 
-0000b650: 7468 6520 7363 6865 6475 6c65 206f 626a  the schedule obj
-0000b660: 6563 7420 746f 2071 7565 7279 2e0a 2020  ect to query..  
-0000b670: 2020 2020 2020 3a70 6172 616d 2069 6e63        :param inc
-0000b680: 6c75 6465 5f6c 6173 745f 7275 6e3a 2057  lude_last_run: W
-0000b690: 6865 7468 6572 2074 6f20 696e 636c 7564  hether to includ
-0000b6a0: 6520 7468 6520 7265 7375 6c74 7320 6f66  e the results of
-0000b6b0: 2074 6865 2073 6368 6564 756c 6527 7320   the schedule's 
-0000b6c0: 6c61 7374 2072 756e 2069 6e20 7468 6520  last run in the 
-0000b6d0: 7265 7370 6f6e 7365 2e0a 2020 2020 2020  response..      
-0000b6e0: 2020 2222 220a 0a20 2020 2020 2020 2070    """..        p
-0000b6f0: 726f 6a65 6374 203d 2070 726f 6a65 6374  roject = project
-0000b700: 206f 7220 636f 6e66 6967 2e64 6566 6175   or config.defau
-0000b710: 6c74 5f70 726f 6a65 6374 0a20 2020 2020  lt_project.     
-0000b720: 2020 2070 6174 6820 3d20 6622 7072 6f6a     path = f"proj
-0000b730: 6563 7473 2f7b 7072 6f6a 6563 747d 2f73  ects/{project}/s
-0000b740: 6368 6564 756c 6573 2f7b 6e61 6d65 7d22  chedules/{name}"
-0000b750: 0a20 2020 2020 2020 2065 7272 6f72 5f6d  .        error_m
-0000b760: 6573 7361 6765 203d 2066 2246 6169 6c65  essage = f"Faile
-0000b770: 6420 6765 7474 696e 6720 7363 6865 6475  d getting schedu
-0000b780: 6c65 2066 6f72 207b 7072 6f6a 6563 747d  le for {project}
-0000b790: 2f7b 6e61 6d65 7d22 0a20 2020 2020 2020  /{name}".       
-0000b7a0: 2072 6573 7020 3d20 7365 6c66 2e61 7069   resp = self.api
-0000b7b0: 5f63 616c 6c28 0a20 2020 2020 2020 2020  _call(.         
-0000b7c0: 2020 2022 4745 5422 2c20 7061 7468 2c20     "GET", path, 
-0000b7d0: 6572 726f 725f 6d65 7373 6167 652c 2070  error_message, p
-0000b7e0: 6172 616d 733d 7b22 696e 636c 7564 655f  arams={"include_
-0000b7f0: 6c61 7374 5f72 756e 223a 2069 6e63 6c75  last_run": inclu
-0000b800: 6465 5f6c 6173 745f 7275 6e7d 0a20 2020  de_last_run}.   
-0000b810: 2020 2020 2029 0a20 2020 2020 2020 2072       ).        r
-0000b820: 6574 7572 6e20 7363 6865 6d61 732e 5363  eturn schemas.Sc
-0000b830: 6865 6475 6c65 4f75 7470 7574 282a 2a72  heduleOutput(**r
-0000b840: 6573 702e 6a73 6f6e 2829 290a 0a20 2020  esp.json())..   
-0000b850: 2064 6566 206c 6973 745f 7363 6865 6475   def list_schedu
-0000b860: 6c65 7328 0a20 2020 2020 2020 2073 656c  les(.        sel
-0000b870: 662c 0a20 2020 2020 2020 2070 726f 6a65  f,.        proje
-0000b880: 6374 3a20 7374 722c 0a20 2020 2020 2020  ct: str,.       
-0000b890: 206e 616d 653a 2073 7472 203d 204e 6f6e   name: str = Non
-0000b8a0: 652c 0a20 2020 2020 2020 206b 696e 643a  e,.        kind:
-0000b8b0: 2073 6368 656d 6173 2e53 6368 6564 756c   schemas.Schedul
-0000b8c0: 654b 696e 6473 203d 204e 6f6e 652c 0a20  eKinds = None,. 
-0000b8d0: 2020 2020 2020 2069 6e63 6c75 6465 5f6c         include_l
-0000b8e0: 6173 745f 7275 6e3a 2062 6f6f 6c20 3d20  ast_run: bool = 
-0000b8f0: 4661 6c73 652c 0a20 2020 2029 202d 3e20  False,.    ) -> 
-0000b900: 7363 6865 6d61 732e 5363 6865 6475 6c65  schemas.Schedule
-0000b910: 734f 7574 7075 743a 0a20 2020 2020 2020  sOutput:.       
-0000b920: 2022 2222 5265 7472 6965 7665 206c 6973   """Retrieve lis
-0000b930: 7420 6f66 2073 6368 6564 756c 6573 206f  t of schedules o
-0000b940: 6620 7370 6563 6966 6963 206e 616d 6520  f specific name 
-0000b950: 6f72 206b 696e 642e 0a0a 2020 2020 2020  or kind...      
-0000b960: 2020 3a70 6172 616d 2070 726f 6a65 6374    :param project
-0000b970: 3a20 5072 6f6a 6563 7420 6e61 6d65 2e0a  : Project name..
-0000b980: 2020 2020 2020 2020 3a70 6172 616d 206e          :param n
-0000b990: 616d 653a 204e 616d 6520 6f66 2073 6368  ame: Name of sch
-0000b9a0: 6564 756c 6520 746f 2072 6574 7269 6576  edule to retriev
-0000b9b0: 652e 2043 616e 2062 6520 6f6d 6974 7465  e. Can be omitte
-0000b9c0: 6420 746f 206c 6973 7420 616c 6c20 7363  d to list all sc
-0000b9d0: 6865 6475 6c65 732e 0a20 2020 2020 2020  hedules..       
-0000b9e0: 203a 7061 7261 6d20 6b69 6e64 3a20 4b69   :param kind: Ki
-0000b9f0: 6e64 206f 6620 7363 6865 6475 6c65 206f  nd of schedule o
-0000ba00: 626a 6563 7473 2074 6f20 7265 7472 6965  bjects to retrie
-0000ba10: 7665 2c20 6361 6e20 6265 2065 6974 6865  ve, can be eithe
-0000ba20: 7220 6060 6a6f 6260 6020 6f72 2060 6070  r ``job`` or ``p
-0000ba30: 6970 656c 696e 6560 602e 0a20 2020 2020  ipeline``..     
-0000ba40: 2020 203a 7061 7261 6d20 696e 636c 7564     :param includ
-0000ba50: 655f 6c61 7374 5f72 756e 3a20 5768 6574  e_last_run: Whet
-0000ba60: 6865 7220 746f 2072 6574 7572 6e20 666f  her to return fo
-0000ba70: 7220 6561 6368 2073 6368 6564 756c 6520  r each schedule 
-0000ba80: 7265 7475 726e 6564 2061 6c73 6f20 7468  returned also th
-0000ba90: 6520 7265 7375 6c74 7320 6f66 2074 6865  e results of the
-0000baa0: 206c 6173 7420 7275 6e20 6f66 0a20 2020   last run of.   
-0000bab0: 2020 2020 2020 2020 2074 6861 7420 7363           that sc
-0000bac0: 6865 6475 6c65 2e0a 2020 2020 2020 2020  hedule..        
-0000bad0: 2222 220a 0a20 2020 2020 2020 2070 726f  """..        pro
-0000bae0: 6a65 6374 203d 2070 726f 6a65 6374 206f  ject = project o
-0000baf0: 7220 636f 6e66 6967 2e64 6566 6175 6c74  r config.default
-0000bb00: 5f70 726f 6a65 6374 0a20 2020 2020 2020  _project.       
-0000bb10: 2070 6172 616d 7320 3d20 7b22 6b69 6e64   params = {"kind
-0000bb20: 223a 206b 696e 642c 2022 6e61 6d65 223a  ": kind, "name":
-0000bb30: 206e 616d 652c 2022 696e 636c 7564 655f   name, "include_
-0000bb40: 6c61 7374 5f72 756e 223a 2069 6e63 6c75  last_run": inclu
-0000bb50: 6465 5f6c 6173 745f 7275 6e7d 0a20 2020  de_last_run}.   
-0000bb60: 2020 2020 2070 6174 6820 3d20 6622 7072       path = f"pr
-0000bb70: 6f6a 6563 7473 2f7b 7072 6f6a 6563 747d  ojects/{project}
-0000bb80: 2f73 6368 6564 756c 6573 220a 2020 2020  /schedules".    
-0000bb90: 2020 2020 6572 726f 725f 6d65 7373 6167      error_messag
-0000bba0: 6520 3d20 6622 4661 696c 6564 206c 6973  e = f"Failed lis
-0000bbb0: 7469 6e67 2073 6368 6564 756c 6573 2066  ting schedules f
-0000bbc0: 6f72 207b 7072 6f6a 6563 747d 203f 207b  or {project} ? {
-0000bbd0: 6b69 6e64 7d20 7b6e 616d 657d 220a 2020  kind} {name}".  
-0000bbe0: 2020 2020 2020 7265 7370 203d 2073 656c        resp = sel
-0000bbf0: 662e 6170 695f 6361 6c6c 2822 4745 5422  f.api_call("GET"
-0000bc00: 2c20 7061 7468 2c20 6572 726f 725f 6d65  , path, error_me
-0000bc10: 7373 6167 652c 2070 6172 616d 733d 7061  ssage, params=pa
-0000bc20: 7261 6d73 290a 2020 2020 2020 2020 7265  rams).        re
-0000bc30: 7475 726e 2073 6368 656d 6173 2e53 6368  turn schemas.Sch
-0000bc40: 6564 756c 6573 4f75 7470 7574 282a 2a72  edulesOutput(**r
-0000bc50: 6573 702e 6a73 6f6e 2829 290a 0a20 2020  esp.json())..   
-0000bc60: 2064 6566 2064 656c 6574 655f 7363 6865   def delete_sche
-0000bc70: 6475 6c65 2873 656c 662c 2070 726f 6a65  dule(self, proje
-0000bc80: 6374 3a20 7374 722c 206e 616d 653a 2073  ct: str, name: s
-0000bc90: 7472 293a 0a20 2020 2020 2020 2022 2222  tr):.        """
-0000bca0: 4465 6c65 7465 2061 2073 7065 6369 6669  Delete a specifi
-0000bcb0: 6320 7363 6865 6475 6c65 2062 7920 6e61  c schedule by na
-0000bcc0: 6d65 2e22 2222 0a0a 2020 2020 2020 2020  me."""..        
-0000bcd0: 7072 6f6a 6563 7420 3d20 7072 6f6a 6563  project = projec
-0000bce0: 7420 6f72 2063 6f6e 6669 672e 6465 6661  t or config.defa
-0000bcf0: 756c 745f 7072 6f6a 6563 740a 2020 2020  ult_project.    
-0000bd00: 2020 2020 7061 7468 203d 2066 2270 726f      path = f"pro
-0000bd10: 6a65 6374 732f 7b70 726f 6a65 6374 7d2f  jects/{project}/
-0000bd20: 7363 6865 6475 6c65 732f 7b6e 616d 657d  schedules/{name}
-0000bd30: 220a 2020 2020 2020 2020 6572 726f 725f  ".        error_
-0000bd40: 6d65 7373 6167 6520 3d20 6622 4661 696c  message = f"Fail
-0000bd50: 6564 2064 656c 6574 696e 6720 7363 6865  ed deleting sche
-0000bd60: 6475 6c65 207b 7072 6f6a 6563 747d 2f7b  dule {project}/{
-0000bd70: 6e61 6d65 7d22 0a20 2020 2020 2020 2073  name}".        s
-0000bd80: 656c 662e 6170 695f 6361 6c6c 2822 4445  elf.api_call("DE
-0000bd90: 4c45 5445 222c 2070 6174 682c 2065 7272  LETE", path, err
-0000bda0: 6f72 5f6d 6573 7361 6765 290a 0a20 2020  or_message)..   
-0000bdb0: 2064 6566 2069 6e76 6f6b 655f 7363 6865   def invoke_sche
-0000bdc0: 6475 6c65 2873 656c 662c 2070 726f 6a65  dule(self, proje
-0000bdd0: 6374 3a20 7374 722c 206e 616d 653a 2073  ct: str, name: s
-0000bde0: 7472 293a 0a20 2020 2020 2020 2022 2222  tr):.        """
-0000bdf0: 4578 6563 7574 6520 7468 6520 6f62 6a65  Execute the obje
-0000be00: 6374 2072 6566 6572 656e 6365 6420 6279  ct referenced by
-0000be10: 2074 6865 2073 6368 6564 756c 6520 696d   the schedule im
-0000be20: 6d65 6469 6174 656c 792e 2222 220a 0a20  mediately.""".. 
-0000be30: 2020 2020 2020 2070 726f 6a65 6374 203d         project =
-0000be40: 2070 726f 6a65 6374 206f 7220 636f 6e66   project or conf
-0000be50: 6967 2e64 6566 6175 6c74 5f70 726f 6a65  ig.default_proje
-0000be60: 6374 0a20 2020 2020 2020 2070 6174 6820  ct.        path 
-0000be70: 3d20 6622 7072 6f6a 6563 7473 2f7b 7072  = f"projects/{pr
-0000be80: 6f6a 6563 747d 2f73 6368 6564 756c 6573  oject}/schedules
-0000be90: 2f7b 6e61 6d65 7d2f 696e 766f 6b65 220a  /{name}/invoke".
-0000bea0: 2020 2020 2020 2020 6572 726f 725f 6d65          error_me
-0000beb0: 7373 6167 6520 3d20 6622 4661 696c 6564  ssage = f"Failed
-0000bec0: 2069 6e76 6f6b 696e 6720 7363 6865 6475   invoking schedu
-0000bed0: 6c65 207b 7072 6f6a 6563 747d 2f7b 6e61  le {project}/{na
-0000bee0: 6d65 7d22 0a20 2020 2020 2020 2073 656c  me}".        sel
-0000bef0: 662e 6170 695f 6361 6c6c 2822 504f 5354  f.api_call("POST
-0000bf00: 222c 2070 6174 682c 2065 7272 6f72 5f6d  ", path, error_m
-0000bf10: 6573 7361 6765 290a 0a20 2020 2064 6566  essage)..    def
-0000bf20: 2072 656d 6f74 655f 6275 696c 6465 7228   remote_builder(
-0000bf30: 0a20 2020 2020 2020 2073 656c 662c 0a20  .        self,. 
-0000bf40: 2020 2020 2020 2066 756e 632c 0a20 2020         func,.   
-0000bf50: 2020 2020 2077 6974 685f 6d6c 7275 6e2c       with_mlrun,
-0000bf60: 0a20 2020 2020 2020 206d 6c72 756e 5f76  .        mlrun_v
-0000bf70: 6572 7369 6f6e 5f73 7065 6369 6669 6572  ersion_specifier
-0000bf80: 3d4e 6f6e 652c 0a20 2020 2020 2020 2073  =None,.        s
-0000bf90: 6b69 705f 6465 706c 6f79 6564 3d46 616c  kip_deployed=Fal
-0000bfa0: 7365 2c0a 2020 2020 2020 2020 6275 696c  se,.        buil
-0000bfb0: 6465 725f 656e 763d 4e6f 6e65 2c0a 2020  der_env=None,.  
-0000bfc0: 2020 293a 0a20 2020 2020 2020 2022 2222    ):.        """
-0000bfd0: 4275 696c 6420 7468 6520 706f 6420 696d  Build the pod im
-0000bfe0: 6167 6520 666f 7220 6120 6675 6e63 7469  age for a functi
-0000bff0: 6f6e 2c20 666f 7220 6578 6563 7574 696f  on, for executio
-0000c000: 6e20 6f6e 2061 2072 656d 6f74 6520 636c  n on a remote cl
-0000c010: 7573 7465 722e 2054 6869 7320 6973 2065  uster. This is e
-0000c020: 7865 6375 7465 6420 6279 2074 6865 204d  xecuted by the M
-0000c030: 4c52 756e 0a20 2020 2020 2020 2041 5049  LRun.        API
-0000c040: 2073 6572 7665 722c 2061 6e64 2063 7265   server, and cre
-0000c050: 6174 6573 2061 2044 6f63 6b65 7220 696d  ates a Docker im
-0000c060: 6167 6520 6f75 7420 6f66 2074 6865 2066  age out of the f
-0000c070: 756e 6374 696f 6e20 7072 6f76 6964 6564  unction provided
-0000c080: 2061 6e64 2061 6e79 2073 7065 6369 6669   and any specifi
-0000c090: 6320 6275 696c 640a 2020 2020 2020 2020  c build.        
-0000c0a0: 696e 7374 7275 6374 696f 6e73 2070 726f  instructions pro
-0000c0b0: 7669 6465 6420 7769 7468 696e 2e20 5468  vided within. Th
-0000c0c0: 6973 2069 7320 6120 7072 652d 7265 7175  is is a pre-requ
-0000c0d0: 6973 6974 6520 666f 7220 7265 6d6f 7465  isite for remote
-0000c0e0: 6c79 2065 7865 6375 7469 6e67 2061 2066  ly executing a f
-0000c0f0: 756e 6374 696f 6e2c 2075 6e6c 6573 7320  unction, unless 
-0000c100: 7573 696e 670a 2020 2020 2020 2020 6120  using.        a 
-0000c110: 7072 652d 6465 706c 6f79 6564 2069 6d61  pre-deployed ima
-0000c120: 6765 2e0a 0a20 2020 2020 2020 203a 7061  ge...        :pa
-0000c130: 7261 6d20 6675 6e63 3a20 4675 6e63 7469  ram func: Functi
-0000c140: 6f6e 2074 6f20 6275 696c 642e 0a20 2020  on to build..   
-0000c150: 2020 2020 203a 7061 7261 6d20 7769 7468       :param with
-0000c160: 5f6d 6c72 756e 3a20 5768 6574 6865 7220  _mlrun: Whether 
-0000c170: 746f 2061 6464 204d 4c52 756e 2070 6163  to add MLRun pac
-0000c180: 6b61 6765 2074 6f20 7468 6520 6275 696c  kage to the buil
-0000c190: 7420 7061 636b 6167 652e 2054 6869 7320  t package. This 
-0000c1a0: 6973 206e 6f74 2072 6571 7569 7265 6420  is not required 
-0000c1b0: 6966 2075 7369 6e67 2061 2062 6173 650a  if using a base.
-0000c1c0: 2020 2020 2020 2020 2020 2020 696d 6167              imag
-0000c1d0: 6520 7468 6174 2061 6c72 6561 6479 2068  e that already h
-0000c1e0: 6173 204d 4c52 756e 2069 6e20 6974 2e0a  as MLRun in it..
-0000c1f0: 2020 2020 2020 2020 3a70 6172 616d 206d          :param m
-0000c200: 6c72 756e 5f76 6572 7369 6f6e 5f73 7065  lrun_version_spe
-0000c210: 6369 6669 6572 3a20 5665 7273 696f 6e20  cifier: Version 
-0000c220: 6f66 204d 4c52 756e 2074 6f20 696e 636c  of MLRun to incl
-0000c230: 7564 6520 696e 2074 6865 2062 7569 6c74  ude in the built
-0000c240: 2069 6d61 6765 2e0a 2020 2020 2020 2020   image..        
-0000c250: 3a70 6172 616d 2073 6b69 705f 6465 706c  :param skip_depl
-0000c260: 6f79 6564 3a20 536b 6970 2074 6865 2062  oyed: Skip the b
-0000c270: 7569 6c64 2069 6620 7765 2061 6c72 6561  uild if we alrea
-0000c280: 6479 2068 6176 6520 616e 2069 6d61 6765  dy have an image
-0000c290: 2066 6f72 2074 6865 2066 756e 6374 696f   for the functio
-0000c2a0: 6e2e 0a20 2020 2020 2020 203a 7061 7261  n..        :para
-0000c2b0: 6d20 6275 696c 6465 725f 656e 763a 2020  m builder_env:  
-0000c2c0: 204b 616e 696b 6f20 6275 696c 6465 7220   Kaniko builder 
-0000c2d0: 706f 6420 656e 7620 7661 7273 2064 6963  pod env vars dic
-0000c2e0: 7420 2866 6f72 2063 6f6e 6669 672f 6372  t (for config/cr
-0000c2f0: 6564 656e 7469 616c 7329 0a20 2020 2020  edentials).     
-0000c300: 2020 2022 2222 0a0a 2020 2020 2020 2020     """..        
-0000c310: 7472 793a 0a20 2020 2020 2020 2020 2020  try:.           
-0000c320: 2072 6571 203d 207b 0a20 2020 2020 2020   req = {.       
-0000c330: 2020 2020 2020 2020 2022 6675 6e63 7469           "functi
-0000c340: 6f6e 223a 2066 756e 632e 746f 5f64 6963  on": func.to_dic
-0000c350: 7428 292c 0a20 2020 2020 2020 2020 2020  t(),.           
-0000c360: 2020 2020 2022 7769 7468 5f6d 6c72 756e       "with_mlrun
-0000c370: 223a 2062 6f6f 6c32 7374 7228 7769 7468  ": bool2str(with
-0000c380: 5f6d 6c72 756e 292c 0a20 2020 2020 2020  _mlrun),.       
-0000c390: 2020 2020 2020 2020 2022 736b 6970 5f64           "skip_d
-0000c3a0: 6570 6c6f 7965 6422 3a20 736b 6970 5f64  eployed": skip_d
-0000c3b0: 6570 6c6f 7965 642c 0a20 2020 2020 2020  eployed,.       
-0000c3c0: 2020 2020 207d 0a20 2020 2020 2020 2020       }.         
-0000c3d0: 2020 2069 6620 6d6c 7275 6e5f 7665 7273     if mlrun_vers
-0000c3e0: 696f 6e5f 7370 6563 6966 6965 723a 0a20  ion_specifier:. 
-0000c3f0: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-0000c400: 6571 5b22 6d6c 7275 6e5f 7665 7273 696f  eq["mlrun_versio
-0000c410: 6e5f 7370 6563 6966 6965 7222 5d20 3d20  n_specifier"] = 
-0000c420: 6d6c 7275 6e5f 7665 7273 696f 6e5f 7370  mlrun_version_sp
-0000c430: 6563 6966 6965 720a 2020 2020 2020 2020  ecifier.        
-0000c440: 2020 2020 6966 2062 7569 6c64 6572 5f65      if builder_e
-0000c450: 6e76 3a0a 2020 2020 2020 2020 2020 2020  nv:.            
-0000c460: 2020 2020 7265 715b 2262 7569 6c64 6572      req["builder
-0000c470: 5f65 6e76 225d 203d 2062 7569 6c64 6572  _env"] = builder
-0000c480: 5f65 6e76 0a20 2020 2020 2020 2020 2020  _env.           
-0000c490: 2072 6573 7020 3d20 7365 6c66 2e61 7069   resp = self.api
-0000c4a0: 5f63 616c 6c28 2250 4f53 5422 2c20 2262  _call("POST", "b
-0000c4b0: 7569 6c64 2f66 756e 6374 696f 6e22 2c20  uild/function", 
-0000c4c0: 6a73 6f6e 3d72 6571 290a 2020 2020 2020  json=req).      
-0000c4d0: 2020 6578 6365 7074 204f 5345 7272 6f72    except OSError
-0000c4e0: 2061 7320 6572 723a 0a20 2020 2020 2020   as err:.       
-0000c4f0: 2020 2020 206c 6f67 6765 722e 6572 726f       logger.erro
-0000c500: 7228 6622 6572 726f 7220 7375 626d 6974  r(f"error submit
-0000c510: 7469 6e67 2062 7569 6c64 2074 6173 6b3a  ting build task:
-0000c520: 207b 6572 725f 746f 5f73 7472 2865 7272   {err_to_str(err
-0000c530: 297d 2229 0a20 2020 2020 2020 2020 2020  )}").           
-0000c540: 2072 6169 7365 204f 5345 7272 6f72 2866   raise OSError(f
-0000c550: 2265 7272 6f72 3a20 6361 6e6e 6f74 2073  "error: cannot s
-0000c560: 7562 6d69 7420 6275 696c 642c 207b 6572  ubmit build, {er
-0000c570: 725f 746f 5f73 7472 2865 7272 297d 2229  r_to_str(err)}")
-0000c580: 0a0a 2020 2020 2020 2020 6966 206e 6f74  ..        if not
-0000c590: 2072 6573 702e 6f6b 3a0a 2020 2020 2020   resp.ok:.      
-0000c5a0: 2020 2020 2020 6c6f 6767 6572 2e65 7272        logger.err
-0000c5b0: 6f72 2866 2262 6164 2072 6573 7021 215c  or(f"bad resp!!\
-0000c5c0: 6e7b 7265 7370 2e74 6578 747d 2229 0a20  n{resp.text}"). 
-0000c5d0: 2020 2020 2020 2020 2020 2072 6169 7365             raise
-0000c5e0: 2056 616c 7565 4572 726f 7228 2262 6164   ValueError("bad
-0000c5f0: 2066 756e 6374 696f 6e20 7275 6e20 7265   function run re
-0000c600: 7370 6f6e 7365 2229 0a0a 2020 2020 2020  sponse")..      
-0000c610: 2020 7265 7475 726e 2072 6573 702e 6a73    return resp.js
-0000c620: 6f6e 2829 0a0a 2020 2020 6465 6620 6765  on()..    def ge
-0000c630: 745f 6275 696c 6465 725f 7374 6174 7573  t_builder_status
-0000c640: 280a 2020 2020 2020 2020 7365 6c66 2c0a  (.        self,.
-0000c650: 2020 2020 2020 2020 6675 6e63 3a20 4261          func: Ba
-0000c660: 7365 5275 6e74 696d 652c 0a20 2020 2020  seRuntime,.     
-0000c670: 2020 206f 6666 7365 743d 302c 0a20 2020     offset=0,.   
-0000c680: 2020 2020 206c 6f67 733d 5472 7565 2c0a       logs=True,.
-0000c690: 2020 2020 2020 2020 6c61 7374 5f6c 6f67          last_log
-0000c6a0: 5f74 696d 6573 7461 6d70 3d30 2c0a 2020  _timestamp=0,.  
-0000c6b0: 2020 2020 2020 7665 7262 6f73 653d 4661        verbose=Fa
-0000c6c0: 6c73 652c 0a20 2020 2029 3a0a 2020 2020  lse,.    ):.    
-0000c6d0: 2020 2020 2222 2252 6574 7269 6576 6520      """Retrieve 
-0000c6e0: 7468 6520 7374 6174 7573 206f 6620 6120  the status of a 
-0000c6f0: 6275 696c 6420 6f70 6572 6174 696f 6e20  build operation 
-0000c700: 6375 7272 656e 746c 7920 696e 2070 726f  currently in pro
-0000c710: 6772 6573 732e 0a0a 2020 2020 2020 2020  gress...        
-0000c720: 3a70 6172 616d 2066 756e 633a 2046 756e  :param func: Fun
-0000c730: 6374 696f 6e20 6f62 6a65 6374 2074 6861  ction object tha
-0000c740: 7420 6973 2062 6569 6e67 2062 7569 6c74  t is being built
-0000c750: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
-0000c760: 206f 6666 7365 743a 204f 6666 7365 7420   offset: Offset 
-0000c770: 696e 746f 2074 6865 2062 7569 6c64 206c  into the build l
-0000c780: 6f67 7320 746f 2072 6574 7269 6576 6520  ogs to retrieve 
-0000c790: 6c6f 6773 2066 726f 6d2e 0a20 2020 2020  logs from..     
-0000c7a0: 2020 203a 7061 7261 6d20 6c6f 6773 3a20     :param logs: 
-0000c7b0: 5368 6f75 6c64 2062 7569 6c64 206c 6f67  Should build log
-0000c7c0: 7320 6265 2072 6574 7269 6576 6564 2e0a  s be retrieved..
-0000c7d0: 2020 2020 2020 2020 3a70 6172 616d 206c          :param l
-0000c7e0: 6173 745f 6c6f 675f 7469 6d65 7374 616d  ast_log_timestam
-0000c7f0: 703a 204c 6173 7420 7469 6d65 7374 616d  p: Last timestam
-0000c800: 7020 6f66 206c 6f67 7320 7468 6174 2077  p of logs that w
-0000c810: 6572 6520 616c 7265 6164 7920 7265 7472  ere already retr
-0000c820: 6965 7665 642e 2046 756e 6374 696f 6e20  ieved. Function 
-0000c830: 7769 6c6c 2072 6574 7572 6e20 6f6e 6c79  will return only
-0000c840: 206c 6f67 730a 2020 2020 2020 2020 2020   logs.          
-0000c850: 2020 6c61 7465 7220 7468 616e 2074 6869    later than thi
-0000c860: 7320 7061 7261 6d65 7465 722e 0a20 2020  s parameter..   
-0000c870: 2020 2020 203a 7061 7261 6d20 7665 7262       :param verb
-0000c880: 6f73 653a 2041 6464 2076 6572 626f 7365  ose: Add verbose
-0000c890: 206c 6f67 7320 696e 746f 2074 6865 206f   logs into the o
-0000c8a0: 7574 7075 742e 0a20 2020 2020 2020 203a  utput..        :
-0000c8b0: 7265 7475 726e 733a 2054 6865 2066 6f6c  returns: The fol
-0000c8c0: 6c6f 7769 6e67 2070 6172 616d 6574 6572  lowing parameter
-0000c8d0: 733a 0a0a 2020 2020 2020 2020 2020 2020  s:..            
-0000c8e0: 2d20 5465 7874 206f 6620 6275 696c 6465  - Text of builde
-0000c8f0: 7220 6c6f 6773 2e0a 2020 2020 2020 2020  r logs..        
-0000c900: 2020 2020 2d20 5469 6d65 7374 616d 7020      - Timestamp 
-0000c910: 6f66 206c 6173 7420 6c6f 6720 7265 7472  of last log retr
-0000c920: 6965 7665 642c 2074 6f20 6265 2075 7365  ieved, to be use
-0000c930: 6420 696e 2073 7562 7365 7175 656e 7420  d in subsequent 
-0000c940: 6361 6c6c 7320 746f 2074 6869 7320 6675  calls to this fu
-0000c950: 6e63 7469 6f6e 2e0a 0a20 2020 2020 2020  nction...       
-0000c960: 2020 2020 2054 6865 2066 756e 6374 696f       The functio
-0000c970: 6e20 616c 736f 2075 7064 6174 6573 2069  n also updates i
-0000c980: 6e74 6572 6e61 6c20 6d65 6d62 6572 7320  nternal members 
-0000c990: 6f66 2074 6865 2060 6066 756e 6360 6020  of the ``func`` 
-0000c9a0: 6f62 6a65 6374 2074 6f20 7265 666c 6563  object to reflec
-0000c9b0: 7420 6275 696c 6420 7072 6f63 6573 7320  t build process 
-0000c9c0: 696e 666f 2e0a 2020 2020 2020 2020 2222  info..        ""
-0000c9d0: 220a 0a20 2020 2020 2020 2074 7279 3a0a  "..        try:.
-0000c9e0: 2020 2020 2020 2020 2020 2020 7061 7261              para
-0000c9f0: 6d73 203d 207b 0a20 2020 2020 2020 2020  ms = {.         
-0000ca00: 2020 2020 2020 2022 6e61 6d65 223a 206e         "name": n
-0000ca10: 6f72 6d61 6c69 7a65 5f6e 616d 6528 6675  ormalize_name(fu
-0000ca20: 6e63 2e6d 6574 6164 6174 612e 6e61 6d65  nc.metadata.name
-0000ca30: 292c 0a20 2020 2020 2020 2020 2020 2020  ),.             
-0000ca40: 2020 2022 7072 6f6a 6563 7422 3a20 6675     "project": fu
-0000ca50: 6e63 2e6d 6574 6164 6174 612e 7072 6f6a  nc.metadata.proj
-0000ca60: 6563 742c 0a20 2020 2020 2020 2020 2020  ect,.           
-0000ca70: 2020 2020 2022 7461 6722 3a20 6675 6e63       "tag": func
-0000ca80: 2e6d 6574 6164 6174 612e 7461 672c 0a20  .metadata.tag,. 
-0000ca90: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-0000caa0: 6c6f 6773 223a 2062 6f6f 6c32 7374 7228  logs": bool2str(
-0000cab0: 6c6f 6773 292c 0a20 2020 2020 2020 2020  logs),.         
-0000cac0: 2020 2020 2020 2022 6f66 6673 6574 223a         "offset":
-0000cad0: 2073 7472 286f 6666 7365 7429 2c0a 2020   str(offset),.  
-0000cae0: 2020 2020 2020 2020 2020 2020 2020 226c                "l
-0000caf0: 6173 745f 6c6f 675f 7469 6d65 7374 616d  ast_log_timestam
-0000cb00: 7022 3a20 7374 7228 6c61 7374 5f6c 6f67  p": str(last_log
-0000cb10: 5f74 696d 6573 7461 6d70 292c 0a20 2020  _timestamp),.   
-0000cb20: 2020 2020 2020 2020 2020 2020 2022 7665               "ve
-0000cb30: 7262 6f73 6522 3a20 626f 6f6c 3273 7472  rbose": bool2str
-0000cb40: 2876 6572 626f 7365 292c 0a20 2020 2020  (verbose),.     
-0000cb50: 2020 2020 2020 207d 0a20 2020 2020 2020         }.       
-0000cb60: 2020 2020 2072 6573 7020 3d20 7365 6c66       resp = self
-0000cb70: 2e61 7069 5f63 616c 6c28 2247 4554 222c  .api_call("GET",
-0000cb80: 2022 6275 696c 642f 7374 6174 7573 222c   "build/status",
-0000cb90: 2070 6172 616d 733d 7061 7261 6d73 290a   params=params).
-0000cba0: 2020 2020 2020 2020 6578 6365 7074 204f          except O
-0000cbb0: 5345 7272 6f72 2061 7320 6572 723a 0a20  SError as err:. 
-0000cbc0: 2020 2020 2020 2020 2020 206c 6f67 6765             logge
-0000cbd0: 722e 6572 726f 7228 6622 6572 726f 7220  r.error(f"error 
-0000cbe0: 6765 7474 696e 6720 6275 696c 6420 7374  getting build st
-0000cbf0: 6174 7573 3a20 7b65 7272 5f74 6f5f 7374  atus: {err_to_st
-0000cc00: 7228 6572 7229 7d22 290a 2020 2020 2020  r(err)}").      
-0000cc10: 2020 2020 2020 7261 6973 6520 4f53 4572        raise OSEr
-0000cc20: 726f 7228 6622 6572 726f 723a 2063 616e  ror(f"error: can
-0000cc30: 6e6f 7420 6765 7420 6275 696c 6420 7374  not get build st
-0000cc40: 6174 7573 2c20 7b65 7272 5f74 6f5f 7374  atus, {err_to_st
-0000cc50: 7228 6572 7229 7d22 290a 0a20 2020 2020  r(err)}")..     
-0000cc60: 2020 2069 6620 6e6f 7420 7265 7370 2e6f     if not resp.o
-0000cc70: 6b3a 0a20 2020 2020 2020 2020 2020 206c  k:.            l
-0000cc80: 6f67 6765 722e 7761 726e 696e 6728 6622  ogger.warning(f"
-0000cc90: 6661 696c 6564 2072 6573 702c 207b 7265  failed resp, {re
-0000cca0: 7370 2e74 6578 747d 2229 0a20 2020 2020  sp.text}").     
-0000ccb0: 2020 2020 2020 2072 6169 7365 2052 756e         raise Run
-0000ccc0: 4442 4572 726f 7228 2262 6164 2066 756e  DBError("bad fun
-0000ccd0: 6374 696f 6e20 6275 696c 6420 7265 7370  ction build resp
-0000cce0: 6f6e 7365 2229 0a0a 2020 2020 2020 2020  onse")..        
-0000ccf0: 6966 2072 6573 702e 6865 6164 6572 733a  if resp.headers:
-0000cd00: 0a20 2020 2020 2020 2020 2020 2066 756e  .            fun
-0000cd10: 632e 7374 6174 7573 2e73 7461 7465 203d  c.status.state =
-0000cd20: 2072 6573 702e 6865 6164 6572 732e 6765   resp.headers.ge
-0000cd30: 7428 2278 2d6d 6c72 756e 2d66 756e 6374  t("x-mlrun-funct
-0000cd40: 696f 6e2d 7374 6174 7573 222c 2022 2229  ion-status", "")
-0000cd50: 0a20 2020 2020 2020 2020 2020 206c 6173  .            las
-0000cd60: 745f 6c6f 675f 7469 6d65 7374 616d 7020  t_log_timestamp 
-0000cd70: 3d20 666c 6f61 7428 0a20 2020 2020 2020  = float(.       
-0000cd80: 2020 2020 2020 2020 2072 6573 702e 6865           resp.he
-0000cd90: 6164 6572 732e 6765 7428 2278 2d6d 6c72  aders.get("x-mlr
-0000cda0: 756e 2d6c 6173 742d 7469 6d65 7374 616d  un-last-timestam
-0000cdb0: 7022 2c20 2230 2e30 2229 0a20 2020 2020  p", "0.0").     
-0000cdc0: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-0000cdd0: 2020 2020 2069 6620 6675 6e63 2e6b 696e       if func.kin
-0000cde0: 6420 696e 206d 6c72 756e 2e72 756e 7469  d in mlrun.runti
-0000cdf0: 6d65 732e 5275 6e74 696d 654b 696e 6473  mes.RuntimeKinds
-0000ce00: 2e6e 7563 6c69 6f5f 7275 6e74 696d 6573  .nuclio_runtimes
-0000ce10: 2829 3a0a 2020 2020 2020 2020 2020 2020  ():.            
-0000ce20: 2020 2020 6675 6e63 2e73 7461 7475 732e      func.status.
-0000ce30: 6164 6472 6573 7320 3d20 7265 7370 2e68  address = resp.h
-0000ce40: 6561 6465 7273 2e67 6574 2822 782d 6d6c  eaders.get("x-ml
-0000ce50: 7275 6e2d 6164 6472 6573 7322 2c20 2222  run-address", ""
-0000ce60: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-0000ce70: 2020 6675 6e63 2e73 7461 7475 732e 6e75    func.status.nu
-0000ce80: 636c 696f 5f6e 616d 6520 3d20 7265 7370  clio_name = resp
-0000ce90: 2e68 6561 6465 7273 2e67 6574 2822 782d  .headers.get("x-
-0000cea0: 6d6c 7275 6e2d 6e61 6d65 222c 2022 2229  mlrun-name", "")
-0000ceb0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000cec0: 2066 756e 632e 7374 6174 7573 2e69 6e74   func.status.int
-0000ced0: 6572 6e61 6c5f 696e 766f 6361 7469 6f6e  ernal_invocation
-0000cee0: 5f75 726c 7320 3d20 7265 7370 2e68 6561  _urls = resp.hea
-0000cef0: 6465 7273 2e67 6574 280a 2020 2020 2020  ders.get(.      
-0000cf00: 2020 2020 2020 2020 2020 2020 2020 2278                "x
-0000cf10: 2d6d 6c72 756e 2d69 6e74 6572 6e61 6c2d  -mlrun-internal-
-0000cf20: 696e 766f 6361 7469 6f6e 2d75 726c 7322  invocation-urls"
-0000cf30: 2c20 2222 0a20 2020 2020 2020 2020 2020  , "".           
-0000cf40: 2020 2020 2029 2e73 706c 6974 2822 2c22       ).split(","
-0000cf50: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-0000cf60: 2020 6675 6e63 2e73 7461 7475 732e 6578    func.status.ex
-0000cf70: 7465 726e 616c 5f69 6e76 6f63 6174 696f  ternal_invocatio
-0000cf80: 6e5f 7572 6c73 203d 2072 6573 702e 6865  n_urls = resp.he
-0000cf90: 6164 6572 732e 6765 7428 0a20 2020 2020  aders.get(.     
-0000cfa0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-0000cfb0: 782d 6d6c 7275 6e2d 6578 7465 726e 616c  x-mlrun-external
-0000cfc0: 2d69 6e76 6f63 6174 696f 6e2d 7572 6c73  -invocation-urls
-0000cfd0: 222c 2022 220a 2020 2020 2020 2020 2020  ", "".          
-0000cfe0: 2020 2020 2020 292e 7370 6c69 7428 222c        ).split(",
-0000cff0: 2229 0a20 2020 2020 2020 2020 2020 2020  ").             
-0000d000: 2020 2066 756e 632e 7374 6174 7573 2e63     func.status.c
-0000d010: 6f6e 7461 696e 6572 5f69 6d61 6765 203d  ontainer_image =
-0000d020: 2072 6573 702e 6865 6164 6572 732e 6765   resp.headers.ge
-0000d030: 7428 0a20 2020 2020 2020 2020 2020 2020  t(.             
-0000d040: 2020 2020 2020 2022 782d 6d6c 7275 6e2d         "x-mlrun-
-0000d050: 636f 6e74 6169 6e65 722d 696d 6167 6522  container-image"
-0000d060: 2c20 2222 0a20 2020 2020 2020 2020 2020  , "".           
-0000d070: 2020 2020 2029 0a20 2020 2020 2020 2020       ).         
-0000d080: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-0000d090: 2020 2020 2020 2020 2066 756e 632e 7374           func.st
-0000d0a0: 6174 7573 2e62 7569 6c64 5f70 6f64 203d  atus.build_pod =
-0000d0b0: 2072 6573 702e 6865 6164 6572 732e 6765   resp.headers.ge
-0000d0c0: 7428 2262 7569 6c64 6572 5f70 6f64 222c  t("builder_pod",
-0000d0d0: 2022 2229 0a20 2020 2020 2020 2020 2020   "").           
-0000d0e0: 2020 2020 2066 756e 632e 7370 6563 2e69       func.spec.i
+00005f80: 2020 2020 2020 2077 6974 685f 6e6f 7469         with_noti
+00005f90: 6669 6361 7469 6f6e 733a 2062 6f6f 6c20  fications: bool 
+00005fa0: 3d20 4661 6c73 652c 0a20 2020 2029 202d  = False,.    ) -
+00005fb0: 3e20 5275 6e4c 6973 743a 0a20 2020 2020  > RunList:.     
+00005fc0: 2020 2022 2222 5265 7472 6965 7665 2061     """Retrieve a
+00005fd0: 206c 6973 7420 6f66 2072 756e 732c 2066   list of runs, f
+00005fe0: 696c 7465 7265 6420 6279 2076 6172 696f  iltered by vario
+00005ff0: 7573 206f 7074 696f 6e73 2e0a 2020 2020  us options..    
+00006000: 2020 2020 4578 616d 706c 653a 3a0a 0a20      Example::.. 
+00006010: 2020 2020 2020 2020 2020 2072 756e 7320             runs 
+00006020: 3d20 6462 2e6c 6973 745f 7275 6e73 286e  = db.list_runs(n
+00006030: 616d 653d 2764 6f77 6e6c 6f61 6427 2c20  ame='download', 
+00006040: 7072 6f6a 6563 743d 2769 7269 7327 2c20  project='iris', 
+00006050: 6c61 6265 6c73 3d27 6f77 6e65 723d 6164  labels='owner=ad
+00006060: 6d69 6e27 290a 2020 2020 2020 2020 2020  min').          
+00006070: 2020 2320 4966 2072 756e 6e69 6e67 2069    # If running i
+00006080: 6e20 4a75 7079 7465 722c 2063 616e 2075  n Jupyter, can u
+00006090: 7365 2074 6865 202e 7368 6f77 2829 2066  se the .show() f
+000060a0: 756e 6374 696f 6e20 746f 2064 6973 706c  unction to displ
+000060b0: 6179 2074 6865 2072 6573 756c 7473 0a20  ay the results. 
+000060c0: 2020 2020 2020 2020 2020 2064 622e 6c69             db.li
+000060d0: 7374 5f72 756e 7328 6e61 6d65 3d27 272c  st_runs(name='',
+000060e0: 2070 726f 6a65 6374 3d70 726f 6a65 6374   project=project
+000060f0: 5f6e 616d 6529 2e73 686f 7728 290a 0a0a  _name).show()...
+00006100: 2020 2020 2020 2020 3a70 6172 616d 206e          :param n
+00006110: 616d 653a 204e 616d 6520 6f66 2074 6865  ame: Name of the
+00006120: 2072 756e 2074 6f20 7265 7472 6965 7665   run to retrieve
+00006130: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
+00006140: 2075 6964 3a20 556e 6971 7565 2049 4420   uid: Unique ID 
+00006150: 6f66 2074 6865 2072 756e 2c20 6f72 2061  of the run, or a
+00006160: 206c 6973 7420 6f66 2072 756e 2055 4944   list of run UID
+00006170: 732e 0a20 2020 2020 2020 203a 7061 7261  s..        :para
+00006180: 6d20 7072 6f6a 6563 743a 2050 726f 6a65  m project: Proje
+00006190: 6374 2074 6861 7420 7468 6520 7275 6e73  ct that the runs
+000061a0: 2062 656c 6f6e 6773 2074 6f2e 0a20 2020   belongs to..   
+000061b0: 2020 2020 203a 7061 7261 6d20 6c61 6265       :param labe
+000061c0: 6c73 3a20 4c69 7374 2072 756e 7320 7468  ls: List runs th
+000061d0: 6174 2068 6176 6520 6120 7370 6563 6966  at have a specif
+000061e0: 6963 206c 6162 656c 2061 7373 6967 6e65  ic label assigne
+000061f0: 642e 2043 7572 7265 6e74 6c79 206f 6e6c  d. Currently onl
+00006200: 7920 6120 7369 6e67 6c65 206c 6162 656c  y a single label
+00006210: 2066 696c 7465 7220 6361 6e20 6265 0a20   filter can be. 
+00006220: 2020 2020 2020 2020 2020 2061 7070 6c69             appli
+00006230: 6564 2c20 6f74 6865 7277 6973 6520 7265  ed, otherwise re
+00006240: 7375 6c74 2077 696c 6c20 6265 2065 6d70  sult will be emp
+00006250: 7479 2e0a 2020 2020 2020 2020 3a70 6172  ty..        :par
+00006260: 616d 2073 7461 7465 3a20 4c69 7374 206f  am state: List o
+00006270: 6e6c 7920 7275 6e73 2077 686f 7365 2073  nly runs whose s
+00006280: 7461 7465 2069 7320 7370 6563 6966 6965  tate is specifie
+00006290: 642e 0a20 2020 2020 2020 203a 7061 7261  d..        :para
+000062a0: 6d20 736f 7274 3a20 5768 6574 6865 7220  m sort: Whether 
+000062b0: 746f 2073 6f72 7420 7468 6520 7265 7375  to sort the resu
+000062c0: 6c74 2061 6363 6f72 6469 6e67 2074 6f20  lt according to 
+000062d0: 7468 6569 7220 7374 6172 7420 7469 6d65  their start time
+000062e0: 2e20 4f74 6865 7277 6973 652c 2072 6573  . Otherwise, res
+000062f0: 756c 7473 2077 696c 6c20 6265 0a20 2020  ults will be.   
+00006300: 2020 2020 2020 2020 2072 6574 7572 6e65           returne
+00006310: 6420 6279 2074 6865 6972 2069 6e74 6572  d by their inter
+00006320: 6e61 6c20 6f72 6465 7220 696e 2074 6865  nal order in the
+00006330: 2044 4220 286f 7264 6572 2077 696c 6c20   DB (order will 
+00006340: 6e6f 7420 6265 2067 7561 7261 6e74 6565  not be guarantee
+00006350: 6429 2e0a 2020 2020 2020 2020 3a70 6172  d)..        :par
+00006360: 616d 206c 6173 743a 2044 6570 7265 6361  am last: Depreca
+00006370: 7465 6420 2d20 6375 7272 656e 746c 7920  ted - currently 
+00006380: 6e6f 7420 7573 6564 2e0a 2020 2020 2020  not used..      
+00006390: 2020 3a70 6172 616d 2069 7465 723a 2049    :param iter: I
+000063a0: 6620 6060 5472 7565 6060 2072 6574 7572  f ``True`` retur
+000063b0: 6e20 7275 6e73 2066 726f 6d20 616c 6c20  n runs from all 
+000063c0: 6974 6572 6174 696f 6e73 2e20 4f74 6865  iterations. Othe
+000063d0: 7277 6973 652c 2072 6574 7572 6e20 6f6e  rwise, return on
+000063e0: 6c79 2072 756e 7320 7768 6f73 6520 6060  ly runs whose ``
+000063f0: 6974 6572 6060 2069 7320 302e 0a20 2020  iter`` is 0..   
+00006400: 2020 2020 203a 7061 7261 6d20 7374 6172       :param star
+00006410: 745f 7469 6d65 5f66 726f 6d3a 2046 696c  t_time_from: Fil
+00006420: 7465 7220 6279 2072 756e 2073 7461 7274  ter by run start
+00006430: 2074 696d 6520 696e 2060 605b 7374 6172   time in ``[star
+00006440: 745f 7469 6d65 5f66 726f 6d2c 2073 7461  t_time_from, sta
+00006450: 7274 5f74 696d 655f 746f 5d60 602e 0a20  rt_time_to]``.. 
+00006460: 2020 2020 2020 203a 7061 7261 6d20 7374         :param st
+00006470: 6172 745f 7469 6d65 5f74 6f3a 2046 696c  art_time_to: Fil
+00006480: 7465 7220 6279 2072 756e 2073 7461 7274  ter by run start
+00006490: 2074 696d 6520 696e 2060 605b 7374 6172   time in ``[star
+000064a0: 745f 7469 6d65 5f66 726f 6d2c 2073 7461  t_time_from, sta
+000064b0: 7274 5f74 696d 655f 746f 5d60 602e 0a20  rt_time_to]``.. 
+000064c0: 2020 2020 2020 203a 7061 7261 6d20 6c61         :param la
+000064d0: 7374 5f75 7064 6174 655f 7469 6d65 5f66  st_update_time_f
+000064e0: 726f 6d3a 2046 696c 7465 7220 6279 2072  rom: Filter by r
+000064f0: 756e 206c 6173 7420 7570 6461 7465 2074  un last update t
+00006500: 696d 6520 696e 2060 6028 6c61 7374 5f75  ime in ``(last_u
+00006510: 7064 6174 655f 7469 6d65 5f66 726f 6d2c  pdate_time_from,
+00006520: 0a20 2020 2020 2020 2020 2020 206c 6173  .            las
+00006530: 745f 7570 6461 7465 5f74 696d 655f 746f  t_update_time_to
+00006540: 2960 602e 0a20 2020 2020 2020 203a 7061  )``..        :pa
+00006550: 7261 6d20 6c61 7374 5f75 7064 6174 655f  ram last_update_
+00006560: 7469 6d65 5f74 6f3a 2046 696c 7465 7220  time_to: Filter 
+00006570: 6279 2072 756e 206c 6173 7420 7570 6461  by run last upda
+00006580: 7465 2074 696d 6520 696e 2060 6028 6c61  te time in ``(la
+00006590: 7374 5f75 7064 6174 655f 7469 6d65 5f66  st_update_time_f
+000065a0: 726f 6d2c 206c 6173 745f 7570 6461 7465  rom, last_update
+000065b0: 5f74 696d 655f 746f 2960 602e 0a20 2020  _time_to)``..   
+000065c0: 2020 2020 203a 7061 7261 6d20 7061 7274       :param part
+000065d0: 6974 696f 6e5f 6279 3a20 4669 656c 6420  ition_by: Field 
+000065e0: 746f 2067 726f 7570 2072 6573 756c 7473  to group results
+000065f0: 2062 792e 204f 6e6c 7920 616c 6c6f 7765   by. Only allowe
+00006600: 6420 7661 6c75 6520 6973 2060 6e61 6d65  d value is `name
+00006610: 602e 2057 6865 6e20 6070 6172 7469 7469  `. When `partiti
+00006620: 6f6e 5f62 7960 2069 7320 7370 6563 6966  on_by` is specif
+00006630: 6965 642c 0a20 2020 2020 2020 2020 2020  ied,.           
+00006640: 2074 6865 2060 7061 7274 6974 696f 6e5f   the `partition_
+00006650: 736f 7274 5f62 7960 2070 6172 616d 6574  sort_by` paramet
+00006660: 6572 206d 7573 7420 6265 2070 726f 7669  er must be provi
+00006670: 6465 6420 6173 2077 656c 6c2e 0a20 2020  ded as well..   
+00006680: 2020 2020 203a 7061 7261 6d20 726f 7773       :param rows
+00006690: 5f70 6572 5f70 6172 7469 7469 6f6e 3a20  _per_partition: 
+000066a0: 486f 7720 6d61 6e79 2074 6f70 2072 6f77  How many top row
+000066b0: 7320 2870 6572 2073 6f72 7469 6e67 2064  s (per sorting d
+000066c0: 6566 696e 6564 2062 7920 6070 6172 7469  efined by `parti
+000066d0: 7469 6f6e 5f73 6f72 745f 6279 6020 616e  tion_sort_by` an
+000066e0: 6420 6070 6172 7469 7469 6f6e 5f6f 7264  d `partition_ord
+000066f0: 6572 6029 0a20 2020 2020 2020 2020 2020  er`).           
+00006700: 2074 6f20 7265 7475 726e 2070 6572 2067   to return per g
+00006710: 726f 7570 2e20 4465 6661 756c 7420 7661  roup. Default va
+00006720: 6c75 6520 6973 2031 2e0a 2020 2020 2020  lue is 1..      
+00006730: 2020 3a70 6172 616d 2070 6172 7469 7469    :param partiti
+00006740: 6f6e 5f73 6f72 745f 6279 3a20 5768 6174  on_sort_by: What
+00006750: 2066 6965 6c64 2074 6f20 736f 7274 2074   field to sort t
+00006760: 6865 2072 6573 756c 7473 2062 792c 2077  he results by, w
+00006770: 6974 6869 6e20 6561 6368 2070 6172 7469  ithin each parti
+00006780: 7469 6f6e 2064 6566 696e 6564 2062 7920  tion defined by 
+00006790: 6070 6172 7469 7469 6f6e 5f62 7960 2e0a  `partition_by`..
+000067a0: 2020 2020 2020 2020 2020 2020 4375 7272              Curr
+000067b0: 656e 746c 7920 7468 6520 6f6e 6c79 2061  ently the only a
+000067c0: 6c6c 6f77 6564 2076 616c 7565 7320 6172  llowed values ar
+000067d0: 6520 6063 7265 6174 6564 6020 616e 6420  e `created` and 
+000067e0: 6075 7064 6174 6564 602e 0a20 2020 2020  `updated`..     
+000067f0: 2020 203a 7061 7261 6d20 7061 7274 6974     :param partit
+00006800: 696f 6e5f 6f72 6465 723a 204f 7264 6572  ion_order: Order
+00006810: 206f 6620 736f 7274 696e 6720 7769 7468   of sorting with
+00006820: 696e 2070 6172 7469 7469 6f6e 7320 2d20  in partitions - 
+00006830: 6061 7363 6020 6f72 2060 6465 7363 602e  `asc` or `desc`.
+00006840: 2044 6566 6175 6c74 2069 7320 6064 6573   Default is `des
+00006850: 6360 2e0a 2020 2020 2020 2020 3a70 6172  c`..        :par
+00006860: 616d 206d 6178 5f70 6172 7469 7469 6f6e  am max_partition
+00006870: 733a 204d 6178 696d 616c 206e 756d 6265  s: Maximal numbe
+00006880: 7220 6f66 2070 6172 7469 7469 6f6e 7320  r of partitions 
+00006890: 746f 2069 6e63 6c75 6465 2069 6e20 7468  to include in th
+000068a0: 6520 7265 7375 6c74 2e20 4465 6661 756c  e result. Defaul
+000068b0: 7420 6973 2060 3060 2077 6869 6368 206d  t is `0` which m
+000068c0: 6561 6e73 206e 6f0a 2020 2020 2020 2020  eans no.        
+000068d0: 2020 2020 6c69 6d69 742e 0a20 2020 2020      limit..     
+000068e0: 2020 203a 7061 7261 6d20 7769 7468 5f6e     :param with_n
+000068f0: 6f74 6966 6963 6174 696f 6e73 3a20 5265  otifications: Re
+00006900: 7475 726e 2072 756e 7320 7769 7468 206e  turn runs with n
+00006910: 6f74 6966 6963 6174 696f 6e73 2c20 616e  otifications, an
+00006920: 6420 6a6f 696e 2074 6865 6d20 746f 2074  d join them to t
+00006930: 6865 2072 6573 706f 6e73 652e 2044 6566  he response. Def
+00006940: 6175 6c74 2069 7320 6046 616c 7365 602e  ault is `False`.
+00006950: 0a20 2020 2020 2020 2022 2222 0a0a 2020  .        """..  
+00006960: 2020 2020 2020 7072 6f6a 6563 7420 3d20        project = 
+00006970: 7072 6f6a 6563 7420 6f72 2063 6f6e 6669  project or confi
+00006980: 672e 6465 6661 756c 745f 7072 6f6a 6563  g.default_projec
+00006990: 740a 2020 2020 2020 2020 7061 7261 6d73  t.        params
+000069a0: 203d 207b 0a20 2020 2020 2020 2020 2020   = {.           
+000069b0: 2022 6e61 6d65 223a 206e 616d 652c 0a20   "name": name,. 
+000069c0: 2020 2020 2020 2020 2020 2022 7569 6422             "uid"
+000069d0: 3a20 7569 642c 0a20 2020 2020 2020 2020  : uid,.         
+000069e0: 2020 2022 7072 6f6a 6563 7422 3a20 7072     "project": pr
+000069f0: 6f6a 6563 742c 0a20 2020 2020 2020 2020  oject,.         
+00006a00: 2020 2022 6c61 6265 6c22 3a20 6c61 6265     "label": labe
+00006a10: 6c73 206f 7220 5b5d 2c0a 2020 2020 2020  ls or [],.      
+00006a20: 2020 2020 2020 2273 7461 7465 223a 2073        "state": s
+00006a30: 7461 7465 2c0a 2020 2020 2020 2020 2020  tate,.          
+00006a40: 2020 2273 6f72 7422 3a20 626f 6f6c 3273    "sort": bool2s
+00006a50: 7472 2873 6f72 7429 2c0a 2020 2020 2020  tr(sort),.      
+00006a60: 2020 2020 2020 2269 7465 7222 3a20 626f        "iter": bo
+00006a70: 6f6c 3273 7472 2869 7465 7229 2c0a 2020  ol2str(iter),.  
+00006a80: 2020 2020 2020 2020 2020 2273 7461 7274            "start
+00006a90: 5f74 696d 655f 6672 6f6d 223a 2064 6174  _time_from": dat
+00006aa0: 6574 696d 655f 746f 5f69 736f 2873 7461  etime_to_iso(sta
+00006ab0: 7274 5f74 696d 655f 6672 6f6d 292c 0a20  rt_time_from),. 
+00006ac0: 2020 2020 2020 2020 2020 2022 7374 6172             "star
+00006ad0: 745f 7469 6d65 5f74 6f22 3a20 6461 7465  t_time_to": date
+00006ae0: 7469 6d65 5f74 6f5f 6973 6f28 7374 6172  time_to_iso(star
+00006af0: 745f 7469 6d65 5f74 6f29 2c0a 2020 2020  t_time_to),.    
+00006b00: 2020 2020 2020 2020 226c 6173 745f 7570          "last_up
+00006b10: 6461 7465 5f74 696d 655f 6672 6f6d 223a  date_time_from":
+00006b20: 2064 6174 6574 696d 655f 746f 5f69 736f   datetime_to_iso
+00006b30: 286c 6173 745f 7570 6461 7465 5f74 696d  (last_update_tim
+00006b40: 655f 6672 6f6d 292c 0a20 2020 2020 2020  e_from),.       
+00006b50: 2020 2020 2022 6c61 7374 5f75 7064 6174       "last_updat
+00006b60: 655f 7469 6d65 5f74 6f22 3a20 6461 7465  e_time_to": date
+00006b70: 7469 6d65 5f74 6f5f 6973 6f28 6c61 7374  time_to_iso(last
+00006b80: 5f75 7064 6174 655f 7469 6d65 5f74 6f29  _update_time_to)
+00006b90: 2c0a 2020 2020 2020 2020 2020 2020 2277  ,.            "w
+00006ba0: 6974 685f 6e6f 7469 6669 6361 7469 6f6e  ith_notification
+00006bb0: 7322 3a20 7769 7468 5f6e 6f74 6966 6963  s": with_notific
+00006bc0: 6174 696f 6e73 2c0a 2020 2020 2020 2020  ations,.        
+00006bd0: 7d0a 0a20 2020 2020 2020 2069 6620 7061  }..        if pa
+00006be0: 7274 6974 696f 6e5f 6279 3a0a 2020 2020  rtition_by:.    
+00006bf0: 2020 2020 2020 2020 7061 7261 6d73 2e75          params.u
+00006c00: 7064 6174 6528 0a20 2020 2020 2020 2020  pdate(.         
+00006c10: 2020 2020 2020 2073 656c 662e 5f67 656e         self._gen
+00006c20: 6572 6174 655f 7061 7274 6974 696f 6e5f  erate_partition_
+00006c30: 6279 5f70 6172 616d 7328 0a20 2020 2020  by_params(.     
+00006c40: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+00006c50: 6368 656d 6173 2e52 756e 5061 7274 6974  chemas.RunPartit
+00006c60: 696f 6e42 7946 6965 6c64 2c0a 2020 2020  ionByField,.    
+00006c70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00006c80: 7061 7274 6974 696f 6e5f 6279 2c0a 2020  partition_by,.  
+00006c90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00006ca0: 2020 726f 7773 5f70 6572 5f70 6172 7469    rows_per_parti
+00006cb0: 7469 6f6e 2c0a 2020 2020 2020 2020 2020  tion,.          
+00006cc0: 2020 2020 2020 2020 2020 7061 7274 6974            partit
+00006cd0: 696f 6e5f 736f 7274 5f62 792c 0a20 2020  ion_sort_by,.   
+00006ce0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00006cf0: 2070 6172 7469 7469 6f6e 5f6f 7264 6572   partition_order
+00006d00: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00006d10: 2020 2020 2020 6d61 785f 7061 7274 6974        max_partit
+00006d20: 696f 6e73 2c0a 2020 2020 2020 2020 2020  ions,.          
+00006d30: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+00006d40: 2020 2020 290a 2020 2020 2020 2020 6572      ).        er
+00006d50: 726f 7220 3d20 226c 6973 7420 7275 6e73  ror = "list runs
+00006d60: 220a 2020 2020 2020 2020 7265 7370 203d  ".        resp =
+00006d70: 2073 656c 662e 6170 695f 6361 6c6c 2822   self.api_call("
+00006d80: 4745 5422 2c20 2272 756e 7322 2c20 6572  GET", "runs", er
+00006d90: 726f 722c 2070 6172 616d 733d 7061 7261  ror, params=para
+00006da0: 6d73 290a 2020 2020 2020 2020 7265 7475  ms).        retu
+00006db0: 726e 2052 756e 4c69 7374 2872 6573 702e  rn RunList(resp.
+00006dc0: 6a73 6f6e 2829 5b22 7275 6e73 225d 290a  json()["runs"]).
+00006dd0: 0a20 2020 2064 6566 2064 656c 5f72 756e  .    def del_run
+00006de0: 7328 7365 6c66 2c20 6e61 6d65 3d4e 6f6e  s(self, name=Non
+00006df0: 652c 2070 726f 6a65 6374 3d4e 6f6e 652c  e, project=None,
+00006e00: 206c 6162 656c 733d 4e6f 6e65 2c20 7374   labels=None, st
+00006e10: 6174 653d 4e6f 6e65 2c20 6461 7973 5f61  ate=None, days_a
+00006e20: 676f 3d30 293a 0a20 2020 2020 2020 2022  go=0):.        "
+00006e30: 2222 4465 6c65 7465 2061 2067 726f 7570  ""Delete a group
+00006e40: 206f 6620 7275 6e73 2069 6465 6e74 6966   of runs identif
+00006e50: 6965 6420 6279 2074 6865 2070 6172 616d  ied by the param
+00006e60: 6574 6572 7320 6f66 2074 6865 2066 756e  eters of the fun
+00006e70: 6374 696f 6e2e 0a0a 2020 2020 2020 2020  ction...        
+00006e80: 4578 616d 706c 653a 3a0a 0a20 2020 2020  Example::..     
+00006e90: 2020 2020 2020 2064 622e 6465 6c5f 7275         db.del_ru
+00006ea0: 6e73 2873 7461 7465 3d27 636f 6d70 6c65  ns(state='comple
+00006eb0: 7465 6427 290a 0a20 2020 2020 2020 203a  ted')..        :
+00006ec0: 7061 7261 6d20 6e61 6d65 3a20 4e61 6d65  param name: Name
+00006ed0: 206f 6620 7468 6520 7461 736b 2077 6869   of the task whi
+00006ee0: 6368 2074 6865 2072 756e 7320 6265 6c6f  ch the runs belo
+00006ef0: 6e67 2074 6f2e 0a20 2020 2020 2020 203a  ng to..        :
+00006f00: 7061 7261 6d20 7072 6f6a 6563 743a 2050  param project: P
+00006f10: 726f 6a65 6374 2074 6f20 7768 6963 6820  roject to which 
+00006f20: 7468 6520 7275 6e73 2062 656c 6f6e 672e  the runs belong.
+00006f30: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
+00006f40: 6c61 6265 6c73 3a20 4669 6c74 6572 2072  labels: Filter r
+00006f50: 756e 7320 7468 6174 2061 7265 206c 6162  uns that are lab
+00006f60: 656c 6564 2075 7369 6e67 2074 6865 7365  eled using these
+00006f70: 2073 7065 6369 6669 6320 6c61 6265 6c20   specific label 
+00006f80: 7661 6c75 6573 2e0a 2020 2020 2020 2020  values..        
+00006f90: 3a70 6172 616d 2073 7461 7465 3a20 4669  :param state: Fi
+00006fa0: 6c74 6572 206f 6e6c 7920 7275 6e73 2077  lter only runs w
+00006fb0: 6869 6368 2061 7265 2069 6e20 7468 6973  hich are in this
+00006fc0: 2073 7461 7465 2e0a 2020 2020 2020 2020   state..        
+00006fd0: 3a70 6172 616d 2064 6179 735f 6167 6f3a  :param days_ago:
+00006fe0: 2046 696c 7465 7220 7275 6e73 2077 686f   Filter runs who
+00006ff0: 7365 2073 7461 7274 2074 696d 6520 6973  se start time is
+00007000: 206e 6577 6572 2074 6861 6e20 7468 6973   newer than this
+00007010: 2070 6172 616d 6574 6572 2e0a 2020 2020   parameter..    
+00007020: 2020 2020 2222 220a 0a20 2020 2020 2020      """..       
+00007030: 2070 726f 6a65 6374 203d 2070 726f 6a65   project = proje
+00007040: 6374 206f 7220 636f 6e66 6967 2e64 6566  ct or config.def
+00007050: 6175 6c74 5f70 726f 6a65 6374 0a20 2020  ault_project.   
+00007060: 2020 2020 2070 6172 616d 7320 3d20 7b0a       params = {.
+00007070: 2020 2020 2020 2020 2020 2020 226e 616d              "nam
+00007080: 6522 3a20 6e61 6d65 2c0a 2020 2020 2020  e": name,.      
+00007090: 2020 2020 2020 2270 726f 6a65 6374 223a        "project":
+000070a0: 2070 726f 6a65 6374 2c0a 2020 2020 2020   project,.      
+000070b0: 2020 2020 2020 226c 6162 656c 223a 206c        "label": l
+000070c0: 6162 656c 7320 6f72 205b 5d2c 0a20 2020  abels or [],.   
+000070d0: 2020 2020 2020 2020 2022 7374 6174 6522           "state"
+000070e0: 3a20 7374 6174 652c 0a20 2020 2020 2020  : state,.       
+000070f0: 2020 2020 2022 6461 7973 5f61 676f 223a       "days_ago":
+00007100: 2073 7472 2864 6179 735f 6167 6f29 2c0a   str(days_ago),.
+00007110: 2020 2020 2020 2020 7d0a 2020 2020 2020          }.      
+00007120: 2020 6572 726f 7220 3d20 2264 656c 2072    error = "del r
+00007130: 756e 7322 0a20 2020 2020 2020 2073 656c  uns".        sel
+00007140: 662e 6170 695f 6361 6c6c 2822 4445 4c45  f.api_call("DELE
+00007150: 5445 222c 2022 7275 6e73 222c 2065 7272  TE", "runs", err
+00007160: 6f72 2c20 7061 7261 6d73 3d70 6172 616d  or, params=param
+00007170: 7329 0a0a 2020 2020 6465 6620 7374 6f72  s)..    def stor
+00007180: 655f 6172 7469 6661 6374 2873 656c 662c  e_artifact(self,
+00007190: 206b 6579 2c20 6172 7469 6661 6374 2c20   key, artifact, 
+000071a0: 7569 642c 2069 7465 723d 4e6f 6e65 2c20  uid, iter=None, 
+000071b0: 7461 673d 4e6f 6e65 2c20 7072 6f6a 6563  tag=None, projec
+000071c0: 743d 2222 293a 0a20 2020 2020 2020 2022  t=""):.        "
+000071d0: 2222 5374 6f72 6520 616e 2061 7274 6966  ""Store an artif
+000071e0: 6163 7420 696e 2074 6865 2044 422e 0a0a  act in the DB...
+000071f0: 2020 2020 2020 2020 3a70 6172 616d 206b          :param k
+00007200: 6579 3a20 4964 656e 7469 6679 696e 6720  ey: Identifying 
+00007210: 6b65 7920 6f66 2074 6865 2061 7274 6966  key of the artif
+00007220: 6163 742e 0a20 2020 2020 2020 203a 7061  act..        :pa
+00007230: 7261 6d20 6172 7469 6661 6374 3a20 5468  ram artifact: Th
+00007240: 6520 6163 7475 616c 2061 7274 6966 6163  e actual artifac
+00007250: 7420 746f 2073 746f 7265 2e0a 2020 2020  t to store..    
+00007260: 2020 2020 3a70 6172 616d 2075 6964 3a20      :param uid: 
+00007270: 4120 756e 6971 7565 2049 4420 666f 7220  A unique ID for 
+00007280: 7468 6973 2073 7065 6369 6669 6320 7665  this specific ve
+00007290: 7273 696f 6e20 6f66 2074 6865 2061 7274  rsion of the art
+000072a0: 6966 6163 742e 0a20 2020 2020 2020 203a  ifact..        :
+000072b0: 7061 7261 6d20 6974 6572 3a20 5468 6520  param iter: The 
+000072c0: 7461 736b 2069 7465 7261 7469 6f6e 2077  task iteration w
+000072d0: 6869 6368 2067 656e 6572 6174 6564 2074  hich generated t
+000072e0: 6869 7320 6172 7469 6661 6374 2e20 4966  his artifact. If
+000072f0: 2060 6069 7465 7260 6020 6973 206e 6f74   ``iter`` is not
+00007300: 2060 604e 6f6e 6560 6020 7468 6520 6974   ``None`` the it
+00007310: 6572 6174 696f 6e20 7769 6c6c 0a20 2020  eration will.   
+00007320: 2020 2020 2020 2020 2062 6520 6164 6465           be adde
+00007330: 6420 746f 2074 6865 206b 6579 2070 726f  d to the key pro
+00007340: 7669 6465 6420 746f 2067 656e 6572 6174  vided to generat
+00007350: 6520 6120 756e 6971 7565 206b 6579 2066  e a unique key f
+00007360: 6f72 2074 6865 2061 7274 6966 6163 7420  or the artifact 
+00007370: 6f66 2074 6865 2073 7065 6369 6669 6320  of the specific 
+00007380: 6974 6572 6174 696f 6e2e 0a20 2020 2020  iteration..     
+00007390: 2020 203a 7061 7261 6d20 7461 673a 2054     :param tag: T
+000073a0: 6167 206f 6620 7468 6520 6172 7469 6661  ag of the artifa
+000073b0: 6374 2e0a 2020 2020 2020 2020 3a70 6172  ct..        :par
+000073c0: 616d 2070 726f 6a65 6374 3a20 5072 6f6a  am project: Proj
+000073d0: 6563 7420 7468 6174 2074 6865 2061 7274  ect that the art
+000073e0: 6966 6163 7420 6265 6c6f 6e67 7320 746f  ifact belongs to
+000073f0: 2e0a 2020 2020 2020 2020 2222 220a 0a20  ..        """.. 
+00007400: 2020 2020 2020 2065 6e64 706f 696e 745f         endpoint_
+00007410: 7061 7468 203d 2066 2270 726f 6a65 6374  path = f"project
+00007420: 732f 7b70 726f 6a65 6374 7d2f 6172 7469  s/{project}/arti
+00007430: 6661 6374 732f 7b75 6964 7d2f 7b6b 6579  facts/{uid}/{key
+00007440: 7d22 0a20 2020 2020 2020 2070 6172 616d  }".        param
+00007450: 7320 3d20 7b0a 2020 2020 2020 2020 2020  s = {.          
+00007460: 2020 2274 6167 223a 2074 6167 2c0a 2020    "tag": tag,.  
+00007470: 2020 2020 2020 7d0a 2020 2020 2020 2020        }.        
+00007480: 6966 2069 7465 723a 0a20 2020 2020 2020  if iter:.       
+00007490: 2020 2020 2070 6172 616d 735b 2269 7465       params["ite
+000074a0: 7222 5d20 3d20 7374 7228 6974 6572 290a  r"] = str(iter).
+000074b0: 0a20 2020 2020 2020 2065 7272 6f72 203d  .        error =
+000074c0: 2066 2273 746f 7265 2061 7274 6966 6163   f"store artifac
+000074d0: 7420 7b70 726f 6a65 6374 7d2f 7b75 6964  t {project}/{uid
+000074e0: 7d2f 7b6b 6579 7d22 0a0a 2020 2020 2020  }/{key}"..      
+000074f0: 2020 626f 6479 203d 205f 6173 5f6a 736f    body = _as_jso
+00007500: 6e28 6172 7469 6661 6374 290a 2020 2020  n(artifact).    
+00007510: 2020 2020 7365 6c66 2e61 7069 5f63 616c      self.api_cal
+00007520: 6c28 2250 4f53 5422 2c20 656e 6470 6f69  l("POST", endpoi
+00007530: 6e74 5f70 6174 682c 2065 7272 6f72 2c20  nt_path, error, 
+00007540: 7061 7261 6d73 3d70 6172 616d 732c 2062  params=params, b
+00007550: 6f64 793d 626f 6479 290a 0a20 2020 2064  ody=body)..    d
+00007560: 6566 2072 6561 645f 6172 7469 6661 6374  ef read_artifact
+00007570: 2873 656c 662c 206b 6579 2c20 7461 673d  (self, key, tag=
+00007580: 4e6f 6e65 2c20 6974 6572 3d4e 6f6e 652c  None, iter=None,
+00007590: 2070 726f 6a65 6374 3d22 2229 3a0a 2020   project=""):.  
+000075a0: 2020 2020 2020 2222 2252 6561 6420 616e        """Read an
+000075b0: 2061 7274 6966 6163 742c 2069 6465 6e74   artifact, ident
+000075c0: 6966 6965 6420 6279 2069 7473 206b 6579  ified by its key
+000075d0: 2c20 7461 6720 616e 6420 6974 6572 6174  , tag and iterat
+000075e0: 696f 6e2e 2222 220a 0a20 2020 2020 2020  ion."""..       
+000075f0: 2070 726f 6a65 6374 203d 2070 726f 6a65   project = proje
+00007600: 6374 206f 7220 636f 6e66 6967 2e64 6566  ct or config.def
+00007610: 6175 6c74 5f70 726f 6a65 6374 0a20 2020  ault_project.   
+00007620: 2020 2020 2074 6167 203d 2074 6167 206f       tag = tag o
+00007630: 7220 226c 6174 6573 7422 0a20 2020 2020  r "latest".     
+00007640: 2020 2065 6e64 706f 696e 745f 7061 7468     endpoint_path
+00007650: 203d 2066 2270 726f 6a65 6374 732f 7b70   = f"projects/{p
+00007660: 726f 6a65 6374 7d2f 6172 7469 6661 6374  roject}/artifact
+00007670: 732f 7b6b 6579 7d3f 7461 673d 7b74 6167  s/{key}?tag={tag
+00007680: 7d22 0a20 2020 2020 2020 2065 7272 6f72  }".        error
+00007690: 203d 2066 2272 6561 6420 6172 7469 6661   = f"read artifa
+000076a0: 6374 207b 7072 6f6a 6563 747d 2f7b 6b65  ct {project}/{ke
+000076b0: 797d 220a 2020 2020 2020 2020 2320 6578  y}".        # ex
+000076c0: 706c 6963 6974 6c79 2073 6574 2061 7274  plicitly set art
+000076d0: 6966 6163 7473 2066 6f72 6d61 7420 746f  ifacts format to
+000076e0: 2027 6675 6c6c 2720 7369 6e63 6520 6f6c   'full' since ol
+000076f0: 6420 7365 7276 6572 7320 6d61 7920 6465  d servers may de
+00007700: 6661 756c 7420 746f 2027 6c65 6761 6379  fault to 'legacy
+00007710: 270a 2020 2020 2020 2020 7061 7261 6d73  '.        params
+00007720: 203d 207b 2266 6f72 6d61 7422 3a20 7363   = {"format": sc
+00007730: 6865 6d61 732e 4172 7469 6661 6374 7346  hemas.ArtifactsF
+00007740: 6f72 6d61 742e 6675 6c6c 2e76 616c 7565  ormat.full.value
+00007750: 7d0a 2020 2020 2020 2020 6966 2069 7465  }.        if ite
+00007760: 723a 0a20 2020 2020 2020 2020 2020 2070  r:.            p
+00007770: 6172 616d 735b 2269 7465 7222 5d20 3d20  arams["iter"] = 
+00007780: 7374 7228 6974 6572 290a 2020 2020 2020  str(iter).      
+00007790: 2020 7265 7370 203d 2073 656c 662e 6170    resp = self.ap
+000077a0: 695f 6361 6c6c 2822 4745 5422 2c20 656e  i_call("GET", en
+000077b0: 6470 6f69 6e74 5f70 6174 682c 2065 7272  dpoint_path, err
+000077c0: 6f72 2c20 7061 7261 6d73 3d70 6172 616d  or, params=param
+000077d0: 7329 0a20 2020 2020 2020 2072 6574 7572  s).        retur
+000077e0: 6e20 7265 7370 2e6a 736f 6e28 295b 2264  n resp.json()["d
+000077f0: 6174 6122 5d0a 0a20 2020 2064 6566 2064  ata"]..    def d
+00007800: 656c 5f61 7274 6966 6163 7428 7365 6c66  el_artifact(self
+00007810: 2c20 6b65 792c 2074 6167 3d4e 6f6e 652c  , key, tag=None,
+00007820: 2070 726f 6a65 6374 3d22 2229 3a0a 2020   project=""):.  
+00007830: 2020 2020 2020 2222 2244 656c 6574 6520        """Delete 
+00007840: 616e 2061 7274 6966 6163 742e 2222 220a  an artifact.""".
+00007850: 0a20 2020 2020 2020 2065 6e64 706f 696e  .        endpoin
+00007860: 745f 7061 7468 203d 2066 2270 726f 6a65  t_path = f"proje
+00007870: 6374 732f 7b70 726f 6a65 6374 7d2f 6172  cts/{project}/ar
+00007880: 7469 6661 6374 732f 7b6b 6579 7d22 0a20  tifacts/{key}". 
+00007890: 2020 2020 2020 2070 6172 616d 7320 3d20         params = 
+000078a0: 7b0a 2020 2020 2020 2020 2020 2020 226b  {.            "k
+000078b0: 6579 223a 206b 6579 2c0a 2020 2020 2020  ey": key,.      
+000078c0: 2020 2020 2020 2274 6167 223a 2074 6167        "tag": tag
+000078d0: 2c0a 2020 2020 2020 2020 7d0a 2020 2020  ,.        }.    
+000078e0: 2020 2020 6572 726f 7220 3d20 6622 6465      error = f"de
+000078f0: 6c20 6172 7469 6661 6374 207b 7072 6f6a  l artifact {proj
+00007900: 6563 747d 2f7b 6b65 797d 220a 2020 2020  ect}/{key}".    
+00007910: 2020 2020 7365 6c66 2e61 7069 5f63 616c      self.api_cal
+00007920: 6c28 2244 454c 4554 4522 2c20 656e 6470  l("DELETE", endp
+00007930: 6f69 6e74 5f70 6174 682c 2065 7272 6f72  oint_path, error
+00007940: 2c20 7061 7261 6d73 3d70 6172 616d 7329  , params=params)
+00007950: 0a0a 2020 2020 6465 6620 6c69 7374 5f61  ..    def list_a
+00007960: 7274 6966 6163 7473 280a 2020 2020 2020  rtifacts(.      
+00007970: 2020 7365 6c66 2c0a 2020 2020 2020 2020    self,.        
+00007980: 6e61 6d65 3d4e 6f6e 652c 0a20 2020 2020  name=None,.     
+00007990: 2020 2070 726f 6a65 6374 3d4e 6f6e 652c     project=None,
+000079a0: 0a20 2020 2020 2020 2074 6167 3d4e 6f6e  .        tag=Non
+000079b0: 652c 0a20 2020 2020 2020 206c 6162 656c  e,.        label
+000079c0: 733a 204f 7074 696f 6e61 6c5b 556e 696f  s: Optional[Unio
+000079d0: 6e5b 4469 6374 5b73 7472 2c20 7374 725d  n[Dict[str, str]
+000079e0: 2c20 4c69 7374 5b73 7472 5d5d 5d20 3d20  , List[str]]] = 
+000079f0: 4e6f 6e65 2c0a 2020 2020 2020 2020 7369  None,.        si
+00007a00: 6e63 653d 4e6f 6e65 2c0a 2020 2020 2020  nce=None,.      
+00007a10: 2020 756e 7469 6c3d 4e6f 6e65 2c0a 2020    until=None,.  
+00007a20: 2020 2020 2020 6974 6572 3a20 696e 7420        iter: int 
+00007a30: 3d20 4e6f 6e65 2c0a 2020 2020 2020 2020  = None,.        
+00007a40: 6265 7374 5f69 7465 7261 7469 6f6e 3a20  best_iteration: 
+00007a50: 626f 6f6c 203d 2046 616c 7365 2c0a 2020  bool = False,.  
+00007a60: 2020 2020 2020 6b69 6e64 3a20 7374 7220        kind: str 
+00007a70: 3d20 4e6f 6e65 2c0a 2020 2020 2020 2020  = None,.        
+00007a80: 6361 7465 676f 7279 3a20 556e 696f 6e5b  category: Union[
+00007a90: 7374 722c 2073 6368 656d 6173 2e41 7274  str, schemas.Art
+00007aa0: 6966 6163 7443 6174 6567 6f72 6965 735d  ifactCategories]
+00007ab0: 203d 204e 6f6e 652c 0a20 2020 2029 202d   = None,.    ) -
+00007ac0: 3e20 4172 7469 6661 6374 4c69 7374 3a0a  > ArtifactList:.
+00007ad0: 2020 2020 2020 2020 2222 224c 6973 7420          """List 
+00007ae0: 6172 7469 6661 6374 7320 6669 6c74 6572  artifacts filter
+00007af0: 6564 2062 7920 7661 7269 6f75 7320 7061  ed by various pa
+00007b00: 7261 6d65 7465 7273 2e0a 0a20 2020 2020  rameters...     
+00007b10: 2020 2045 7861 6d70 6c65 733a 3a0a 0a20     Examples::.. 
+00007b20: 2020 2020 2020 2020 2020 2023 2053 686f             # Sho
+00007b30: 7720 6c61 7465 7374 2076 6572 7369 6f6e  w latest version
+00007b40: 206f 6620 616c 6c20 6172 7469 6661 6374   of all artifact
+00007b50: 7320 696e 2070 726f 6a65 6374 0a20 2020  s in project.   
+00007b60: 2020 2020 2020 2020 206c 6174 6573 745f           latest_
+00007b70: 6172 7469 6661 6374 7320 3d20 6462 2e6c  artifacts = db.l
+00007b80: 6973 745f 6172 7469 6661 6374 7328 2727  ist_artifacts(''
+00007b90: 2c20 7461 673d 276c 6174 6573 7427 2c20  , tag='latest', 
+00007ba0: 7072 6f6a 6563 743d 2769 7269 7327 290a  project='iris').
+00007bb0: 2020 2020 2020 2020 2020 2020 2320 6368              # ch
+00007bc0: 6563 6b20 6469 6666 6572 656e 7420 6172  eck different ar
+00007bd0: 7469 6661 6374 2076 6572 7369 6f6e 7320  tifact versions 
+00007be0: 666f 7220 6120 7370 6563 6966 6963 2061  for a specific a
+00007bf0: 7274 6966 6163 740a 2020 2020 2020 2020  rtifact.        
+00007c00: 2020 2020 7265 7375 6c74 5f76 6572 7369      result_versi
+00007c10: 6f6e 7320 3d20 6462 2e6c 6973 745f 6172  ons = db.list_ar
+00007c20: 7469 6661 6374 7328 2772 6573 756c 7473  tifacts('results
+00007c30: 272c 2074 6167 3d27 2a27 2c20 7072 6f6a  ', tag='*', proj
+00007c40: 6563 743d 2769 7269 7327 290a 2020 2020  ect='iris').    
+00007c50: 2020 2020 2020 2020 2320 5368 6f77 2061          # Show a
+00007c60: 7274 6966 6163 7473 2077 6974 6820 6c61  rtifacts with la
+00007c70: 6265 6c20 6669 6c74 6572 7320 2d20 626f  bel filters - bo
+00007c80: 7468 2075 706c 6f61 6465 6420 616e 6420  th uploaded and 
+00007c90: 6f66 2062 696e 6172 7920 7479 7065 0a20  of binary type. 
+00007ca0: 2020 2020 2020 2020 2020 2072 6573 756c             resul
+00007cb0: 745f 6c61 6265 6c73 203d 2064 622e 6c69  t_labels = db.li
+00007cc0: 7374 5f61 7274 6966 6163 7473 2827 7265  st_artifacts('re
+00007cd0: 7375 6c74 7327 2c20 7461 673d 272a 272c  sults', tag='*',
+00007ce0: 2070 726f 6a65 6374 3d27 6972 6973 272c   project='iris',
+00007cf0: 206c 6162 656c 733d 5b27 7570 6c6f 6164   labels=['upload
+00007d00: 6564 272c 2027 7479 7065 3d62 696e 6172  ed', 'type=binar
+00007d10: 7927 5d29 0a0a 2020 2020 2020 2020 3a70  y'])..        :p
+00007d20: 6172 616d 206e 616d 653a 204e 616d 6520  aram name: Name 
+00007d30: 6f66 2061 7274 6966 6163 7473 2074 6f20  of artifacts to 
+00007d40: 7265 7472 6965 7665 2e20 4e61 6d65 2069  retrieve. Name i
+00007d50: 7320 7573 6564 2061 7320 6120 6c69 6b65  s used as a like
+00007d60: 2071 7565 7279 2c20 616e 6420 6973 206e   query, and is n
+00007d70: 6f74 2063 6173 652d 7365 6e73 6974 6976  ot case-sensitiv
+00007d80: 652e 2054 6869 7320 6d65 616e 730a 2020  e. This means.  
+00007d90: 2020 2020 2020 2020 2020 7468 6174 2071            that q
+00007da0: 7565 7279 696e 6720 666f 7220 6060 6e61  uerying for ``na
+00007db0: 6d65 6060 206d 6179 2072 6574 7572 6e20  me`` may return 
+00007dc0: 6172 7469 6661 6374 7320 6e61 6d65 6420  artifacts named 
+00007dd0: 6060 6d79 5f4e 616d 655f 3160 6020 6f72  ``my_Name_1`` or
+00007de0: 2060 6073 7572 6e61 6d65 6060 2e0a 2020   ``surname``..  
+00007df0: 2020 2020 2020 3a70 6172 616d 2070 726f        :param pro
+00007e00: 6a65 6374 3a20 5072 6f6a 6563 7420 6e61  ject: Project na
+00007e10: 6d65 2e0a 2020 2020 2020 2020 3a70 6172  me..        :par
+00007e20: 616d 2074 6167 3a20 5265 7475 726e 2061  am tag: Return a
+00007e30: 7274 6966 6163 7473 2061 7373 6967 6e65  rtifacts assigne
+00007e40: 6420 7468 6973 2074 6167 2e0a 2020 2020  d this tag..    
+00007e50: 2020 2020 3a70 6172 616d 206c 6162 656c      :param label
+00007e60: 733a 2052 6574 7572 6e20 6172 7469 6661  s: Return artifa
+00007e70: 6374 7320 7468 6174 2068 6176 6520 7468  cts that have th
+00007e80: 6573 6520 6c61 6265 6c73 2e20 4c61 6265  ese labels. Labe
+00007e90: 6c73 2063 616e 2065 6974 6865 7220 6265  ls can either be
+00007ea0: 2061 2064 6963 7469 6f6e 6172 7920 7b22   a dictionary {"
+00007eb0: 6c61 6265 6c22 3a20 2276 616c 7565 227d  label": "value"}
+00007ec0: 206f 720a 2020 2020 2020 2020 2020 2020   or.            
+00007ed0: 6120 6c69 7374 206f 6620 226c 6162 656c  a list of "label
+00007ee0: 3d76 616c 7565 2220 286d 6174 6368 206c  =value" (match l
+00007ef0: 6162 656c 206b 6579 2061 6e64 2076 616c  abel key and val
+00007f00: 7565 2920 6f72 2022 6c61 6265 6c22 2028  ue) or "label" (
+00007f10: 6d61 7463 6820 6a75 7374 206c 6162 656c  match just label
+00007f20: 206b 6579 2920 7374 7269 6e67 732e 0a20   key) strings.. 
+00007f30: 2020 2020 2020 203a 7061 7261 6d20 7369         :param si
+00007f40: 6e63 653a 204e 6f74 2069 6e20 7573 6520  nce: Not in use 
+00007f50: 696e 203a 7079 3a63 6c61 7373 3a60 4854  in :py:class:`HT
+00007f60: 5450 5275 6e44 4260 2e0a 2020 2020 2020  TPRunDB`..      
+00007f70: 2020 3a70 6172 616d 2075 6e74 696c 3a20    :param until: 
+00007f80: 4e6f 7420 696e 2075 7365 2069 6e20 3a70  Not in use in :p
+00007f90: 793a 636c 6173 733a 6048 5454 5052 756e  y:class:`HTTPRun
+00007fa0: 4442 602e 0a20 2020 2020 2020 203a 7061  DB`..        :pa
+00007fb0: 7261 6d20 6974 6572 3a20 5265 7475 726e  ram iter: Return
+00007fc0: 2061 7274 6966 6163 7473 2066 726f 6d20   artifacts from 
+00007fd0: 6120 7370 6563 6966 6963 2069 7465 7261  a specific itera
+00007fe0: 7469 6f6e 2028 7768 6572 6520 6060 6974  tion (where ``it
+00007ff0: 6572 3d30 6060 206d 6561 6e73 2074 6865  er=0`` means the
+00008000: 2072 6f6f 7420 6974 6572 6174 696f 6e29   root iteration)
+00008010: 2e20 4966 0a20 2020 2020 2020 2020 2020  . If.           
+00008020: 2060 604e 6f6e 6560 6020 2864 6566 6175   ``None`` (defau
+00008030: 6c74 2920 7265 7475 726e 2061 7274 6966  lt) return artif
+00008040: 6163 7473 2066 726f 6d20 616c 6c20 6974  acts from all it
+00008050: 6572 6174 696f 6e73 2e0a 2020 2020 2020  erations..      
+00008060: 2020 3a70 6172 616d 2062 6573 745f 6974    :param best_it
+00008070: 6572 6174 696f 6e3a 2052 6574 7572 6e73  eration: Returns
+00008080: 2074 6865 2061 7274 6966 6163 7420 7768   the artifact wh
+00008090: 6963 6820 6265 6c6f 6e67 7320 746f 2074  ich belongs to t
+000080a0: 6865 2062 6573 7420 6974 6572 6174 696f  he best iteratio
+000080b0: 6e20 6f66 2061 2067 6976 656e 2072 756e  n of a given run
+000080c0: 2c20 696e 2074 6865 2063 6173 6520 6f66  , in the case of
+000080d0: 0a20 2020 2020 2020 2020 2020 2061 7274  .            art
+000080e0: 6966 6163 7473 2067 656e 6572 6174 6564  ifacts generated
+000080f0: 2066 726f 6d20 6120 6879 7065 722d 7061   from a hyper-pa
+00008100: 7261 6d20 7275 6e2e 2049 6620 6f6e 6c79  ram run. If only
+00008110: 2061 2073 696e 676c 6520 6974 6572 6174   a single iterat
+00008120: 696f 6e20 6578 6973 7473 2c20 7769 6c6c  ion exists, will
+00008130: 2072 6574 7572 6e20 7468 6520 6172 7469   return the arti
+00008140: 6661 6374 0a20 2020 2020 2020 2020 2020  fact.           
+00008150: 2066 726f 6d20 7468 6174 2069 7465 7261   from that itera
+00008160: 7469 6f6e 2e20 4966 2075 7369 6e67 2060  tion. If using `
+00008170: 6062 6573 745f 6974 6572 6060 2c20 7468  `best_iter``, th
+00008180: 6520 6060 6974 6572 6060 2070 6172 616d  e ``iter`` param
+00008190: 6574 6572 206d 7573 7420 6e6f 7420 6265  eter must not be
+000081a0: 2075 7365 642e 0a20 2020 2020 2020 203a   used..        :
+000081b0: 7061 7261 6d20 6b69 6e64 3a20 5265 7475  param kind: Retu
+000081c0: 726e 2061 7274 6966 6163 7473 206f 6620  rn artifacts of 
+000081d0: 7468 6520 7265 7175 6573 7465 6420 6b69  the requested ki
+000081e0: 6e64 2e0a 2020 2020 2020 2020 3a70 6172  nd..        :par
+000081f0: 616d 2063 6174 6567 6f72 793a 2052 6574  am category: Ret
+00008200: 7572 6e20 6172 7469 6661 6374 7320 6f66  urn artifacts of
+00008210: 2074 6865 2072 6571 7565 7374 6564 2063   the requested c
+00008220: 6174 6567 6f72 792e 0a20 2020 2020 2020  ategory..       
+00008230: 2022 2222 0a0a 2020 2020 2020 2020 7072   """..        pr
+00008240: 6f6a 6563 7420 3d20 7072 6f6a 6563 7420  oject = project 
+00008250: 6f72 2063 6f6e 6669 672e 6465 6661 756c  or config.defaul
+00008260: 745f 7072 6f6a 6563 740a 0a20 2020 2020  t_project..     
+00008270: 2020 206c 6162 656c 7320 3d20 6c61 6265     labels = labe
+00008280: 6c73 206f 7220 5b5d 0a20 2020 2020 2020  ls or [].       
+00008290: 2069 6620 6973 696e 7374 616e 6365 286c   if isinstance(l
+000082a0: 6162 656c 732c 2064 6963 7429 3a0a 2020  abels, dict):.  
+000082b0: 2020 2020 2020 2020 2020 6c61 6265 6c73            labels
+000082c0: 203d 205b 6622 7b6b 6579 7d3d 7b76 616c   = [f"{key}={val
+000082d0: 7565 7d22 2066 6f72 206b 6579 2c20 7661  ue}" for key, va
+000082e0: 6c75 6520 696e 206c 6162 656c 732e 6974  lue in labels.it
+000082f0: 656d 7328 295d 0a0a 2020 2020 2020 2020  ems()]..        
+00008300: 7061 7261 6d73 203d 207b 0a20 2020 2020  params = {.     
+00008310: 2020 2020 2020 2022 6e61 6d65 223a 206e         "name": n
+00008320: 616d 652c 0a20 2020 2020 2020 2020 2020  ame,.           
+00008330: 2022 7461 6722 3a20 7461 672c 0a20 2020   "tag": tag,.   
+00008340: 2020 2020 2020 2020 2022 6c61 6265 6c22           "label"
+00008350: 3a20 6c61 6265 6c73 2c0a 2020 2020 2020  : labels,.      
+00008360: 2020 2020 2020 2269 7465 7222 3a20 6974        "iter": it
+00008370: 6572 2c0a 2020 2020 2020 2020 2020 2020  er,.            
+00008380: 2262 6573 742d 6974 6572 6174 696f 6e22  "best-iteration"
+00008390: 3a20 6265 7374 5f69 7465 7261 7469 6f6e  : best_iteration
+000083a0: 2c0a 2020 2020 2020 2020 2020 2020 226b  ,.            "k
+000083b0: 696e 6422 3a20 6b69 6e64 2c0a 2020 2020  ind": kind,.    
+000083c0: 2020 2020 2020 2020 2263 6174 6567 6f72          "categor
+000083d0: 7922 3a20 6361 7465 676f 7279 2c0a 2020  y": category,.  
+000083e0: 2020 2020 2020 2020 2020 2266 6f72 6d61            "forma
+000083f0: 7422 3a20 7363 6865 6d61 732e 4172 7469  t": schemas.Arti
+00008400: 6661 6374 7346 6f72 6d61 742e 6675 6c6c  factsFormat.full
+00008410: 2e76 616c 7565 2c0a 2020 2020 2020 2020  .value,.        
+00008420: 7d0a 2020 2020 2020 2020 6572 726f 7220  }.        error 
+00008430: 3d20 226c 6973 7420 6172 7469 6661 6374  = "list artifact
+00008440: 7322 0a20 2020 2020 2020 2065 6e64 706f  s".        endpo
+00008450: 696e 745f 7061 7468 203d 2066 2270 726f  int_path = f"pro
+00008460: 6a65 6374 732f 7b70 726f 6a65 6374 7d2f  jects/{project}/
+00008470: 6172 7469 6661 6374 7322 0a20 2020 2020  artifacts".     
+00008480: 2020 2072 6573 7020 3d20 7365 6c66 2e61     resp = self.a
+00008490: 7069 5f63 616c 6c28 2247 4554 222c 2065  pi_call("GET", e
+000084a0: 6e64 706f 696e 745f 7061 7468 2c20 6572  ndpoint_path, er
+000084b0: 726f 722c 2070 6172 616d 733d 7061 7261  ror, params=para
+000084c0: 6d73 290a 2020 2020 2020 2020 7661 6c75  ms).        valu
+000084d0: 6573 203d 2041 7274 6966 6163 744c 6973  es = ArtifactLis
+000084e0: 7428 7265 7370 2e6a 736f 6e28 295b 2261  t(resp.json()["a
+000084f0: 7274 6966 6163 7473 225d 290a 2020 2020  rtifacts"]).    
+00008500: 2020 2020 7661 6c75 6573 2e74 6167 203d      values.tag =
+00008510: 2074 6167 0a20 2020 2020 2020 2072 6574   tag.        ret
+00008520: 7572 6e20 7661 6c75 6573 0a0a 2020 2020  urn values..    
+00008530: 6465 6620 6465 6c5f 6172 7469 6661 6374  def del_artifact
+00008540: 7328 7365 6c66 2c20 6e61 6d65 3d4e 6f6e  s(self, name=Non
+00008550: 652c 2070 726f 6a65 6374 3d4e 6f6e 652c  e, project=None,
+00008560: 2074 6167 3d4e 6f6e 652c 206c 6162 656c   tag=None, label
+00008570: 733d 4e6f 6e65 2c20 6461 7973 5f61 676f  s=None, days_ago
+00008580: 3d30 293a 0a20 2020 2020 2020 2022 2222  =0):.        """
+00008590: 4465 6c65 7465 2061 7274 6966 6163 7473  Delete artifacts
+000085a0: 2072 6566 6572 656e 6365 6420 6279 2074   referenced by t
+000085b0: 6865 2070 6172 616d 6574 6572 732e 0a0a  he parameters...
+000085c0: 2020 2020 2020 2020 3a70 6172 616d 206e          :param n
+000085d0: 616d 653a 204e 616d 6520 6f66 2061 7274  ame: Name of art
+000085e0: 6966 6163 7473 2074 6f20 6465 6c65 7465  ifacts to delete
+000085f0: 2e20 4e6f 7465 2074 6861 7420 7468 6973  . Note that this
+00008600: 2069 7320 6120 6c69 6b65 2071 7565 7279   is a like query
+00008610: 2c20 616e 6420 6973 2063 6173 652d 696e  , and is case-in
+00008620: 7365 6e73 6974 6976 652e 2053 6565 0a20  sensitive. See. 
+00008630: 2020 2020 2020 2020 2020 203a 7079 3a66             :py:f
+00008640: 756e 633a 607e 6c69 7374 5f61 7274 6966  unc:`~list_artif
+00008650: 6163 7473 6020 666f 7220 6d6f 7265 2064  acts` for more d
+00008660: 6574 6169 6c73 2e0a 2020 2020 2020 2020  etails..        
+00008670: 3a70 6172 616d 2070 726f 6a65 6374 3a20  :param project: 
+00008680: 5072 6f6a 6563 7420 7468 6174 2061 7274  Project that art
+00008690: 6966 6163 7473 2062 656c 6f6e 6720 746f  ifacts belong to
+000086a0: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
+000086b0: 2074 6167 3a20 4368 6f6f 7365 2061 7274   tag: Choose art
+000086c0: 6966 6163 7473 2077 686f 2061 7265 2061  ifacts who are a
+000086d0: 7373 6967 6e65 6420 7468 6973 2074 6167  ssigned this tag
+000086e0: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
+000086f0: 206c 6162 656c 733a 2043 686f 6f73 6520   labels: Choose 
+00008700: 6172 7469 6661 6374 7320 7768 6963 6820  artifacts which 
+00008710: 6172 6520 6c61 6265 6c65 642e 0a20 2020  are labeled..   
+00008720: 2020 2020 203a 7061 7261 6d20 6461 7973       :param days
+00008730: 5f61 676f 3a20 5468 6973 2070 6172 616d  _ago: This param
+00008740: 6574 6572 2069 7320 6465 7072 6563 6174  eter is deprecat
+00008750: 6564 2061 6e64 206e 6f74 2075 7365 642e  ed and not used.
+00008760: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+00008770: 2020 2020 2070 726f 6a65 6374 203d 2070       project = p
+00008780: 726f 6a65 6374 206f 7220 636f 6e66 6967  roject or config
+00008790: 2e64 6566 6175 6c74 5f70 726f 6a65 6374  .default_project
+000087a0: 0a20 2020 2020 2020 2070 6172 616d 7320  .        params 
+000087b0: 3d20 7b0a 2020 2020 2020 2020 2020 2020  = {.            
+000087c0: 226e 616d 6522 3a20 6e61 6d65 2c0a 2020  "name": name,.  
+000087d0: 2020 2020 2020 2020 2020 2274 6167 223a            "tag":
+000087e0: 2074 6167 2c0a 2020 2020 2020 2020 2020   tag,.          
+000087f0: 2020 226c 6162 656c 223a 206c 6162 656c    "label": label
+00008800: 7320 6f72 205b 5d2c 0a20 2020 2020 2020  s or [],.       
+00008810: 2020 2020 2022 6461 7973 5f61 676f 223a       "days_ago":
+00008820: 2073 7472 2864 6179 735f 6167 6f29 2c0a   str(days_ago),.
+00008830: 2020 2020 2020 2020 7d0a 2020 2020 2020          }.      
+00008840: 2020 6572 726f 7220 3d20 2264 656c 2061    error = "del a
+00008850: 7274 6966 6163 7473 220a 2020 2020 2020  rtifacts".      
+00008860: 2020 656e 6470 6f69 6e74 5f70 6174 6820    endpoint_path 
+00008870: 3d20 6622 7072 6f6a 6563 7473 2f7b 7072  = f"projects/{pr
+00008880: 6f6a 6563 747d 2f61 7274 6966 6163 7473  oject}/artifacts
+00008890: 220a 2020 2020 2020 2020 7365 6c66 2e61  ".        self.a
+000088a0: 7069 5f63 616c 6c28 2244 454c 4554 4522  pi_call("DELETE"
+000088b0: 2c20 656e 6470 6f69 6e74 5f70 6174 682c  , endpoint_path,
+000088c0: 2065 7272 6f72 2c20 7061 7261 6d73 3d70   error, params=p
+000088d0: 6172 616d 7329 0a0a 2020 2020 6465 6620  arams)..    def 
+000088e0: 6c69 7374 5f61 7274 6966 6163 745f 7461  list_artifact_ta
+000088f0: 6773 280a 2020 2020 2020 2020 7365 6c66  gs(.        self
+00008900: 2c0a 2020 2020 2020 2020 7072 6f6a 6563  ,.        projec
+00008910: 743d 4e6f 6e65 2c0a 2020 2020 2020 2020  t=None,.        
+00008920: 6361 7465 676f 7279 3a20 556e 696f 6e5b  category: Union[
+00008930: 7374 722c 2073 6368 656d 6173 2e41 7274  str, schemas.Art
+00008940: 6966 6163 7443 6174 6567 6f72 6965 735d  ifactCategories]
+00008950: 203d 204e 6f6e 652c 0a20 2020 2029 202d   = None,.    ) -
+00008960: 3e20 4c69 7374 5b73 7472 5d3a 0a20 2020  > List[str]:.   
+00008970: 2020 2020 2022 2222 5265 7475 726e 2061       """Return a
+00008980: 206c 6973 7420 6f66 2061 6c6c 2074 6865   list of all the
+00008990: 2074 6167 7320 6173 7369 676e 6564 2074   tags assigned t
+000089a0: 6f20 6172 7469 6661 6374 7320 696e 2074  o artifacts in t
+000089b0: 6865 2073 636f 7065 206f 6620 7468 6520  he scope of the 
+000089c0: 6769 7665 6e20 7072 6f6a 6563 742e 2222  given project.""
+000089d0: 220a 0a20 2020 2020 2020 2070 726f 6a65  "..        proje
+000089e0: 6374 203d 2070 726f 6a65 6374 206f 7220  ct = project or 
+000089f0: 636f 6e66 6967 2e64 6566 6175 6c74 5f70  config.default_p
+00008a00: 726f 6a65 6374 0a20 2020 2020 2020 2065  roject.        e
+00008a10: 7272 6f72 5f6d 6573 7361 6765 203d 2066  rror_message = f
+00008a20: 2246 6169 6c65 6420 6c69 7374 696e 6720  "Failed listing 
+00008a30: 6172 7469 6661 6374 2074 6167 732e 2070  artifact tags. p
+00008a40: 726f 6a65 6374 3d7b 7072 6f6a 6563 747d  roject={project}
+00008a50: 220a 2020 2020 2020 2020 7061 7261 6d73  ".        params
+00008a60: 203d 207b 2263 6174 6567 6f72 7922 3a20   = {"category": 
+00008a70: 6361 7465 676f 7279 7d20 6966 2063 6174  category} if cat
+00008a80: 6567 6f72 7920 656c 7365 207b 7d0a 0a20  egory else {}.. 
+00008a90: 2020 2020 2020 2072 6573 706f 6e73 6520         response 
+00008aa0: 3d20 7365 6c66 2e61 7069 5f63 616c 6c28  = self.api_call(
+00008ab0: 0a20 2020 2020 2020 2020 2020 2022 4745  .            "GE
+00008ac0: 5422 2c20 6622 7072 6f6a 6563 7473 2f7b  T", f"projects/{
+00008ad0: 7072 6f6a 6563 747d 2f61 7274 6966 6163  project}/artifac
+00008ae0: 742d 7461 6773 222c 2065 7272 6f72 5f6d  t-tags", error_m
+00008af0: 6573 7361 6765 2c20 7061 7261 6d73 3d70  essage, params=p
+00008b00: 6172 616d 730a 2020 2020 2020 2020 290a  arams.        ).
+00008b10: 2020 2020 2020 2020 7265 7475 726e 2072          return r
+00008b20: 6573 706f 6e73 652e 6a73 6f6e 2829 5b22  esponse.json()["
+00008b30: 7461 6773 225d 0a0a 2020 2020 6465 6620  tags"]..    def 
+00008b40: 7374 6f72 655f 6675 6e63 7469 6f6e 280a  store_function(.
+00008b50: 2020 2020 2020 2020 7365 6c66 2c0a 2020          self,.  
+00008b60: 2020 2020 2020 6675 6e63 7469 6f6e 3a20        function: 
+00008b70: 7479 7069 6e67 2e55 6e69 6f6e 5b6d 6c72  typing.Union[mlr
+00008b80: 756e 2e72 756e 7469 6d65 732e 4261 7365  un.runtimes.Base
+00008b90: 5275 6e74 696d 652c 2064 6963 745d 2c0a  Runtime, dict],.
+00008ba0: 2020 2020 2020 2020 6e61 6d65 2c0a 2020          name,.  
+00008bb0: 2020 2020 2020 7072 6f6a 6563 743d 2222        project=""
+00008bc0: 2c0a 2020 2020 2020 2020 7461 673d 4e6f  ,.        tag=No
+00008bd0: 6e65 2c0a 2020 2020 2020 2020 7665 7273  ne,.        vers
+00008be0: 696f 6e65 643d 4661 6c73 652c 0a20 2020  ioned=False,.   
+00008bf0: 2029 3a0a 2020 2020 2020 2020 2222 2253   ):.        """S
+00008c00: 746f 7265 2061 2066 756e 6374 696f 6e20  tore a function 
+00008c10: 6f62 6a65 6374 2e20 4675 6e63 7469 6f6e  object. Function
+00008c20: 2069 7320 6964 656e 7469 6669 6564 2062   is identified b
+00008c30: 7920 6974 7320 6e61 6d65 2061 6e64 2074  y its name and t
+00008c40: 6167 2c20 616e 6420 6361 6e20 6265 2076  ag, and can be v
+00008c50: 6572 7369 6f6e 6564 2e22 2222 0a20 2020  ersioned.""".   
+00008c60: 2020 2020 206e 616d 6520 3d20 6d6c 7275       name = mlru
+00008c70: 6e2e 7574 696c 732e 6e6f 726d 616c 697a  n.utils.normaliz
+00008c80: 655f 6e61 6d65 286e 616d 6529 0a20 2020  e_name(name).   
+00008c90: 2020 2020 2069 6620 6861 7361 7474 7228       if hasattr(
+00008ca0: 6675 6e63 7469 6f6e 2c20 2274 6f5f 6469  function, "to_di
+00008cb0: 6374 2229 3a0a 2020 2020 2020 2020 2020  ct"):.          
+00008cc0: 2020 6675 6e63 7469 6f6e 203d 2066 756e    function = fun
+00008cd0: 6374 696f 6e2e 746f 5f64 6963 7428 290a  ction.to_dict().
+00008ce0: 0a20 2020 2020 2020 2070 6172 616d 7320  .        params 
+00008cf0: 3d20 7b22 7461 6722 3a20 7461 672c 2022  = {"tag": tag, "
+00008d00: 7665 7273 696f 6e65 6422 3a20 7665 7273  versioned": vers
+00008d10: 696f 6e65 647d 0a20 2020 2020 2020 2070  ioned}.        p
+00008d20: 726f 6a65 6374 203d 2070 726f 6a65 6374  roject = project
+00008d30: 206f 7220 636f 6e66 6967 2e64 6566 6175   or config.defau
+00008d40: 6c74 5f70 726f 6a65 6374 0a20 2020 2020  lt_project.     
+00008d50: 2020 2070 6174 6820 3d20 7365 6c66 2e5f     path = self._
+00008d60: 7061 7468 5f6f 6628 2266 756e 6322 2c20  path_of("func", 
+00008d70: 7072 6f6a 6563 742c 206e 616d 6529 0a0a  project, name)..
+00008d80: 2020 2020 2020 2020 6572 726f 7220 3d20          error = 
+00008d90: 6622 7374 6f72 6520 6675 6e63 7469 6f6e  f"store function
+00008da0: 207b 7072 6f6a 6563 747d 2f7b 6e61 6d65   {project}/{name
+00008db0: 7d22 0a20 2020 2020 2020 2072 6573 7020  }".        resp 
+00008dc0: 3d20 7365 6c66 2e61 7069 5f63 616c 6c28  = self.api_call(
+00008dd0: 0a20 2020 2020 2020 2020 2020 2022 504f  .            "PO
+00008de0: 5354 222c 2070 6174 682c 2065 7272 6f72  ST", path, error
+00008df0: 2c20 7061 7261 6d73 3d70 6172 616d 732c  , params=params,
+00008e00: 2062 6f64 793d 6469 6374 5f74 6f5f 6a73   body=dict_to_js
+00008e10: 6f6e 2866 756e 6374 696f 6e29 0a20 2020  on(function).   
+00008e20: 2020 2020 2029 0a0a 2020 2020 2020 2020       )..        
+00008e30: 2320 6861 7368 206b 6579 206f 7074 696f  # hash key optio
+00008e40: 6e61 6c20 746f 2062 6520 6261 636b 7761  nal to be backwa
+00008e50: 7264 7320 636f 6d70 6174 6962 6c65 2074  rds compatible t
+00008e60: 6f20 4150 4920 763c 302e 342e 3130 2069  o API v<0.4.10 i
+00008e70: 6e20 7768 6963 6820 6974 2077 6173 6e27  n which it wasn'
+00008e80: 7420 696e 2074 6865 2072 6573 706f 6e73  t in the respons
+00008e90: 650a 2020 2020 2020 2020 7265 7475 726e  e.        return
+00008ea0: 2072 6573 702e 6a73 6f6e 2829 2e67 6574   resp.json().get
+00008eb0: 2822 6861 7368 5f6b 6579 2229 0a0a 2020  ("hash_key")..  
+00008ec0: 2020 6465 6620 6765 745f 6675 6e63 7469    def get_functi
+00008ed0: 6f6e 2873 656c 662c 206e 616d 652c 2070  on(self, name, p
+00008ee0: 726f 6a65 6374 3d22 222c 2074 6167 3d4e  roject="", tag=N
+00008ef0: 6f6e 652c 2068 6173 685f 6b65 793d 2222  one, hash_key=""
+00008f00: 293a 0a20 2020 2020 2020 2022 2222 5265  ):.        """Re
+00008f10: 7472 6965 7665 2064 6574 6169 6c73 206f  trieve details o
+00008f20: 6620 6120 7370 6563 6966 6963 2066 756e  f a specific fun
+00008f30: 6374 696f 6e2c 2069 6465 6e74 6966 6965  ction, identifie
+00008f40: 6420 6279 2069 7473 206e 616d 6520 616e  d by its name an
+00008f50: 6420 706f 7465 6e74 6961 6c6c 7920 6120  d potentially a 
+00008f60: 7461 6720 6f72 2066 756e 6374 696f 6e20  tag or function 
+00008f70: 6861 7368 2e22 2222 0a0a 2020 2020 2020  hash."""..      
+00008f80: 2020 7061 7261 6d73 203d 207b 2274 6167    params = {"tag
+00008f90: 223a 2074 6167 2c20 2268 6173 685f 6b65  ": tag, "hash_ke
+00008fa0: 7922 3a20 6861 7368 5f6b 6579 7d0a 2020  y": hash_key}.  
+00008fb0: 2020 2020 2020 7072 6f6a 6563 7420 3d20        project = 
+00008fc0: 7072 6f6a 6563 7420 6f72 2063 6f6e 6669  project or confi
+00008fd0: 672e 6465 6661 756c 745f 7072 6f6a 6563  g.default_projec
+00008fe0: 740a 2020 2020 2020 2020 7061 7468 203d  t.        path =
+00008ff0: 2073 656c 662e 5f70 6174 685f 6f66 2822   self._path_of("
+00009000: 6675 6e63 222c 2070 726f 6a65 6374 2c20  func", project, 
+00009010: 6e61 6d65 290a 2020 2020 2020 2020 6572  name).        er
+00009020: 726f 7220 3d20 6622 6765 7420 6675 6e63  ror = f"get func
+00009030: 7469 6f6e 207b 7072 6f6a 6563 747d 2f7b  tion {project}/{
+00009040: 6e61 6d65 7d22 0a20 2020 2020 2020 2072  name}".        r
+00009050: 6573 7020 3d20 7365 6c66 2e61 7069 5f63  esp = self.api_c
+00009060: 616c 6c28 2247 4554 222c 2070 6174 682c  all("GET", path,
+00009070: 2065 7272 6f72 2c20 7061 7261 6d73 3d70   error, params=p
+00009080: 6172 616d 7329 0a20 2020 2020 2020 2072  arams).        r
+00009090: 6574 7572 6e20 7265 7370 2e6a 736f 6e28  eturn resp.json(
+000090a0: 295b 2266 756e 6322 5d0a 0a20 2020 2064  )["func"]..    d
+000090b0: 6566 2064 656c 6574 655f 6675 6e63 7469  ef delete_functi
+000090c0: 6f6e 2873 656c 662c 206e 616d 653a 2073  on(self, name: s
+000090d0: 7472 2c20 7072 6f6a 6563 743a 2073 7472  tr, project: str
+000090e0: 203d 2022 2229 3a0a 2020 2020 2020 2020   = ""):.        
+000090f0: 2222 2244 656c 6574 6520 6120 6675 6e63  """Delete a func
+00009100: 7469 6f6e 2062 656c 6f6e 6769 6e67 2074  tion belonging t
+00009110: 6f20 6120 7370 6563 6966 6963 2070 726f  o a specific pro
+00009120: 6a65 6374 2e22 2222 0a0a 2020 2020 2020  ject."""..      
+00009130: 2020 7072 6f6a 6563 7420 3d20 7072 6f6a    project = proj
+00009140: 6563 7420 6f72 2063 6f6e 6669 672e 6465  ect or config.de
+00009150: 6661 756c 745f 7072 6f6a 6563 740a 2020  fault_project.  
+00009160: 2020 2020 2020 7061 7468 203d 2066 2270        path = f"p
+00009170: 726f 6a65 6374 732f 7b70 726f 6a65 6374  rojects/{project
+00009180: 7d2f 6675 6e63 7469 6f6e 732f 7b6e 616d  }/functions/{nam
+00009190: 657d 220a 2020 2020 2020 2020 6572 726f  e}".        erro
+000091a0: 725f 6d65 7373 6167 6520 3d20 6622 4661  r_message = f"Fa
+000091b0: 696c 6564 2064 656c 6574 696e 6720 6675  iled deleting fu
+000091c0: 6e63 7469 6f6e 207b 7072 6f6a 6563 747d  nction {project}
+000091d0: 2f7b 6e61 6d65 7d22 0a20 2020 2020 2020  /{name}".       
+000091e0: 2073 656c 662e 6170 695f 6361 6c6c 2822   self.api_call("
+000091f0: 4445 4c45 5445 222c 2070 6174 682c 2065  DELETE", path, e
+00009200: 7272 6f72 5f6d 6573 7361 6765 290a 0a20  rror_message).. 
+00009210: 2020 2064 6566 206c 6973 745f 6675 6e63     def list_func
+00009220: 7469 6f6e 7328 7365 6c66 2c20 6e61 6d65  tions(self, name
+00009230: 3d4e 6f6e 652c 2070 726f 6a65 6374 3d4e  =None, project=N
+00009240: 6f6e 652c 2074 6167 3d4e 6f6e 652c 206c  one, tag=None, l
+00009250: 6162 656c 733d 4e6f 6e65 293a 0a20 2020  abels=None):.   
+00009260: 2020 2020 2022 2222 5265 7472 6965 7665       """Retrieve
+00009270: 2061 206c 6973 7420 6f66 2066 756e 6374   a list of funct
+00009280: 696f 6e73 2c20 6669 6c74 6572 6564 2062  ions, filtered b
+00009290: 7920 7370 6563 6966 6963 2063 7269 7465  y specific crite
+000092a0: 7269 612e 0a0a 2020 2020 2020 2020 3a70  ria...        :p
+000092b0: 6172 616d 206e 616d 653a 2052 6574 7572  aram name: Retur
+000092c0: 6e20 6f6e 6c79 2066 756e 6374 696f 6e73  n only functions
+000092d0: 2077 6974 6820 6120 7370 6563 6966 6963   with a specific
+000092e0: 206e 616d 652e 0a20 2020 2020 2020 203a   name..        :
+000092f0: 7061 7261 6d20 7072 6f6a 6563 743a 2052  param project: R
+00009300: 6574 7572 6e20 6675 6e63 7469 6f6e 7320  eturn functions 
+00009310: 6265 6c6f 6e67 696e 6720 746f 2074 6869  belonging to thi
+00009320: 7320 7072 6f6a 6563 742e 2049 6620 6e6f  s project. If no
+00009330: 7420 7370 6563 6966 6965 642c 2074 6865  t specified, the
+00009340: 2064 6566 6175 6c74 2070 726f 6a65 6374   default project
+00009350: 2069 7320 7573 6564 2e0a 2020 2020 2020   is used..      
+00009360: 2020 3a70 6172 616d 2074 6167 3a20 5265    :param tag: Re
+00009370: 7475 726e 2066 756e 6374 696f 6e20 7665  turn function ve
+00009380: 7273 696f 6e73 2077 6974 6820 7370 6563  rsions with spec
+00009390: 6966 6963 2074 6167 732e 0a20 2020 2020  ific tags..     
+000093a0: 2020 203a 7061 7261 6d20 6c61 6265 6c73     :param labels
+000093b0: 3a20 5265 7475 726e 2066 756e 6374 696f  : Return functio
+000093c0: 6e73 2074 6861 7420 6861 7665 2073 7065  ns that have spe
+000093d0: 6369 6669 6320 6c61 6265 6c73 2061 7373  cific labels ass
+000093e0: 6967 6e65 6420 746f 2074 6865 6d2e 0a20  igned to them.. 
+000093f0: 2020 2020 2020 203a 7265 7475 726e 733a         :returns:
+00009400: 204c 6973 7420 6f66 2066 756e 6374 696f   List of functio
+00009410: 6e20 6f62 6a65 6374 7320 2861 7320 6469  n objects (as di
+00009420: 6374 696f 6e61 7279 292e 0a20 2020 2020  ctionary)..     
+00009430: 2020 2022 2222 0a0a 2020 2020 2020 2020     """..        
+00009440: 7061 7261 6d73 203d 207b 0a20 2020 2020  params = {.     
+00009450: 2020 2020 2020 2022 7072 6f6a 6563 7422         "project"
+00009460: 3a20 7072 6f6a 6563 7420 6f72 2063 6f6e  : project or con
+00009470: 6669 672e 6465 6661 756c 745f 7072 6f6a  fig.default_proj
+00009480: 6563 742c 0a20 2020 2020 2020 2020 2020  ect,.           
+00009490: 2022 6e61 6d65 223a 206e 616d 652c 0a20   "name": name,. 
+000094a0: 2020 2020 2020 2020 2020 2022 7461 6722             "tag"
+000094b0: 3a20 7461 672c 0a20 2020 2020 2020 2020  : tag,.         
+000094c0: 2020 2022 6c61 6265 6c22 3a20 6c61 6265     "label": labe
+000094d0: 6c73 206f 7220 5b5d 2c0a 2020 2020 2020  ls or [],.      
+000094e0: 2020 7d0a 2020 2020 2020 2020 6572 726f    }.        erro
+000094f0: 7220 3d20 226c 6973 7420 6675 6e63 7469  r = "list functi
+00009500: 6f6e 7322 0a20 2020 2020 2020 2072 6573  ons".        res
+00009510: 7020 3d20 7365 6c66 2e61 7069 5f63 616c  p = self.api_cal
+00009520: 6c28 2247 4554 222c 2022 6675 6e63 7322  l("GET", "funcs"
+00009530: 2c20 6572 726f 722c 2070 6172 616d 733d  , error, params=
+00009540: 7061 7261 6d73 290a 2020 2020 2020 2020  params).        
+00009550: 7265 7475 726e 2072 6573 702e 6a73 6f6e  return resp.json
+00009560: 2829 5b22 6675 6e63 7322 5d0a 0a20 2020  ()["funcs"]..   
+00009570: 2064 6566 206c 6973 745f 7275 6e74 696d   def list_runtim
+00009580: 655f 7265 736f 7572 6365 7328 0a20 2020  e_resources(.   
+00009590: 2020 2020 2073 656c 662c 0a20 2020 2020       self,.     
+000095a0: 2020 2070 726f 6a65 6374 3a20 4f70 7469     project: Opti
+000095b0: 6f6e 616c 5b73 7472 5d20 3d20 4e6f 6e65  onal[str] = None
+000095c0: 2c0a 2020 2020 2020 2020 6c61 6265 6c5f  ,.        label_
+000095d0: 7365 6c65 6374 6f72 3a20 4f70 7469 6f6e  selector: Option
+000095e0: 616c 5b73 7472 5d20 3d20 4e6f 6e65 2c0a  al[str] = None,.
+000095f0: 2020 2020 2020 2020 6b69 6e64 3a20 4f70          kind: Op
+00009600: 7469 6f6e 616c 5b73 7472 5d20 3d20 4e6f  tional[str] = No
+00009610: 6e65 2c0a 2020 2020 2020 2020 6f62 6a65  ne,.        obje
+00009620: 6374 5f69 643a 204f 7074 696f 6e61 6c5b  ct_id: Optional[
+00009630: 7374 725d 203d 204e 6f6e 652c 0a20 2020  str] = None,.   
+00009640: 2020 2020 2067 726f 7570 5f62 793a 204f       group_by: O
+00009650: 7074 696f 6e61 6c5b 6d6c 7275 6e2e 6170  ptional[mlrun.ap
+00009660: 692e 7363 6865 6d61 732e 4c69 7374 5275  i.schemas.ListRu
+00009670: 6e74 696d 6552 6573 6f75 7263 6573 4772  ntimeResourcesGr
+00009680: 6f75 7042 7946 6965 6c64 5d20 3d20 4e6f  oupByField] = No
+00009690: 6e65 2c0a 2020 2020 2920 2d3e 2055 6e69  ne,.    ) -> Uni
+000096a0: 6f6e 5b0a 2020 2020 2020 2020 6d6c 7275  on[.        mlru
+000096b0: 6e2e 6170 692e 7363 6865 6d61 732e 5275  n.api.schemas.Ru
+000096c0: 6e74 696d 6552 6573 6f75 7263 6573 4f75  ntimeResourcesOu
+000096d0: 7470 7574 2c0a 2020 2020 2020 2020 6d6c  tput,.        ml
+000096e0: 7275 6e2e 6170 692e 7363 6865 6d61 732e  run.api.schemas.
+000096f0: 4772 6f75 7065 6442 794a 6f62 5275 6e74  GroupedByJobRunt
+00009700: 696d 6552 6573 6f75 7263 6573 4f75 7470  imeResourcesOutp
+00009710: 7574 2c0a 2020 2020 2020 2020 6d6c 7275  ut,.        mlru
+00009720: 6e2e 6170 692e 7363 6865 6d61 732e 4772  n.api.schemas.Gr
+00009730: 6f75 7065 6442 7950 726f 6a65 6374 5275  oupedByProjectRu
+00009740: 6e74 696d 6552 6573 6f75 7263 6573 4f75  ntimeResourcesOu
+00009750: 7470 7574 2c0a 2020 2020 5d3a 0a20 2020  tput,.    ]:.   
+00009760: 2020 2020 2022 2222 4c69 7374 2063 7572       """List cur
+00009770: 7265 6e74 2072 756e 7469 6d65 2072 6573  rent runtime res
+00009780: 6f75 7263 6573 2c20 7768 6963 6820 6172  ources, which ar
+00009790: 6520 7573 7561 6c6c 7920 2862 7574 206e  e usually (but n
+000097a0: 6f74 206c 696d 6974 6564 2074 6f29 204b  ot limited to) K
+000097b0: 7562 6572 6e65 7465 7320 706f 6473 206f  ubernetes pods o
+000097c0: 7220 4352 4473 2e0a 2020 2020 2020 2020  r CRDs..        
+000097d0: 4675 6e63 7469 6f6e 2061 7070 6c69 6573  Function applies
+000097e0: 2066 6f72 2072 756e 7320 6f66 2074 7970   for runs of typ
+000097f0: 6520 605b 2764 6173 6b27 2c20 276a 6f62  e `['dask', 'job
+00009800: 272c 2027 7370 6172 6b27 2c20 2772 656d  ', 'spark', 'rem
+00009810: 6f74 652d 7370 6172 6b27 2c20 276d 7069  ote-spark', 'mpi
+00009820: 6a6f 6227 5d60 2c20 616e 6420 7769 6c6c  job']`, and will
+00009830: 2072 6574 7572 6e20 7065 720a 2020 2020   return per.    
+00009840: 2020 2020 7275 6e74 696d 6520 6b69 6e64      runtime kind
+00009850: 2061 206c 6973 7420 6f66 2074 6865 2072   a list of the r
+00009860: 756e 7469 6d65 2072 6573 6f75 7263 6573  untime resources
+00009870: 2028 7768 6963 6820 6d61 7920 6861 7665   (which may have
+00009880: 2061 6c72 6561 6479 2063 6f6d 706c 6574   already complet
+00009890: 6564 2074 6865 6972 2065 7865 6375 7469  ed their executi
+000098a0: 6f6e 292e 0a0a 2020 2020 2020 2020 3a70  on)...        :p
+000098b0: 6172 616d 2070 726f 6a65 6374 3a20 4765  aram project: Ge
+000098c0: 7420 6f6e 6c79 2072 756e 7469 6d65 2072  t only runtime r
+000098d0: 6573 6f75 7263 6573 206f 6620 6120 7370  esources of a sp
+000098e0: 6563 6966 6963 2070 726f 6a65 6374 2c20  ecific project, 
+000098f0: 6279 2064 6566 6175 6c74 204e 6f6e 652c  by default None,
+00009900: 2077 6869 6368 2077 696c 6c20 7265 7475   which will retu
+00009910: 726e 206f 6e6c 7920 7468 650a 2020 2020  rn only the.    
+00009920: 2020 2020 2020 2020 7072 6f6a 6563 7473          projects
+00009930: 2079 6f75 2772 6520 6175 7468 6f72 697a   you're authoriz
+00009940: 6564 2074 6f20 7365 652e 0a20 2020 2020  ed to see..     
+00009950: 2020 203a 7061 7261 6d20 6c61 6265 6c5f     :param label_
+00009960: 7365 6c65 6374 6f72 3a20 4120 6c61 6265  selector: A labe
+00009970: 6c20 6669 6c74 6572 2074 6861 7420 7769  l filter that wi
+00009980: 6c6c 2062 6520 7061 7373 6564 2074 6f20  ll be passed to 
+00009990: 4b75 6265 726e 6574 6573 2066 6f72 2066  Kubernetes for f
+000099a0: 696c 7465 7269 6e67 2074 6865 2072 6573  iltering the res
+000099b0: 756c 7473 2061 6363 6f72 6469 6e67 0a20  ults according. 
+000099c0: 2020 2020 2020 2020 2020 2074 6f20 7468             to th
+000099d0: 6569 7220 6c61 6265 6c73 2e0a 2020 2020  eir labels..    
+000099e0: 2020 2020 3a70 6172 616d 206b 696e 643a      :param kind:
+000099f0: 2054 6865 206b 696e 6420 6f66 2072 756e   The kind of run
+00009a00: 7469 6d65 2074 6f20 7175 6572 792e 204d  time to query. M
+00009a10: 6179 2062 6520 6f6e 6520 6f66 2060 5b27  ay be one of `['
+00009a20: 6461 736b 272c 2027 6a6f 6227 2c20 2773  dask', 'job', 's
+00009a30: 7061 726b 272c 2027 7265 6d6f 7465 2d73  park', 'remote-s
+00009a40: 7061 726b 272c 2027 6d70 696a 6f62 275d  park', 'mpijob']
+00009a50: 600a 2020 2020 2020 2020 3a70 6172 616d  `.        :param
+00009a60: 206f 626a 6563 745f 6964 3a20 5468 6520   object_id: The 
+00009a70: 6964 656e 7469 6669 6572 206f 6620 7468  identifier of th
+00009a80: 6520 6d6c 7275 6e20 6f62 6a65 6374 2074  e mlrun object t
+00009a90: 6f20 7175 6572 7920 6974 7320 7275 6e74  o query its runt
+00009aa0: 696d 6520 7265 736f 7572 6365 732e 2066  ime resources. f
+00009ab0: 6f72 206d 6f73 7420 6675 6e63 7469 6f6e  or most function
+00009ac0: 2072 756e 7469 6d65 732c 0a20 2020 2020   runtimes,.     
+00009ad0: 2020 2020 2020 2072 756e 7469 6d65 2072         runtime r
+00009ae0: 6573 6f75 7263 6573 2061 7265 2070 6572  esources are per
+00009af0: 2052 756e 2c20 666f 7220 7768 6963 6820   Run, for which 
+00009b00: 7468 6520 6964 656e 7469 6669 6572 2069  the identifier i
+00009b10: 7320 7468 6520 5275 6e27 7320 5549 442e  s the Run's UID.
+00009b20: 2046 6f72 2064 6173 6b20 7275 6e74 696d   For dask runtim
+00009b30: 652c 2074 6865 2072 756e 7469 6d65 0a20  e, the runtime. 
+00009b40: 2020 2020 2020 2020 2020 2072 6573 6f75             resou
+00009b50: 7263 6573 2061 7265 2070 6572 2046 756e  rces are per Fun
+00009b60: 6374 696f 6e2c 2066 6f72 2077 6869 6368  ction, for which
+00009b70: 2074 6865 2069 6465 6e74 6966 6965 7220   the identifier 
+00009b80: 6973 2074 6865 2046 756e 6374 696f 6e27  is the Function'
+00009b90: 7320 6e61 6d65 2e0a 2020 2020 2020 2020  s name..        
+00009ba0: 3a70 6172 616d 2067 726f 7570 5f62 793a  :param group_by:
+00009bb0: 204f 626a 6563 7420 746f 2067 726f 7570   Object to group
+00009bc0: 2072 6573 756c 7473 2062 792e 2041 6c6c   results by. All
+00009bd0: 6f77 6564 2076 616c 7565 7320 6172 6520  owed values are 
+00009be0: 606a 6f62 6020 616e 6420 6070 726f 6a65  `job` and `proje
+00009bf0: 6374 602e 0a20 2020 2020 2020 2022 2222  ct`..        """
+00009c00: 0a20 2020 2020 2020 2070 6172 616d 7320  .        params 
+00009c10: 3d20 7b0a 2020 2020 2020 2020 2020 2020  = {.            
+00009c20: 226c 6162 656c 5f73 656c 6563 746f 7222  "label_selector"
+00009c30: 3a20 6c61 6265 6c5f 7365 6c65 6374 6f72  : label_selector
+00009c40: 2c0a 2020 2020 2020 2020 2020 2020 2267  ,.            "g
+00009c50: 726f 7570 2d62 7922 3a20 6772 6f75 705f  roup-by": group_
+00009c60: 6279 2c0a 2020 2020 2020 2020 2020 2020  by,.            
+00009c70: 226b 696e 6422 3a20 6b69 6e64 2c0a 2020  "kind": kind,.  
+00009c80: 2020 2020 2020 2020 2020 226f 626a 6563            "objec
+00009c90: 742d 6964 223a 206f 626a 6563 745f 6964  t-id": object_id
+00009ca0: 2c0a 2020 2020 2020 2020 7d0a 2020 2020  ,.        }.    
+00009cb0: 2020 2020 7072 6f6a 6563 745f 7061 7468      project_path
+00009cc0: 203d 2070 726f 6a65 6374 2069 6620 7072   = project if pr
+00009cd0: 6f6a 6563 7420 656c 7365 2022 2a22 0a20  oject else "*". 
+00009ce0: 2020 2020 2020 2065 7272 6f72 203d 2022         error = "
+00009cf0: 4661 696c 6564 206c 6973 7469 6e67 2072  Failed listing r
+00009d00: 756e 7469 6d65 2072 6573 6f75 7263 6573  untime resources
+00009d10: 220a 2020 2020 2020 2020 7265 7370 6f6e  ".        respon
+00009d20: 7365 203d 2073 656c 662e 6170 695f 6361  se = self.api_ca
+00009d30: 6c6c 280a 2020 2020 2020 2020 2020 2020  ll(.            
+00009d40: 2247 4554 222c 2066 2270 726f 6a65 6374  "GET", f"project
+00009d50: 732f 7b70 726f 6a65 6374 5f70 6174 687d  s/{project_path}
+00009d60: 2f72 756e 7469 6d65 2d72 6573 6f75 7263  /runtime-resourc
+00009d70: 6573 222c 2065 7272 6f72 2c20 7061 7261  es", error, para
+00009d80: 6d73 3d70 6172 616d 730a 2020 2020 2020  ms=params.      
+00009d90: 2020 290a 2020 2020 2020 2020 6966 2067    ).        if g
+00009da0: 726f 7570 5f62 7920 6973 204e 6f6e 653a  roup_by is None:
+00009db0: 0a20 2020 2020 2020 2020 2020 2073 7472  .            str
+00009dc0: 7563 7475 7265 645f 6c69 7374 203d 205b  uctured_list = [
+00009dd0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00009de0: 206d 6c72 756e 2e61 7069 2e73 6368 656d   mlrun.api.schem
+00009df0: 6173 2e4b 696e 6452 756e 7469 6d65 5265  as.KindRuntimeRe
+00009e00: 736f 7572 6365 7328 2a2a 6b69 6e64 5f72  sources(**kind_r
+00009e10: 756e 7469 6d65 5f72 6573 6f75 7263 6573  untime_resources
+00009e20: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+00009e30: 2020 666f 7220 6b69 6e64 5f72 756e 7469    for kind_runti
+00009e40: 6d65 5f72 6573 6f75 7263 6573 2069 6e20  me_resources in 
+00009e50: 7265 7370 6f6e 7365 2e6a 736f 6e28 290a  response.json().
+00009e60: 2020 2020 2020 2020 2020 2020 5d0a 2020              ].  
+00009e70: 2020 2020 2020 2020 2020 7265 7475 726e            return
+00009e80: 2073 7472 7563 7475 7265 645f 6c69 7374   structured_list
+00009e90: 0a20 2020 2020 2020 2065 6c69 6620 6772  .        elif gr
+00009ea0: 6f75 705f 6279 203d 3d20 6d6c 7275 6e2e  oup_by == mlrun.
+00009eb0: 6170 692e 7363 6865 6d61 732e 4c69 7374  api.schemas.List
+00009ec0: 5275 6e74 696d 6552 6573 6f75 7263 6573  RuntimeResources
+00009ed0: 4772 6f75 7042 7946 6965 6c64 2e6a 6f62  GroupByField.job
+00009ee0: 3a0a 2020 2020 2020 2020 2020 2020 7374  :.            st
+00009ef0: 7275 6374 7572 6564 5f64 6963 7420 3d20  ructured_dict = 
+00009f00: 7b7d 0a20 2020 2020 2020 2020 2020 2066  {}.            f
+00009f10: 6f72 2070 726f 6a65 6374 2c20 6a6f 625f  or project, job_
+00009f20: 7275 6e74 696d 655f 7265 736f 7572 6365  runtime_resource
+00009f30: 735f 6d61 7020 696e 2072 6573 706f 6e73  s_map in respons
+00009f40: 652e 6a73 6f6e 2829 2e69 7465 6d73 2829  e.json().items()
+00009f50: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00009f60: 2020 666f 7220 6a6f 625f 6964 2c20 7275    for job_id, ru
+00009f70: 6e74 696d 655f 7265 736f 7572 6365 7320  ntime_resources 
+00009f80: 696e 206a 6f62 5f72 756e 7469 6d65 5f72  in job_runtime_r
+00009f90: 6573 6f75 7263 6573 5f6d 6170 2e69 7465  esources_map.ite
+00009fa0: 6d73 2829 3a0a 2020 2020 2020 2020 2020  ms():.          
+00009fb0: 2020 2020 2020 2020 2020 7374 7275 6374            struct
+00009fc0: 7572 6564 5f64 6963 742e 7365 7464 6566  ured_dict.setdef
+00009fd0: 6175 6c74 2870 726f 6a65 6374 2c20 7b7d  ault(project, {}
+00009fe0: 295b 0a20 2020 2020 2020 2020 2020 2020  )[.             
+00009ff0: 2020 2020 2020 2020 2020 206a 6f62 5f69             job_i
+0000a000: 640a 2020 2020 2020 2020 2020 2020 2020  d.              
+0000a010: 2020 2020 2020 5d20 3d20 6d6c 7275 6e2e        ] = mlrun.
+0000a020: 6170 692e 7363 6865 6d61 732e 5275 6e74  api.schemas.Runt
+0000a030: 696d 6552 6573 6f75 7263 6573 282a 2a72  imeResources(**r
+0000a040: 756e 7469 6d65 5f72 6573 6f75 7263 6573  untime_resources
+0000a050: 290a 2020 2020 2020 2020 2020 2020 7265  ).            re
+0000a060: 7475 726e 2073 7472 7563 7475 7265 645f  turn structured_
+0000a070: 6469 6374 0a20 2020 2020 2020 2065 6c69  dict.        eli
+0000a080: 6620 6772 6f75 705f 6279 203d 3d20 6d6c  f group_by == ml
+0000a090: 7275 6e2e 6170 692e 7363 6865 6d61 732e  run.api.schemas.
+0000a0a0: 4c69 7374 5275 6e74 696d 6552 6573 6f75  ListRuntimeResou
+0000a0b0: 7263 6573 4772 6f75 7042 7946 6965 6c64  rcesGroupByField
+0000a0c0: 2e70 726f 6a65 6374 3a0a 2020 2020 2020  .project:.      
+0000a0d0: 2020 2020 2020 7374 7275 6374 7572 6564        structured
+0000a0e0: 5f64 6963 7420 3d20 7b7d 0a20 2020 2020  _dict = {}.     
+0000a0f0: 2020 2020 2020 2066 6f72 2070 726f 6a65         for proje
+0000a100: 6374 2c20 6b69 6e64 5f72 756e 7469 6d65  ct, kind_runtime
+0000a110: 5f72 6573 6f75 7263 6573 5f6d 6170 2069  _resources_map i
+0000a120: 6e20 7265 7370 6f6e 7365 2e6a 736f 6e28  n response.json(
+0000a130: 292e 6974 656d 7328 293a 0a20 2020 2020  ).items():.     
+0000a140: 2020 2020 2020 2020 2020 2066 6f72 206b             for k
+0000a150: 696e 642c 2072 756e 7469 6d65 5f72 6573  ind, runtime_res
+0000a160: 6f75 7263 6573 2069 6e20 6b69 6e64 5f72  ources in kind_r
+0000a170: 756e 7469 6d65 5f72 6573 6f75 7263 6573  untime_resources
+0000a180: 5f6d 6170 2e69 7465 6d73 2829 3a0a 2020  _map.items():.  
+0000a190: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a1a0: 2020 7374 7275 6374 7572 6564 5f64 6963    structured_dic
+0000a1b0: 742e 7365 7464 6566 6175 6c74 2870 726f  t.setdefault(pro
+0000a1c0: 6a65 6374 2c20 7b7d 295b 0a20 2020 2020  ject, {})[.     
+0000a1d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a1e0: 2020 206b 696e 640a 2020 2020 2020 2020     kind.        
+0000a1f0: 2020 2020 2020 2020 2020 2020 5d20 3d20              ] = 
+0000a200: 6d6c 7275 6e2e 6170 692e 7363 6865 6d61  mlrun.api.schema
+0000a210: 732e 5275 6e74 696d 6552 6573 6f75 7263  s.RuntimeResourc
+0000a220: 6573 282a 2a72 756e 7469 6d65 5f72 6573  es(**runtime_res
+0000a230: 6f75 7263 6573 290a 2020 2020 2020 2020  ources).        
+0000a240: 2020 2020 7265 7475 726e 2073 7472 7563      return struc
+0000a250: 7475 7265 645f 6469 6374 0a20 2020 2020  tured_dict.     
+0000a260: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+0000a270: 2020 2020 2072 6169 7365 204e 6f74 496d       raise NotIm
+0000a280: 706c 656d 656e 7465 6445 7272 6f72 280a  plementedError(.
+0000a290: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a2a0: 6622 5072 6f76 6964 6564 2067 726f 7570  f"Provided group
+0000a2b0: 2062 7920 6669 656c 6420 6973 206e 6f74   by field is not
+0000a2c0: 2073 7570 706f 7274 6564 2e20 6772 6f75   supported. grou
+0000a2d0: 705f 6279 3d7b 6772 6f75 705f 6279 7d22  p_by={group_by}"
+0000a2e0: 0a20 2020 2020 2020 2020 2020 2029 0a0a  .            )..
+0000a2f0: 2020 2020 6465 6620 6465 6c65 7465 5f72      def delete_r
+0000a300: 756e 7469 6d65 5f72 6573 6f75 7263 6573  untime_resources
+0000a310: 280a 2020 2020 2020 2020 7365 6c66 2c0a  (.        self,.
+0000a320: 2020 2020 2020 2020 7072 6f6a 6563 743a          project:
+0000a330: 204f 7074 696f 6e61 6c5b 7374 725d 203d   Optional[str] =
+0000a340: 204e 6f6e 652c 0a20 2020 2020 2020 206c   None,.        l
+0000a350: 6162 656c 5f73 656c 6563 746f 723a 204f  abel_selector: O
+0000a360: 7074 696f 6e61 6c5b 7374 725d 203d 204e  ptional[str] = N
+0000a370: 6f6e 652c 0a20 2020 2020 2020 206b 696e  one,.        kin
+0000a380: 643a 204f 7074 696f 6e61 6c5b 7374 725d  d: Optional[str]
+0000a390: 203d 204e 6f6e 652c 0a20 2020 2020 2020   = None,.       
+0000a3a0: 206f 626a 6563 745f 6964 3a20 4f70 7469   object_id: Opti
+0000a3b0: 6f6e 616c 5b73 7472 5d20 3d20 4e6f 6e65  onal[str] = None
+0000a3c0: 2c0a 2020 2020 2020 2020 666f 7263 653a  ,.        force:
+0000a3d0: 2062 6f6f 6c20 3d20 4661 6c73 652c 0a20   bool = False,. 
+0000a3e0: 2020 2020 2020 2067 7261 6365 5f70 6572         grace_per
+0000a3f0: 696f 643a 2069 6e74 203d 204e 6f6e 652c  iod: int = None,
+0000a400: 0a20 2020 2029 202d 3e20 6d6c 7275 6e2e  .    ) -> mlrun.
+0000a410: 6170 692e 7363 6865 6d61 732e 4772 6f75  api.schemas.Grou
+0000a420: 7065 6442 7950 726f 6a65 6374 5275 6e74  pedByProjectRunt
+0000a430: 696d 6552 6573 6f75 7263 6573 4f75 7470  imeResourcesOutp
+0000a440: 7574 3a0a 2020 2020 2020 2020 2222 2244  ut:.        """D
+0000a450: 656c 6574 6520 616c 6c20 7275 6e74 696d  elete all runtim
+0000a460: 6520 7265 736f 7572 6365 7320 7768 6963  e resources whic
+0000a470: 6820 6172 6520 696e 2074 6572 6d69 6e61  h are in termina
+0000a480: 6c20 7374 6174 652e 0a0a 2020 2020 2020  l state...      
+0000a490: 2020 3a70 6172 616d 2070 726f 6a65 6374    :param project
+0000a4a0: 3a20 4465 6c65 7465 206f 6e6c 7920 7275  : Delete only ru
+0000a4b0: 6e74 696d 6520 7265 736f 7572 6365 7320  ntime resources 
+0000a4c0: 6f66 2061 2073 7065 6369 6669 6320 7072  of a specific pr
+0000a4d0: 6f6a 6563 742c 2062 7920 6465 6661 756c  oject, by defaul
+0000a4e0: 7420 4e6f 6e65 2c20 7768 6963 6820 7769  t None, which wi
+0000a4f0: 6c6c 2064 656c 6574 6520 6f6e 6c79 0a20  ll delete only. 
+0000a500: 2020 2020 2020 2020 2020 2066 726f 6d20             from 
+0000a510: 7468 6520 7072 6f6a 6563 7473 2079 6f75  the projects you
+0000a520: 2772 6520 6175 7468 6f72 697a 6564 2074  're authorized t
+0000a530: 6f20 6465 6c65 7465 2066 726f 6d2e 0a20  o delete from.. 
+0000a540: 2020 2020 2020 203a 7061 7261 6d20 6c61         :param la
+0000a550: 6265 6c5f 7365 6c65 6374 6f72 3a20 4465  bel_selector: De
+0000a560: 6c65 7465 206f 6e6c 7920 7275 6e74 696d  lete only runtim
+0000a570: 6520 7265 736f 7572 6365 7320 6d61 7463  e resources matc
+0000a580: 6869 6e67 2074 6865 206c 6162 656c 2073  hing the label s
+0000a590: 656c 6563 746f 722e 0a20 2020 2020 2020  elector..       
+0000a5a0: 203a 7061 7261 6d20 6b69 6e64 3a20 5468   :param kind: Th
+0000a5b0: 6520 6b69 6e64 206f 6620 7275 6e74 696d  e kind of runtim
+0000a5c0: 6520 746f 2064 656c 6574 652e 204d 6179  e to delete. May
+0000a5d0: 2062 6520 6f6e 6520 6f66 2060 5b27 6461   be one of `['da
+0000a5e0: 736b 272c 2027 6a6f 6227 2c20 2773 7061  sk', 'job', 'spa
+0000a5f0: 726b 272c 2027 7265 6d6f 7465 2d73 7061  rk', 'remote-spa
+0000a600: 726b 272c 2027 6d70 696a 6f62 275d 600a  rk', 'mpijob']`.
+0000a610: 2020 2020 2020 2020 3a70 6172 616d 206f          :param o
+0000a620: 626a 6563 745f 6964 3a20 5468 6520 6964  bject_id: The id
+0000a630: 656e 7469 6669 6572 206f 6620 7468 6520  entifier of the 
+0000a640: 6d6c 7275 6e20 6f62 6a65 6374 2074 6f20  mlrun object to 
+0000a650: 6465 6c65 7465 2069 7473 2072 756e 7469  delete its runti
+0000a660: 6d65 2072 6573 6f75 7263 6573 2e20 666f  me resources. fo
+0000a670: 7220 6d6f 7374 2066 756e 6374 696f 6e0a  r most function.
+0000a680: 2020 2020 2020 2020 2020 2020 7275 6e74              runt
+0000a690: 696d 6573 2c20 7275 6e74 696d 6520 7265  imes, runtime re
+0000a6a0: 736f 7572 6365 7320 6172 6520 7065 7220  sources are per 
+0000a6b0: 5275 6e2c 2066 6f72 2077 6869 6368 2074  Run, for which t
+0000a6c0: 6865 2069 6465 6e74 6966 6965 7220 6973  he identifier is
+0000a6d0: 2074 6865 2052 756e 2773 2055 4944 2e20   the Run's UID. 
+0000a6e0: 466f 7220 6461 736b 2072 756e 7469 6d65  For dask runtime
+0000a6f0: 2c20 7468 650a 2020 2020 2020 2020 2020  , the.          
+0000a700: 2020 7275 6e74 696d 6520 7265 736f 7572    runtime resour
+0000a710: 6365 7320 6172 6520 7065 7220 4675 6e63  ces are per Func
+0000a720: 7469 6f6e 2c20 666f 7220 7768 6963 6820  tion, for which 
+0000a730: 7468 6520 6964 656e 7469 6669 6572 2069  the identifier i
+0000a740: 7320 7468 6520 4675 6e63 7469 6f6e 2773  s the Function's
+0000a750: 206e 616d 652e 0a20 2020 2020 2020 203a   name..        :
+0000a760: 7061 7261 6d20 666f 7263 653a 2046 6f72  param force: For
+0000a770: 6365 2064 656c 6574 696f 6e20 2d20 6465  ce deletion - de
+0000a780: 6c65 7465 2074 6865 2072 756e 7469 6d65  lete the runtime
+0000a790: 2072 6573 6f75 7263 6520 6576 656e 2069   resource even i
+0000a7a0: 6620 6974 2773 206e 6f74 2069 6e20 7465  f it's not in te
+0000a7b0: 726d 696e 616c 2073 7461 7465 206f 7220  rminal state or 
+0000a7c0: 6966 2074 6865 2067 7261 6365 0a20 2020  if the grace.   
+0000a7d0: 2020 2020 2020 2020 2070 6572 696f 6420           period 
+0000a7e0: 6469 646e 2774 2070 6173 732e 0a20 2020  didn't pass..   
+0000a7f0: 2020 2020 203a 7061 7261 6d20 6772 6163       :param grac
+0000a800: 655f 7065 7269 6f64 3a20 4772 6163 6520  e_period: Grace 
+0000a810: 7065 7269 6f64 2067 6976 656e 2074 6f20  period given to 
+0000a820: 7468 6520 7275 6e74 696d 6520 7265 736f  the runtime reso
+0000a830: 7572 6365 2062 6566 6f72 6520 7468 6579  urce before they
+0000a840: 2061 7265 2061 6374 7561 6c6c 7920 7265   are actually re
+0000a850: 6d6f 7665 642c 2063 6f75 6e74 6564 2066  moved, counted f
+0000a860: 726f 6d0a 2020 2020 2020 2020 2020 2020  rom.            
+0000a870: 7468 6520 6d6f 6d65 6e74 2074 6865 7920  the moment they 
+0000a880: 6d6f 7665 6420 746f 2074 6572 6d69 6e61  moved to termina
+0000a890: 6c20 7374 6174 6520 2864 6566 6175 6c74  l state (default
+0000a8a0: 7320 746f 206d 6c72 756e 2e6d 6c63 6f6e  s to mlrun.mlcon
+0000a8b0: 662e 7275 6e74 696d 655f 7265 736f 7572  f.runtime_resour
+0000a8c0: 6365 735f 6465 6c65 7469 6f6e 5f67 7261  ces_deletion_gra
+0000a8d0: 6365 5f70 6572 696f 6429 2e0a 0a20 2020  ce_period)...   
+0000a8e0: 2020 2020 203a 7265 7475 726e 733a 203a       :returns: :
+0000a8f0: 7079 3a63 6c61 7373 3a60 7e6d 6c72 756e  py:class:`~mlrun
+0000a900: 2e61 7069 2e73 6368 656d 6173 2e47 726f  .api.schemas.Gro
+0000a910: 7570 6564 4279 5072 6f6a 6563 7452 756e  upedByProjectRun
+0000a920: 7469 6d65 5265 736f 7572 6365 734f 7574  timeResourcesOut
+0000a930: 7075 7460 206c 6973 7469 6e67 2074 6865  put` listing the
+0000a940: 2072 756e 7469 6d65 2072 6573 6f75 7263   runtime resourc
+0000a950: 6573 0a20 2020 2020 2020 2020 2020 2074  es.            t
+0000a960: 6861 7420 7765 7265 2072 656d 6f76 6564  hat were removed
+0000a970: 2e0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
+0000a980: 2020 2020 2020 6966 2067 7261 6365 5f70        if grace_p
+0000a990: 6572 696f 6420 6973 204e 6f6e 653a 0a20  eriod is None:. 
+0000a9a0: 2020 2020 2020 2020 2020 2067 7261 6365             grace
+0000a9b0: 5f70 6572 696f 6420 3d20 636f 6e66 6967  _period = config
+0000a9c0: 2e72 756e 7469 6d65 5f72 6573 6f75 7263  .runtime_resourc
+0000a9d0: 6573 5f64 656c 6574 696f 6e5f 6772 6163  es_deletion_grac
+0000a9e0: 655f 7065 7269 6f64 0a20 2020 2020 2020  e_period.       
+0000a9f0: 2020 2020 206c 6f67 6765 722e 696e 666f       logger.info
+0000aa00: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+0000aa10: 2020 2255 7369 6e67 2064 6566 6175 6c74    "Using default
+0000aa20: 2067 7261 6365 2070 6572 696f 6420 666f   grace period fo
+0000aa30: 7220 7275 6e74 696d 6520 7265 736f 7572  r runtime resour
+0000aa40: 6365 7320 6465 6c65 7469 6f6e 222c 0a20  ces deletion",. 
+0000aa50: 2020 2020 2020 2020 2020 2020 2020 2067                 g
+0000aa60: 7261 6365 5f70 6572 696f 643d 6772 6163  race_period=grac
+0000aa70: 655f 7065 7269 6f64 2c0a 2020 2020 2020  e_period,.      
+0000aa80: 2020 2020 2020 290a 0a20 2020 2020 2020        )..       
+0000aa90: 2070 6172 616d 7320 3d20 7b0a 2020 2020   params = {.    
+0000aaa0: 2020 2020 2020 2020 226c 6162 656c 2d73          "label-s
+0000aab0: 656c 6563 746f 7222 3a20 6c61 6265 6c5f  elector": label_
+0000aac0: 7365 6c65 6374 6f72 2c0a 2020 2020 2020  selector,.      
+0000aad0: 2020 2020 2020 226b 696e 6422 3a20 6b69        "kind": ki
+0000aae0: 6e64 2c0a 2020 2020 2020 2020 2020 2020  nd,.            
+0000aaf0: 226f 626a 6563 742d 6964 223a 206f 626a  "object-id": obj
+0000ab00: 6563 745f 6964 2c0a 2020 2020 2020 2020  ect_id,.        
+0000ab10: 2020 2020 2266 6f72 6365 223a 2066 6f72      "force": for
+0000ab20: 6365 2c0a 2020 2020 2020 2020 2020 2020  ce,.            
+0000ab30: 2267 7261 6365 2d70 6572 696f 6422 3a20  "grace-period": 
+0000ab40: 6772 6163 655f 7065 7269 6f64 2c0a 2020  grace_period,.  
+0000ab50: 2020 2020 2020 7d0a 2020 2020 2020 2020        }.        
+0000ab60: 6572 726f 7220 3d20 2246 6169 6c65 6420  error = "Failed 
+0000ab70: 6465 6c65 7469 6e67 2072 756e 7469 6d65  deleting runtime
+0000ab80: 2072 6573 6f75 7263 6573 220a 2020 2020   resources".    
+0000ab90: 2020 2020 7072 6f6a 6563 745f 7061 7468      project_path
+0000aba0: 203d 2070 726f 6a65 6374 2069 6620 7072   = project if pr
+0000abb0: 6f6a 6563 7420 656c 7365 2022 2a22 0a20  oject else "*". 
+0000abc0: 2020 2020 2020 2072 6573 706f 6e73 6520         response 
+0000abd0: 3d20 7365 6c66 2e61 7069 5f63 616c 6c28  = self.api_call(
+0000abe0: 0a20 2020 2020 2020 2020 2020 2022 4445  .            "DE
+0000abf0: 4c45 5445 222c 0a20 2020 2020 2020 2020  LETE",.         
+0000ac00: 2020 2066 2270 726f 6a65 6374 732f 7b70     f"projects/{p
+0000ac10: 726f 6a65 6374 5f70 6174 687d 2f72 756e  roject_path}/run
+0000ac20: 7469 6d65 2d72 6573 6f75 7263 6573 222c  time-resources",
+0000ac30: 0a20 2020 2020 2020 2020 2020 2065 7272  .            err
+0000ac40: 6f72 2c0a 2020 2020 2020 2020 2020 2020  or,.            
+0000ac50: 7061 7261 6d73 3d70 6172 616d 732c 0a20  params=params,. 
+0000ac60: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+0000ac70: 2073 7472 7563 7475 7265 645f 6469 6374   structured_dict
+0000ac80: 203d 207b 7d0a 2020 2020 2020 2020 666f   = {}.        fo
+0000ac90: 7220 7072 6f6a 6563 742c 206b 696e 645f  r project, kind_
+0000aca0: 7275 6e74 696d 655f 7265 736f 7572 6365  runtime_resource
+0000acb0: 735f 6d61 7020 696e 2072 6573 706f 6e73  s_map in respons
+0000acc0: 652e 6a73 6f6e 2829 2e69 7465 6d73 2829  e.json().items()
+0000acd0: 3a0a 2020 2020 2020 2020 2020 2020 666f  :.            fo
+0000ace0: 7220 6b69 6e64 2c20 7275 6e74 696d 655f  r kind, runtime_
+0000acf0: 7265 736f 7572 6365 7320 696e 206b 696e  resources in kin
+0000ad00: 645f 7275 6e74 696d 655f 7265 736f 7572  d_runtime_resour
+0000ad10: 6365 735f 6d61 702e 6974 656d 7328 293a  ces_map.items():
+0000ad20: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000ad30: 2073 7472 7563 7475 7265 645f 6469 6374   structured_dict
+0000ad40: 2e73 6574 6465 6661 756c 7428 7072 6f6a  .setdefault(proj
+0000ad50: 6563 742c 207b 7d29 5b0a 2020 2020 2020  ect, {})[.      
+0000ad60: 2020 2020 2020 2020 2020 2020 2020 6b69                ki
+0000ad70: 6e64 0a20 2020 2020 2020 2020 2020 2020  nd.             
+0000ad80: 2020 205d 203d 206d 6c72 756e 2e61 7069     ] = mlrun.api
+0000ad90: 2e73 6368 656d 6173 2e52 756e 7469 6d65  .schemas.Runtime
+0000ada0: 5265 736f 7572 6365 7328 2a2a 7275 6e74  Resources(**runt
+0000adb0: 696d 655f 7265 736f 7572 6365 7329 0a20  ime_resources). 
+0000adc0: 2020 2020 2020 2072 6574 7572 6e20 7374         return st
+0000add0: 7275 6374 7572 6564 5f64 6963 740a 0a20  ructured_dict.. 
+0000ade0: 2020 2064 6566 2063 7265 6174 655f 7363     def create_sc
+0000adf0: 6865 6475 6c65 2873 656c 662c 2070 726f  hedule(self, pro
+0000ae00: 6a65 6374 3a20 7374 722c 2073 6368 6564  ject: str, sched
+0000ae10: 756c 653a 2073 6368 656d 6173 2e53 6368  ule: schemas.Sch
+0000ae20: 6564 756c 6549 6e70 7574 293a 0a20 2020  eduleInput):.   
+0000ae30: 2020 2020 2022 2222 4372 6561 7465 2061       """Create a
+0000ae40: 206e 6577 2073 6368 6564 756c 6520 6f6e   new schedule on
+0000ae50: 2074 6865 2067 6976 656e 2070 726f 6a65   the given proje
+0000ae60: 6374 2e20 5468 6520 6465 7461 696c 7320  ct. The details 
+0000ae70: 6f6e 2074 6865 2061 6374 7561 6c20 6f62  on the actual ob
+0000ae80: 6a65 6374 2074 6f20 7363 6865 6475 6c65  ject to schedule
+0000ae90: 2061 7320 7765 6c6c 2061 7320 7468 650a   as well as the.
+0000aea0: 2020 2020 2020 2020 7363 6865 6475 6c65          schedule
+0000aeb0: 2069 7473 656c 6620 6172 6520 7769 7468   itself are with
+0000aec0: 696e 2074 6865 2073 6368 6564 756c 6520  in the schedule 
+0000aed0: 6f62 6a65 6374 2070 726f 7669 6465 642e  object provided.
+0000aee0: 0a20 2020 2020 2020 2054 6865 203a 7079  .        The :py
+0000aef0: 3a63 6c61 7373 3a60 7e53 6368 6564 756c  :class:`~Schedul
+0000af00: 6543 726f 6e54 7269 6767 6572 6020 666f  eCronTrigger` fo
+0000af10: 6c6c 6f77 7320 7468 6520 6775 6964 656c  llows the guidel
+0000af20: 696e 6573 2069 6e0a 2020 2020 2020 2020  ines in.        
+0000af30: 6874 7470 733a 2f2f 6170 7363 6865 6475  https://apschedu
+0000af40: 6c65 722e 7265 6164 7468 6564 6f63 732e  ler.readthedocs.
+0000af50: 696f 2f65 6e2f 332e 782f 6d6f 6475 6c65  io/en/3.x/module
+0000af60: 732f 7472 6967 6765 7273 2f63 726f 6e2e  s/triggers/cron.
+0000af70: 6874 6d6c 2e0a 2020 2020 2020 2020 4974  html..        It
+0000af80: 2061 6c73 6f20 7375 7070 6f72 7473 2061   also supports a
+0000af90: 203a 7079 3a66 756e 633a 607e 5363 6865   :py:func:`~Sche
+0000afa0: 6475 6c65 4372 6f6e 5472 6967 6765 722e  duleCronTrigger.
+0000afb0: 6672 6f6d 5f63 726f 6e74 6162 6020 6675  from_crontab` fu
+0000afc0: 6e63 7469 6f6e 2074 6861 7420 6163 6365  nction that acce
+0000afd0: 7074 7320 610a 2020 2020 2020 2020 6372  pts a.        cr
+0000afe0: 6f6e 7461 622d 666f 726d 6174 7465 6420  ontab-formatted 
+0000aff0: 7374 7269 6e67 2028 7365 6520 6874 7470  string (see http
+0000b000: 733a 2f2f 656e 2e77 696b 6970 6564 6961  s://en.wikipedia
+0000b010: 2e6f 7267 2f77 696b 692f 4372 6f6e 2066  .org/wiki/Cron f
+0000b020: 6f72 206d 6f72 6520 696e 666f 726d 6174  or more informat
+0000b030: 696f 6e20 6f6e 2074 6865 2066 6f72 6d61  ion on the forma
+0000b040: 7420 616e 640a 2020 2020 2020 2020 6e6f  t and.        no
+0000b050: 7465 2074 6861 7420 7468 6520 3020 7765  te that the 0 we
+0000b060: 656b 6461 7920 6973 2061 6c77 6179 7320  ekday is always 
+0000b070: 6d6f 6e64 6179 292e 0a0a 0a20 2020 2020  monday)....     
+0000b080: 2020 2045 7861 6d70 6c65 3a3a 0a0a 2020     Example::..  
+0000b090: 2020 2020 2020 2020 2020 6672 6f6d 206d            from m
+0000b0a0: 6c72 756e 2e61 7069 2069 6d70 6f72 7420  lrun.api import 
+0000b0b0: 7363 6865 6d61 730a 0a20 2020 2020 2020  schemas..       
+0000b0c0: 2020 2020 2023 2045 7865 6375 7465 2074       # Execute t
+0000b0d0: 6865 2067 6574 5f64 6174 615f 6675 6e63  he get_data_func
+0000b0e0: 2066 756e 6374 696f 6e20 6576 6572 7920   function every 
+0000b0f0: 5475 6573 6461 7920 6174 2031 353a 3330  Tuesday at 15:30
+0000b100: 0a20 2020 2020 2020 2020 2020 2073 6368  .            sch
+0000b110: 6564 756c 6520 3d20 7363 6865 6d61 732e  edule = schemas.
+0000b120: 5363 6865 6475 6c65 496e 7075 7428 0a20  ScheduleInput(. 
+0000b130: 2020 2020 2020 2020 2020 2020 2020 206e                 n
+0000b140: 616d 653d 2272 756e 5f66 756e 635f 6f6e  ame="run_func_on
+0000b150: 5f74 7565 7364 6179 7322 2c0a 2020 2020  _tuesdays",.    
+0000b160: 2020 2020 2020 2020 2020 2020 6b69 6e64              kind
+0000b170: 3d22 6a6f 6222 2c0a 2020 2020 2020 2020  ="job",.        
+0000b180: 2020 2020 2020 2020 7363 6865 6475 6c65          schedule
+0000b190: 645f 6f62 6a65 6374 3d67 6574 5f64 6174  d_object=get_dat
+0000b1a0: 615f 6675 6e63 2c0a 2020 2020 2020 2020  a_func,.        
+0000b1b0: 2020 2020 2020 2020 6372 6f6e 5f74 7269          cron_tri
+0000b1c0: 6767 6572 3d73 6368 656d 6173 2e53 6368  gger=schemas.Sch
+0000b1d0: 6564 756c 6543 726f 6e54 7269 6767 6572  eduleCronTrigger
+0000b1e0: 2864 6179 5f6f 665f 7765 656b 3d27 7475  (day_of_week='tu
+0000b1f0: 6527 2c20 686f 7572 3d31 352c 206d 696e  e', hour=15, min
+0000b200: 7574 653d 3330 292c 0a20 2020 2020 2020  ute=30),.       
+0000b210: 2020 2020 2029 0a20 2020 2020 2020 2020       ).         
+0000b220: 2020 2064 622e 6372 6561 7465 5f73 6368     db.create_sch
+0000b230: 6564 756c 6528 7072 6f6a 6563 745f 6e61  edule(project_na
+0000b240: 6d65 2c20 7363 6865 6475 6c65 290a 2020  me, schedule).  
+0000b250: 2020 2020 2020 2222 220a 0a20 2020 2020        """..     
+0000b260: 2020 2070 726f 6a65 6374 203d 2070 726f     project = pro
+0000b270: 6a65 6374 206f 7220 636f 6e66 6967 2e64  ject or config.d
+0000b280: 6566 6175 6c74 5f70 726f 6a65 6374 0a20  efault_project. 
+0000b290: 2020 2020 2020 2070 6174 6820 3d20 6622         path = f"
+0000b2a0: 7072 6f6a 6563 7473 2f7b 7072 6f6a 6563  projects/{projec
+0000b2b0: 747d 2f73 6368 6564 756c 6573 220a 0a20  t}/schedules".. 
+0000b2c0: 2020 2020 2020 2065 7272 6f72 5f6d 6573         error_mes
+0000b2d0: 7361 6765 203d 2066 2246 6169 6c65 6420  sage = f"Failed 
+0000b2e0: 6372 6561 7469 6e67 2073 6368 6564 756c  creating schedul
+0000b2f0: 6520 7b70 726f 6a65 6374 7d2f 7b73 6368  e {project}/{sch
+0000b300: 6564 756c 652e 6e61 6d65 7d22 0a20 2020  edule.name}".   
+0000b310: 2020 2020 2073 656c 662e 6170 695f 6361       self.api_ca
+0000b320: 6c6c 2822 504f 5354 222c 2070 6174 682c  ll("POST", path,
+0000b330: 2065 7272 6f72 5f6d 6573 7361 6765 2c20   error_message, 
+0000b340: 626f 6479 3d64 6963 745f 746f 5f6a 736f  body=dict_to_jso
+0000b350: 6e28 7363 6865 6475 6c65 2e64 6963 7428  n(schedule.dict(
+0000b360: 2929 290a 0a20 2020 2064 6566 2075 7064  )))..    def upd
+0000b370: 6174 655f 7363 6865 6475 6c65 280a 2020  ate_schedule(.  
+0000b380: 2020 2020 2020 7365 6c66 2c20 7072 6f6a        self, proj
+0000b390: 6563 743a 2073 7472 2c20 6e61 6d65 3a20  ect: str, name: 
+0000b3a0: 7374 722c 2073 6368 6564 756c 653a 2073  str, schedule: s
+0000b3b0: 6368 656d 6173 2e53 6368 6564 756c 6555  chemas.ScheduleU
+0000b3c0: 7064 6174 650a 2020 2020 293a 0a20 2020  pdate.    ):.   
+0000b3d0: 2020 2020 2022 2222 5570 6461 7465 2061       """Update a
+0000b3e0: 6e20 6578 6973 7469 6e67 2073 6368 6564  n existing sched
+0000b3f0: 756c 652c 2072 6570 6c61 6365 2069 7420  ule, replace it 
+0000b400: 7769 7468 2074 6865 2064 6574 6169 6c73  with the details
+0000b410: 2063 6f6e 7461 696e 6564 2069 6e20 7468   contained in th
+0000b420: 6520 7363 6865 6475 6c65 206f 626a 6563  e schedule objec
+0000b430: 742e 2222 220a 0a20 2020 2020 2020 2070  t."""..        p
+0000b440: 726f 6a65 6374 203d 2070 726f 6a65 6374  roject = project
+0000b450: 206f 7220 636f 6e66 6967 2e64 6566 6175   or config.defau
+0000b460: 6c74 5f70 726f 6a65 6374 0a20 2020 2020  lt_project.     
+0000b470: 2020 2070 6174 6820 3d20 6622 7072 6f6a     path = f"proj
+0000b480: 6563 7473 2f7b 7072 6f6a 6563 747d 2f73  ects/{project}/s
+0000b490: 6368 6564 756c 6573 2f7b 6e61 6d65 7d22  chedules/{name}"
+0000b4a0: 0a0a 2020 2020 2020 2020 6572 726f 725f  ..        error_
+0000b4b0: 6d65 7373 6167 6520 3d20 6622 4661 696c  message = f"Fail
+0000b4c0: 6564 2075 7064 6174 696e 6720 7363 6865  ed updating sche
+0000b4d0: 6475 6c65 207b 7072 6f6a 6563 747d 2f7b  dule {project}/{
+0000b4e0: 6e61 6d65 7d22 0a20 2020 2020 2020 2073  name}".        s
+0000b4f0: 656c 662e 6170 695f 6361 6c6c 2822 5055  elf.api_call("PU
+0000b500: 5422 2c20 7061 7468 2c20 6572 726f 725f  T", path, error_
+0000b510: 6d65 7373 6167 652c 2062 6f64 793d 6469  message, body=di
+0000b520: 6374 5f74 6f5f 6a73 6f6e 2873 6368 6564  ct_to_json(sched
+0000b530: 756c 652e 6469 6374 2829 2929 0a0a 2020  ule.dict()))..  
+0000b540: 2020 6465 6620 6765 745f 7363 6865 6475    def get_schedu
+0000b550: 6c65 280a 2020 2020 2020 2020 7365 6c66  le(.        self
+0000b560: 2c20 7072 6f6a 6563 743a 2073 7472 2c20  , project: str, 
+0000b570: 6e61 6d65 3a20 7374 722c 2069 6e63 6c75  name: str, inclu
+0000b580: 6465 5f6c 6173 745f 7275 6e3a 2062 6f6f  de_last_run: boo
+0000b590: 6c20 3d20 4661 6c73 650a 2020 2020 2920  l = False.    ) 
+0000b5a0: 2d3e 2073 6368 656d 6173 2e53 6368 6564  -> schemas.Sched
+0000b5b0: 756c 654f 7574 7075 743a 0a20 2020 2020  uleOutput:.     
+0000b5c0: 2020 2022 2222 5265 7472 6965 7665 2064     """Retrieve d
+0000b5d0: 6574 6169 6c73 206f 6620 7468 6520 7363  etails of the sc
+0000b5e0: 6865 6475 6c65 2069 6e20 7175 6573 7469  hedule in questi
+0000b5f0: 6f6e 2e20 4265 7369 6465 7320 7265 7475  on. Besides retu
+0000b600: 726e 696e 6720 7468 6520 6465 7461 696c  rning the detail
+0000b610: 7320 6f66 2074 6865 2073 6368 6564 756c  s of the schedul
+0000b620: 6520 6f62 6a65 6374 2069 7473 656c 662c  e object itself,
+0000b630: 0a20 2020 2020 2020 2074 6869 7320 6675  .        this fu
+0000b640: 6e63 7469 6f6e 2061 6c73 6f20 7265 7475  nction also retu
+0000b650: 726e 7320 7468 6520 6e65 7874 2073 6368  rns the next sch
+0000b660: 6564 756c 6564 2072 756e 2066 6f72 2074  eduled run for t
+0000b670: 6869 7320 7370 6563 6966 6963 2073 6368  his specific sch
+0000b680: 6564 756c 652c 2061 7320 7765 6c6c 2061  edule, as well a
+0000b690: 7320 706f 7465 6e74 6961 6c6c 7920 7468  s potentially th
+0000b6a0: 650a 2020 2020 2020 2020 7265 7375 6c74  e.        result
+0000b6b0: 7320 6f66 2074 6865 206c 6173 7420 7275  s of the last ru
+0000b6c0: 6e20 6578 6563 7574 6564 2074 6872 6f75  n executed throu
+0000b6d0: 6768 2074 6869 7320 7363 6865 6475 6c65  gh this schedule
+0000b6e0: 2e0a 0a20 2020 2020 2020 203a 7061 7261  ...        :para
+0000b6f0: 6d20 7072 6f6a 6563 743a 2050 726f 6a65  m project: Proje
+0000b700: 6374 206e 616d 652e 0a20 2020 2020 2020  ct name..       
+0000b710: 203a 7061 7261 6d20 6e61 6d65 3a20 4e61   :param name: Na
+0000b720: 6d65 206f 6620 7468 6520 7363 6865 6475  me of the schedu
+0000b730: 6c65 206f 626a 6563 7420 746f 2071 7565  le object to que
+0000b740: 7279 2e0a 2020 2020 2020 2020 3a70 6172  ry..        :par
+0000b750: 616d 2069 6e63 6c75 6465 5f6c 6173 745f  am include_last_
+0000b760: 7275 6e3a 2057 6865 7468 6572 2074 6f20  run: Whether to 
+0000b770: 696e 636c 7564 6520 7468 6520 7265 7375  include the resu
+0000b780: 6c74 7320 6f66 2074 6865 2073 6368 6564  lts of the sched
+0000b790: 756c 6527 7320 6c61 7374 2072 756e 2069  ule's last run i
+0000b7a0: 6e20 7468 6520 7265 7370 6f6e 7365 2e0a  n the response..
+0000b7b0: 2020 2020 2020 2020 2222 220a 0a20 2020          """..   
+0000b7c0: 2020 2020 2070 726f 6a65 6374 203d 2070       project = p
+0000b7d0: 726f 6a65 6374 206f 7220 636f 6e66 6967  roject or config
+0000b7e0: 2e64 6566 6175 6c74 5f70 726f 6a65 6374  .default_project
+0000b7f0: 0a20 2020 2020 2020 2070 6174 6820 3d20  .        path = 
+0000b800: 6622 7072 6f6a 6563 7473 2f7b 7072 6f6a  f"projects/{proj
+0000b810: 6563 747d 2f73 6368 6564 756c 6573 2f7b  ect}/schedules/{
+0000b820: 6e61 6d65 7d22 0a20 2020 2020 2020 2065  name}".        e
+0000b830: 7272 6f72 5f6d 6573 7361 6765 203d 2066  rror_message = f
+0000b840: 2246 6169 6c65 6420 6765 7474 696e 6720  "Failed getting 
+0000b850: 7363 6865 6475 6c65 2066 6f72 207b 7072  schedule for {pr
+0000b860: 6f6a 6563 747d 2f7b 6e61 6d65 7d22 0a20  oject}/{name}". 
+0000b870: 2020 2020 2020 2072 6573 7020 3d20 7365         resp = se
+0000b880: 6c66 2e61 7069 5f63 616c 6c28 0a20 2020  lf.api_call(.   
+0000b890: 2020 2020 2020 2020 2022 4745 5422 2c20           "GET", 
+0000b8a0: 7061 7468 2c20 6572 726f 725f 6d65 7373  path, error_mess
+0000b8b0: 6167 652c 2070 6172 616d 733d 7b22 696e  age, params={"in
+0000b8c0: 636c 7564 655f 6c61 7374 5f72 756e 223a  clude_last_run":
+0000b8d0: 2069 6e63 6c75 6465 5f6c 6173 745f 7275   include_last_ru
+0000b8e0: 6e7d 0a20 2020 2020 2020 2029 0a20 2020  n}.        ).   
+0000b8f0: 2020 2020 2072 6574 7572 6e20 7363 6865       return sche
+0000b900: 6d61 732e 5363 6865 6475 6c65 4f75 7470  mas.ScheduleOutp
+0000b910: 7574 282a 2a72 6573 702e 6a73 6f6e 2829  ut(**resp.json()
+0000b920: 290a 0a20 2020 2064 6566 206c 6973 745f  )..    def list_
+0000b930: 7363 6865 6475 6c65 7328 0a20 2020 2020  schedules(.     
+0000b940: 2020 2073 656c 662c 0a20 2020 2020 2020     self,.       
+0000b950: 2070 726f 6a65 6374 3a20 7374 722c 0a20   project: str,. 
+0000b960: 2020 2020 2020 206e 616d 653a 2073 7472         name: str
+0000b970: 203d 204e 6f6e 652c 0a20 2020 2020 2020   = None,.       
+0000b980: 206b 696e 643a 2073 6368 656d 6173 2e53   kind: schemas.S
+0000b990: 6368 6564 756c 654b 696e 6473 203d 204e  cheduleKinds = N
+0000b9a0: 6f6e 652c 0a20 2020 2020 2020 2069 6e63  one,.        inc
+0000b9b0: 6c75 6465 5f6c 6173 745f 7275 6e3a 2062  lude_last_run: b
+0000b9c0: 6f6f 6c20 3d20 4661 6c73 652c 0a20 2020  ool = False,.   
+0000b9d0: 2029 202d 3e20 7363 6865 6d61 732e 5363   ) -> schemas.Sc
+0000b9e0: 6865 6475 6c65 734f 7574 7075 743a 0a20  hedulesOutput:. 
+0000b9f0: 2020 2020 2020 2022 2222 5265 7472 6965         """Retrie
+0000ba00: 7665 206c 6973 7420 6f66 2073 6368 6564  ve list of sched
+0000ba10: 756c 6573 206f 6620 7370 6563 6966 6963  ules of specific
+0000ba20: 206e 616d 6520 6f72 206b 696e 642e 0a0a   name or kind...
+0000ba30: 2020 2020 2020 2020 3a70 6172 616d 2070          :param p
+0000ba40: 726f 6a65 6374 3a20 5072 6f6a 6563 7420  roject: Project 
+0000ba50: 6e61 6d65 2e0a 2020 2020 2020 2020 3a70  name..        :p
+0000ba60: 6172 616d 206e 616d 653a 204e 616d 6520  aram name: Name 
+0000ba70: 6f66 2073 6368 6564 756c 6520 746f 2072  of schedule to r
+0000ba80: 6574 7269 6576 652e 2043 616e 2062 6520  etrieve. Can be 
+0000ba90: 6f6d 6974 7465 6420 746f 206c 6973 7420  omitted to list 
+0000baa0: 616c 6c20 7363 6865 6475 6c65 732e 0a20  all schedules.. 
+0000bab0: 2020 2020 2020 203a 7061 7261 6d20 6b69         :param ki
+0000bac0: 6e64 3a20 4b69 6e64 206f 6620 7363 6865  nd: Kind of sche
+0000bad0: 6475 6c65 206f 626a 6563 7473 2074 6f20  dule objects to 
+0000bae0: 7265 7472 6965 7665 2c20 6361 6e20 6265  retrieve, can be
+0000baf0: 2065 6974 6865 7220 6060 6a6f 6260 6020   either ``job`` 
+0000bb00: 6f72 2060 6070 6970 656c 696e 6560 602e  or ``pipeline``.
+0000bb10: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
+0000bb20: 696e 636c 7564 655f 6c61 7374 5f72 756e  include_last_run
+0000bb30: 3a20 5768 6574 6865 7220 746f 2072 6574  : Whether to ret
+0000bb40: 7572 6e20 666f 7220 6561 6368 2073 6368  urn for each sch
+0000bb50: 6564 756c 6520 7265 7475 726e 6564 2061  edule returned a
+0000bb60: 6c73 6f20 7468 6520 7265 7375 6c74 7320  lso the results 
+0000bb70: 6f66 2074 6865 206c 6173 7420 7275 6e20  of the last run 
+0000bb80: 6f66 0a20 2020 2020 2020 2020 2020 2074  of.            t
+0000bb90: 6861 7420 7363 6865 6475 6c65 2e0a 2020  hat schedule..  
+0000bba0: 2020 2020 2020 2222 220a 0a20 2020 2020        """..     
+0000bbb0: 2020 2070 726f 6a65 6374 203d 2070 726f     project = pro
+0000bbc0: 6a65 6374 206f 7220 636f 6e66 6967 2e64  ject or config.d
+0000bbd0: 6566 6175 6c74 5f70 726f 6a65 6374 0a20  efault_project. 
+0000bbe0: 2020 2020 2020 2070 6172 616d 7320 3d20         params = 
+0000bbf0: 7b22 6b69 6e64 223a 206b 696e 642c 2022  {"kind": kind, "
+0000bc00: 6e61 6d65 223a 206e 616d 652c 2022 696e  name": name, "in
+0000bc10: 636c 7564 655f 6c61 7374 5f72 756e 223a  clude_last_run":
+0000bc20: 2069 6e63 6c75 6465 5f6c 6173 745f 7275   include_last_ru
+0000bc30: 6e7d 0a20 2020 2020 2020 2070 6174 6820  n}.        path 
+0000bc40: 3d20 6622 7072 6f6a 6563 7473 2f7b 7072  = f"projects/{pr
+0000bc50: 6f6a 6563 747d 2f73 6368 6564 756c 6573  oject}/schedules
+0000bc60: 220a 2020 2020 2020 2020 6572 726f 725f  ".        error_
+0000bc70: 6d65 7373 6167 6520 3d20 6622 4661 696c  message = f"Fail
+0000bc80: 6564 206c 6973 7469 6e67 2073 6368 6564  ed listing sched
+0000bc90: 756c 6573 2066 6f72 207b 7072 6f6a 6563  ules for {projec
+0000bca0: 747d 203f 207b 6b69 6e64 7d20 7b6e 616d  t} ? {kind} {nam
+0000bcb0: 657d 220a 2020 2020 2020 2020 7265 7370  e}".        resp
+0000bcc0: 203d 2073 656c 662e 6170 695f 6361 6c6c   = self.api_call
+0000bcd0: 2822 4745 5422 2c20 7061 7468 2c20 6572  ("GET", path, er
+0000bce0: 726f 725f 6d65 7373 6167 652c 2070 6172  ror_message, par
+0000bcf0: 616d 733d 7061 7261 6d73 290a 2020 2020  ams=params).    
+0000bd00: 2020 2020 7265 7475 726e 2073 6368 656d      return schem
+0000bd10: 6173 2e53 6368 6564 756c 6573 4f75 7470  as.SchedulesOutp
+0000bd20: 7574 282a 2a72 6573 702e 6a73 6f6e 2829  ut(**resp.json()
+0000bd30: 290a 0a20 2020 2064 6566 2064 656c 6574  )..    def delet
+0000bd40: 655f 7363 6865 6475 6c65 2873 656c 662c  e_schedule(self,
+0000bd50: 2070 726f 6a65 6374 3a20 7374 722c 206e   project: str, n
+0000bd60: 616d 653a 2073 7472 293a 0a20 2020 2020  ame: str):.     
+0000bd70: 2020 2022 2222 4465 6c65 7465 2061 2073     """Delete a s
+0000bd80: 7065 6369 6669 6320 7363 6865 6475 6c65  pecific schedule
+0000bd90: 2062 7920 6e61 6d65 2e22 2222 0a0a 2020   by name."""..  
+0000bda0: 2020 2020 2020 7072 6f6a 6563 7420 3d20        project = 
+0000bdb0: 7072 6f6a 6563 7420 6f72 2063 6f6e 6669  project or confi
+0000bdc0: 672e 6465 6661 756c 745f 7072 6f6a 6563  g.default_projec
+0000bdd0: 740a 2020 2020 2020 2020 7061 7468 203d  t.        path =
+0000bde0: 2066 2270 726f 6a65 6374 732f 7b70 726f   f"projects/{pro
+0000bdf0: 6a65 6374 7d2f 7363 6865 6475 6c65 732f  ject}/schedules/
+0000be00: 7b6e 616d 657d 220a 2020 2020 2020 2020  {name}".        
+0000be10: 6572 726f 725f 6d65 7373 6167 6520 3d20  error_message = 
+0000be20: 6622 4661 696c 6564 2064 656c 6574 696e  f"Failed deletin
+0000be30: 6720 7363 6865 6475 6c65 207b 7072 6f6a  g schedule {proj
+0000be40: 6563 747d 2f7b 6e61 6d65 7d22 0a20 2020  ect}/{name}".   
+0000be50: 2020 2020 2073 656c 662e 6170 695f 6361       self.api_ca
+0000be60: 6c6c 2822 4445 4c45 5445 222c 2070 6174  ll("DELETE", pat
+0000be70: 682c 2065 7272 6f72 5f6d 6573 7361 6765  h, error_message
+0000be80: 290a 0a20 2020 2064 6566 2069 6e76 6f6b  )..    def invok
+0000be90: 655f 7363 6865 6475 6c65 2873 656c 662c  e_schedule(self,
+0000bea0: 2070 726f 6a65 6374 3a20 7374 722c 206e   project: str, n
+0000beb0: 616d 653a 2073 7472 293a 0a20 2020 2020  ame: str):.     
+0000bec0: 2020 2022 2222 4578 6563 7574 6520 7468     """Execute th
+0000bed0: 6520 6f62 6a65 6374 2072 6566 6572 656e  e object referen
+0000bee0: 6365 6420 6279 2074 6865 2073 6368 6564  ced by the sched
+0000bef0: 756c 6520 696d 6d65 6469 6174 656c 792e  ule immediately.
+0000bf00: 2222 220a 0a20 2020 2020 2020 2070 726f  """..        pro
+0000bf10: 6a65 6374 203d 2070 726f 6a65 6374 206f  ject = project o
+0000bf20: 7220 636f 6e66 6967 2e64 6566 6175 6c74  r config.default
+0000bf30: 5f70 726f 6a65 6374 0a20 2020 2020 2020  _project.       
+0000bf40: 2070 6174 6820 3d20 6622 7072 6f6a 6563   path = f"projec
+0000bf50: 7473 2f7b 7072 6f6a 6563 747d 2f73 6368  ts/{project}/sch
+0000bf60: 6564 756c 6573 2f7b 6e61 6d65 7d2f 696e  edules/{name}/in
+0000bf70: 766f 6b65 220a 2020 2020 2020 2020 6572  voke".        er
+0000bf80: 726f 725f 6d65 7373 6167 6520 3d20 6622  ror_message = f"
+0000bf90: 4661 696c 6564 2069 6e76 6f6b 696e 6720  Failed invoking 
+0000bfa0: 7363 6865 6475 6c65 207b 7072 6f6a 6563  schedule {projec
+0000bfb0: 747d 2f7b 6e61 6d65 7d22 0a20 2020 2020  t}/{name}".     
+0000bfc0: 2020 2073 656c 662e 6170 695f 6361 6c6c     self.api_call
+0000bfd0: 2822 504f 5354 222c 2070 6174 682c 2065  ("POST", path, e
+0000bfe0: 7272 6f72 5f6d 6573 7361 6765 290a 0a20  rror_message).. 
+0000bff0: 2020 2064 6566 2072 656d 6f74 655f 6275     def remote_bu
+0000c000: 696c 6465 7228 0a20 2020 2020 2020 2073  ilder(.        s
+0000c010: 656c 662c 0a20 2020 2020 2020 2066 756e  elf,.        fun
+0000c020: 632c 0a20 2020 2020 2020 2077 6974 685f  c,.        with_
+0000c030: 6d6c 7275 6e2c 0a20 2020 2020 2020 206d  mlrun,.        m
+0000c040: 6c72 756e 5f76 6572 7369 6f6e 5f73 7065  lrun_version_spe
+0000c050: 6369 6669 6572 3d4e 6f6e 652c 0a20 2020  cifier=None,.   
+0000c060: 2020 2020 2073 6b69 705f 6465 706c 6f79       skip_deploy
+0000c070: 6564 3d46 616c 7365 2c0a 2020 2020 2020  ed=False,.      
+0000c080: 2020 6275 696c 6465 725f 656e 763d 4e6f    builder_env=No
+0000c090: 6e65 2c0a 2020 2020 293a 0a20 2020 2020  ne,.    ):.     
+0000c0a0: 2020 2022 2222 4275 696c 6420 7468 6520     """Build the 
+0000c0b0: 706f 6420 696d 6167 6520 666f 7220 6120  pod image for a 
+0000c0c0: 6675 6e63 7469 6f6e 2c20 666f 7220 6578  function, for ex
+0000c0d0: 6563 7574 696f 6e20 6f6e 2061 2072 656d  ecution on a rem
+0000c0e0: 6f74 6520 636c 7573 7465 722e 2054 6869  ote cluster. Thi
+0000c0f0: 7320 6973 2065 7865 6375 7465 6420 6279  s is executed by
+0000c100: 2074 6865 204d 4c52 756e 0a20 2020 2020   the MLRun.     
+0000c110: 2020 2041 5049 2073 6572 7665 722c 2061     API server, a
+0000c120: 6e64 2063 7265 6174 6573 2061 2044 6f63  nd creates a Doc
+0000c130: 6b65 7220 696d 6167 6520 6f75 7420 6f66  ker image out of
+0000c140: 2074 6865 2066 756e 6374 696f 6e20 7072   the function pr
+0000c150: 6f76 6964 6564 2061 6e64 2061 6e79 2073  ovided and any s
+0000c160: 7065 6369 6669 6320 6275 696c 640a 2020  pecific build.  
+0000c170: 2020 2020 2020 696e 7374 7275 6374 696f        instructio
+0000c180: 6e73 2070 726f 7669 6465 6420 7769 7468  ns provided with
+0000c190: 696e 2e20 5468 6973 2069 7320 6120 7072  in. This is a pr
+0000c1a0: 652d 7265 7175 6973 6974 6520 666f 7220  e-requisite for 
+0000c1b0: 7265 6d6f 7465 6c79 2065 7865 6375 7469  remotely executi
+0000c1c0: 6e67 2061 2066 756e 6374 696f 6e2c 2075  ng a function, u
+0000c1d0: 6e6c 6573 7320 7573 696e 670a 2020 2020  nless using.    
+0000c1e0: 2020 2020 6120 7072 652d 6465 706c 6f79      a pre-deploy
+0000c1f0: 6564 2069 6d61 6765 2e0a 0a20 2020 2020  ed image...     
+0000c200: 2020 203a 7061 7261 6d20 6675 6e63 3a20     :param func: 
+0000c210: 4675 6e63 7469 6f6e 2074 6f20 6275 696c  Function to buil
+0000c220: 642e 0a20 2020 2020 2020 203a 7061 7261  d..        :para
+0000c230: 6d20 7769 7468 5f6d 6c72 756e 3a20 5768  m with_mlrun: Wh
+0000c240: 6574 6865 7220 746f 2061 6464 204d 4c52  ether to add MLR
+0000c250: 756e 2070 6163 6b61 6765 2074 6f20 7468  un package to th
+0000c260: 6520 6275 696c 7420 7061 636b 6167 652e  e built package.
+0000c270: 2054 6869 7320 6973 206e 6f74 2072 6571   This is not req
+0000c280: 7569 7265 6420 6966 2075 7369 6e67 2061  uired if using a
+0000c290: 2062 6173 650a 2020 2020 2020 2020 2020   base.          
+0000c2a0: 2020 696d 6167 6520 7468 6174 2061 6c72    image that alr
+0000c2b0: 6561 6479 2068 6173 204d 4c52 756e 2069  eady has MLRun i
+0000c2c0: 6e20 6974 2e0a 2020 2020 2020 2020 3a70  n it..        :p
+0000c2d0: 6172 616d 206d 6c72 756e 5f76 6572 7369  aram mlrun_versi
+0000c2e0: 6f6e 5f73 7065 6369 6669 6572 3a20 5665  on_specifier: Ve
+0000c2f0: 7273 696f 6e20 6f66 204d 4c52 756e 2074  rsion of MLRun t
+0000c300: 6f20 696e 636c 7564 6520 696e 2074 6865  o include in the
+0000c310: 2062 7569 6c74 2069 6d61 6765 2e0a 2020   built image..  
+0000c320: 2020 2020 2020 3a70 6172 616d 2073 6b69        :param ski
+0000c330: 705f 6465 706c 6f79 6564 3a20 536b 6970  p_deployed: Skip
+0000c340: 2074 6865 2062 7569 6c64 2069 6620 7765   the build if we
+0000c350: 2061 6c72 6561 6479 2068 6176 6520 616e   already have an
+0000c360: 2069 6d61 6765 2066 6f72 2074 6865 2066   image for the f
+0000c370: 756e 6374 696f 6e2e 0a20 2020 2020 2020  unction..       
+0000c380: 203a 7061 7261 6d20 6275 696c 6465 725f   :param builder_
+0000c390: 656e 763a 2020 204b 616e 696b 6f20 6275  env:   Kaniko bu
+0000c3a0: 696c 6465 7220 706f 6420 656e 7620 7661  ilder pod env va
+0000c3b0: 7273 2064 6963 7420 2866 6f72 2063 6f6e  rs dict (for con
+0000c3c0: 6669 672f 6372 6564 656e 7469 616c 7329  fig/credentials)
+0000c3d0: 0a20 2020 2020 2020 2022 2222 0a0a 2020  .        """..  
+0000c3e0: 2020 2020 2020 7472 793a 0a20 2020 2020        try:.     
+0000c3f0: 2020 2020 2020 2072 6571 203d 207b 0a20         req = {. 
+0000c400: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+0000c410: 6675 6e63 7469 6f6e 223a 2066 756e 632e  function": func.
+0000c420: 746f 5f64 6963 7428 292c 0a20 2020 2020  to_dict(),.     
+0000c430: 2020 2020 2020 2020 2020 2022 7769 7468             "with
+0000c440: 5f6d 6c72 756e 223a 2062 6f6f 6c32 7374  _mlrun": bool2st
+0000c450: 7228 7769 7468 5f6d 6c72 756e 292c 0a20  r(with_mlrun),. 
+0000c460: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+0000c470: 736b 6970 5f64 6570 6c6f 7965 6422 3a20  skip_deployed": 
+0000c480: 736b 6970 5f64 6570 6c6f 7965 642c 0a20  skip_deployed,. 
+0000c490: 2020 2020 2020 2020 2020 207d 0a20 2020             }.   
+0000c4a0: 2020 2020 2020 2020 2069 6620 6d6c 7275           if mlru
+0000c4b0: 6e5f 7665 7273 696f 6e5f 7370 6563 6966  n_version_specif
+0000c4c0: 6965 723a 0a20 2020 2020 2020 2020 2020  ier:.           
+0000c4d0: 2020 2020 2072 6571 5b22 6d6c 7275 6e5f       req["mlrun_
+0000c4e0: 7665 7273 696f 6e5f 7370 6563 6966 6965  version_specifie
+0000c4f0: 7222 5d20 3d20 6d6c 7275 6e5f 7665 7273  r"] = mlrun_vers
+0000c500: 696f 6e5f 7370 6563 6966 6965 720a 2020  ion_specifier.  
+0000c510: 2020 2020 2020 2020 2020 6966 2062 7569            if bui
+0000c520: 6c64 6572 5f65 6e76 3a0a 2020 2020 2020  lder_env:.      
+0000c530: 2020 2020 2020 2020 2020 7265 715b 2262            req["b
+0000c540: 7569 6c64 6572 5f65 6e76 225d 203d 2062  uilder_env"] = b
+0000c550: 7569 6c64 6572 5f65 6e76 0a20 2020 2020  uilder_env.     
+0000c560: 2020 2020 2020 2072 6573 7020 3d20 7365         resp = se
+0000c570: 6c66 2e61 7069 5f63 616c 6c28 2250 4f53  lf.api_call("POS
+0000c580: 5422 2c20 2262 7569 6c64 2f66 756e 6374  T", "build/funct
+0000c590: 696f 6e22 2c20 6a73 6f6e 3d72 6571 290a  ion", json=req).
+0000c5a0: 2020 2020 2020 2020 6578 6365 7074 204f          except O
+0000c5b0: 5345 7272 6f72 2061 7320 6572 723a 0a20  SError as err:. 
+0000c5c0: 2020 2020 2020 2020 2020 206c 6f67 6765             logge
+0000c5d0: 722e 6572 726f 7228 6622 6572 726f 7220  r.error(f"error 
+0000c5e0: 7375 626d 6974 7469 6e67 2062 7569 6c64  submitting build
+0000c5f0: 2074 6173 6b3a 207b 6572 725f 746f 5f73   task: {err_to_s
+0000c600: 7472 2865 7272 297d 2229 0a20 2020 2020  tr(err)}").     
+0000c610: 2020 2020 2020 2072 6169 7365 204f 5345         raise OSE
+0000c620: 7272 6f72 2866 2265 7272 6f72 3a20 6361  rror(f"error: ca
+0000c630: 6e6e 6f74 2073 7562 6d69 7420 6275 696c  nnot submit buil
+0000c640: 642c 207b 6572 725f 746f 5f73 7472 2865  d, {err_to_str(e
+0000c650: 7272 297d 2229 0a0a 2020 2020 2020 2020  rr)}")..        
+0000c660: 6966 206e 6f74 2072 6573 702e 6f6b 3a0a  if not resp.ok:.
+0000c670: 2020 2020 2020 2020 2020 2020 6c6f 6767              logg
+0000c680: 6572 2e65 7272 6f72 2866 2262 6164 2072  er.error(f"bad r
+0000c690: 6573 7021 215c 6e7b 7265 7370 2e74 6578  esp!!\n{resp.tex
+0000c6a0: 747d 2229 0a20 2020 2020 2020 2020 2020  t}").           
+0000c6b0: 2072 6169 7365 2056 616c 7565 4572 726f   raise ValueErro
+0000c6c0: 7228 2262 6164 2066 756e 6374 696f 6e20  r("bad function 
+0000c6d0: 7275 6e20 7265 7370 6f6e 7365 2229 0a0a  run response")..
+0000c6e0: 2020 2020 2020 2020 7265 7475 726e 2072          return r
+0000c6f0: 6573 702e 6a73 6f6e 2829 0a0a 2020 2020  esp.json()..    
+0000c700: 6465 6620 6765 745f 6275 696c 6465 725f  def get_builder_
+0000c710: 7374 6174 7573 280a 2020 2020 2020 2020  status(.        
+0000c720: 7365 6c66 2c0a 2020 2020 2020 2020 6675  self,.        fu
+0000c730: 6e63 3a20 4261 7365 5275 6e74 696d 652c  nc: BaseRuntime,
+0000c740: 0a20 2020 2020 2020 206f 6666 7365 743d  .        offset=
+0000c750: 302c 0a20 2020 2020 2020 206c 6f67 733d  0,.        logs=
+0000c760: 5472 7565 2c0a 2020 2020 2020 2020 6c61  True,.        la
+0000c770: 7374 5f6c 6f67 5f74 696d 6573 7461 6d70  st_log_timestamp
+0000c780: 3d30 2c0a 2020 2020 2020 2020 7665 7262  =0,.        verb
+0000c790: 6f73 653d 4661 6c73 652c 0a20 2020 2029  ose=False,.    )
+0000c7a0: 3a0a 2020 2020 2020 2020 2222 2252 6574  :.        """Ret
+0000c7b0: 7269 6576 6520 7468 6520 7374 6174 7573  rieve the status
+0000c7c0: 206f 6620 6120 6275 696c 6420 6f70 6572   of a build oper
+0000c7d0: 6174 696f 6e20 6375 7272 656e 746c 7920  ation currently 
+0000c7e0: 696e 2070 726f 6772 6573 732e 0a0a 2020  in progress...  
+0000c7f0: 2020 2020 2020 3a70 6172 616d 2066 756e        :param fun
+0000c800: 633a 2046 756e 6374 696f 6e20 6f62 6a65  c: Function obje
+0000c810: 6374 2074 6861 7420 6973 2062 6569 6e67  ct that is being
+0000c820: 2062 7569 6c74 2e0a 2020 2020 2020 2020   built..        
+0000c830: 3a70 6172 616d 206f 6666 7365 743a 204f  :param offset: O
+0000c840: 6666 7365 7420 696e 746f 2074 6865 2062  ffset into the b
+0000c850: 7569 6c64 206c 6f67 7320 746f 2072 6574  uild logs to ret
+0000c860: 7269 6576 6520 6c6f 6773 2066 726f 6d2e  rieve logs from.
+0000c870: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
+0000c880: 6c6f 6773 3a20 5368 6f75 6c64 2062 7569  logs: Should bui
+0000c890: 6c64 206c 6f67 7320 6265 2072 6574 7269  ld logs be retri
+0000c8a0: 6576 6564 2e0a 2020 2020 2020 2020 3a70  eved..        :p
+0000c8b0: 6172 616d 206c 6173 745f 6c6f 675f 7469  aram last_log_ti
+0000c8c0: 6d65 7374 616d 703a 204c 6173 7420 7469  mestamp: Last ti
+0000c8d0: 6d65 7374 616d 7020 6f66 206c 6f67 7320  mestamp of logs 
+0000c8e0: 7468 6174 2077 6572 6520 616c 7265 6164  that were alread
+0000c8f0: 7920 7265 7472 6965 7665 642e 2046 756e  y retrieved. Fun
+0000c900: 6374 696f 6e20 7769 6c6c 2072 6574 7572  ction will retur
+0000c910: 6e20 6f6e 6c79 206c 6f67 730a 2020 2020  n only logs.    
+0000c920: 2020 2020 2020 2020 6c61 7465 7220 7468          later th
+0000c930: 616e 2074 6869 7320 7061 7261 6d65 7465  an this paramete
+0000c940: 722e 0a20 2020 2020 2020 203a 7061 7261  r..        :para
+0000c950: 6d20 7665 7262 6f73 653a 2041 6464 2076  m verbose: Add v
+0000c960: 6572 626f 7365 206c 6f67 7320 696e 746f  erbose logs into
+0000c970: 2074 6865 206f 7574 7075 742e 0a20 2020   the output..   
+0000c980: 2020 2020 203a 7265 7475 726e 733a 2054       :returns: T
+0000c990: 6865 2066 6f6c 6c6f 7769 6e67 2070 6172  he following par
+0000c9a0: 616d 6574 6572 733a 0a0a 2020 2020 2020  ameters:..      
+0000c9b0: 2020 2020 2020 2d20 5465 7874 206f 6620        - Text of 
+0000c9c0: 6275 696c 6465 7220 6c6f 6773 2e0a 2020  builder logs..  
+0000c9d0: 2020 2020 2020 2020 2020 2d20 5469 6d65            - Time
+0000c9e0: 7374 616d 7020 6f66 206c 6173 7420 6c6f  stamp of last lo
+0000c9f0: 6720 7265 7472 6965 7665 642c 2074 6f20  g retrieved, to 
+0000ca00: 6265 2075 7365 6420 696e 2073 7562 7365  be used in subse
+0000ca10: 7175 656e 7420 6361 6c6c 7320 746f 2074  quent calls to t
+0000ca20: 6869 7320 6675 6e63 7469 6f6e 2e0a 0a20  his function... 
+0000ca30: 2020 2020 2020 2020 2020 2054 6865 2066             The f
+0000ca40: 756e 6374 696f 6e20 616c 736f 2075 7064  unction also upd
+0000ca50: 6174 6573 2069 6e74 6572 6e61 6c20 6d65  ates internal me
+0000ca60: 6d62 6572 7320 6f66 2074 6865 2060 6066  mbers of the ``f
+0000ca70: 756e 6360 6020 6f62 6a65 6374 2074 6f20  unc`` object to 
+0000ca80: 7265 666c 6563 7420 6275 696c 6420 7072  reflect build pr
+0000ca90: 6f63 6573 7320 696e 666f 2e0a 2020 2020  ocess info..    
+0000caa0: 2020 2020 2222 220a 0a20 2020 2020 2020      """..       
+0000cab0: 2074 7279 3a0a 2020 2020 2020 2020 2020   try:.          
+0000cac0: 2020 7061 7261 6d73 203d 207b 0a20 2020    params = {.   
+0000cad0: 2020 2020 2020 2020 2020 2020 2022 6e61               "na
+0000cae0: 6d65 223a 206e 6f72 6d61 6c69 7a65 5f6e  me": normalize_n
+0000caf0: 616d 6528 6675 6e63 2e6d 6574 6164 6174  ame(func.metadat
+0000cb00: 612e 6e61 6d65 292c 0a20 2020 2020 2020  a.name),.       
+0000cb10: 2020 2020 2020 2020 2022 7072 6f6a 6563           "projec
+0000cb20: 7422 3a20 6675 6e63 2e6d 6574 6164 6174  t": func.metadat
+0000cb30: 612e 7072 6f6a 6563 742c 0a20 2020 2020  a.project,.     
+0000cb40: 2020 2020 2020 2020 2020 2022 7461 6722             "tag"
+0000cb50: 3a20 6675 6e63 2e6d 6574 6164 6174 612e  : func.metadata.
+0000cb60: 7461 672c 0a20 2020 2020 2020 2020 2020  tag,.           
+0000cb70: 2020 2020 2022 6c6f 6773 223a 2062 6f6f       "logs": boo
+0000cb80: 6c32 7374 7228 6c6f 6773 292c 0a20 2020  l2str(logs),.   
+0000cb90: 2020 2020 2020 2020 2020 2020 2022 6f66               "of
+0000cba0: 6673 6574 223a 2073 7472 286f 6666 7365  fset": str(offse
+0000cbb0: 7429 2c0a 2020 2020 2020 2020 2020 2020  t),.            
+0000cbc0: 2020 2020 226c 6173 745f 6c6f 675f 7469      "last_log_ti
+0000cbd0: 6d65 7374 616d 7022 3a20 7374 7228 6c61  mestamp": str(la
+0000cbe0: 7374 5f6c 6f67 5f74 696d 6573 7461 6d70  st_log_timestamp
+0000cbf0: 292c 0a20 2020 2020 2020 2020 2020 2020  ),.             
+0000cc00: 2020 2022 7665 7262 6f73 6522 3a20 626f     "verbose": bo
+0000cc10: 6f6c 3273 7472 2876 6572 626f 7365 292c  ol2str(verbose),
+0000cc20: 0a20 2020 2020 2020 2020 2020 207d 0a20  .            }. 
+0000cc30: 2020 2020 2020 2020 2020 2072 6573 7020             resp 
+0000cc40: 3d20 7365 6c66 2e61 7069 5f63 616c 6c28  = self.api_call(
+0000cc50: 2247 4554 222c 2022 6275 696c 642f 7374  "GET", "build/st
+0000cc60: 6174 7573 222c 2070 6172 616d 733d 7061  atus", params=pa
+0000cc70: 7261 6d73 290a 2020 2020 2020 2020 6578  rams).        ex
+0000cc80: 6365 7074 204f 5345 7272 6f72 2061 7320  cept OSError as 
+0000cc90: 6572 723a 0a20 2020 2020 2020 2020 2020  err:.           
+0000cca0: 206c 6f67 6765 722e 6572 726f 7228 6622   logger.error(f"
+0000ccb0: 6572 726f 7220 6765 7474 696e 6720 6275  error getting bu
+0000ccc0: 696c 6420 7374 6174 7573 3a20 7b65 7272  ild status: {err
+0000ccd0: 5f74 6f5f 7374 7228 6572 7229 7d22 290a  _to_str(err)}").
+0000cce0: 2020 2020 2020 2020 2020 2020 7261 6973              rais
+0000ccf0: 6520 4f53 4572 726f 7228 6622 6572 726f  e OSError(f"erro
+0000cd00: 723a 2063 616e 6e6f 7420 6765 7420 6275  r: cannot get bu
+0000cd10: 696c 6420 7374 6174 7573 2c20 7b65 7272  ild status, {err
+0000cd20: 5f74 6f5f 7374 7228 6572 7229 7d22 290a  _to_str(err)}").
+0000cd30: 0a20 2020 2020 2020 2069 6620 6e6f 7420  .        if not 
+0000cd40: 7265 7370 2e6f 6b3a 0a20 2020 2020 2020  resp.ok:.       
+0000cd50: 2020 2020 206c 6f67 6765 722e 7761 726e       logger.warn
+0000cd60: 696e 6728 6622 6661 696c 6564 2072 6573  ing(f"failed res
+0000cd70: 702c 207b 7265 7370 2e74 6578 747d 2229  p, {resp.text}")
+0000cd80: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
+0000cd90: 7365 2052 756e 4442 4572 726f 7228 2262  se RunDBError("b
+0000cda0: 6164 2066 756e 6374 696f 6e20 6275 696c  ad function buil
+0000cdb0: 6420 7265 7370 6f6e 7365 2229 0a0a 2020  d response")..  
+0000cdc0: 2020 2020 2020 6966 2072 6573 702e 6865        if resp.he
+0000cdd0: 6164 6572 733a 0a20 2020 2020 2020 2020  aders:.         
+0000cde0: 2020 2066 756e 632e 7374 6174 7573 2e73     func.status.s
+0000cdf0: 7461 7465 203d 2072 6573 702e 6865 6164  tate = resp.head
+0000ce00: 6572 732e 6765 7428 2278 2d6d 6c72 756e  ers.get("x-mlrun
+0000ce10: 2d66 756e 6374 696f 6e2d 7374 6174 7573  -function-status
+0000ce20: 222c 2022 2229 0a20 2020 2020 2020 2020  ", "").         
+0000ce30: 2020 206c 6173 745f 6c6f 675f 7469 6d65     last_log_time
+0000ce40: 7374 616d 7020 3d20 666c 6f61 7428 0a20  stamp = float(. 
+0000ce50: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+0000ce60: 6573 702e 6865 6164 6572 732e 6765 7428  esp.headers.get(
+0000ce70: 2278 2d6d 6c72 756e 2d6c 6173 742d 7469  "x-mlrun-last-ti
+0000ce80: 6d65 7374 616d 7022 2c20 2230 2e30 2229  mestamp", "0.0")
+0000ce90: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
+0000cea0: 2020 2020 2020 2020 2020 2069 6620 6675             if fu
+0000ceb0: 6e63 2e6b 696e 6420 696e 206d 6c72 756e  nc.kind in mlrun
+0000cec0: 2e72 756e 7469 6d65 732e 5275 6e74 696d  .runtimes.Runtim
+0000ced0: 654b 696e 6473 2e6e 7563 6c69 6f5f 7275  eKinds.nuclio_ru
+0000cee0: 6e74 696d 6573 2829 3a0a 2020 2020 2020  ntimes():.      
+0000cef0: 2020 2020 2020 2020 2020 6675 6e63 2e73            func.s
+0000cf00: 7461 7475 732e 6164 6472 6573 7320 3d20  tatus.address = 
+0000cf10: 7265 7370 2e68 6561 6465 7273 2e67 6574  resp.headers.get
+0000cf20: 2822 782d 6d6c 7275 6e2d 6164 6472 6573  ("x-mlrun-addres
+0000cf30: 7322 2c20 2222 290a 2020 2020 2020 2020  s", "").        
+0000cf40: 2020 2020 2020 2020 6675 6e63 2e73 7461          func.sta
+0000cf50: 7475 732e 6e75 636c 696f 5f6e 616d 6520  tus.nuclio_name 
+0000cf60: 3d20 7265 7370 2e68 6561 6465 7273 2e67  = resp.headers.g
+0000cf70: 6574 2822 782d 6d6c 7275 6e2d 6e61 6d65  et("x-mlrun-name
+0000cf80: 222c 2022 2229 0a20 2020 2020 2020 2020  ", "").         
+0000cf90: 2020 2020 2020 2066 756e 632e 7374 6174         func.stat
+0000cfa0: 7573 2e69 6e74 6572 6e61 6c5f 696e 766f  us.internal_invo
+0000cfb0: 6361 7469 6f6e 5f75 726c 7320 3d20 7265  cation_urls = re
+0000cfc0: 7370 2e68 6561 6465 7273 2e67 6574 280a  sp.headers.get(.
+0000cfd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000cfe0: 2020 2020 2278 2d6d 6c72 756e 2d69 6e74      "x-mlrun-int
+0000cff0: 6572 6e61 6c2d 696e 766f 6361 7469 6f6e  ernal-invocation
+0000d000: 2d75 726c 7322 2c20 2222 0a20 2020 2020  -urls", "".     
+0000d010: 2020 2020 2020 2020 2020 2029 2e73 706c             ).spl
+0000d020: 6974 2822 2c22 290a 2020 2020 2020 2020  it(",").        
+0000d030: 2020 2020 2020 2020 6675 6e63 2e73 7461          func.sta
+0000d040: 7475 732e 6578 7465 726e 616c 5f69 6e76  tus.external_inv
+0000d050: 6f63 6174 696f 6e5f 7572 6c73 203d 2072  ocation_urls = r
+0000d060: 6573 702e 6865 6164 6572 732e 6765 7428  esp.headers.get(
+0000d070: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000d080: 2020 2020 2022 782d 6d6c 7275 6e2d 6578       "x-mlrun-ex
+0000d090: 7465 726e 616c 2d69 6e76 6f63 6174 696f  ternal-invocatio
+0000d0a0: 6e2d 7572 6c73 222c 2022 220a 2020 2020  n-urls", "".    
+0000d0b0: 2020 2020 2020 2020 2020 2020 292e 7370              ).sp
+0000d0c0: 6c69 7428 222c 2229 0a20 2020 2020 2020  lit(",").       
+0000d0d0: 2020 2020 2020 2020 2066 756e 632e 7374           func.st
+0000d0e0: 6174 7573 2e63 6f6e 7461 696e 6572 5f69  atus.container_i
 0000d0f0: 6d61 6765 203d 2072 6573 702e 6865 6164  mage = resp.head
-0000d100: 6572 732e 6765 7428 2266 756e 6374 696f  ers.get("functio
-0000d110: 6e5f 696d 6167 6522 2c20 2222 290a 0a20  n_image", "").. 
-0000d120: 2020 2020 2020 2074 6578 7420 3d20 2222         text = ""
-0000d130: 0a20 2020 2020 2020 2069 6620 7265 7370  .        if resp
-0000d140: 2e63 6f6e 7465 6e74 3a0a 2020 2020 2020  .content:.      
-0000d150: 2020 2020 2020 7465 7874 203d 2072 6573        text = res
-0000d160: 702e 636f 6e74 656e 742e 6465 636f 6465  p.content.decode
-0000d170: 2829 0a20 2020 2020 2020 2072 6574 7572  ().        retur
-0000d180: 6e20 7465 7874 2c20 6c61 7374 5f6c 6f67  n text, last_log
-0000d190: 5f74 696d 6573 7461 6d70 0a0a 2020 2020  _timestamp..    
-0000d1a0: 6465 6620 7265 6d6f 7465 5f73 7461 7274  def remote_start
-0000d1b0: 2873 656c 662c 2066 756e 635f 7572 6c29  (self, func_url)
-0000d1c0: 202d 3e20 7363 6865 6d61 732e 4261 636b   -> schemas.Back
-0000d1d0: 6772 6f75 6e64 5461 736b 3a0a 2020 2020  groundTask:.    
-0000d1e0: 2020 2020 2222 2245 7865 6375 7465 2061      """Execute a
-0000d1f0: 2066 756e 6374 696f 6e20 7265 6d6f 7465   function remote
-0000d200: 6c79 2c20 5573 6564 2066 6f72 2060 6064  ly, Used for ``d
-0000d210: 6173 6b60 6020 6675 6e63 7469 6f6e 732e  ask`` functions.
-0000d220: 0a0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
-0000d230: 2066 756e 635f 7572 6c3a 2055 524c 2074   func_url: URL t
-0000d240: 6f20 7468 6520 6675 6e63 7469 6f6e 2074  o the function t
-0000d250: 6f20 6265 2065 7865 6375 7465 642e 0a20  o be executed.. 
-0000d260: 2020 2020 2020 203a 7265 7475 726e 733a         :returns:
-0000d270: 2041 2042 6163 6b67 726f 756e 6454 6173   A BackgroundTas
-0000d280: 6b20 6f62 6a65 6374 2c20 7769 7468 2064  k object, with d
-0000d290: 6574 6169 6c73 206f 6e20 6578 6563 7574  etails on execut
-0000d2a0: 696f 6e20 7072 6f63 6573 7320 616e 6420  ion process and 
-0000d2b0: 6974 7320 7374 6174 7573 2e0a 2020 2020  its status..    
-0000d2c0: 2020 2020 2222 220a 0a20 2020 2020 2020      """..       
-0000d2d0: 2074 7279 3a0a 2020 2020 2020 2020 2020   try:.          
-0000d2e0: 2020 7265 7120 3d20 7b22 6675 6e63 7469    req = {"functi
-0000d2f0: 6f6e 5572 6c22 3a20 6675 6e63 5f75 726c  onUrl": func_url
-0000d300: 7d0a 2020 2020 2020 2020 2020 2020 7265  }.            re
-0000d310: 7370 203d 2073 656c 662e 6170 695f 6361  sp = self.api_ca
-0000d320: 6c6c 280a 2020 2020 2020 2020 2020 2020  ll(.            
-0000d330: 2020 2020 2250 4f53 5422 2c0a 2020 2020      "POST",.    
-0000d340: 2020 2020 2020 2020 2020 2020 2273 7461              "sta
-0000d350: 7274 2f66 756e 6374 696f 6e22 2c0a 2020  rt/function",.  
-0000d360: 2020 2020 2020 2020 2020 2020 2020 6a73                js
-0000d370: 6f6e 3d72 6571 2c0a 2020 2020 2020 2020  on=req,.        
-0000d380: 2020 2020 2020 2020 7469 6d65 6f75 743d          timeout=
-0000d390: 696e 7428 636f 6e66 6967 2e73 7562 6d69  int(config.submi
-0000d3a0: 745f 7469 6d65 6f75 7429 206f 7220 3630  t_timeout) or 60
-0000d3b0: 2c0a 2020 2020 2020 2020 2020 2020 290a  ,.            ).
-0000d3c0: 2020 2020 2020 2020 6578 6365 7074 204f          except O
-0000d3d0: 5345 7272 6f72 2061 7320 6572 723a 0a20  SError as err:. 
-0000d3e0: 2020 2020 2020 2020 2020 206c 6f67 6765             logge
-0000d3f0: 722e 6572 726f 7228 6622 6572 726f 7220  r.error(f"error 
-0000d400: 7374 6172 7469 6e67 2066 756e 6374 696f  starting functio
-0000d410: 6e3a 207b 6572 725f 746f 5f73 7472 2865  n: {err_to_str(e
-0000d420: 7272 297d 2229 0a20 2020 2020 2020 2020  rr)}").         
-0000d430: 2020 2072 6169 7365 204f 5345 7272 6f72     raise OSError
-0000d440: 2866 2265 7272 6f72 3a20 6361 6e6e 6f74  (f"error: cannot
-0000d450: 2073 7461 7274 2066 756e 6374 696f 6e2c   start function,
-0000d460: 207b 6572 725f 746f 5f73 7472 2865 7272   {err_to_str(err
-0000d470: 297d 2229 0a0a 2020 2020 2020 2020 6966  )}")..        if
-0000d480: 206e 6f74 2072 6573 702e 6f6b 3a0a 2020   not resp.ok:.  
-0000d490: 2020 2020 2020 2020 2020 6c6f 6767 6572            logger
-0000d4a0: 2e65 7272 6f72 2866 2262 6164 2072 6573  .error(f"bad res
-0000d4b0: 7021 215c 6e7b 7265 7370 2e74 6578 747d  p!!\n{resp.text}
-0000d4c0: 2229 0a20 2020 2020 2020 2020 2020 2072  ").            r
-0000d4d0: 6169 7365 2056 616c 7565 4572 726f 7228  aise ValueError(
-0000d4e0: 2262 6164 2066 756e 6374 696f 6e20 7374  "bad function st
-0000d4f0: 6172 7420 7265 7370 6f6e 7365 2229 0a0a  art response")..
-0000d500: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-0000d510: 6368 656d 6173 2e42 6163 6b67 726f 756e  chemas.Backgroun
-0000d520: 6454 6173 6b28 2a2a 7265 7370 2e6a 736f  dTask(**resp.jso
-0000d530: 6e28 2929 0a0a 2020 2020 6465 6620 6765  n())..    def ge
-0000d540: 745f 7072 6f6a 6563 745f 6261 636b 6772  t_project_backgr
-0000d550: 6f75 6e64 5f74 6173 6b28 0a20 2020 2020  ound_task(.     
-0000d560: 2020 2073 656c 662c 0a20 2020 2020 2020     self,.       
-0000d570: 2070 726f 6a65 6374 3a20 7374 722c 0a20   project: str,. 
-0000d580: 2020 2020 2020 206e 616d 653a 2073 7472         name: str
-0000d590: 2c0a 2020 2020 2920 2d3e 2073 6368 656d  ,.    ) -> schem
-0000d5a0: 6173 2e42 6163 6b67 726f 756e 6454 6173  as.BackgroundTas
-0000d5b0: 6b3a 0a20 2020 2020 2020 2022 2222 5265  k:.        """Re
-0000d5c0: 7472 6965 7665 2075 7064 6174 6564 2069  trieve updated i
-0000d5d0: 6e66 6f72 6d61 7469 6f6e 206f 6e20 6120  nformation on a 
-0000d5e0: 7072 6f6a 6563 7420 6261 636b 6772 6f75  project backgrou
-0000d5f0: 6e64 2074 6173 6b20 6265 696e 6720 6578  nd task being ex
-0000d600: 6563 7574 6564 2e22 2222 0a0a 2020 2020  ecuted."""..    
-0000d610: 2020 2020 7072 6f6a 6563 7420 3d20 7072      project = pr
-0000d620: 6f6a 6563 7420 6f72 2063 6f6e 6669 672e  oject or config.
-0000d630: 6465 6661 756c 745f 7072 6f6a 6563 740a  default_project.
-0000d640: 2020 2020 2020 2020 7061 7468 203d 2066          path = f
-0000d650: 2270 726f 6a65 6374 732f 7b70 726f 6a65  "projects/{proje
-0000d660: 6374 7d2f 6261 636b 6772 6f75 6e64 2d74  ct}/background-t
-0000d670: 6173 6b73 2f7b 6e61 6d65 7d22 0a20 2020  asks/{name}".   
-0000d680: 2020 2020 2065 7272 6f72 5f6d 6573 7361       error_messa
-0000d690: 6765 203d 2028 0a20 2020 2020 2020 2020  ge = (.         
-0000d6a0: 2020 2066 2246 6169 6c65 6420 6765 7474     f"Failed gett
-0000d6b0: 696e 6720 7072 6f6a 6563 7420 6261 636b  ing project back
-0000d6c0: 6772 6f75 6e64 2074 6173 6b2e 2070 726f  ground task. pro
-0000d6d0: 6a65 6374 3d7b 7072 6f6a 6563 747d 2c20  ject={project}, 
-0000d6e0: 6e61 6d65 3d7b 6e61 6d65 7d22 0a20 2020  name={name}".   
-0000d6f0: 2020 2020 2029 0a20 2020 2020 2020 2072       ).        r
-0000d700: 6573 706f 6e73 6520 3d20 7365 6c66 2e61  esponse = self.a
-0000d710: 7069 5f63 616c 6c28 2247 4554 222c 2070  pi_call("GET", p
-0000d720: 6174 682c 2065 7272 6f72 5f6d 6573 7361  ath, error_messa
-0000d730: 6765 290a 2020 2020 2020 2020 7265 7475  ge).        retu
-0000d740: 726e 2073 6368 656d 6173 2e42 6163 6b67  rn schemas.Backg
-0000d750: 726f 756e 6454 6173 6b28 2a2a 7265 7370  roundTask(**resp
-0000d760: 6f6e 7365 2e6a 736f 6e28 2929 0a0a 2020  onse.json())..  
-0000d770: 2020 6465 6620 6765 745f 6261 636b 6772    def get_backgr
-0000d780: 6f75 6e64 5f74 6173 6b28 7365 6c66 2c20  ound_task(self, 
-0000d790: 6e61 6d65 3a20 7374 7229 202d 3e20 7363  name: str) -> sc
-0000d7a0: 6865 6d61 732e 4261 636b 6772 6f75 6e64  hemas.Background
-0000d7b0: 5461 736b 3a0a 2020 2020 2020 2020 2222  Task:.        ""
-0000d7c0: 2252 6574 7269 6576 6520 7570 6461 7465  "Retrieve update
-0000d7d0: 6420 696e 666f 726d 6174 696f 6e20 6f6e  d information on
-0000d7e0: 2061 2062 6163 6b67 726f 756e 6420 7461   a background ta
-0000d7f0: 736b 2062 6569 6e67 2065 7865 6375 7465  sk being execute
-0000d800: 642e 2222 220a 0a20 2020 2020 2020 2070  d."""..        p
-0000d810: 6174 6820 3d20 6622 6261 636b 6772 6f75  ath = f"backgrou
-0000d820: 6e64 2d74 6173 6b73 2f7b 6e61 6d65 7d22  nd-tasks/{name}"
-0000d830: 0a20 2020 2020 2020 2065 7272 6f72 5f6d  .        error_m
-0000d840: 6573 7361 6765 203d 2066 2246 6169 6c65  essage = f"Faile
-0000d850: 6420 6765 7474 696e 6720 6261 636b 6772  d getting backgr
-0000d860: 6f75 6e64 2074 6173 6b2e 206e 616d 653d  ound task. name=
-0000d870: 7b6e 616d 657d 220a 2020 2020 2020 2020  {name}".        
-0000d880: 7265 7370 6f6e 7365 203d 2073 656c 662e  response = self.
-0000d890: 6170 695f 6361 6c6c 2822 4745 5422 2c20  api_call("GET", 
-0000d8a0: 7061 7468 2c20 6572 726f 725f 6d65 7373  path, error_mess
-0000d8b0: 6167 6529 0a20 2020 2020 2020 2072 6574  age).        ret
-0000d8c0: 7572 6e20 7363 6865 6d61 732e 4261 636b  urn schemas.Back
-0000d8d0: 6772 6f75 6e64 5461 736b 282a 2a72 6573  groundTask(**res
-0000d8e0: 706f 6e73 652e 6a73 6f6e 2829 290a 0a20  ponse.json()).. 
-0000d8f0: 2020 2064 6566 2072 656d 6f74 655f 7374     def remote_st
-0000d900: 6174 7573 2873 656c 662c 2070 726f 6a65  atus(self, proje
-0000d910: 6374 2c20 6e61 6d65 2c20 6b69 6e64 2c20  ct, name, kind, 
-0000d920: 7365 6c65 6374 6f72 293a 0a20 2020 2020  selector):.     
-0000d930: 2020 2022 2222 5265 7472 6965 7665 2073     """Retrieve s
-0000d940: 7461 7475 7320 6f66 2061 2066 756e 6374  tatus of a funct
-0000d950: 696f 6e20 6265 696e 6720 6578 6563 7574  ion being execut
-0000d960: 6564 2072 656d 6f74 656c 7920 2872 656c  ed remotely (rel
-0000d970: 6576 616e 7420 746f 2060 6064 6173 6b60  evant to ``dask`
-0000d980: 6020 6675 6e63 7469 6f6e 7329 2e0a 0a20  ` functions)... 
-0000d990: 2020 2020 2020 203a 7061 7261 6d20 7072         :param pr
-0000d9a0: 6f6a 6563 743a 2054 6865 2070 726f 6a65  oject: The proje
-0000d9b0: 6374 206f 6620 7468 6520 6675 6e63 7469  ct of the functi
-0000d9c0: 6f6e 0a20 2020 2020 2020 203a 7061 7261  on.        :para
-0000d9d0: 6d20 6e61 6d65 3a20 5468 6520 6e61 6d65  m name: The name
-0000d9e0: 206f 6620 7468 6520 6675 6e63 7469 6f6e   of the function
-0000d9f0: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
-0000da00: 6b69 6e64 3a20 5468 6520 6b69 6e64 206f  kind: The kind o
-0000da10: 6620 7468 6520 6675 6e63 7469 6f6e 2c20  f the function, 
-0000da20: 6375 7272 656e 746c 7920 6060 6461 736b  currently ``dask
-0000da30: 6060 2069 7320 7375 7070 6f72 7465 642e  `` is supported.
-0000da40: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
-0000da50: 7365 6c65 6374 6f72 3a20 5365 6c65 6374  selector: Select
-0000da60: 6f72 2063 6c61 7573 6520 746f 2062 6520  or clause to be 
-0000da70: 6170 706c 6965 6420 746f 2074 6865 204b  applied to the K
-0000da80: 7562 6572 6e65 7465 7320 7374 6174 7573  ubernetes status
-0000da90: 2071 7565 7279 2074 6f20 6669 6c74 6572   query to filter
-0000daa0: 2074 6865 2072 6573 756c 7473 2e0a 2020   the results..  
-0000dab0: 2020 2020 2020 2222 220a 0a20 2020 2020        """..     
-0000dac0: 2020 2074 7279 3a0a 2020 2020 2020 2020     try:.        
-0000dad0: 2020 2020 7265 7120 3d20 7b22 6b69 6e64      req = {"kind
-0000dae0: 223a 206b 696e 642c 2022 7365 6c65 6374  ": kind, "select
-0000daf0: 6f72 223a 2073 656c 6563 746f 722c 2022  or": selector, "
-0000db00: 7072 6f6a 6563 7422 3a20 7072 6f6a 6563  project": projec
-0000db10: 742c 2022 6e61 6d65 223a 206e 616d 657d  t, "name": name}
-0000db20: 0a20 2020 2020 2020 2020 2020 2072 6573  .            res
-0000db30: 7020 3d20 7365 6c66 2e61 7069 5f63 616c  p = self.api_cal
-0000db40: 6c28 2250 4f53 5422 2c20 2273 7461 7475  l("POST", "statu
-0000db50: 732f 6675 6e63 7469 6f6e 222c 206a 736f  s/function", jso
-0000db60: 6e3d 7265 7129 0a20 2020 2020 2020 2065  n=req).        e
-0000db70: 7863 6570 7420 4f53 4572 726f 7220 6173  xcept OSError as
-0000db80: 2065 7272 3a0a 2020 2020 2020 2020 2020   err:.          
-0000db90: 2020 6c6f 6767 6572 2e65 7272 6f72 2866    logger.error(f
-0000dba0: 2265 7272 6f72 2073 7461 7274 696e 6720  "error starting 
-0000dbb0: 6675 6e63 7469 6f6e 3a20 7b65 7272 5f74  function: {err_t
-0000dbc0: 6f5f 7374 7228 6572 7229 7d22 290a 2020  o_str(err)}").  
-0000dbd0: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
-0000dbe0: 4f53 4572 726f 7228 6622 6572 726f 723a  OSError(f"error:
-0000dbf0: 2063 616e 6e6f 7420 7374 6172 7420 6675   cannot start fu
-0000dc00: 6e63 7469 6f6e 2c20 7b65 7272 5f74 6f5f  nction, {err_to_
-0000dc10: 7374 7228 6572 7229 7d22 290a 0a20 2020  str(err)}")..   
-0000dc20: 2020 2020 2069 6620 6e6f 7420 7265 7370       if not resp
-0000dc30: 2e6f 6b3a 0a20 2020 2020 2020 2020 2020  .ok:.           
-0000dc40: 206c 6f67 6765 722e 6572 726f 7228 6622   logger.error(f"
-0000dc50: 6261 6420 7265 7370 2121 5c6e 7b72 6573  bad resp!!\n{res
-0000dc60: 702e 7465 7874 7d22 290a 2020 2020 2020  p.text}").      
-0000dc70: 2020 2020 2020 7261 6973 6520 5661 6c75        raise Valu
-0000dc80: 6545 7272 6f72 2822 6261 6420 6675 6e63  eError("bad func
-0000dc90: 7469 6f6e 2073 7461 7475 7320 7265 7370  tion status resp
-0000dca0: 6f6e 7365 2229 0a0a 2020 2020 2020 2020  onse")..        
-0000dcb0: 7265 7475 726e 2072 6573 702e 6a73 6f6e  return resp.json
-0000dcc0: 2829 5b22 6461 7461 225d 0a0a 2020 2020  ()["data"]..    
-0000dcd0: 6465 6620 7375 626d 6974 5f6a 6f62 280a  def submit_job(.
-0000dce0: 2020 2020 2020 2020 7365 6c66 2c20 7275          self, ru
-0000dcf0: 6e73 7065 632c 2073 6368 6564 756c 653a  nspec, schedule:
-0000dd00: 2055 6e69 6f6e 5b73 7472 2c20 7363 6865   Union[str, sche
-0000dd10: 6d61 732e 5363 6865 6475 6c65 4372 6f6e  mas.ScheduleCron
-0000dd20: 5472 6967 6765 725d 203d 204e 6f6e 650a  Trigger] = None.
-0000dd30: 2020 2020 293a 0a20 2020 2020 2020 2022      ):.        "
-0000dd40: 2222 5375 626d 6974 2061 206a 6f62 2066  ""Submit a job f
-0000dd50: 6f72 2072 656d 6f74 6520 6578 6563 7574  or remote execut
-0000dd60: 696f 6e2e 0a0a 2020 2020 2020 2020 3a70  ion...        :p
-0000dd70: 6172 616d 2072 756e 7370 6563 3a20 5468  aram runspec: Th
-0000dd80: 6520 7275 6e74 696d 6520 6f62 6a65 6374  e runtime object
-0000dd90: 2073 7065 6320 2854 6173 6b29 2074 6f20   spec (Task) to 
-0000dda0: 6578 6563 7574 652e 0a20 2020 2020 2020  execute..       
-0000ddb0: 203a 7061 7261 6d20 7363 6865 6475 6c65   :param schedule
-0000ddc0: 3a20 5768 6574 6865 7220 746f 2073 6368  : Whether to sch
-0000ddd0: 6564 756c 6520 7468 6973 206a 6f62 2075  edule this job u
-0000dde0: 7369 6e67 2061 2043 726f 6e20 7472 6967  sing a Cron trig
-0000ddf0: 6765 722e 2049 6620 6e6f 7420 7370 6563  ger. If not spec
-0000de00: 6966 6965 642c 2074 6865 206a 6f62 2077  ified, the job w
-0000de10: 696c 6c20 6265 2073 7562 6d69 7474 6564  ill be submitted
-0000de20: 0a20 2020 2020 2020 2020 2020 2069 6d6d  .            imm
-0000de30: 6564 6961 7465 6c79 2e0a 2020 2020 2020  ediately..      
-0000de40: 2020 2222 220a 0a20 2020 2020 2020 2074    """..        t
-0000de50: 7279 3a0a 2020 2020 2020 2020 2020 2020  ry:.            
-0000de60: 7265 7120 3d20 7b22 7461 736b 223a 2072  req = {"task": r
-0000de70: 756e 7370 6563 2e74 6f5f 6469 6374 2829  unspec.to_dict()
-0000de80: 7d0a 2020 2020 2020 2020 2020 2020 6966  }.            if
-0000de90: 2073 6368 6564 756c 653a 0a20 2020 2020   schedule:.     
-0000dea0: 2020 2020 2020 2020 2020 2069 6620 6973             if is
-0000deb0: 696e 7374 616e 6365 2873 6368 6564 756c  instance(schedul
-0000dec0: 652c 2073 6368 656d 6173 2e53 6368 6564  e, schemas.Sched
-0000ded0: 756c 6543 726f 6e54 7269 6767 6572 293a  uleCronTrigger):
-0000dee0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000def0: 2020 2020 2073 6368 6564 756c 6520 3d20       schedule = 
-0000df00: 7363 6865 6475 6c65 2e64 6963 7428 290a  schedule.dict().
-0000df10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000df20: 7265 715b 2273 6368 6564 756c 6522 5d20  req["schedule"] 
-0000df30: 3d20 7363 6865 6475 6c65 0a20 2020 2020  = schedule.     
-0000df40: 2020 2020 2020 2074 696d 656f 7574 203d         timeout =
-0000df50: 2028 696e 7428 636f 6e66 6967 2e73 7562   (int(config.sub
-0000df60: 6d69 745f 7469 6d65 6f75 7429 206f 7220  mit_timeout) or 
-0000df70: 3132 3029 202b 2032 300a 2020 2020 2020  120) + 20.      
-0000df80: 2020 2020 2020 7265 7370 203d 2073 656c        resp = sel
-0000df90: 662e 6170 695f 6361 6c6c 2822 504f 5354  f.api_call("POST
-0000dfa0: 222c 2022 7375 626d 6974 5f6a 6f62 222c  ", "submit_job",
-0000dfb0: 206a 736f 6e3d 7265 712c 2074 696d 656f   json=req, timeo
-0000dfc0: 7574 3d74 696d 656f 7574 290a 0a20 2020  ut=timeout)..   
-0000dfd0: 2020 2020 2065 7863 6570 7420 7265 7175       except requ
-0000dfe0: 6573 7473 2e48 5454 5045 7272 6f72 2061  ests.HTTPError a
-0000dff0: 7320 6572 723a 0a20 2020 2020 2020 2020  s err:.         
-0000e000: 2020 206c 6f67 6765 722e 6572 726f 7228     logger.error(
-0000e010: 6622 6572 726f 7220 7375 626d 6974 7469  f"error submitti
-0000e020: 6e67 2074 6173 6b3a 207b 6572 725f 746f  ng task: {err_to
-0000e030: 5f73 7472 2865 7272 297d 2229 0a20 2020  _str(err)}").   
-0000e040: 2020 2020 2020 2020 2023 206e 6f74 2063           # not c
-0000e050: 7265 6174 696e 6720 6120 6e65 7720 6578  reating a new ex
-0000e060: 6365 7074 696f 6e20 6865 7265 2c20 696e  ception here, in
-0000e070: 206f 7264 6572 2074 6f20 6b65 6570 2074   order to keep t
-0000e080: 6865 2072 6573 706f 6e73 6520 616e 6420  he response and 
-0000e090: 7374 6174 7573 2063 6f64 6520 696e 2074  status code in t
-0000e0a0: 6865 2065 7863 6570 7469 6f6e 0a20 2020  he exception.   
-0000e0b0: 2020 2020 2020 2020 2072 6169 7365 0a0a           raise..
-0000e0c0: 2020 2020 2020 2020 6578 6365 7074 204f          except O
-0000e0d0: 5345 7272 6f72 2061 7320 6572 723a 0a20  SError as err:. 
-0000e0e0: 2020 2020 2020 2020 2020 206c 6f67 6765             logge
-0000e0f0: 722e 6572 726f 7228 6622 6572 726f 7220  r.error(f"error 
-0000e100: 7375 626d 6974 7469 6e67 2074 6173 6b3a  submitting task:
-0000e110: 207b 6572 725f 746f 5f73 7472 2865 7272   {err_to_str(err
-0000e120: 297d 2229 0a20 2020 2020 2020 2020 2020  )}").           
-0000e130: 2072 6169 7365 204f 5345 7272 6f72 2822   raise OSError("
-0000e140: 6572 726f 723a 2063 616e 6e6f 7420 7375  error: cannot su
-0000e150: 626d 6974 2074 6173 6b22 2920 6672 6f6d  bmit task") from
-0000e160: 2065 7272 0a0a 2020 2020 2020 2020 6966   err..        if
-0000e170: 206e 6f74 2072 6573 702e 6f6b 3a0a 2020   not resp.ok:.  
-0000e180: 2020 2020 2020 2020 2020 6c6f 6767 6572            logger
-0000e190: 2e65 7272 6f72 2866 2262 6164 2072 6573  .error(f"bad res
-0000e1a0: 7021 215c 6e7b 7265 7370 2e74 6578 747d  p!!\n{resp.text}
-0000e1b0: 2229 0a20 2020 2020 2020 2020 2020 2072  ").            r
-0000e1c0: 6169 7365 2056 616c 7565 4572 726f 7228  aise ValueError(
-0000e1d0: 6622 6261 6420 6675 6e63 7469 6f6e 2072  f"bad function r
-0000e1e0: 756e 2072 6573 706f 6e73 652c 207b 7265  un response, {re
-0000e1f0: 7370 2e74 6578 747d 2229 0a0a 2020 2020  sp.text}")..    
-0000e200: 2020 2020 7265 7370 203d 2072 6573 702e      resp = resp.
-0000e210: 6a73 6f6e 2829 0a20 2020 2020 2020 2072  json().        r
-0000e220: 6574 7572 6e20 7265 7370 5b22 6461 7461  eturn resp["data
-0000e230: 225d 0a0a 2020 2020 6465 6620 7375 626d  "]..    def subm
-0000e240: 6974 5f70 6970 656c 696e 6528 0a20 2020  it_pipeline(.   
-0000e250: 2020 2020 2073 656c 662c 0a20 2020 2020       self,.     
-0000e260: 2020 2070 726f 6a65 6374 2c0a 2020 2020     project,.    
-0000e270: 2020 2020 7069 7065 6c69 6e65 2c0a 2020      pipeline,.  
-0000e280: 2020 2020 2020 6172 6775 6d65 6e74 733d        arguments=
-0000e290: 4e6f 6e65 2c0a 2020 2020 2020 2020 6578  None,.        ex
-0000e2a0: 7065 7269 6d65 6e74 3d4e 6f6e 652c 0a20  periment=None,. 
-0000e2b0: 2020 2020 2020 2072 756e 3d4e 6f6e 652c         run=None,
-0000e2c0: 0a20 2020 2020 2020 206e 616d 6573 7061  .        namespa
-0000e2d0: 6365 3d4e 6f6e 652c 0a20 2020 2020 2020  ce=None,.       
-0000e2e0: 2061 7274 6966 6163 745f 7061 7468 3d4e   artifact_path=N
-0000e2f0: 6f6e 652c 0a20 2020 2020 2020 206f 7073  one,.        ops
-0000e300: 3d4e 6f6e 652c 0a20 2020 2020 2020 2023  =None,.        #
-0000e310: 2054 4f44 4f3a 2064 6570 7265 6361 7465   TODO: deprecate
-0000e320: 642c 2072 656d 6f76 6520 696e 2031 2e35  d, remove in 1.5
-0000e330: 2e30 0a20 2020 2020 2020 2074 746c 3d4e  .0.        ttl=N
-0000e340: 6f6e 652c 0a20 2020 2020 2020 2063 6c65  one,.        cle
-0000e350: 616e 7570 5f74 746c 3d4e 6f6e 652c 0a20  anup_ttl=None,. 
-0000e360: 2020 2029 3a0a 2020 2020 2020 2020 2222     ):.        ""
-0000e370: 2253 7562 6d69 7420 6120 4b46 5020 7069  "Submit a KFP pi
-0000e380: 7065 6c69 6e65 2066 6f72 2065 7865 6375  peline for execu
-0000e390: 7469 6f6e 2e0a 0a20 2020 2020 2020 203a  tion...        :
-0000e3a0: 7061 7261 6d20 7072 6f6a 6563 743a 2054  param project: T
-0000e3b0: 6865 2070 726f 6a65 6374 206f 6620 7468  he project of th
-0000e3c0: 6520 7069 7065 6c69 6e65 0a20 2020 2020  e pipeline.     
-0000e3d0: 2020 203a 7061 7261 6d20 7069 7065 6c69     :param pipeli
-0000e3e0: 6e65 3a20 5069 7065 6c69 6e65 2066 756e  ne: Pipeline fun
-0000e3f0: 6374 696f 6e20 6f72 2070 6174 6820 746f  ction or path to
-0000e400: 202e 7961 6d6c 2f2e 7a69 7020 7069 7065   .yaml/.zip pipe
-0000e410: 6c69 6e65 2066 696c 652e 0a20 2020 2020  line file..     
-0000e420: 2020 203a 7061 7261 6d20 6172 6775 6d65     :param argume
-0000e430: 6e74 733a 2041 2064 6963 7469 6f6e 6172  nts: A dictionar
-0000e440: 7920 6f66 2061 7267 756d 656e 7473 2074  y of arguments t
-0000e450: 6f20 7061 7373 2074 6f20 7468 6520 7069  o pass to the pi
-0000e460: 7065 6c69 6e65 2e0a 2020 2020 2020 2020  peline..        
-0000e470: 3a70 6172 616d 2065 7870 6572 696d 656e  :param experimen
-0000e480: 743a 2041 206e 616d 6520 746f 2061 7373  t: A name to ass
-0000e490: 6967 6e20 666f 7220 7468 6520 7370 6563  ign for the spec
-0000e4a0: 6966 6963 2065 7870 6572 696d 656e 742e  ific experiment.
-0000e4b0: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
-0000e4c0: 7275 6e3a 2041 206e 616d 6520 666f 7220  run: A name for 
-0000e4d0: 7468 6973 2073 7065 6369 6669 6320 7275  this specific ru
-0000e4e0: 6e2e 0a20 2020 2020 2020 203a 7061 7261  n..        :para
-0000e4f0: 6d20 6e61 6d65 7370 6163 653a 204b 7562  m namespace: Kub
-0000e500: 6572 6e65 7465 7320 6e61 6d65 7370 6163  ernetes namespac
-0000e510: 6520 746f 2065 7865 6375 7465 2074 6865  e to execute the
-0000e520: 2070 6970 656c 696e 6520 696e 2e0a 2020   pipeline in..  
-0000e530: 2020 2020 2020 3a70 6172 616d 2061 7274        :param art
-0000e540: 6966 6163 745f 7061 7468 3a20 4120 7061  ifact_path: A pa
-0000e550: 7468 2074 6f20 6172 7469 6661 6374 7320  th to artifacts 
-0000e560: 7573 6564 2062 7920 7468 6973 2070 6970  used by this pip
-0000e570: 656c 696e 652e 0a20 2020 2020 2020 203a  eline..        :
-0000e580: 7061 7261 6d20 6f70 733a 2054 7261 6e73  param ops: Trans
-0000e590: 666f 726d 6572 7320 746f 2061 7070 6c79  formers to apply
-0000e5a0: 206f 6e20 616c 6c20 6f70 7320 696e 2074   on all ops in t
-0000e5b0: 6865 2070 6970 656c 696e 652e 0a20 2020  he pipeline..   
-0000e5c0: 2020 2020 203a 7061 7261 6d20 7474 6c3a       :param ttl:
-0000e5d0: 2070 6970 656c 696e 6520 636c 6561 6e75   pipeline cleanu
-0000e5e0: 7020 7474 6c20 696e 2073 6563 7320 2874  p ttl in secs (t
-0000e5f0: 696d 6520 746f 2077 6169 7420 6166 7465  ime to wait afte
-0000e600: 7220 776f 726b 666c 6f77 2063 6f6d 706c  r workflow compl
-0000e610: 6574 696f 6e2c 2061 7420 7768 6963 6820  etion, at which 
-0000e620: 706f 696e 7420 7468 6520 776f 726b 666c  point the workfl
-0000e630: 6f77 0a20 2020 2020 2020 2020 2020 2020  ow.             
-0000e640: 2020 2020 2020 2061 6e64 2061 6c6c 2069         and all i
-0000e650: 7473 2072 6573 6f75 7263 6573 2061 7265  ts resources are
-0000e660: 2064 656c 6574 6564 2920 2864 6570 7265   deleted) (depre
-0000e670: 6361 7465 642c 2075 7365 2063 6c65 616e  cated, use clean
-0000e680: 7570 5f74 746c 2069 6e73 7465 6164 290a  up_ttl instead).
-0000e690: 2020 2020 2020 2020 3a70 6172 616d 2063          :param c
-0000e6a0: 6c65 616e 7570 5f74 746c 3a20 7069 7065  leanup_ttl: pipe
-0000e6b0: 6c69 6e65 2063 6c65 616e 7570 2074 746c  line cleanup ttl
-0000e6c0: 2069 6e20 7365 6373 2028 7469 6d65 2074   in secs (time t
-0000e6d0: 6f20 7761 6974 2061 6674 6572 2077 6f72  o wait after wor
-0000e6e0: 6b66 6c6f 7720 636f 6d70 6c65 7469 6f6e  kflow completion
-0000e6f0: 2c20 6174 2077 6869 6368 2070 6f69 6e74  , at which point
-0000e700: 2074 6865 0a20 2020 2020 2020 2020 2020   the.           
-0000e710: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e720: 2077 6f72 6b66 6c6f 7720 616e 6420 616c   workflow and al
-0000e730: 6c20 6974 7320 7265 736f 7572 6365 7320  l its resources 
-0000e740: 6172 6520 6465 6c65 7465 6429 0a20 2020  are deleted).   
-0000e750: 2020 2020 2022 2222 0a0a 2020 2020 2020       """..      
-0000e760: 2020 6966 2074 746c 3a0a 2020 2020 2020    if ttl:.      
-0000e770: 2020 2020 2020 7761 726e 696e 6773 2e77        warnings.w
-0000e780: 6172 6e28 0a20 2020 2020 2020 2020 2020  arn(.           
-0000e790: 2020 2020 2022 2774 746c 2720 6973 2064       "'ttl' is d
-0000e7a0: 6570 7265 6361 7465 642c 2075 7365 2027  eprecated, use '
-0000e7b0: 636c 6561 6e75 705f 7474 6c27 2069 6e73  cleanup_ttl' ins
-0000e7c0: 7465 6164 2e20 220a 2020 2020 2020 2020  tead. ".        
-0000e7d0: 2020 2020 2020 2020 2254 6869 7320 7769          "This wi
-0000e7e0: 6c6c 2062 6520 7265 6d6f 7665 6420 696e  ll be removed in
-0000e7f0: 2031 2e35 2e30 222c 0a20 2020 2020 2020   1.5.0",.       
-0000e800: 2020 2020 2020 2020 2023 2054 4f44 4f3a           # TODO:
-0000e810: 2052 656d 6f76 6520 7468 6973 2069 6e20   Remove this in 
-0000e820: 312e 352e 300a 2020 2020 2020 2020 2020  1.5.0.          
-0000e830: 2020 2020 2020 4675 7475 7265 5761 726e        FutureWarn
-0000e840: 696e 672c 0a20 2020 2020 2020 2020 2020  ing,.           
-0000e850: 2029 0a0a 2020 2020 2020 2020 6966 2069   )..        if i
-0000e860: 7369 6e73 7461 6e63 6528 7069 7065 6c69  sinstance(pipeli
-0000e870: 6e65 2c20 7374 7229 3a0a 2020 2020 2020  ne, str):.      
-0000e880: 2020 2020 2020 7069 7065 5f66 696c 6520        pipe_file 
-0000e890: 3d20 7069 7065 6c69 6e65 0a20 2020 2020  = pipeline.     
-0000e8a0: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-0000e8b0: 2020 2020 2070 6970 655f 6669 6c65 203d       pipe_file =
-0000e8c0: 2074 656d 7066 696c 652e 4e61 6d65 6454   tempfile.NamedT
-0000e8d0: 656d 706f 7261 7279 4669 6c65 2873 7566  emporaryFile(suf
-0000e8e0: 6669 783d 222e 7961 6d6c 222c 2064 656c  fix=".yaml", del
-0000e8f0: 6574 653d 4661 6c73 6529 2e6e 616d 650a  ete=False).name.
-0000e900: 2020 2020 2020 2020 2020 2020 636f 6e66              conf
-0000e910: 203d 206e 6577 5f70 6970 655f 6d65 7461   = new_pipe_meta
-0000e920: 6461 7461 280a 2020 2020 2020 2020 2020  data(.          
-0000e930: 2020 2020 2020 6172 7469 6661 6374 5f70        artifact_p
-0000e940: 6174 683d 6172 7469 6661 6374 5f70 6174  ath=artifact_pat
-0000e950: 682c 0a20 2020 2020 2020 2020 2020 2020  h,.             
-0000e960: 2020 2063 6c65 616e 7570 5f74 746c 3d63     cleanup_ttl=c
-0000e970: 6c65 616e 7570 5f74 746c 206f 7220 7474  leanup_ttl or tt
-0000e980: 6c2c 0a20 2020 2020 2020 2020 2020 2020  l,.             
-0000e990: 2020 206f 705f 7472 616e 7366 6f72 6d65     op_transforme
-0000e9a0: 7273 3d6f 7073 2c0a 2020 2020 2020 2020  rs=ops,.        
-0000e9b0: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
-0000e9c0: 2020 6b66 702e 636f 6d70 696c 6572 2e43    kfp.compiler.C
-0000e9d0: 6f6d 7069 6c65 7228 292e 636f 6d70 696c  ompiler().compil
-0000e9e0: 6528 0a20 2020 2020 2020 2020 2020 2020  e(.             
-0000e9f0: 2020 2070 6970 656c 696e 652c 2070 6970     pipeline, pip
-0000ea00: 655f 6669 6c65 2c20 7479 7065 5f63 6865  e_file, type_che
-0000ea10: 636b 3d46 616c 7365 2c20 7069 7065 6c69  ck=False, pipeli
-0000ea20: 6e65 5f63 6f6e 663d 636f 6e66 0a20 2020  ne_conf=conf.   
-0000ea30: 2020 2020 2020 2020 2029 0a0a 2020 2020           )..    
-0000ea40: 2020 2020 6966 2070 6970 655f 6669 6c65      if pipe_file
-0000ea50: 2e65 6e64 7377 6974 6828 222e 7961 6d6c  .endswith(".yaml
-0000ea60: 2229 3a0a 2020 2020 2020 2020 2020 2020  "):.            
-0000ea70: 6865 6164 6572 7320 3d20 7b22 636f 6e74  headers = {"cont
-0000ea80: 656e 742d 7479 7065 223a 2022 6170 706c  ent-type": "appl
-0000ea90: 6963 6174 696f 6e2f 7961 6d6c 227d 0a20  ication/yaml"}. 
-0000eaa0: 2020 2020 2020 2065 6c69 6620 7069 7065         elif pipe
-0000eab0: 5f66 696c 652e 656e 6473 7769 7468 2822  _file.endswith("
-0000eac0: 2e7a 6970 2229 3a0a 2020 2020 2020 2020  .zip"):.        
-0000ead0: 2020 2020 6865 6164 6572 7320 3d20 7b22      headers = {"
-0000eae0: 636f 6e74 656e 742d 7479 7065 223a 2022  content-type": "
-0000eaf0: 6170 706c 6963 6174 696f 6e2f 7a69 7022  application/zip"
-0000eb00: 7d0a 2020 2020 2020 2020 656c 7365 3a0a  }.        else:.
-0000eb10: 2020 2020 2020 2020 2020 2020 7261 6973              rais
-0000eb20: 6520 5661 6c75 6545 7272 6f72 2822 7069  e ValueError("pi
-0000eb30: 7065 6c69 6e65 2066 696c 6520 6d75 7374  peline file must
-0000eb40: 2062 6520 2e79 616d 6c20 6f72 202e 7a69   be .yaml or .zi
-0000eb50: 7022 290a 2020 2020 2020 2020 6966 2061  p").        if a
-0000eb60: 7267 756d 656e 7473 3a0a 2020 2020 2020  rguments:.      
-0000eb70: 2020 2020 2020 6966 206e 6f74 2069 7369        if not isi
-0000eb80: 6e73 7461 6e63 6528 6172 6775 6d65 6e74  nstance(argument
-0000eb90: 732c 2064 6963 7429 3a0a 2020 2020 2020  s, dict):.      
-0000eba0: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
-0000ebb0: 5661 6c75 6545 7272 6f72 2822 6172 6775  ValueError("argu
-0000ebc0: 6d65 6e74 7320 6d75 7374 2062 6520 6469  ments must be di
-0000ebd0: 6374 2074 7970 6522 290a 2020 2020 2020  ct type").      
-0000ebe0: 2020 2020 2020 6865 6164 6572 735b 7363        headers[sc
-0000ebf0: 6865 6d61 732e 4865 6164 6572 4e61 6d65  hemas.HeaderName
-0000ec00: 732e 7069 7065 6c69 6e65 5f61 7267 756d  s.pipeline_argum
-0000ec10: 656e 7473 5d20 3d20 7374 7228 6172 6775  ents] = str(argu
-0000ec20: 6d65 6e74 7329 0a0a 2020 2020 2020 2020  ments)..        
-0000ec30: 6966 206e 6f74 2070 6174 682e 6973 6669  if not path.isfi
-0000ec40: 6c65 2870 6970 655f 6669 6c65 293a 0a20  le(pipe_file):. 
-0000ec50: 2020 2020 2020 2020 2020 2072 6169 7365             raise
-0000ec60: 204f 5345 7272 6f72 2866 2266 696c 6520   OSError(f"file 
-0000ec70: 7b70 6970 655f 6669 6c65 7d20 646f 6573  {pipe_file} does
-0000ec80: 6e74 2065 7869 7374 2229 0a20 2020 2020  nt exist").     
-0000ec90: 2020 2077 6974 6820 6f70 656e 2870 6970     with open(pip
-0000eca0: 655f 6669 6c65 2c20 2272 6222 2920 6173  e_file, "rb") as
-0000ecb0: 2066 703a 0a20 2020 2020 2020 2020 2020   fp:.           
-0000ecc0: 2064 6174 6120 3d20 6670 2e72 6561 6428   data = fp.read(
-0000ecd0: 290a 2020 2020 2020 2020 6966 206e 6f74  ).        if not
-0000ece0: 2069 7369 6e73 7461 6e63 6528 7069 7065   isinstance(pipe
-0000ecf0: 6c69 6e65 2c20 7374 7229 3a0a 2020 2020  line, str):.    
-0000ed00: 2020 2020 2020 2020 7265 6d6f 7665 2870          remove(p
-0000ed10: 6970 655f 6669 6c65 290a 0a20 2020 2020  ipe_file)..     
-0000ed20: 2020 2074 7279 3a0a 2020 2020 2020 2020     try:.        
-0000ed30: 2020 2020 7061 7261 6d73 203d 207b 226e      params = {"n
-0000ed40: 616d 6573 7061 6365 223a 206e 616d 6573  amespace": names
-0000ed50: 7061 6365 2c20 2265 7870 6572 696d 656e  pace, "experimen
-0000ed60: 7422 3a20 6578 7065 7269 6d65 6e74 2c20  t": experiment, 
-0000ed70: 2272 756e 223a 2072 756e 7d0a 2020 2020  "run": run}.    
-0000ed80: 2020 2020 2020 2020 7265 7370 203d 2073          resp = s
-0000ed90: 656c 662e 6170 695f 6361 6c6c 280a 2020  elf.api_call(.  
-0000eda0: 2020 2020 2020 2020 2020 2020 2020 2250                "P
-0000edb0: 4f53 5422 2c0a 2020 2020 2020 2020 2020  OST",.          
-0000edc0: 2020 2020 2020 6622 7072 6f6a 6563 7473        f"projects
-0000edd0: 2f7b 7072 6f6a 6563 747d 2f70 6970 656c  /{project}/pipel
-0000ede0: 696e 6573 222c 0a20 2020 2020 2020 2020  ines",.         
-0000edf0: 2020 2020 2020 2070 6172 616d 733d 7061         params=pa
-0000ee00: 7261 6d73 2c0a 2020 2020 2020 2020 2020  rams,.          
-0000ee10: 2020 2020 2020 7469 6d65 6f75 743d 3230        timeout=20
-0000ee20: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0000ee30: 2020 626f 6479 3d64 6174 612c 0a20 2020    body=data,.   
-0000ee40: 2020 2020 2020 2020 2020 2020 2068 6561               hea
-0000ee50: 6465 7273 3d68 6561 6465 7273 2c0a 2020  ders=headers,.  
-0000ee60: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
-0000ee70: 2020 2020 6578 6365 7074 204f 5345 7272      except OSErr
-0000ee80: 6f72 2061 7320 6572 723a 0a20 2020 2020  or as err:.     
-0000ee90: 2020 2020 2020 206c 6f67 6765 722e 6572         logger.er
-0000eea0: 726f 7228 6622 6572 726f 7220 6361 6e6e  ror(f"error cann
-0000eeb0: 6f74 2073 7562 6d69 7420 7069 7065 6c69  ot submit pipeli
-0000eec0: 6e65 3a20 7b65 7272 5f74 6f5f 7374 7228  ne: {err_to_str(
-0000eed0: 6572 7229 7d22 290a 2020 2020 2020 2020  err)}").        
-0000eee0: 2020 2020 7261 6973 6520 4f53 4572 726f      raise OSErro
-0000eef0: 7228 6622 6572 726f 723a 2063 616e 6e6f  r(f"error: canno
-0000ef00: 7420 6361 6e6e 6f74 2073 7562 6d69 7420  t cannot submit 
-0000ef10: 7069 7065 6c69 6e65 2c20 7b65 7272 5f74  pipeline, {err_t
-0000ef20: 6f5f 7374 7228 6572 7229 7d22 290a 0a20  o_str(err)}").. 
-0000ef30: 2020 2020 2020 2069 6620 6e6f 7420 7265         if not re
-0000ef40: 7370 2e6f 6b3a 0a20 2020 2020 2020 2020  sp.ok:.         
-0000ef50: 2020 206c 6f67 6765 722e 6572 726f 7228     logger.error(
-0000ef60: 6622 6261 6420 7265 7370 2121 5c6e 7b72  f"bad resp!!\n{r
-0000ef70: 6573 702e 7465 7874 7d22 290a 2020 2020  esp.text}").    
-0000ef80: 2020 2020 2020 2020 7261 6973 6520 5661          raise Va
-0000ef90: 6c75 6545 7272 6f72 2866 2262 6164 2073  lueError(f"bad s
-0000efa0: 7562 6d69 7420 7069 7065 6c69 6e65 2072  ubmit pipeline r
-0000efb0: 6573 706f 6e73 652c 207b 7265 7370 2e74  esponse, {resp.t
-0000efc0: 6578 747d 2229 0a0a 2020 2020 2020 2020  ext}")..        
-0000efd0: 7265 7370 203d 2072 6573 702e 6a73 6f6e  resp = resp.json
-0000efe0: 2829 0a20 2020 2020 2020 206c 6f67 6765  ().        logge
-0000eff0: 722e 696e 666f 2866 2273 7562 6d69 7474  r.info(f"submitt
-0000f000: 6564 2070 6970 656c 696e 6520 7b72 6573  ed pipeline {res
-0000f010: 705b 276e 616d 6527 5d7d 2069 643d 7b72  p['name']} id={r
-0000f020: 6573 705b 2769 6427 5d7d 2229 0a20 2020  esp['id']}").   
-0000f030: 2020 2020 2072 6574 7572 6e20 7265 7370       return resp
-0000f040: 5b22 6964 225d 0a0a 2020 2020 6465 6620  ["id"]..    def 
-0000f050: 6c69 7374 5f70 6970 656c 696e 6573 280a  list_pipelines(.
-0000f060: 2020 2020 2020 2020 7365 6c66 2c0a 2020          self,.  
-0000f070: 2020 2020 2020 7072 6f6a 6563 743a 2073        project: s
-0000f080: 7472 2c0a 2020 2020 2020 2020 6e61 6d65  tr,.        name
-0000f090: 7370 6163 653a 2073 7472 203d 204e 6f6e  space: str = Non
-0000f0a0: 652c 0a20 2020 2020 2020 2073 6f72 745f  e,.        sort_
-0000f0b0: 6279 3a20 7374 7220 3d20 2222 2c0a 2020  by: str = "",.  
-0000f0c0: 2020 2020 2020 7061 6765 5f74 6f6b 656e        page_token
-0000f0d0: 3a20 7374 7220 3d20 2222 2c0a 2020 2020  : str = "",.    
-0000f0e0: 2020 2020 6669 6c74 6572 5f3a 2073 7472      filter_: str
-0000f0f0: 203d 2022 222c 0a20 2020 2020 2020 2066   = "",.        f
-0000f100: 6f72 6d61 745f 3a20 556e 696f 6e5b 0a20  ormat_: Union[. 
-0000f110: 2020 2020 2020 2020 2020 2073 7472 2c20             str, 
-0000f120: 6d6c 7275 6e2e 6170 692e 7363 6865 6d61  mlrun.api.schema
-0000f130: 732e 5069 7065 6c69 6e65 7346 6f72 6d61  s.PipelinesForma
-0000f140: 740a 2020 2020 2020 2020 5d20 3d20 6d6c  t.        ] = ml
-0000f150: 7275 6e2e 6170 692e 7363 6865 6d61 732e  run.api.schemas.
-0000f160: 5069 7065 6c69 6e65 7346 6f72 6d61 742e  PipelinesFormat.
-0000f170: 6d65 7461 6461 7461 5f6f 6e6c 792c 0a20  metadata_only,. 
-0000f180: 2020 2020 2020 2070 6167 655f 7369 7a65         page_size
-0000f190: 3a20 696e 7420 3d20 4e6f 6e65 2c0a 2020  : int = None,.  
-0000f1a0: 2020 2920 2d3e 206d 6c72 756e 2e61 7069    ) -> mlrun.api
-0000f1b0: 2e73 6368 656d 6173 2e50 6970 656c 696e  .schemas.Pipelin
-0000f1c0: 6573 4f75 7470 7574 3a0a 2020 2020 2020  esOutput:.      
-0000f1d0: 2020 2222 2252 6574 7269 6576 6520 6120    """Retrieve a 
-0000f1e0: 6c69 7374 206f 6620 4b46 5020 7069 7065  list of KFP pipe
-0000f1f0: 6c69 6e65 732e 2054 6869 7320 6675 6e63  lines. This func
-0000f200: 7469 6f6e 2063 616e 2062 6520 696e 766f  tion can be invo
-0000f210: 6b65 6420 746f 2067 6574 2061 6c6c 2070  ked to get all p
-0000f220: 6970 656c 696e 6573 2066 726f 6d20 616c  ipelines from al
-0000f230: 6c20 7072 6f6a 6563 7473 2c0a 2020 2020  l projects,.    
-0000f240: 2020 2020 6279 2073 7065 6369 6679 696e      by specifyin
-0000f250: 6720 6060 7072 6f6a 6563 743d 2a60 602c  g ``project=*``,
-0000f260: 2069 6e20 7768 6963 6820 6361 7365 2070   in which case p
-0000f270: 6167 696e 6174 696f 6e20 6361 6e20 6265  agination can be
-0000f280: 2075 7365 6420 616e 6420 7468 6520 7661   used and the va
-0000f290: 7269 6f75 7320 736f 7274 696e 6720 616e  rious sorting an
-0000f2a0: 6420 7061 6769 6e61 7469 6f6e 0a20 2020  d pagination.   
-0000f2b0: 2020 2020 2070 726f 7065 7274 6965 7320       properties 
-0000f2c0: 6361 6e20 6265 2061 7070 6c69 6564 2e20  can be applied. 
-0000f2d0: 4966 2061 2073 7065 6369 6669 6320 7072  If a specific pr
-0000f2e0: 6f6a 6563 7420 6973 2072 6571 7565 7374  oject is request
-0000f2f0: 6564 2c20 7468 656e 2074 6865 2070 6167  ed, then the pag
-0000f300: 696e 6174 696f 6e20 6f70 7469 6f6e 7320  ination options 
-0000f310: 6361 6e6e 6f74 2062 650a 2020 2020 2020  cannot be.      
-0000f320: 2020 7573 6564 2061 6e64 2070 6167 696e    used and pagin
-0000f330: 6174 696f 6e20 6973 206e 6f74 2061 7070  ation is not app
-0000f340: 6c69 6564 2e0a 0a20 2020 2020 2020 203a  lied...        :
-0000f350: 7061 7261 6d20 7072 6f6a 6563 743a 2050  param project: P
-0000f360: 726f 6a65 6374 206e 616d 652e 2043 616e  roject name. Can
-0000f370: 2062 6520 6060 2a60 6020 666f 7220 7175   be ``*`` for qu
-0000f380: 6572 7920 6163 726f 7373 2061 6c6c 2070  ery across all p
-0000f390: 726f 6a65 6374 732e 0a20 2020 2020 2020  rojects..       
-0000f3a0: 203a 7061 7261 6d20 6e61 6d65 7370 6163   :param namespac
-0000f3b0: 653a 204b 7562 6572 6e65 7465 7320 6e61  e: Kubernetes na
-0000f3c0: 6d65 7370 6163 6520 696e 2077 6869 6368  mespace in which
-0000f3d0: 2074 6865 2070 6970 656c 696e 6573 2061   the pipelines a
-0000f3e0: 7265 2065 7865 6375 7469 6e67 2e0a 2020  re executing..  
-0000f3f0: 2020 2020 2020 3a70 6172 616d 2073 6f72        :param sor
-0000f400: 745f 6279 3a20 4669 656c 6420 746f 2073  t_by: Field to s
-0000f410: 6f72 7420 7468 6520 7265 7375 6c74 7320  ort the results 
-0000f420: 6279 2e0a 2020 2020 2020 2020 3a70 6172  by..        :par
-0000f430: 616d 2070 6167 655f 746f 6b65 6e3a 2055  am page_token: U
-0000f440: 7365 2066 6f72 2070 6167 696e 6174 696f  se for paginatio
-0000f450: 6e2c 2074 6f20 7265 7472 6965 7665 206e  n, to retrieve n
-0000f460: 6578 7420 7061 6765 2e0a 2020 2020 2020  ext page..      
-0000f470: 2020 3a70 6172 616d 2066 696c 7465 725f    :param filter_
-0000f480: 3a20 4b75 6265 726e 6574 6573 2066 696c  : Kubernetes fil
-0000f490: 7465 7220 746f 2061 7070 6c79 2074 6f20  ter to apply to 
-0000f4a0: 7468 6520 7175 6572 792c 2063 616e 2062  the query, can b
-0000f4b0: 6520 7573 6564 2074 6f20 6669 6c74 6572  e used to filter
-0000f4c0: 206f 6e20 7370 6563 6966 6963 206f 626a   on specific obj
-0000f4d0: 6563 7420 6669 656c 6473 2e0a 2020 2020  ect fields..    
-0000f4e0: 2020 2020 3a70 6172 616d 2066 6f72 6d61      :param forma
-0000f4f0: 745f 3a20 5265 7375 6c74 2066 6f72 6d61  t_: Result forma
-0000f500: 742e 2043 616e 2062 6520 6f6e 6520 6f66  t. Can be one of
-0000f510: 3a0a 0a20 2020 2020 2020 2020 2020 202d  :..            -
-0000f520: 2060 6066 756c 6c60 6020 2d20 7265 7475   ``full`` - retu
-0000f530: 726e 2074 6865 2066 756c 6c20 6f62 6a65  rn the full obje
-0000f540: 6374 732e 0a20 2020 2020 2020 2020 2020  cts..           
-0000f550: 202d 2060 606d 6574 6164 6174 615f 6f6e   - ``metadata_on
-0000f560: 6c79 6060 2028 6465 6661 756c 7429 202d  ly`` (default) -
-0000f570: 2072 6574 7572 6e20 6a75 7374 206d 6574   return just met
-0000f580: 6164 6174 6120 6f66 2074 6865 2070 6970  adata of the pip
-0000f590: 656c 696e 6573 206f 626a 6563 7473 2e0a  elines objects..
-0000f5a0: 2020 2020 2020 2020 2020 2020 2d20 6060              - ``
-0000f5b0: 6e61 6d65 5f6f 6e6c 7960 6020 2d20 7265  name_only`` - re
-0000f5c0: 7475 726e 206a 7573 7420 7468 6520 6e61  turn just the na
-0000f5d0: 6d65 7320 6f66 2074 6865 2070 6970 656c  mes of the pipel
-0000f5e0: 696e 6520 6f62 6a65 6374 732e 0a20 2020  ine objects..   
-0000f5f0: 2020 2020 203a 7061 7261 6d20 7061 6765       :param page
-0000f600: 5f73 697a 653a 2053 697a 6520 6f66 2061  _size: Size of a
-0000f610: 2073 696e 676c 6520 7061 6765 2077 6865   single page whe
-0000f620: 6e20 6170 706c 7969 6e67 2070 6167 696e  n applying pagin
-0000f630: 6174 696f 6e2e 0a20 2020 2020 2020 2022  ation..        "
-0000f640: 2222 0a0a 2020 2020 2020 2020 6966 2070  ""..        if p
-0000f650: 726f 6a65 6374 2021 3d20 222a 2220 616e  roject != "*" an
-0000f660: 6420 2870 6167 655f 746f 6b65 6e20 6f72  d (page_token or
-0000f670: 2070 6167 655f 7369 7a65 293a 0a20 2020   page_size):.   
-0000f680: 2020 2020 2020 2020 2072 6169 7365 206d           raise m
-0000f690: 6c72 756e 2e65 7272 6f72 732e 4d4c 5275  lrun.errors.MLRu
-0000f6a0: 6e49 6e76 616c 6964 4172 6775 6d65 6e74  nInvalidArgument
-0000f6b0: 4572 726f 7228 0a20 2020 2020 2020 2020  Error(.         
-0000f6c0: 2020 2020 2020 2022 4669 6c74 6572 696e         "Filterin
-0000f6d0: 6720 6279 2070 726f 6a65 6374 2063 616e  g by project can
-0000f6e0: 206e 6f74 2062 6520 7573 6564 2074 6f67   not be used tog
-0000f6f0: 6574 6865 7220 7769 7468 2070 6167 696e  ether with pagin
-0000f700: 6174 696f 6e22 0a20 2020 2020 2020 2020  ation".         
-0000f710: 2020 2029 0a20 2020 2020 2020 2070 6172     ).        par
-0000f720: 616d 7320 3d20 7b0a 2020 2020 2020 2020  ams = {.        
-0000f730: 2020 2020 226e 616d 6573 7061 6365 223a      "namespace":
-0000f740: 206e 616d 6573 7061 6365 2c0a 2020 2020   namespace,.    
-0000f750: 2020 2020 2020 2020 2273 6f72 745f 6279          "sort_by
-0000f760: 223a 2073 6f72 745f 6279 2c0a 2020 2020  ": sort_by,.    
-0000f770: 2020 2020 2020 2020 2270 6167 655f 746f          "page_to
-0000f780: 6b65 6e22 3a20 7061 6765 5f74 6f6b 656e  ken": page_token
-0000f790: 2c0a 2020 2020 2020 2020 2020 2020 2266  ,.            "f
-0000f7a0: 696c 7465 7222 3a20 6669 6c74 6572 5f2c  ilter": filter_,
-0000f7b0: 0a20 2020 2020 2020 2020 2020 2022 666f  .            "fo
-0000f7c0: 726d 6174 223a 2066 6f72 6d61 745f 2c0a  rmat": format_,.
-0000f7d0: 2020 2020 2020 2020 2020 2020 2270 6167              "pag
-0000f7e0: 655f 7369 7a65 223a 2070 6167 655f 7369  e_size": page_si
-0000f7f0: 7a65 2c0a 2020 2020 2020 2020 7d0a 0a20  ze,.        }.. 
-0000f800: 2020 2020 2020 2065 7272 6f72 5f6d 6573         error_mes
-0000f810: 7361 6765 203d 2066 2246 6169 6c65 6420  sage = f"Failed 
-0000f820: 6c69 7374 696e 6720 7069 7065 6c69 6e65  listing pipeline
-0000f830: 732c 2071 7565 7279 3a20 7b70 6172 616d  s, query: {param
-0000f840: 737d 220a 2020 2020 2020 2020 7265 7370  s}".        resp
-0000f850: 6f6e 7365 203d 2073 656c 662e 6170 695f  onse = self.api_
-0000f860: 6361 6c6c 280a 2020 2020 2020 2020 2020  call(.          
-0000f870: 2020 2247 4554 222c 2066 2270 726f 6a65    "GET", f"proje
-0000f880: 6374 732f 7b70 726f 6a65 6374 7d2f 7069  cts/{project}/pi
-0000f890: 7065 6c69 6e65 7322 2c20 6572 726f 725f  pelines", error_
-0000f8a0: 6d65 7373 6167 652c 2070 6172 616d 733d  message, params=
-0000f8b0: 7061 7261 6d73 0a20 2020 2020 2020 2029  params.        )
-0000f8c0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-0000f8d0: 6d6c 7275 6e2e 6170 692e 7363 6865 6d61  mlrun.api.schema
-0000f8e0: 732e 5069 7065 6c69 6e65 734f 7574 7075  s.PipelinesOutpu
-0000f8f0: 7428 2a2a 7265 7370 6f6e 7365 2e6a 736f  t(**response.jso
-0000f900: 6e28 2929 0a0a 2020 2020 6465 6620 6765  n())..    def ge
-0000f910: 745f 7069 7065 6c69 6e65 280a 2020 2020  t_pipeline(.    
-0000f920: 2020 2020 7365 6c66 2c0a 2020 2020 2020      self,.      
-0000f930: 2020 7275 6e5f 6964 3a20 7374 722c 0a20    run_id: str,. 
-0000f940: 2020 2020 2020 206e 616d 6573 7061 6365         namespace
-0000f950: 3a20 7374 7220 3d20 4e6f 6e65 2c0a 2020  : str = None,.  
-0000f960: 2020 2020 2020 7469 6d65 6f75 743a 2069        timeout: i
-0000f970: 6e74 203d 2031 302c 0a20 2020 2020 2020  nt = 10,.       
-0000f980: 2066 6f72 6d61 745f 3a20 556e 696f 6e5b   format_: Union[
-0000f990: 0a20 2020 2020 2020 2020 2020 2073 7472  .            str
-0000f9a0: 2c20 6d6c 7275 6e2e 6170 692e 7363 6865  , mlrun.api.sche
-0000f9b0: 6d61 732e 5069 7065 6c69 6e65 7346 6f72  mas.PipelinesFor
-0000f9c0: 6d61 740a 2020 2020 2020 2020 5d20 3d20  mat.        ] = 
-0000f9d0: 6d6c 7275 6e2e 6170 692e 7363 6865 6d61  mlrun.api.schema
-0000f9e0: 732e 5069 7065 6c69 6e65 7346 6f72 6d61  s.PipelinesForma
-0000f9f0: 742e 7375 6d6d 6172 792c 0a20 2020 2020  t.summary,.     
-0000fa00: 2020 2070 726f 6a65 6374 3a20 7374 7220     project: str 
-0000fa10: 3d20 4e6f 6e65 2c0a 2020 2020 293a 0a20  = None,.    ):. 
-0000fa20: 2020 2020 2020 2022 2222 5265 7472 6965         """Retrie
-0000fa30: 7665 2064 6574 6169 6c73 206f 6620 6120  ve details of a 
-0000fa40: 7370 6563 6966 6963 2070 6970 656c 696e  specific pipelin
-0000fa50: 6520 7573 696e 6720 6974 7320 7275 6e20  e using its run 
-0000fa60: 4944 2028 6173 2070 726f 7669 6465 6420  ID (as provided 
-0000fa70: 7768 656e 2074 6865 2070 6970 656c 696e  when the pipelin
-0000fa80: 6520 7761 7320 6578 6563 7574 6564 292e  e was executed).
-0000fa90: 2222 220a 0a20 2020 2020 2020 2074 7279  """..        try
-0000faa0: 3a0a 2020 2020 2020 2020 2020 2020 7061  :.            pa
-0000fab0: 7261 6d73 203d 207b 7d0a 2020 2020 2020  rams = {}.      
-0000fac0: 2020 2020 2020 6966 206e 616d 6573 7061        if namespa
-0000fad0: 6365 3a0a 2020 2020 2020 2020 2020 2020  ce:.            
-0000fae0: 2020 2020 7061 7261 6d73 5b22 6e61 6d65      params["name
-0000faf0: 7370 6163 6522 5d20 3d20 6e61 6d65 7370  space"] = namesp
-0000fb00: 6163 650a 2020 2020 2020 2020 2020 2020  ace.            
-0000fb10: 7061 7261 6d73 5b22 666f 726d 6174 225d  params["format"]
-0000fb20: 203d 2066 6f72 6d61 745f 0a20 2020 2020   = format_.     
-0000fb30: 2020 2020 2020 2070 726f 6a65 6374 5f70         project_p
-0000fb40: 6174 6820 3d20 7072 6f6a 6563 7420 6966  ath = project if
-0000fb50: 2070 726f 6a65 6374 2065 6c73 6520 222a   project else "*
-0000fb60: 220a 2020 2020 2020 2020 2020 2020 7265  ".            re
-0000fb70: 7370 203d 2073 656c 662e 6170 695f 6361  sp = self.api_ca
-0000fb80: 6c6c 280a 2020 2020 2020 2020 2020 2020  ll(.            
-0000fb90: 2020 2020 2247 4554 222c 0a20 2020 2020      "GET",.     
-0000fba0: 2020 2020 2020 2020 2020 2066 2270 726f             f"pro
-0000fbb0: 6a65 6374 732f 7b70 726f 6a65 6374 5f70  jects/{project_p
-0000fbc0: 6174 687d 2f70 6970 656c 696e 6573 2f7b  ath}/pipelines/{
-0000fbd0: 7275 6e5f 6964 7d22 2c0a 2020 2020 2020  run_id}",.      
-0000fbe0: 2020 2020 2020 2020 2020 7061 7261 6d73            params
-0000fbf0: 3d70 6172 616d 732c 0a20 2020 2020 2020  =params,.       
-0000fc00: 2020 2020 2020 2020 2074 696d 656f 7574           timeout
-0000fc10: 3d74 696d 656f 7574 2c0a 2020 2020 2020  =timeout,.      
-0000fc20: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-0000fc30: 6578 6365 7074 204f 5345 7272 6f72 2061  except OSError a
-0000fc40: 7320 6572 723a 0a20 2020 2020 2020 2020  s err:.         
-0000fc50: 2020 206c 6f67 6765 722e 6572 726f 7228     logger.error(
-0000fc60: 6622 6572 726f 7220 6361 6e6e 6f74 2067  f"error cannot g
-0000fc70: 6574 2070 6970 656c 696e 653a 207b 6572  et pipeline: {er
-0000fc80: 725f 746f 5f73 7472 2865 7272 297d 2229  r_to_str(err)}")
-0000fc90: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
-0000fca0: 7365 204f 5345 7272 6f72 2866 2265 7272  se OSError(f"err
-0000fcb0: 6f72 3a20 6361 6e6e 6f74 2067 6574 2070  or: cannot get p
-0000fcc0: 6970 656c 696e 652c 207b 6572 725f 746f  ipeline, {err_to
-0000fcd0: 5f73 7472 2865 7272 297d 2229 0a0a 2020  _str(err)}")..  
-0000fce0: 2020 2020 2020 6966 206e 6f74 2072 6573        if not res
-0000fcf0: 702e 6f6b 3a0a 2020 2020 2020 2020 2020  p.ok:.          
-0000fd00: 2020 6c6f 6767 6572 2e65 7272 6f72 2866    logger.error(f
-0000fd10: 2262 6164 2072 6573 7021 215c 6e7b 7265  "bad resp!!\n{re
-0000fd20: 7370 2e74 6578 747d 2229 0a20 2020 2020  sp.text}").     
-0000fd30: 2020 2020 2020 2072 6169 7365 2056 616c         raise Val
-0000fd40: 7565 4572 726f 7228 6622 6261 6420 6765  ueError(f"bad ge
-0000fd50: 7420 7069 7065 6c69 6e65 2072 6573 706f  t pipeline respo
-0000fd60: 6e73 652c 207b 7265 7370 2e74 6578 747d  nse, {resp.text}
-0000fd70: 2229 0a0a 2020 2020 2020 2020 7265 7475  ")..        retu
-0000fd80: 726e 2072 6573 702e 6a73 6f6e 2829 0a0a  rn resp.json()..
-0000fd90: 2020 2020 4073 7461 7469 636d 6574 686f      @staticmetho
-0000fda0: 640a 2020 2020 6465 6620 5f72 6573 6f6c  d.    def _resol
-0000fdb0: 7665 5f72 6566 6572 656e 6365 2874 6167  ve_reference(tag
-0000fdc0: 2c20 7569 6429 3a0a 2020 2020 2020 2020  , uid):.        
-0000fdd0: 6966 2075 6964 2061 6e64 2074 6167 3a0a  if uid and tag:.
-0000fde0: 2020 2020 2020 2020 2020 2020 7261 6973              rais
-0000fdf0: 6520 4d4c 5275 6e49 6e76 616c 6964 4172  e MLRunInvalidAr
-0000fe00: 6775 6d65 6e74 4572 726f 7228 2262 6f74  gumentError("bot
-0000fe10: 6820 7569 6420 616e 6420 7461 6720 7765  h uid and tag we
-0000fe20: 7265 2070 726f 7669 6465 6422 290a 2020  re provided").  
-0000fe30: 2020 2020 2020 7265 7475 726e 2075 6964        return uid
-0000fe40: 206f 7220 7461 6720 6f72 2022 6c61 7465   or tag or "late
-0000fe50: 7374 220a 0a20 2020 2064 6566 2063 7265  st"..    def cre
-0000fe60: 6174 655f 6665 6174 7572 655f 7365 7428  ate_feature_set(
-0000fe70: 0a20 2020 2020 2020 2073 656c 662c 0a20  .        self,. 
-0000fe80: 2020 2020 2020 2066 6561 7475 7265 5f73         feature_s
-0000fe90: 6574 3a20 556e 696f 6e5b 6469 6374 2c20  et: Union[dict, 
-0000fea0: 7363 6865 6d61 732e 4665 6174 7572 6553  schemas.FeatureS
-0000feb0: 6574 2c20 4665 6174 7572 6553 6574 5d2c  et, FeatureSet],
-0000fec0: 0a20 2020 2020 2020 2070 726f 6a65 6374  .        project
-0000fed0: 3d22 222c 0a20 2020 2020 2020 2076 6572  ="",.        ver
-0000fee0: 7369 6f6e 6564 3d54 7275 652c 0a20 2020  sioned=True,.   
-0000fef0: 2029 202d 3e20 6469 6374 3a0a 2020 2020   ) -> dict:.    
-0000ff00: 2020 2020 2222 2243 7265 6174 6520 6120      """Create a 
-0000ff10: 6e65 7720 3a70 793a 636c 6173 733a 607e  new :py:class:`~
-0000ff20: 6d6c 7275 6e2e 6665 6174 7572 655f 7374  mlrun.feature_st
-0000ff30: 6f72 652e 4665 6174 7572 6553 6574 6020  ore.FeatureSet` 
-0000ff40: 616e 6420 7361 7665 2069 6e20 7468 6520  and save in the 
-0000ff50: 3a70 793a 6d6f 643a 606d 6c72 756e 6020  :py:mod:`mlrun` 
-0000ff60: 4442 2e20 5468 650a 2020 2020 2020 2020  DB. The.        
-0000ff70: 6665 6174 7572 652d 7365 7420 6d75 7374  feature-set must
-0000ff80: 206e 6f74 2070 7265 7669 6f75 736c 7920   not previously 
-0000ff90: 6578 6973 7420 696e 2074 6865 2044 422e  exist in the DB.
-0000ffa0: 0a0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
-0000ffb0: 2066 6561 7475 7265 5f73 6574 3a20 5468   feature_set: Th
-0000ffc0: 6520 6e65 7720 3a70 793a 636c 6173 733a  e new :py:class:
-0000ffd0: 607e 6d6c 7275 6e2e 6665 6174 7572 655f  `~mlrun.feature_
-0000ffe0: 7374 6f72 652e 4665 6174 7572 6553 6574  store.FeatureSet
-0000fff0: 6020 746f 2063 7265 6174 652e 0a20 2020  ` to create..   
-00010000: 2020 2020 203a 7061 7261 6d20 7072 6f6a       :param proj
-00010010: 6563 743a 204e 616d 6520 6f66 2070 726f  ect: Name of pro
-00010020: 6a65 6374 2074 6869 7320 6665 6174 7572  ject this featur
-00010030: 652d 7365 7420 6265 6c6f 6e67 7320 746f  e-set belongs to
-00010040: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
-00010050: 2076 6572 7369 6f6e 6564 3a20 5768 6574   versioned: Whet
-00010060: 6865 7220 746f 206d 6169 6e74 6169 6e20  her to maintain 
-00010070: 7665 7273 696f 6e73 2066 6f72 2074 6869  versions for thi
-00010080: 7320 6665 6174 7572 652d 7365 742e 2041  s feature-set. A
-00010090: 6c6c 2076 6572 7369 6f6e 7320 6f66 2061  ll versions of a
-000100a0: 2076 6572 7369 6f6e 6564 206f 626a 6563   versioned objec
-000100b0: 740a 2020 2020 2020 2020 2020 2020 7769  t.            wi
-000100c0: 6c6c 2062 6520 6b65 7074 2069 6e20 7468  ll be kept in th
-000100d0: 6520 4442 2061 6e64 2063 616e 2062 6520  e DB and can be 
-000100e0: 7265 7472 6965 7665 6420 756e 7469 6c20  retrieved until 
-000100f0: 6578 706c 6963 6974 6c79 2064 656c 6574  explicitly delet
-00010100: 6564 2e0a 2020 2020 2020 2020 3a72 6574  ed..        :ret
-00010110: 7572 6e73 3a20 5468 6520 3a70 793a 636c  urns: The :py:cl
-00010120: 6173 733a 607e 6d6c 7275 6e2e 6665 6174  ass:`~mlrun.feat
-00010130: 7572 655f 7374 6f72 652e 4665 6174 7572  ure_store.Featur
-00010140: 6553 6574 6020 6f62 6a65 6374 2028 6173  eSet` object (as
-00010150: 2064 6963 7429 2e0a 2020 2020 2020 2020   dict)..        
-00010160: 2222 220a 2020 2020 2020 2020 6966 2069  """.        if i
-00010170: 7369 6e73 7461 6e63 6528 6665 6174 7572  sinstance(featur
-00010180: 655f 7365 742c 2073 6368 656d 6173 2e46  e_set, schemas.F
-00010190: 6561 7475 7265 5365 7429 3a0a 2020 2020  eatureSet):.    
-000101a0: 2020 2020 2020 2020 6665 6174 7572 655f          feature_
-000101b0: 7365 7420 3d20 6665 6174 7572 655f 7365  set = feature_se
-000101c0: 742e 6469 6374 2829 0a20 2020 2020 2020  t.dict().       
-000101d0: 2065 6c69 6620 6973 696e 7374 616e 6365   elif isinstance
-000101e0: 2866 6561 7475 7265 5f73 6574 2c20 4665  (feature_set, Fe
-000101f0: 6174 7572 6553 6574 293a 0a20 2020 2020  atureSet):.     
-00010200: 2020 2020 2020 2066 6561 7475 7265 5f73         feature_s
-00010210: 6574 203d 2066 6561 7475 7265 5f73 6574  et = feature_set
-00010220: 2e74 6f5f 6469 6374 2829 0a0a 2020 2020  .to_dict()..    
-00010230: 2020 2020 7072 6f6a 6563 7420 3d20 280a      project = (.
-00010240: 2020 2020 2020 2020 2020 2020 7072 6f6a              proj
-00010250: 6563 740a 2020 2020 2020 2020 2020 2020  ect.            
-00010260: 6f72 2066 6561 7475 7265 5f73 6574 5b22  or feature_set["
-00010270: 6d65 7461 6461 7461 225d 2e67 6574 2822  metadata"].get("
-00010280: 7072 6f6a 6563 7422 2c20 4e6f 6e65 290a  project", None).
-00010290: 2020 2020 2020 2020 2020 2020 6f72 2063              or c
-000102a0: 6f6e 6669 672e 6465 6661 756c 745f 7072  onfig.default_pr
-000102b0: 6f6a 6563 740a 2020 2020 2020 2020 290a  oject.        ).
-000102c0: 2020 2020 2020 2020 7061 7468 203d 2066          path = f
-000102d0: 2270 726f 6a65 6374 732f 7b70 726f 6a65  "projects/{proje
-000102e0: 6374 7d2f 6665 6174 7572 652d 7365 7473  ct}/feature-sets
-000102f0: 220a 2020 2020 2020 2020 7061 7261 6d73  ".        params
-00010300: 203d 207b 2276 6572 7369 6f6e 6564 223a   = {"versioned":
-00010310: 2076 6572 7369 6f6e 6564 7d0a 0a20 2020   versioned}..   
-00010320: 2020 2020 206e 616d 6520 3d20 6665 6174       name = feat
-00010330: 7572 655f 7365 745b 226d 6574 6164 6174  ure_set["metadat
-00010340: 6122 5d5b 226e 616d 6522 5d0a 2020 2020  a"]["name"].    
-00010350: 2020 2020 6572 726f 725f 6d65 7373 6167      error_messag
-00010360: 6520 3d20 6622 4661 696c 6564 2063 7265  e = f"Failed cre
-00010370: 6174 696e 6720 6665 6174 7572 652d 7365  ating feature-se
-00010380: 7420 7b70 726f 6a65 6374 7d2f 7b6e 616d  t {project}/{nam
-00010390: 657d 220a 2020 2020 2020 2020 7265 7370  e}".        resp
-000103a0: 203d 2073 656c 662e 6170 695f 6361 6c6c   = self.api_call
-000103b0: 280a 2020 2020 2020 2020 2020 2020 2250  (.            "P
-000103c0: 4f53 5422 2c0a 2020 2020 2020 2020 2020  OST",.          
-000103d0: 2020 7061 7468 2c0a 2020 2020 2020 2020    path,.        
-000103e0: 2020 2020 6572 726f 725f 6d65 7373 6167      error_messag
-000103f0: 652c 0a20 2020 2020 2020 2020 2020 2070  e,.            p
-00010400: 6172 616d 733d 7061 7261 6d73 2c0a 2020  arams=params,.  
-00010410: 2020 2020 2020 2020 2020 626f 6479 3d64            body=d
-00010420: 6963 745f 746f 5f6a 736f 6e28 6665 6174  ict_to_json(feat
-00010430: 7572 655f 7365 7429 2c0a 2020 2020 2020  ure_set),.      
-00010440: 2020 290a 2020 2020 2020 2020 7265 7475    ).        retu
-00010450: 726e 2072 6573 702e 6a73 6f6e 2829 0a0a  rn resp.json()..
-00010460: 2020 2020 6465 6620 6765 745f 6665 6174      def get_feat
-00010470: 7572 655f 7365 7428 0a20 2020 2020 2020  ure_set(.       
-00010480: 2073 656c 662c 206e 616d 653a 2073 7472   self, name: str
-00010490: 2c20 7072 6f6a 6563 743a 2073 7472 203d  , project: str =
-000104a0: 2022 222c 2074 6167 3a20 7374 7220 3d20   "", tag: str = 
-000104b0: 4e6f 6e65 2c20 7569 643a 2073 7472 203d  None, uid: str =
-000104c0: 204e 6f6e 650a 2020 2020 2920 2d3e 2046   None.    ) -> F
-000104d0: 6561 7475 7265 5365 743a 0a20 2020 2020  eatureSet:.     
-000104e0: 2020 2022 2222 5265 7472 6965 7665 2061     """Retrieve a
-000104f0: 207e 6d6c 7275 6e2e 6665 6174 7572 655f   ~mlrun.feature_
-00010500: 7374 6f72 652e 4665 6174 7572 6553 6574  store.FeatureSet
-00010510: 6020 6f62 6a65 6374 2e20 4966 2062 6f74  ` object. If bot
-00010520: 6820 6060 7461 6760 6020 616e 6420 6060  h ``tag`` and ``
-00010530: 7569 6460 6020 6172 6520 6e6f 7420 7370  uid`` are not sp
-00010540: 6563 6966 6965 642c 2074 6865 6e0a 2020  ecified, then.  
-00010550: 2020 2020 2020 7468 6520 6f62 6a65 6374        the object
-00010560: 2074 6167 6765 6420 6060 6c61 7465 7374   tagged ``latest
-00010570: 6060 2077 696c 6c20 6265 2072 6574 7269  `` will be retri
-00010580: 6576 6564 2e0a 0a20 2020 2020 2020 203a  eved...        :
-00010590: 7061 7261 6d20 6e61 6d65 3a20 4e61 6d65  param name: Name
-000105a0: 206f 6620 6f62 6a65 6374 2074 6f20 7265   of object to re
-000105b0: 7472 6965 7665 2e0a 2020 2020 2020 2020  trieve..        
-000105c0: 3a70 6172 616d 2070 726f 6a65 6374 3a20  :param project: 
-000105d0: 5072 6f6a 6563 7420 7468 6520 4665 6174  Project the Feat
-000105e0: 7572 6553 6574 2062 656c 6f6e 6773 2074  ureSet belongs t
-000105f0: 6f2e 0a20 2020 2020 2020 203a 7061 7261  o..        :para
-00010600: 6d20 7461 673a 2054 6167 206f 6620 7468  m tag: Tag of th
-00010610: 6520 7370 6563 6966 6963 206f 626a 6563  e specific objec
-00010620: 7420 7665 7273 696f 6e20 746f 2072 6574  t version to ret
-00010630: 7269 6576 652e 0a20 2020 2020 2020 203a  rieve..        :
-00010640: 7061 7261 6d20 7569 643a 2075 6964 206f  param uid: uid o
-00010650: 6620 7468 6520 6f62 6a65 6374 2074 6f20  f the object to 
-00010660: 7265 7472 6965 7665 2028 6361 6e20 6f6e  retrieve (can on
-00010670: 6c79 2062 6520 7573 6564 2066 6f72 2076  ly be used for v
-00010680: 6572 7369 6f6e 6564 206f 626a 6563 7473  ersioned objects
-00010690: 292e 0a20 2020 2020 2020 2022 2222 0a0a  )..        """..
-000106a0: 2020 2020 2020 2020 7072 6f6a 6563 7420          project 
-000106b0: 3d20 7072 6f6a 6563 7420 6f72 2063 6f6e  = project or con
-000106c0: 6669 672e 6465 6661 756c 745f 7072 6f6a  fig.default_proj
-000106d0: 6563 740a 2020 2020 2020 2020 7265 6665  ect.        refe
-000106e0: 7265 6e63 6520 3d20 7365 6c66 2e5f 7265  rence = self._re
-000106f0: 736f 6c76 655f 7265 6665 7265 6e63 6528  solve_reference(
-00010700: 7461 672c 2075 6964 290a 2020 2020 2020  tag, uid).      
-00010710: 2020 7061 7468 203d 2066 2270 726f 6a65    path = f"proje
-00010720: 6374 732f 7b70 726f 6a65 6374 7d2f 6665  cts/{project}/fe
-00010730: 6174 7572 652d 7365 7473 2f7b 6e61 6d65  ature-sets/{name
-00010740: 7d2f 7265 6665 7265 6e63 6573 2f7b 7265  }/references/{re
-00010750: 6665 7265 6e63 657d 220a 2020 2020 2020  ference}".      
-00010760: 2020 6572 726f 725f 6d65 7373 6167 6520    error_message 
-00010770: 3d20 6622 4661 696c 6564 2072 6574 7269  = f"Failed retri
-00010780: 6576 696e 6720 6665 6174 7572 652d 7365  eving feature-se
-00010790: 7420 7b70 726f 6a65 6374 7d2f 7b6e 616d  t {project}/{nam
-000107a0: 657d 220a 2020 2020 2020 2020 7265 7370  e}".        resp
-000107b0: 203d 2073 656c 662e 6170 695f 6361 6c6c   = self.api_call
-000107c0: 2822 4745 5422 2c20 7061 7468 2c20 6572  ("GET", path, er
-000107d0: 726f 725f 6d65 7373 6167 6529 0a20 2020  ror_message).   
-000107e0: 2020 2020 2072 6574 7572 6e20 4665 6174       return Feat
-000107f0: 7572 6553 6574 2e66 726f 6d5f 6469 6374  ureSet.from_dict
-00010800: 2872 6573 702e 6a73 6f6e 2829 290a 0a20  (resp.json()).. 
-00010810: 2020 2064 6566 206c 6973 745f 6665 6174     def list_feat
-00010820: 7572 6573 280a 2020 2020 2020 2020 7365  ures(.        se
-00010830: 6c66 2c0a 2020 2020 2020 2020 7072 6f6a  lf,.        proj
-00010840: 6563 743a 2073 7472 2c0a 2020 2020 2020  ect: str,.      
-00010850: 2020 6e61 6d65 3a20 7374 7220 3d20 4e6f    name: str = No
-00010860: 6e65 2c0a 2020 2020 2020 2020 7461 673a  ne,.        tag:
-00010870: 2073 7472 203d 204e 6f6e 652c 0a20 2020   str = None,.   
-00010880: 2020 2020 2065 6e74 6974 6965 733a 204c       entities: L
-00010890: 6973 745b 7374 725d 203d 204e 6f6e 652c  ist[str] = None,
-000108a0: 0a20 2020 2020 2020 206c 6162 656c 733a  .        labels:
-000108b0: 204c 6973 745b 7374 725d 203d 204e 6f6e   List[str] = Non
-000108c0: 652c 0a20 2020 2029 202d 3e20 4c69 7374  e,.    ) -> List
-000108d0: 5b64 6963 745d 3a0a 2020 2020 2020 2020  [dict]:.        
-000108e0: 2222 224c 6973 7420 6665 6174 7572 652d  """List feature-
-000108f0: 7365 7473 2077 6869 6368 2063 6f6e 7461  sets which conta
-00010900: 696e 2073 7065 6369 6669 6320 6665 6174  in specific feat
-00010910: 7572 6573 2e20 5468 6973 2066 756e 6374  ures. This funct
-00010920: 696f 6e20 6d61 7920 7265 7475 726e 206d  ion may return m
-00010930: 756c 7469 706c 6520 7665 7273 696f 6e73  ultiple versions
-00010940: 206f 6620 7468 6520 7361 6d65 0a20 2020   of the same.   
-00010950: 2020 2020 2066 6561 7475 7265 2d73 6574       feature-set
-00010960: 2069 6620 6120 7370 6563 6966 6963 2074   if a specific t
-00010970: 6167 2069 7320 6e6f 7420 7265 7175 6573  ag is not reques
-00010980: 7465 642e 204e 6f74 6520 7468 6174 2074  ted. Note that t
-00010990: 6865 2076 6172 696f 7573 2066 696c 7465  he various filte
-000109a0: 7273 206f 6620 7468 6973 2066 756e 6374  rs of this funct
-000109b0: 696f 6e20 6163 7475 616c 6c79 0a20 2020  ion actually.   
-000109c0: 2020 2020 2072 6566 6572 2074 6f20 7468       refer to th
-000109d0: 6520 6665 6174 7572 652d 7365 7420 6f62  e feature-set ob
-000109e0: 6a65 6374 2063 6f6e 7461 696e 696e 6720  ject containing 
-000109f0: 7468 6520 6665 6174 7572 6573 2c20 6e6f  the features, no
-00010a00: 7420 746f 2074 6865 2066 6561 7475 7265  t to the feature
-00010a10: 7320 7468 656d 7365 6c76 6573 2e0a 0a20  s themselves... 
-00010a20: 2020 2020 2020 203a 7061 7261 6d20 7072         :param pr
-00010a30: 6f6a 6563 743a 2050 726f 6a65 6374 2077  oject: Project w
-00010a40: 6869 6368 2063 6f6e 7461 696e 7320 7468  hich contains th
-00010a50: 6573 6520 6665 6174 7572 6573 2e0a 2020  ese features..  
-00010a60: 2020 2020 2020 3a70 6172 616d 206e 616d        :param nam
-00010a70: 653a 204e 616d 6520 6f66 2074 6865 2066  e: Name of the f
-00010a80: 6561 7475 7265 2074 6f20 6c6f 6f6b 2066  eature to look f
-00010a90: 6f72 2e20 5468 6520 6e61 6d65 2069 7320  or. The name is 
-00010aa0: 7573 6564 2069 6e20 6120 6c69 6b65 2071  used in a like q
-00010ab0: 7565 7279 2c20 616e 6420 6973 206e 6f74  uery, and is not
-00010ac0: 2063 6173 652d 7365 6e73 6974 6976 652e   case-sensitive.
-00010ad0: 2046 6f72 0a20 2020 2020 2020 2020 2020   For.           
-00010ae0: 2065 7861 6d70 6c65 2c20 6c6f 6f6b 696e   example, lookin
-00010af0: 6720 666f 7220 6060 6665 6174 6060 2077  g for ``feat`` w
-00010b00: 696c 6c20 7265 7475 726e 2066 6561 7475  ill return featu
-00010b10: 7265 7320 7768 6963 6820 6172 6520 6e61  res which are na
-00010b20: 6d65 6420 6060 4d79 4665 6174 7572 6560  med ``MyFeature`
-00010b30: 6020 6173 2077 656c 6c20 6173 2060 6064  ` as well as ``d
-00010b40: 6566 6561 7460 602e 0a20 2020 2020 2020  efeat``..       
-00010b50: 203a 7061 7261 6d20 7461 673a 2052 6574   :param tag: Ret
-00010b60: 7572 6e20 6665 6174 7572 652d 7365 7473  urn feature-sets
-00010b70: 2077 6869 6368 2063 6f6e 7461 696e 2074   which contain t
-00010b80: 6865 2066 6561 7475 7265 7320 6c6f 6f6b  he features look
-00010b90: 6564 2066 6f72 2c20 616e 6420 6172 6520  ed for, and are 
-00010ba0: 7461 6767 6564 2077 6974 6820 7468 6520  tagged with the 
-00010bb0: 7370 6563 6966 6963 2074 6167 2e0a 2020  specific tag..  
-00010bc0: 2020 2020 2020 3a70 6172 616d 2065 6e74        :param ent
-00010bd0: 6974 6965 733a 2052 6574 7572 6e20 6f6e  ities: Return on
-00010be0: 6c79 2066 6561 7475 7265 2d73 6574 7320  ly feature-sets 
-00010bf0: 7768 6963 6820 636f 6e74 6169 6e20 616e  which contain an
-00010c00: 2065 6e74 6974 7920 7768 6f73 6520 6e61   entity whose na
-00010c10: 6d65 2069 7320 636f 6e74 6169 6e65 6420  me is contained 
-00010c20: 696e 2074 6869 7320 6c69 7374 2e0a 2020  in this list..  
-00010c30: 2020 2020 2020 3a70 6172 616d 206c 6162        :param lab
-00010c40: 656c 733a 2052 6574 7572 6e20 6f6e 6c79  els: Return only
-00010c50: 2066 6561 7475 7265 2d73 6574 7320 7768   feature-sets wh
-00010c60: 6963 6820 6172 6520 6c61 6265 6c65 6420  ich are labeled 
-00010c70: 6173 2072 6571 7565 7374 6564 2e0a 2020  as requested..  
-00010c80: 2020 2020 2020 3a72 6574 7572 6e73 3a20        :returns: 
-00010c90: 4120 6c69 7374 206f 6620 6d61 7070 696e  A list of mappin
-00010ca0: 6720 6672 6f6d 2066 6561 7475 7265 2074  g from feature t
-00010cb0: 6f20 6120 6469 6765 7374 206f 6620 7468  o a digest of th
-00010cc0: 6520 6665 6174 7572 652d 7365 742c 2077  e feature-set, w
-00010cd0: 6869 6368 2063 6f6e 7461 696e 7320 7468  hich contains th
-00010ce0: 6520 6665 6174 7572 652d 7365 740a 2020  e feature-set.  
-00010cf0: 2020 2020 2020 2020 2020 6d65 7461 2d64            meta-d
-00010d00: 6174 612e 204d 756c 7469 706c 6520 656e  ata. Multiple en
-00010d10: 7472 6965 7320 6d61 7920 6265 2072 6574  tries may be ret
-00010d20: 7572 6e65 6420 666f 7220 616e 7920 7370  urned for any sp
-00010d30: 6563 6966 6963 2066 6561 7475 7265 2064  ecific feature d
-00010d40: 7565 2074 6f20 6d75 6c74 6970 6c65 2074  ue to multiple t
-00010d50: 6167 7320 6f72 2076 6572 7369 6f6e 730a  ags or versions.
-00010d60: 2020 2020 2020 2020 2020 2020 6f66 2074              of t
-00010d70: 6865 2066 6561 7475 7265 2d73 6574 2e0a  he feature-set..
-00010d80: 2020 2020 2020 2020 2222 220a 0a20 2020          """..   
-00010d90: 2020 2020 2070 726f 6a65 6374 203d 2070       project = p
-00010da0: 726f 6a65 6374 206f 7220 636f 6e66 6967  roject or config
-00010db0: 2e64 6566 6175 6c74 5f70 726f 6a65 6374  .default_project
-00010dc0: 0a20 2020 2020 2020 2070 6172 616d 7320  .        params 
-00010dd0: 3d20 7b0a 2020 2020 2020 2020 2020 2020  = {.            
-00010de0: 226e 616d 6522 3a20 6e61 6d65 2c0a 2020  "name": name,.  
-00010df0: 2020 2020 2020 2020 2020 2274 6167 223a            "tag":
-00010e00: 2074 6167 2c0a 2020 2020 2020 2020 2020   tag,.          
-00010e10: 2020 2265 6e74 6974 7922 3a20 656e 7469    "entity": enti
-00010e20: 7469 6573 206f 7220 5b5d 2c0a 2020 2020  ties or [],.    
-00010e30: 2020 2020 2020 2020 226c 6162 656c 223a          "label":
-00010e40: 206c 6162 656c 7320 6f72 205b 5d2c 0a20   labels or [],. 
-00010e50: 2020 2020 2020 207d 0a0a 2020 2020 2020         }..      
-00010e60: 2020 7061 7468 203d 2066 2270 726f 6a65    path = f"proje
-00010e70: 6374 732f 7b70 726f 6a65 6374 7d2f 6665  cts/{project}/fe
-00010e80: 6174 7572 6573 220a 0a20 2020 2020 2020  atures"..       
-00010e90: 2065 7272 6f72 5f6d 6573 7361 6765 203d   error_message =
-00010ea0: 2066 2246 6169 6c65 6420 6c69 7374 696e   f"Failed listin
-00010eb0: 6720 6665 6174 7572 6573 2c20 7072 6f6a  g features, proj
-00010ec0: 6563 743a 207b 7072 6f6a 6563 747d 2c20  ect: {project}, 
-00010ed0: 7175 6572 793a 207b 7061 7261 6d73 7d22  query: {params}"
-00010ee0: 0a20 2020 2020 2020 2072 6573 7020 3d20  .        resp = 
-00010ef0: 7365 6c66 2e61 7069 5f63 616c 6c28 2247  self.api_call("G
-00010f00: 4554 222c 2070 6174 682c 2065 7272 6f72  ET", path, error
-00010f10: 5f6d 6573 7361 6765 2c20 7061 7261 6d73  _message, params
-00010f20: 3d70 6172 616d 7329 0a20 2020 2020 2020  =params).       
-00010f30: 2072 6574 7572 6e20 7265 7370 2e6a 736f   return resp.jso
-00010f40: 6e28 295b 2266 6561 7475 7265 7322 5d0a  n()["features"].
-00010f50: 0a20 2020 2064 6566 206c 6973 745f 656e  .    def list_en
-00010f60: 7469 7469 6573 280a 2020 2020 2020 2020  tities(.        
-00010f70: 7365 6c66 2c0a 2020 2020 2020 2020 7072  self,.        pr
-00010f80: 6f6a 6563 743a 2073 7472 2c0a 2020 2020  oject: str,.    
-00010f90: 2020 2020 6e61 6d65 3a20 7374 7220 3d20      name: str = 
-00010fa0: 4e6f 6e65 2c0a 2020 2020 2020 2020 7461  None,.        ta
-00010fb0: 673a 2073 7472 203d 204e 6f6e 652c 0a20  g: str = None,. 
-00010fc0: 2020 2020 2020 206c 6162 656c 733a 204c         labels: L
-00010fd0: 6973 745b 7374 725d 203d 204e 6f6e 652c  ist[str] = None,
-00010fe0: 0a20 2020 2029 202d 3e20 4c69 7374 5b64  .    ) -> List[d
-00010ff0: 6963 745d 3a0a 2020 2020 2020 2020 2222  ict]:.        ""
-00011000: 2252 6574 7269 6576 6520 6120 6c69 7374  "Retrieve a list
-00011010: 206f 6620 656e 7469 7469 6573 2061 6e64   of entities and
-00011020: 2074 6865 6972 206d 6170 7069 6e67 2074   their mapping t
-00011030: 6f20 7468 6520 636f 6e74 6169 6e69 6e67  o the containing
-00011040: 2066 6561 7475 7265 2d73 6574 732e 2054   feature-sets. T
-00011050: 6869 7320 6675 6e63 7469 6f6e 2069 7320  his function is 
-00011060: 7369 6d69 6c61 720a 2020 2020 2020 2020  similar.        
-00011070: 746f 2074 6865 203a 7079 3a66 756e 633a  to the :py:func:
-00011080: 607e 6c69 7374 5f66 6561 7475 7265 7360  `~list_features`
-00011090: 2066 756e 6374 696f 6e2c 2061 6e64 2075   function, and u
-000110a0: 7365 7320 7468 6520 7361 6d65 206c 6f67  ses the same log
-000110b0: 6963 2e20 486f 7765 7665 722c 2074 6865  ic. However, the
-000110c0: 2065 6e74 6974 6965 7320 6172 6520 6d61   entities are ma
-000110d0: 7463 6865 640a 2020 2020 2020 2020 6167  tched.        ag
-000110e0: 6169 6e73 7420 7468 6520 6e61 6d65 2072  ainst the name r
-000110f0: 6174 6865 7220 7468 616e 2074 6865 2066  ather than the f
-00011100: 6561 7475 7265 732e 0a20 2020 2020 2020  eatures..       
-00011110: 2022 2222 0a0a 2020 2020 2020 2020 7072   """..        pr
-00011120: 6f6a 6563 7420 3d20 7072 6f6a 6563 7420  oject = project 
-00011130: 6f72 2063 6f6e 6669 672e 6465 6661 756c  or config.defaul
-00011140: 745f 7072 6f6a 6563 740a 2020 2020 2020  t_project.      
-00011150: 2020 7061 7261 6d73 203d 207b 0a20 2020    params = {.   
-00011160: 2020 2020 2020 2020 2022 6e61 6d65 223a           "name":
-00011170: 206e 616d 652c 0a20 2020 2020 2020 2020   name,.         
-00011180: 2020 2022 7461 6722 3a20 7461 672c 0a20     "tag": tag,. 
-00011190: 2020 2020 2020 2020 2020 2022 6c61 6265             "labe
-000111a0: 6c22 3a20 6c61 6265 6c73 206f 7220 5b5d  l": labels or []
-000111b0: 2c0a 2020 2020 2020 2020 7d0a 0a20 2020  ,.        }..   
-000111c0: 2020 2020 2070 6174 6820 3d20 6622 7072       path = f"pr
-000111d0: 6f6a 6563 7473 2f7b 7072 6f6a 6563 747d  ojects/{project}
-000111e0: 2f65 6e74 6974 6965 7322 0a0a 2020 2020  /entities"..    
-000111f0: 2020 2020 6572 726f 725f 6d65 7373 6167      error_messag
-00011200: 6520 3d20 6622 4661 696c 6564 206c 6973  e = f"Failed lis
-00011210: 7469 6e67 2065 6e74 6974 6965 732c 2070  ting entities, p
-00011220: 726f 6a65 6374 3a20 7b70 726f 6a65 6374  roject: {project
-00011230: 7d2c 2071 7565 7279 3a20 7b70 6172 616d  }, query: {param
-00011240: 737d 220a 2020 2020 2020 2020 7265 7370  s}".        resp
-00011250: 203d 2073 656c 662e 6170 695f 6361 6c6c   = self.api_call
-00011260: 2822 4745 5422 2c20 7061 7468 2c20 6572  ("GET", path, er
-00011270: 726f 725f 6d65 7373 6167 652c 2070 6172  ror_message, par
-00011280: 616d 733d 7061 7261 6d73 290a 2020 2020  ams=params).    
-00011290: 2020 2020 7265 7475 726e 2072 6573 702e      return resp.
-000112a0: 6a73 6f6e 2829 5b22 656e 7469 7469 6573  json()["entities
-000112b0: 225d 0a0a 2020 2020 4073 7461 7469 636d  "]..    @staticm
-000112c0: 6574 686f 640a 2020 2020 6465 6620 5f67  ethod.    def _g
-000112d0: 656e 6572 6174 655f 7061 7274 6974 696f  enerate_partitio
-000112e0: 6e5f 6279 5f70 6172 616d 7328 0a20 2020  n_by_params(.   
-000112f0: 2020 2020 2070 6172 7469 7469 6f6e 5f62       partition_b
-00011300: 795f 636c 732c 0a20 2020 2020 2020 2070  y_cls,.        p
-00011310: 6172 7469 7469 6f6e 5f62 792c 0a20 2020  artition_by,.   
-00011320: 2020 2020 2072 6f77 735f 7065 725f 7061       rows_per_pa
-00011330: 7274 6974 696f 6e2c 0a20 2020 2020 2020  rtition,.       
-00011340: 2073 6f72 745f 6279 2c0a 2020 2020 2020   sort_by,.      
-00011350: 2020 6f72 6465 722c 0a20 2020 2020 2020    order,.       
-00011360: 206d 6178 5f70 6172 7469 7469 6f6e 733d   max_partitions=
-00011370: 4e6f 6e65 2c0a 2020 2020 293a 0a0a 2020  None,.    ):..  
-00011380: 2020 2020 2020 7061 7274 6974 696f 6e5f        partition_
-00011390: 7061 7261 6d73 203d 207b 0a20 2020 2020  params = {.     
-000113a0: 2020 2020 2020 2022 7061 7274 6974 696f         "partitio
-000113b0: 6e2d 6279 223a 2070 6172 7469 7469 6f6e  n-by": partition
-000113c0: 5f62 792c 0a20 2020 2020 2020 2020 2020  _by,.           
-000113d0: 2022 726f 7773 2d70 6572 2d70 6172 7469   "rows-per-parti
-000113e0: 7469 6f6e 223a 2072 6f77 735f 7065 725f  tion": rows_per_
-000113f0: 7061 7274 6974 696f 6e2c 0a20 2020 2020  partition,.     
-00011400: 2020 2020 2020 2022 7061 7274 6974 696f         "partitio
-00011410: 6e2d 736f 7274 2d62 7922 3a20 736f 7274  n-sort-by": sort
-00011420: 5f62 792c 0a20 2020 2020 2020 2020 2020  _by,.           
-00011430: 2022 7061 7274 6974 696f 6e2d 6f72 6465   "partition-orde
-00011440: 7222 3a20 6f72 6465 722c 0a20 2020 2020  r": order,.     
-00011450: 2020 207d 0a20 2020 2020 2020 2069 6620     }.        if 
-00011460: 6d61 785f 7061 7274 6974 696f 6e73 2069  max_partitions i
-00011470: 7320 6e6f 7420 4e6f 6e65 3a0a 2020 2020  s not None:.    
-00011480: 2020 2020 2020 2020 7061 7274 6974 696f          partitio
-00011490: 6e5f 7061 7261 6d73 5b22 6d61 782d 7061  n_params["max-pa
-000114a0: 7274 6974 696f 6e73 225d 203d 206d 6178  rtitions"] = max
-000114b0: 5f70 6172 7469 7469 6f6e 730a 2020 2020  _partitions.    
-000114c0: 2020 2020 7265 7475 726e 2070 6172 7469      return parti
-000114d0: 7469 6f6e 5f70 6172 616d 730a 0a20 2020  tion_params..   
-000114e0: 2064 6566 206c 6973 745f 6665 6174 7572   def list_featur
-000114f0: 655f 7365 7473 280a 2020 2020 2020 2020  e_sets(.        
-00011500: 7365 6c66 2c0a 2020 2020 2020 2020 7072  self,.        pr
-00011510: 6f6a 6563 743a 2073 7472 203d 2022 222c  oject: str = "",
-00011520: 0a20 2020 2020 2020 206e 616d 653a 2073  .        name: s
-00011530: 7472 203d 204e 6f6e 652c 0a20 2020 2020  tr = None,.     
-00011540: 2020 2074 6167 3a20 7374 7220 3d20 4e6f     tag: str = No
-00011550: 6e65 2c0a 2020 2020 2020 2020 7374 6174  ne,.        stat
-00011560: 653a 2073 7472 203d 204e 6f6e 652c 0a20  e: str = None,. 
-00011570: 2020 2020 2020 2065 6e74 6974 6965 733a         entities:
-00011580: 204c 6973 745b 7374 725d 203d 204e 6f6e   List[str] = Non
-00011590: 652c 0a20 2020 2020 2020 2066 6561 7475  e,.        featu
-000115a0: 7265 733a 204c 6973 745b 7374 725d 203d  res: List[str] =
-000115b0: 204e 6f6e 652c 0a20 2020 2020 2020 206c   None,.        l
-000115c0: 6162 656c 733a 204c 6973 745b 7374 725d  abels: List[str]
-000115d0: 203d 204e 6f6e 652c 0a20 2020 2020 2020   = None,.       
-000115e0: 2070 6172 7469 7469 6f6e 5f62 793a 2055   partition_by: U
-000115f0: 6e69 6f6e 5b73 6368 656d 6173 2e46 6561  nion[schemas.Fea
-00011600: 7475 7265 5374 6f72 6550 6172 7469 7469  tureStorePartiti
-00011610: 6f6e 4279 4669 656c 642c 2073 7472 5d20  onByField, str] 
-00011620: 3d20 4e6f 6e65 2c0a 2020 2020 2020 2020  = None,.        
-00011630: 726f 7773 5f70 6572 5f70 6172 7469 7469  rows_per_partiti
-00011640: 6f6e 3a20 696e 7420 3d20 312c 0a20 2020  on: int = 1,.   
-00011650: 2020 2020 2070 6172 7469 7469 6f6e 5f73       partition_s
-00011660: 6f72 745f 6279 3a20 556e 696f 6e5b 7363  ort_by: Union[sc
-00011670: 6865 6d61 732e 536f 7274 4669 656c 642c  hemas.SortField,
-00011680: 2073 7472 5d20 3d20 4e6f 6e65 2c0a 2020   str] = None,.  
-00011690: 2020 2020 2020 7061 7274 6974 696f 6e5f        partition_
-000116a0: 6f72 6465 723a 2055 6e69 6f6e 5b73 6368  order: Union[sch
-000116b0: 656d 6173 2e4f 7264 6572 5479 7065 2c20  emas.OrderType, 
-000116c0: 7374 725d 203d 2073 6368 656d 6173 2e4f  str] = schemas.O
-000116d0: 7264 6572 5479 7065 2e64 6573 632c 0a20  rderType.desc,. 
-000116e0: 2020 2029 202d 3e20 4c69 7374 5b46 6561     ) -> List[Fea
-000116f0: 7475 7265 5365 745d 3a0a 2020 2020 2020  tureSet]:.      
-00011700: 2020 2222 2252 6574 7269 6576 6520 6120    """Retrieve a 
-00011710: 6c69 7374 206f 6620 6665 6174 7572 652d  list of feature-
-00011720: 7365 7473 206d 6174 6368 696e 6720 7468  sets matching th
-00011730: 6520 6372 6974 6572 6961 2070 726f 7669  e criteria provi
-00011740: 6465 642e 0a0a 2020 2020 2020 2020 3a70  ded...        :p
-00011750: 6172 616d 2070 726f 6a65 6374 3a20 5072  aram project: Pr
-00011760: 6f6a 6563 7420 6e61 6d65 2e0a 2020 2020  oject name..    
-00011770: 2020 2020 3a70 6172 616d 206e 616d 653a      :param name:
-00011780: 204e 616d 6520 6f66 2066 6561 7475 7265   Name of feature
-00011790: 2d73 6574 2074 6f20 6d61 7463 682e 2054  -set to match. T
-000117a0: 6869 7320 6973 2061 206c 696b 6520 7175  his is a like qu
-000117b0: 6572 792c 2061 6e64 2069 7320 6361 7365  ery, and is case
-000117c0: 2d69 6e73 656e 7369 7469 7665 2e0a 2020  -insensitive..  
-000117d0: 2020 2020 2020 3a70 6172 616d 2074 6167        :param tag
-000117e0: 3a20 4d61 7463 6820 6665 6174 7572 652d  : Match feature-
-000117f0: 7365 7473 2077 6974 6820 7370 6563 6966  sets with specif
-00011800: 6963 2074 6167 2e0a 2020 2020 2020 2020  ic tag..        
-00011810: 3a70 6172 616d 2073 7461 7465 3a20 4d61  :param state: Ma
-00011820: 7463 6820 6665 6174 7572 652d 7365 7473  tch feature-sets
-00011830: 2077 6974 6820 6120 7370 6563 6966 6963   with a specific
-00011840: 2073 7461 7465 2e0a 2020 2020 2020 2020   state..        
-00011850: 3a70 6172 616d 2065 6e74 6974 6965 733a  :param entities:
-00011860: 204d 6174 6368 2066 6561 7475 7265 2d73   Match feature-s
-00011870: 6574 7320 7768 6963 6820 636f 6e74 6169  ets which contai
-00011880: 6e20 656e 7469 7469 6573 2077 686f 7365  n entities whose
-00011890: 206e 616d 6520 6973 2069 6e20 7468 6973   name is in this
-000118a0: 206c 6973 742e 0a20 2020 2020 2020 203a   list..        :
-000118b0: 7061 7261 6d20 6665 6174 7572 6573 3a20  param features: 
-000118c0: 4d61 7463 6820 6665 6174 7572 652d 7365  Match feature-se
-000118d0: 7473 2077 6869 6368 2063 6f6e 7461 696e  ts which contain
-000118e0: 2066 6561 7475 7265 7320 7768 6f73 6520   features whose 
-000118f0: 6e61 6d65 2069 7320 696e 2074 6869 7320  name is in this 
-00011900: 6c69 7374 2e0a 2020 2020 2020 2020 3a70  list..        :p
-00011910: 6172 616d 206c 6162 656c 733a 204d 6174  aram labels: Mat
-00011920: 6368 2066 6561 7475 7265 2d73 6574 7320  ch feature-sets 
-00011930: 7768 6963 6820 6861 7665 2074 6865 7365  which have these
-00011940: 206c 6162 656c 732e 0a20 2020 2020 2020   labels..       
-00011950: 203a 7061 7261 6d20 7061 7274 6974 696f   :param partitio
-00011960: 6e5f 6279 3a20 4669 656c 6420 746f 2067  n_by: Field to g
-00011970: 726f 7570 2072 6573 756c 7473 2062 792e  roup results by.
-00011980: 204f 6e6c 7920 616c 6c6f 7765 6420 7661   Only allowed va
-00011990: 6c75 6520 6973 2060 6e61 6d65 602e 2057  lue is `name`. W
-000119a0: 6865 6e20 6070 6172 7469 7469 6f6e 5f62  hen `partition_b
-000119b0: 7960 2069 7320 7370 6563 6966 6965 642c  y` is specified,
-000119c0: 0a20 2020 2020 2020 2020 2020 2074 6865  .            the
-000119d0: 2060 7061 7274 6974 696f 6e5f 736f 7274   `partition_sort
-000119e0: 5f62 7960 2070 6172 616d 6574 6572 206d  _by` parameter m
-000119f0: 7573 7420 6265 2070 726f 7669 6465 6420  ust be provided 
-00011a00: 6173 2077 656c 6c2e 0a20 2020 2020 2020  as well..       
-00011a10: 203a 7061 7261 6d20 726f 7773 5f70 6572   :param rows_per
-00011a20: 5f70 6172 7469 7469 6f6e 3a20 486f 7720  _partition: How 
-00011a30: 6d61 6e79 2074 6f70 2072 6f77 7320 2870  many top rows (p
-00011a40: 6572 2073 6f72 7469 6e67 2064 6566 696e  er sorting defin
-00011a50: 6564 2062 7920 6070 6172 7469 7469 6f6e  ed by `partition
-00011a60: 5f73 6f72 745f 6279 6020 616e 6420 6070  _sort_by` and `p
-00011a70: 6172 7469 7469 6f6e 5f6f 7264 6572 6029  artition_order`)
-00011a80: 0a20 2020 2020 2020 2020 2020 2074 6f20  .            to 
-00011a90: 7265 7475 726e 2070 6572 2067 726f 7570  return per group
-00011aa0: 2e20 4465 6661 756c 7420 7661 6c75 6520  . Default value 
-00011ab0: 6973 2031 2e0a 2020 2020 2020 2020 3a70  is 1..        :p
-00011ac0: 6172 616d 2070 6172 7469 7469 6f6e 5f73  aram partition_s
-00011ad0: 6f72 745f 6279 3a20 5768 6174 2066 6965  ort_by: What fie
-00011ae0: 6c64 2074 6f20 736f 7274 2074 6865 2072  ld to sort the r
-00011af0: 6573 756c 7473 2062 792c 2077 6974 6869  esults by, withi
-00011b00: 6e20 6561 6368 2070 6172 7469 7469 6f6e  n each partition
-00011b10: 2064 6566 696e 6564 2062 7920 6070 6172   defined by `par
-00011b20: 7469 7469 6f6e 5f62 7960 2e0a 2020 2020  tition_by`..    
-00011b30: 2020 2020 2020 2020 4375 7272 656e 746c          Currentl
-00011b40: 7920 7468 6520 6f6e 6c79 2061 6c6c 6f77  y the only allow
-00011b50: 6564 2076 616c 7565 2061 7265 2060 6372  ed value are `cr
-00011b60: 6561 7465 6460 2061 6e64 2060 7570 6461  eated` and `upda
-00011b70: 7465 6460 2e0a 2020 2020 2020 2020 3a70  ted`..        :p
-00011b80: 6172 616d 2070 6172 7469 7469 6f6e 5f6f  aram partition_o
-00011b90: 7264 6572 3a20 4f72 6465 7220 6f66 2073  rder: Order of s
-00011ba0: 6f72 7469 6e67 2077 6974 6869 6e20 7061  orting within pa
-00011bb0: 7274 6974 696f 6e73 202d 2060 6173 6360  rtitions - `asc`
-00011bc0: 206f 7220 6064 6573 6360 2e20 4465 6661   or `desc`. Defa
-00011bd0: 756c 7420 6973 2060 6465 7363 602e 0a20  ult is `desc`.. 
-00011be0: 2020 2020 2020 203a 7265 7475 726e 733a         :returns:
-00011bf0: 204c 6973 7420 6f66 206d 6174 6368 696e   List of matchin
-00011c00: 6720 3a70 793a 636c 6173 733a 607e 6d6c  g :py:class:`~ml
-00011c10: 7275 6e2e 6665 6174 7572 655f 7374 6f72  run.feature_stor
-00011c20: 652e 4665 6174 7572 6553 6574 6020 6f62  e.FeatureSet` ob
-00011c30: 6a65 6374 732e 0a20 2020 2020 2020 2022  jects..        "
-00011c40: 2222 0a0a 2020 2020 2020 2020 7072 6f6a  ""..        proj
-00011c50: 6563 7420 3d20 7072 6f6a 6563 7420 6f72  ect = project or
-00011c60: 2063 6f6e 6669 672e 6465 6661 756c 745f   config.default_
-00011c70: 7072 6f6a 6563 740a 0a20 2020 2020 2020  project..       
-00011c80: 2070 6172 616d 7320 3d20 7b0a 2020 2020   params = {.    
-00011c90: 2020 2020 2020 2020 226e 616d 6522 3a20          "name": 
-00011ca0: 6e61 6d65 2c0a 2020 2020 2020 2020 2020  name,.          
-00011cb0: 2020 2273 7461 7465 223a 2073 7461 7465    "state": state
-00011cc0: 2c0a 2020 2020 2020 2020 2020 2020 2274  ,.            "t
-00011cd0: 6167 223a 2074 6167 2c0a 2020 2020 2020  ag": tag,.      
-00011ce0: 2020 2020 2020 2265 6e74 6974 7922 3a20        "entity": 
-00011cf0: 656e 7469 7469 6573 206f 7220 5b5d 2c0a  entities or [],.
-00011d00: 2020 2020 2020 2020 2020 2020 2266 6561              "fea
-00011d10: 7475 7265 223a 2066 6561 7475 7265 7320  ture": features 
-00011d20: 6f72 205b 5d2c 0a20 2020 2020 2020 2020  or [],.         
-00011d30: 2020 2022 6c61 6265 6c22 3a20 6c61 6265     "label": labe
-00011d40: 6c73 206f 7220 5b5d 2c0a 2020 2020 2020  ls or [],.      
-00011d50: 2020 7d0a 2020 2020 2020 2020 6966 2070    }.        if p
-00011d60: 6172 7469 7469 6f6e 5f62 793a 0a20 2020  artition_by:.   
-00011d70: 2020 2020 2020 2020 2070 6172 616d 732e           params.
-00011d80: 7570 6461 7465 280a 2020 2020 2020 2020  update(.        
-00011d90: 2020 2020 2020 2020 7365 6c66 2e5f 6765          self._ge
-00011da0: 6e65 7261 7465 5f70 6172 7469 7469 6f6e  nerate_partition
-00011db0: 5f62 795f 7061 7261 6d73 280a 2020 2020  _by_params(.    
-00011dc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011dd0: 7363 6865 6d61 732e 4665 6174 7572 6553  schemas.FeatureS
-00011de0: 746f 7265 5061 7274 6974 696f 6e42 7946  torePartitionByF
-00011df0: 6965 6c64 2c0a 2020 2020 2020 2020 2020  ield,.          
-00011e00: 2020 2020 2020 2020 2020 7061 7274 6974            partit
-00011e10: 696f 6e5f 6279 2c0a 2020 2020 2020 2020  ion_by,.        
-00011e20: 2020 2020 2020 2020 2020 2020 726f 7773              rows
-00011e30: 5f70 6572 5f70 6172 7469 7469 6f6e 2c0a  _per_partition,.
-00011e40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011e50: 2020 2020 7061 7274 6974 696f 6e5f 736f      partition_so
-00011e60: 7274 5f62 792c 0a20 2020 2020 2020 2020  rt_by,.         
-00011e70: 2020 2020 2020 2020 2020 2070 6172 7469             parti
-00011e80: 7469 6f6e 5f6f 7264 6572 2c0a 2020 2020  tion_order,.    
-00011e90: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
-00011ea0: 2020 2020 2020 2020 2020 290a 0a20 2020            )..   
-00011eb0: 2020 2020 2070 6174 6820 3d20 6622 7072       path = f"pr
-00011ec0: 6f6a 6563 7473 2f7b 7072 6f6a 6563 747d  ojects/{project}
-00011ed0: 2f66 6561 7475 7265 2d73 6574 7322 0a0a  /feature-sets"..
-00011ee0: 2020 2020 2020 2020 6572 726f 725f 6d65          error_me
-00011ef0: 7373 6167 6520 3d20 280a 2020 2020 2020  ssage = (.      
-00011f00: 2020 2020 2020 6622 4661 696c 6564 206c        f"Failed l
-00011f10: 6973 7469 6e67 2066 6561 7475 7265 2d73  isting feature-s
-00011f20: 6574 732c 2070 726f 6a65 6374 3a20 7b70  ets, project: {p
-00011f30: 726f 6a65 6374 7d2c 2071 7565 7279 3a20  roject}, query: 
-00011f40: 7b70 6172 616d 737d 220a 2020 2020 2020  {params}".      
-00011f50: 2020 290a 2020 2020 2020 2020 7265 7370    ).        resp
-00011f60: 203d 2073 656c 662e 6170 695f 6361 6c6c   = self.api_call
-00011f70: 2822 4745 5422 2c20 7061 7468 2c20 6572  ("GET", path, er
-00011f80: 726f 725f 6d65 7373 6167 652c 2070 6172  ror_message, par
-00011f90: 616d 733d 7061 7261 6d73 290a 2020 2020  ams=params).    
-00011fa0: 2020 2020 6665 6174 7572 655f 7365 7473      feature_sets
-00011fb0: 203d 2072 6573 702e 6a73 6f6e 2829 5b22   = resp.json()["
-00011fc0: 6665 6174 7572 655f 7365 7473 225d 0a20  feature_sets"]. 
-00011fd0: 2020 2020 2020 2069 6620 6665 6174 7572         if featur
-00011fe0: 655f 7365 7473 3a0a 2020 2020 2020 2020  e_sets:.        
-00011ff0: 2020 2020 7265 7475 726e 205b 4665 6174      return [Feat
-00012000: 7572 6553 6574 2e66 726f 6d5f 6469 6374  ureSet.from_dict
-00012010: 286f 626a 2920 666f 7220 6f62 6a20 696e  (obj) for obj in
-00012020: 2066 6561 7475 7265 5f73 6574 735d 0a0a   feature_sets]..
-00012030: 2020 2020 6465 6620 7374 6f72 655f 6665      def store_fe
-00012040: 6174 7572 655f 7365 7428 0a20 2020 2020  ature_set(.     
-00012050: 2020 2073 656c 662c 0a20 2020 2020 2020     self,.       
-00012060: 2066 6561 7475 7265 5f73 6574 3a20 556e   feature_set: Un
-00012070: 696f 6e5b 6469 6374 2c20 7363 6865 6d61  ion[dict, schema
-00012080: 732e 4665 6174 7572 6553 6574 2c20 4665  s.FeatureSet, Fe
-00012090: 6174 7572 6553 6574 5d2c 0a20 2020 2020  atureSet],.     
-000120a0: 2020 206e 616d 653d 4e6f 6e65 2c0a 2020     name=None,.  
-000120b0: 2020 2020 2020 7072 6f6a 6563 743d 2222        project=""
-000120c0: 2c0a 2020 2020 2020 2020 7461 673d 4e6f  ,.        tag=No
-000120d0: 6e65 2c0a 2020 2020 2020 2020 7569 643d  ne,.        uid=
-000120e0: 4e6f 6e65 2c0a 2020 2020 2020 2020 7665  None,.        ve
-000120f0: 7273 696f 6e65 643d 5472 7565 2c0a 2020  rsioned=True,.  
-00012100: 2020 2920 2d3e 2064 6963 743a 0a20 2020    ) -> dict:.   
-00012110: 2020 2020 2022 2222 5361 7665 2061 203a       """Save a :
-00012120: 7079 3a63 6c61 7373 3a60 7e6d 6c72 756e  py:class:`~mlrun
-00012130: 2e66 6561 7475 7265 5f73 746f 7265 2e46  .feature_store.F
-00012140: 6561 7475 7265 5365 7460 206f 626a 6563  eatureSet` objec
-00012150: 7420 696e 2074 6865 203a 7079 3a6d 6f64  t in the :py:mod
-00012160: 3a60 6d6c 7275 6e60 2044 422e 2054 6865  :`mlrun` DB. The
-00012170: 0a20 2020 2020 2020 2066 6561 7475 7265  .        feature
-00012180: 2d73 6574 2063 616e 2062 6520 6569 7468  -set can be eith
-00012190: 6572 2061 206e 6577 206f 626a 6563 7420  er a new object 
-000121a0: 6f72 2061 206d 6f64 6966 6963 6174 696f  or a modificatio
-000121b0: 6e20 746f 2065 7869 7374 696e 6720 6f62  n to existing ob
-000121c0: 6a65 6374 2072 6566 6572 656e 6365 6420  ject referenced 
-000121d0: 6279 2074 6865 2070 6172 616d 7320 6f66  by the params of
-000121e0: 0a20 2020 2020 2020 2074 6865 2066 756e  .        the fun
-000121f0: 6374 696f 6e2e 0a0a 2020 2020 2020 2020  ction...        
-00012200: 3a70 6172 616d 2066 6561 7475 7265 5f73  :param feature_s
-00012210: 6574 3a20 5468 6520 3a70 793a 636c 6173  et: The :py:clas
-00012220: 733a 607e 6d6c 7275 6e2e 6665 6174 7572  s:`~mlrun.featur
-00012230: 655f 7374 6f72 652e 4665 6174 7572 6553  e_store.FeatureS
-00012240: 6574 6020 746f 2073 746f 7265 2e0a 2020  et` to store..  
-00012250: 2020 2020 2020 3a70 6172 616d 206e 616d        :param nam
-00012260: 653a 2020 2020 4e61 6d65 206f 6620 6665  e:    Name of fe
-00012270: 6174 7572 6520 7365 742e 0a20 2020 2020  ature set..     
-00012280: 2020 203a 7061 7261 6d20 7072 6f6a 6563     :param projec
-00012290: 743a 204e 616d 6520 6f66 2070 726f 6a65  t: Name of proje
-000122a0: 6374 2074 6869 7320 6665 6174 7572 652d  ct this feature-
-000122b0: 7365 7420 6265 6c6f 6e67 7320 746f 2e0a  set belongs to..
-000122c0: 2020 2020 2020 2020 3a70 6172 616d 2074          :param t
-000122d0: 6167 3a20 5468 6520 6060 7461 6760 6020  ag: The ``tag`` 
-000122e0: 6f66 2074 6865 206f 626a 6563 7420 746f  of the object to
-000122f0: 2072 6570 6c61 6365 2069 6e20 7468 6520   replace in the 
-00012300: 4442 2c20 666f 7220 6578 616d 706c 6520  DB, for example 
-00012310: 6060 6c61 7465 7374 6060 2e0a 2020 2020  ``latest``..    
-00012320: 2020 2020 3a70 6172 616d 2075 6964 3a20      :param uid: 
-00012330: 5468 6520 6060 7569 6460 6020 6f66 2074  The ``uid`` of t
-00012340: 6865 206f 626a 6563 7420 746f 2072 6570  he object to rep
-00012350: 6c61 6365 2069 6e20 7468 6520 4442 2e20  lace in the DB. 
-00012360: 4966 2075 7369 6e67 2074 6869 7320 7061  If using this pa
-00012370: 7261 6d65 7465 722c 2074 6865 206d 6f64  rameter, the mod
-00012380: 6966 6965 6420 6f62 6a65 6374 0a20 2020  ified object.   
-00012390: 2020 2020 2020 2020 206d 7573 7420 6861           must ha
-000123a0: 7665 2074 6865 2073 616d 6520 6060 7569  ve the same ``ui
-000123b0: 6460 6020 6f66 2074 6865 2070 7265 7669  d`` of the previ
-000123c0: 6f75 736c 792d 6578 6973 7469 6e67 206f  ously-existing o
-000123d0: 626a 6563 742e 2054 6869 7320 6361 6e6e  bject. This cann
-000123e0: 6f74 2062 6520 7573 6564 2066 6f72 206e  ot be used for n
-000123f0: 6f6e 2d76 6572 7369 6f6e 6564 206f 626a  on-versioned obj
-00012400: 6563 7473 2e0a 2020 2020 2020 2020 3a70  ects..        :p
-00012410: 6172 616d 2076 6572 7369 6f6e 6564 3a20  aram versioned: 
-00012420: 5768 6574 6865 7220 746f 206d 6169 6e74  Whether to maint
-00012430: 6169 6e20 7665 7273 696f 6e73 2066 6f72  ain versions for
-00012440: 2074 6869 7320 6665 6174 7572 652d 7365   this feature-se
-00012450: 742e 2041 6c6c 2076 6572 7369 6f6e 7320  t. All versions 
-00012460: 6f66 2061 2076 6572 7369 6f6e 6564 206f  of a versioned o
-00012470: 626a 6563 740a 2020 2020 2020 2020 2020  bject.          
-00012480: 2020 7769 6c6c 2062 6520 6b65 7074 2069    will be kept i
-00012490: 6e20 7468 6520 4442 2061 6e64 2063 616e  n the DB and can
-000124a0: 2062 6520 7265 7472 6965 7665 6420 756e   be retrieved un
-000124b0: 7469 6c20 6578 706c 6963 6974 6c79 2064  til explicitly d
-000124c0: 656c 6574 6564 2e0a 2020 2020 2020 2020  eleted..        
-000124d0: 3a72 6574 7572 6e73 3a20 5468 6520 3a70  :returns: The :p
-000124e0: 793a 636c 6173 733a 607e 6d6c 7275 6e2e  y:class:`~mlrun.
-000124f0: 6665 6174 7572 655f 7374 6f72 652e 4665  feature_store.Fe
-00012500: 6174 7572 6553 6574 6020 6f62 6a65 6374  atureSet` object
-00012510: 2028 6173 2064 6963 7429 2e0a 2020 2020   (as dict)..    
-00012520: 2020 2020 2222 220a 0a20 2020 2020 2020      """..       
-00012530: 2072 6566 6572 656e 6365 203d 2073 656c   reference = sel
-00012540: 662e 5f72 6573 6f6c 7665 5f72 6566 6572  f._resolve_refer
-00012550: 656e 6365 2874 6167 2c20 7569 6429 0a20  ence(tag, uid). 
-00012560: 2020 2020 2020 2070 6172 616d 7320 3d20         params = 
-00012570: 7b22 7665 7273 696f 6e65 6422 3a20 7665  {"versioned": ve
-00012580: 7273 696f 6e65 647d 0a0a 2020 2020 2020  rsioned}..      
-00012590: 2020 6966 2069 7369 6e73 7461 6e63 6528    if isinstance(
-000125a0: 6665 6174 7572 655f 7365 742c 2073 6368  feature_set, sch
-000125b0: 656d 6173 2e46 6561 7475 7265 5365 7429  emas.FeatureSet)
-000125c0: 3a0a 2020 2020 2020 2020 2020 2020 6665  :.            fe
-000125d0: 6174 7572 655f 7365 7420 3d20 6665 6174  ature_set = feat
-000125e0: 7572 655f 7365 742e 6469 6374 2829 0a20  ure_set.dict(). 
-000125f0: 2020 2020 2020 2065 6c69 6620 6973 696e         elif isin
-00012600: 7374 616e 6365 2866 6561 7475 7265 5f73  stance(feature_s
-00012610: 6574 2c20 4665 6174 7572 6553 6574 293a  et, FeatureSet):
-00012620: 0a20 2020 2020 2020 2020 2020 2066 6561  .            fea
-00012630: 7475 7265 5f73 6574 203d 2066 6561 7475  ture_set = featu
-00012640: 7265 5f73 6574 2e74 6f5f 6469 6374 2829  re_set.to_dict()
-00012650: 0a0a 2020 2020 2020 2020 6e61 6d65 203d  ..        name =
-00012660: 206e 616d 6520 6f72 2066 6561 7475 7265   name or feature
-00012670: 5f73 6574 5b22 6d65 7461 6461 7461 225d  _set["metadata"]
-00012680: 5b22 6e61 6d65 225d 0a20 2020 2020 2020  ["name"].       
-00012690: 2070 726f 6a65 6374 203d 2028 0a20 2020   project = (.   
-000126a0: 2020 2020 2020 2020 2070 726f 6a65 6374           project
-000126b0: 206f 7220 6665 6174 7572 655f 7365 745b   or feature_set[
-000126c0: 226d 6574 6164 6174 6122 5d2e 6765 7428  "metadata"].get(
-000126d0: 2270 726f 6a65 6374 2229 206f 7220 636f  "project") or co
-000126e0: 6e66 6967 2e64 6566 6175 6c74 5f70 726f  nfig.default_pro
-000126f0: 6a65 6374 0a20 2020 2020 2020 2029 0a20  ject.        ). 
-00012700: 2020 2020 2020 2070 6174 6820 3d20 6622         path = f"
-00012710: 7072 6f6a 6563 7473 2f7b 7072 6f6a 6563  projects/{projec
-00012720: 747d 2f66 6561 7475 7265 2d73 6574 732f  t}/feature-sets/
-00012730: 7b6e 616d 657d 2f72 6566 6572 656e 6365  {name}/reference
-00012740: 732f 7b72 6566 6572 656e 6365 7d22 0a20  s/{reference}". 
-00012750: 2020 2020 2020 2065 7272 6f72 5f6d 6573         error_mes
-00012760: 7361 6765 203d 2066 2246 6169 6c65 6420  sage = f"Failed 
-00012770: 7374 6f72 696e 6720 6665 6174 7572 652d  storing feature-
-00012780: 7365 7420 7b70 726f 6a65 6374 7d2f 7b6e  set {project}/{n
-00012790: 616d 657d 220a 2020 2020 2020 2020 7265  ame}".        re
-000127a0: 7370 203d 2073 656c 662e 6170 695f 6361  sp = self.api_ca
-000127b0: 6c6c 280a 2020 2020 2020 2020 2020 2020  ll(.            
-000127c0: 2250 5554 222c 2070 6174 682c 2065 7272  "PUT", path, err
-000127d0: 6f72 5f6d 6573 7361 6765 2c20 7061 7261  or_message, para
-000127e0: 6d73 3d70 6172 616d 732c 2062 6f64 793d  ms=params, body=
-000127f0: 6469 6374 5f74 6f5f 6a73 6f6e 2866 6561  dict_to_json(fea
-00012800: 7475 7265 5f73 6574 290a 2020 2020 2020  ture_set).      
-00012810: 2020 290a 2020 2020 2020 2020 7265 7475    ).        retu
-00012820: 726e 2072 6573 702e 6a73 6f6e 2829 0a0a  rn resp.json()..
-00012830: 2020 2020 6465 6620 7061 7463 685f 6665      def patch_fe
-00012840: 6174 7572 655f 7365 7428 0a20 2020 2020  ature_set(.     
-00012850: 2020 2073 656c 662c 0a20 2020 2020 2020     self,.       
-00012860: 206e 616d 652c 0a20 2020 2020 2020 2066   name,.        f
-00012870: 6561 7475 7265 5f73 6574 5f75 7064 6174  eature_set_updat
-00012880: 653a 2064 6963 742c 0a20 2020 2020 2020  e: dict,.       
-00012890: 2070 726f 6a65 6374 3d22 222c 0a20 2020   project="",.   
-000128a0: 2020 2020 2074 6167 3d4e 6f6e 652c 0a20       tag=None,. 
-000128b0: 2020 2020 2020 2075 6964 3d4e 6f6e 652c         uid=None,
-000128c0: 0a20 2020 2020 2020 2070 6174 6368 5f6d  .        patch_m
-000128d0: 6f64 653a 2055 6e69 6f6e 5b73 7472 2c20  ode: Union[str, 
-000128e0: 7363 6865 6d61 732e 5061 7463 684d 6f64  schemas.PatchMod
-000128f0: 655d 203d 2073 6368 656d 6173 2e50 6174  e] = schemas.Pat
-00012900: 6368 4d6f 6465 2e72 6570 6c61 6365 2c0a  chMode.replace,.
-00012910: 2020 2020 293a 0a20 2020 2020 2020 2022      ):.        "
-00012920: 2222 4d6f 6469 6679 2028 7061 7463 6829  ""Modify (patch)
-00012930: 2061 6e20 6578 6973 7469 6e67 203a 7079   an existing :py
-00012940: 3a63 6c61 7373 3a60 7e6d 6c72 756e 2e66  :class:`~mlrun.f
-00012950: 6561 7475 7265 5f73 746f 7265 2e46 6561  eature_store.Fea
-00012960: 7475 7265 5365 7460 206f 626a 6563 742e  tureSet` object.
-00012970: 0a20 2020 2020 2020 2054 6865 206f 626a  .        The obj
-00012980: 6563 7420 6973 2069 6465 6e74 6966 6965  ect is identifie
-00012990: 6420 6279 2069 7473 206e 616d 6520 2861  d by its name (a
-000129a0: 6e64 2070 726f 6a65 6374 2069 7420 6265  nd project it be
-000129b0: 6c6f 6e67 7320 746f 292c 2061 7320 7765  longs to), as we
-000129c0: 6c6c 2061 7320 6f70 7469 6f6e 616c 6c79  ll as optionally
-000129d0: 2061 2060 6074 6167 6060 206f 7220 6974   a ``tag`` or it
-000129e0: 730a 2020 2020 2020 2020 6060 7569 6460  s.        ``uid`
-000129f0: 6020 2866 6f72 2076 6572 7369 6f6e 6564  ` (for versioned
-00012a00: 206f 626a 6563 7429 2e20 4966 2062 6f74   object). If bot
-00012a10: 6820 6060 7461 6760 6020 616e 6420 6060  h ``tag`` and ``
-00012a20: 7569 6460 6020 6172 6520 6f6d 6974 7465  uid`` are omitte
-00012a30: 6420 7468 656e 2074 6865 206f 626a 6563  d then the objec
-00012a40: 7420 7769 7468 2074 6167 2060 606c 6174  t with tag ``lat
-00012a50: 6573 7460 600a 2020 2020 2020 2020 6973  est``.        is
-00012a60: 206d 6f64 6966 6965 642e 0a0a 2020 2020   modified...    
-00012a70: 2020 2020 3a70 6172 616d 206e 616d 653a      :param name:
-00012a80: 204e 616d 6520 6f66 2074 6865 206f 626a   Name of the obj
-00012a90: 6563 7420 746f 2070 6174 6368 2e0a 2020  ect to patch..  
-00012aa0: 2020 2020 2020 3a70 6172 616d 2066 6561        :param fea
-00012ab0: 7475 7265 5f73 6574 5f75 7064 6174 653a  ture_set_update:
-00012ac0: 2054 6865 206d 6f64 6966 6963 6174 696f   The modificatio
-00012ad0: 6e73 206e 6565 6465 6420 696e 2074 6865  ns needed in the
-00012ae0: 206f 626a 6563 742e 2054 6869 7320 7061   object. This pa
-00012af0: 7261 6d65 7465 7220 6f6e 6c79 2068 6173  rameter only has
-00012b00: 2074 6865 2063 6861 6e67 6573 2069 6e20   the changes in 
-00012b10: 6974 2c0a 2020 2020 2020 2020 2020 2020  it,.            
-00012b20: 6e6f 7420 6120 6675 6c6c 206f 626a 6563  not a full objec
-00012b30: 742e 0a20 2020 2020 2020 2020 2020 2045  t..            E
-00012b40: 7861 6d70 6c65 3a3a 0a0a 2020 2020 2020  xample::..      
-00012b50: 2020 2020 2020 2020 2020 6665 6174 7572            featur
-00012b60: 655f 7365 745f 7570 6461 7465 203d 207b  e_set_update = {
-00012b70: 2273 7461 7475 7322 3a20 7b22 7072 6f63  "status": {"proc
-00012b80: 6573 7365 6422 203a 2054 7275 657d 7d0a  essed" : True}}.
-00012b90: 0a20 2020 2020 2020 2020 2020 2057 696c  .            Wil
-00012ba0: 6c20 6170 706c 7920 7468 6520 6669 656c  l apply the fiel
-00012bb0: 6420 6060 7374 6174 7573 2e70 726f 6365  d ``status.proce
-00012bc0: 7373 6564 6060 2074 6f20 7468 6520 6578  ssed`` to the ex
-00012bd0: 6973 7469 6e67 206f 626a 6563 742e 0a20  isting object.. 
-00012be0: 2020 2020 2020 203a 7061 7261 6d20 7072         :param pr
-00012bf0: 6f6a 6563 743a 2050 726f 6a65 6374 2077  oject: Project w
-00012c00: 6869 6368 2063 6f6e 7461 696e 7320 7468  hich contains th
-00012c10: 6520 6d6f 6469 6669 6564 206f 626a 6563  e modified objec
-00012c20: 742e 0a20 2020 2020 2020 203a 7061 7261  t..        :para
-00012c30: 6d20 7461 673a 2054 6865 2074 6167 206f  m tag: The tag o
-00012c40: 6620 7468 6520 6f62 6a65 6374 2074 6f20  f the object to 
-00012c50: 6d6f 6469 6679 2e0a 2020 2020 2020 2020  modify..        
-00012c60: 3a70 6172 616d 2075 6964 3a20 7569 6420  :param uid: uid 
-00012c70: 6f66 2074 6865 206f 626a 6563 7420 746f  of the object to
-00012c80: 206d 6f64 6966 792e 0a20 2020 2020 2020   modify..       
-00012c90: 203a 7061 7261 6d20 7061 7463 685f 6d6f   :param patch_mo
-00012ca0: 6465 3a20 5468 6520 7374 7261 7465 6779  de: The strategy
-00012cb0: 2066 6f72 206d 6572 6769 6e67 2074 6865   for merging the
-00012cc0: 2063 6861 6e67 6573 2077 6974 6820 7468   changes with th
-00012cd0: 6520 6578 6973 7469 6e67 206f 626a 6563  e existing objec
-00012ce0: 742e 2043 616e 2062 6520 6569 7468 6572  t. Can be either
-00012cf0: 2060 6072 6570 6c61 6365 6060 0a20 2020   ``replace``.   
-00012d00: 2020 2020 2020 2020 206f 7220 6060 6164           or ``ad
-00012d10: 6469 7469 7665 6060 2e0a 2020 2020 2020  ditive``..      
-00012d20: 2020 2222 220a 2020 2020 2020 2020 7072    """.        pr
-00012d30: 6f6a 6563 7420 3d20 7072 6f6a 6563 7420  oject = project 
-00012d40: 6f72 2063 6f6e 6669 672e 6465 6661 756c  or config.defaul
-00012d50: 745f 7072 6f6a 6563 740a 2020 2020 2020  t_project.      
-00012d60: 2020 7265 6665 7265 6e63 6520 3d20 7365    reference = se
-00012d70: 6c66 2e5f 7265 736f 6c76 655f 7265 6665  lf._resolve_refe
-00012d80: 7265 6e63 6528 7461 672c 2075 6964 290a  rence(tag, uid).
-00012d90: 2020 2020 2020 2020 6865 6164 6572 7320          headers 
-00012da0: 3d20 7b73 6368 656d 6173 2e48 6561 6465  = {schemas.Heade
-00012db0: 724e 616d 6573 2e70 6174 6368 5f6d 6f64  rNames.patch_mod
-00012dc0: 653a 2070 6174 6368 5f6d 6f64 657d 0a20  e: patch_mode}. 
-00012dd0: 2020 2020 2020 2070 6174 6820 3d20 6622         path = f"
-00012de0: 7072 6f6a 6563 7473 2f7b 7072 6f6a 6563  projects/{projec
-00012df0: 747d 2f66 6561 7475 7265 2d73 6574 732f  t}/feature-sets/
-00012e00: 7b6e 616d 657d 2f72 6566 6572 656e 6365  {name}/reference
-00012e10: 732f 7b72 6566 6572 656e 6365 7d22 0a20  s/{reference}". 
-00012e20: 2020 2020 2020 2065 7272 6f72 5f6d 6573         error_mes
-00012e30: 7361 6765 203d 2066 2246 6169 6c65 6420  sage = f"Failed 
-00012e40: 7570 6461 7469 6e67 2066 6561 7475 7265  updating feature
-00012e50: 2d73 6574 207b 7072 6f6a 6563 747d 2f7b  -set {project}/{
-00012e60: 6e61 6d65 7d22 0a20 2020 2020 2020 2073  name}".        s
-00012e70: 656c 662e 6170 695f 6361 6c6c 280a 2020  elf.api_call(.  
-00012e80: 2020 2020 2020 2020 2020 2250 4154 4348            "PATCH
-00012e90: 222c 0a20 2020 2020 2020 2020 2020 2070  ",.            p
-00012ea0: 6174 682c 0a20 2020 2020 2020 2020 2020  ath,.           
-00012eb0: 2065 7272 6f72 5f6d 6573 7361 6765 2c0a   error_message,.
-00012ec0: 2020 2020 2020 2020 2020 2020 626f 6479              body
-00012ed0: 3d64 6963 745f 746f 5f6a 736f 6e28 6665  =dict_to_json(fe
-00012ee0: 6174 7572 655f 7365 745f 7570 6461 7465  ature_set_update
-00012ef0: 292c 0a20 2020 2020 2020 2020 2020 2068  ),.            h
-00012f00: 6561 6465 7273 3d68 6561 6465 7273 2c0a  eaders=headers,.
-00012f10: 2020 2020 2020 2020 290a 0a20 2020 2064          )..    d
-00012f20: 6566 2064 656c 6574 655f 6665 6174 7572  ef delete_featur
-00012f30: 655f 7365 7428 7365 6c66 2c20 6e61 6d65  e_set(self, name
-00012f40: 2c20 7072 6f6a 6563 743d 2222 2c20 7461  , project="", ta
-00012f50: 673d 4e6f 6e65 2c20 7569 643d 4e6f 6e65  g=None, uid=None
-00012f60: 293a 0a20 2020 2020 2020 2022 2222 4465  ):.        """De
-00012f70: 6c65 7465 2061 203a 7079 3a63 6c61 7373  lete a :py:class
-00012f80: 3a60 7e6d 6c72 756e 2e66 6561 7475 7265  :`~mlrun.feature
-00012f90: 5f73 746f 7265 2e46 6561 7475 7265 5365  _store.FeatureSe
-00012fa0: 7460 206f 626a 6563 7420 6672 6f6d 2074  t` object from t
-00012fb0: 6865 2044 422e 0a20 2020 2020 2020 2049  he DB..        I
-00012fc0: 6620 6060 7461 6760 6020 6f72 2060 6075  f ``tag`` or ``u
-00012fd0: 6964 6060 2061 7265 2073 7065 6369 6669  id`` are specifi
-00012fe0: 6564 2c20 7468 656e 206a 7573 7420 7468  ed, then just th
-00012ff0: 6520 7665 7273 696f 6e20 7265 6665 7265  e version refere
-00013000: 6e63 6564 2062 7920 7468 656d 2077 696c  nced by them wil
-00013010: 6c20 6265 2064 656c 6574 6564 2e20 5573  l be deleted. Us
-00013020: 696e 6720 626f 7468 0a20 2020 2020 2020  ing both.       
-00013030: 2069 7320 6e6f 7420 616c 6c6f 7765 642e   is not allowed.
-00013040: 0a20 2020 2020 2020 2049 6620 6e6f 6e65  .        If none
-00013050: 2061 7265 2073 7065 6369 6669 6564 2c20   are specified, 
-00013060: 7468 656e 2061 6c6c 2069 6e73 7461 6e63  then all instanc
-00013070: 6573 206f 6620 7468 6520 6f62 6a65 6374  es of the object
-00013080: 2077 686f 7365 206e 616d 6520 6973 2060   whose name is `
-00013090: 606e 616d 6560 6020 7769 6c6c 2062 6520  `name`` will be 
-000130a0: 6465 6c65 7465 642e 0a20 2020 2020 2020  deleted..       
-000130b0: 2022 2222 0a20 2020 2020 2020 2070 726f   """.        pro
-000130c0: 6a65 6374 203d 2070 726f 6a65 6374 206f  ject = project o
-000130d0: 7220 636f 6e66 6967 2e64 6566 6175 6c74  r config.default
-000130e0: 5f70 726f 6a65 6374 0a20 2020 2020 2020  _project.       
-000130f0: 2070 6174 6820 3d20 6622 7072 6f6a 6563   path = f"projec
-00013100: 7473 2f7b 7072 6f6a 6563 747d 2f66 6561  ts/{project}/fea
-00013110: 7475 7265 2d73 6574 732f 7b6e 616d 657d  ture-sets/{name}
-00013120: 220a 0a20 2020 2020 2020 2069 6620 7461  "..        if ta
-00013130: 6720 6f72 2075 6964 3a0a 2020 2020 2020  g or uid:.      
-00013140: 2020 2020 2020 7265 6665 7265 6e63 6520        reference 
-00013150: 3d20 7365 6c66 2e5f 7265 736f 6c76 655f  = self._resolve_
-00013160: 7265 6665 7265 6e63 6528 7461 672c 2075  reference(tag, u
-00013170: 6964 290a 2020 2020 2020 2020 2020 2020  id).            
-00013180: 7061 7468 203d 2070 6174 6820 2b20 6622  path = path + f"
-00013190: 2f72 6566 6572 656e 6365 732f 7b72 6566  /references/{ref
-000131a0: 6572 656e 6365 7d22 0a0a 2020 2020 2020  erence}"..      
-000131b0: 2020 6572 726f 725f 6d65 7373 6167 6520    error_message 
-000131c0: 3d20 6622 4661 696c 6564 2064 656c 6574  = f"Failed delet
-000131d0: 696e 6720 6665 6174 7572 652d 7365 7420  ing feature-set 
-000131e0: 7b6e 616d 657d 220a 2020 2020 2020 2020  {name}".        
-000131f0: 7365 6c66 2e61 7069 5f63 616c 6c28 2244  self.api_call("D
-00013200: 454c 4554 4522 2c20 7061 7468 2c20 6572  ELETE", path, er
-00013210: 726f 725f 6d65 7373 6167 6529 0a0a 2020  ror_message)..  
-00013220: 2020 6465 6620 6372 6561 7465 5f66 6561    def create_fea
-00013230: 7475 7265 5f76 6563 746f 7228 0a20 2020  ture_vector(.   
-00013240: 2020 2020 2073 656c 662c 0a20 2020 2020       self,.     
-00013250: 2020 2066 6561 7475 7265 5f76 6563 746f     feature_vecto
-00013260: 723a 2055 6e69 6f6e 5b64 6963 742c 2073  r: Union[dict, s
-00013270: 6368 656d 6173 2e46 6561 7475 7265 5665  chemas.FeatureVe
-00013280: 6374 6f72 2c20 4665 6174 7572 6556 6563  ctor, FeatureVec
-00013290: 746f 725d 2c0a 2020 2020 2020 2020 7072  tor],.        pr
-000132a0: 6f6a 6563 743d 2222 2c0a 2020 2020 2020  oject="",.      
-000132b0: 2020 7665 7273 696f 6e65 643d 5472 7565    versioned=True
-000132c0: 2c0a 2020 2020 2920 2d3e 2064 6963 743a  ,.    ) -> dict:
-000132d0: 0a20 2020 2020 2020 2022 2222 4372 6561  .        """Crea
-000132e0: 7465 2061 206e 6577 203a 7079 3a63 6c61  te a new :py:cla
-000132f0: 7373 3a60 7e6d 6c72 756e 2e66 6561 7475  ss:`~mlrun.featu
-00013300: 7265 5f73 746f 7265 2e46 6561 7475 7265  re_store.Feature
-00013310: 5665 6374 6f72 6020 616e 6420 7361 7665  Vector` and save
-00013320: 2069 6e20 7468 6520 3a70 793a 6d6f 643a   in the :py:mod:
-00013330: 606d 6c72 756e 6020 4442 2e0a 0a20 2020  `mlrun` DB...   
-00013340: 2020 2020 203a 7061 7261 6d20 6665 6174       :param feat
-00013350: 7572 655f 7665 6374 6f72 3a20 5468 6520  ure_vector: The 
-00013360: 6e65 7720 3a70 793a 636c 6173 733a 607e  new :py:class:`~
-00013370: 6d6c 7275 6e2e 6665 6174 7572 655f 7374  mlrun.feature_st
-00013380: 6f72 652e 4665 6174 7572 6556 6563 746f  ore.FeatureVecto
-00013390: 7260 2074 6f20 6372 6561 7465 2e0a 2020  r` to create..  
-000133a0: 2020 2020 2020 3a70 6172 616d 2070 726f        :param pro
-000133b0: 6a65 6374 3a20 4e61 6d65 206f 6620 7072  ject: Name of pr
-000133c0: 6f6a 6563 7420 7468 6973 2066 6561 7475  oject this featu
-000133d0: 7265 2d76 6563 746f 7220 6265 6c6f 6e67  re-vector belong
-000133e0: 7320 746f 2e0a 2020 2020 2020 2020 3a70  s to..        :p
-000133f0: 6172 616d 2076 6572 7369 6f6e 6564 3a20  aram versioned: 
-00013400: 5768 6574 6865 7220 746f 206d 6169 6e74  Whether to maint
-00013410: 6169 6e20 7665 7273 696f 6e73 2066 6f72  ain versions for
-00013420: 2074 6869 7320 6665 6174 7572 652d 7665   this feature-ve
-00013430: 6374 6f72 2e20 416c 6c20 7665 7273 696f  ctor. All versio
-00013440: 6e73 206f 6620 6120 7665 7273 696f 6e65  ns of a versione
-00013450: 6420 6f62 6a65 6374 0a20 2020 2020 2020  d object.       
-00013460: 2020 2020 2077 696c 6c20 6265 206b 6570       will be kep
-00013470: 7420 696e 2074 6865 2044 4220 616e 6420  t in the DB and 
-00013480: 6361 6e20 6265 2072 6574 7269 6576 6564  can be retrieved
-00013490: 2075 6e74 696c 2065 7870 6c69 6369 746c   until explicitl
-000134a0: 7920 6465 6c65 7465 642e 0a20 2020 2020  y deleted..     
-000134b0: 2020 203a 7265 7475 726e 733a 2054 6865     :returns: The
-000134c0: 203a 7079 3a63 6c61 7373 3a60 7e6d 6c72   :py:class:`~mlr
-000134d0: 756e 2e66 6561 7475 7265 5f73 746f 7265  un.feature_store
-000134e0: 2e46 6561 7475 7265 5665 6374 6f72 6020  .FeatureVector` 
-000134f0: 6f62 6a65 6374 2028 6173 2064 6963 7429  object (as dict)
-00013500: 2e0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
-00013510: 2020 2020 2020 6966 2069 7369 6e73 7461        if isinsta
-00013520: 6e63 6528 6665 6174 7572 655f 7665 6374  nce(feature_vect
-00013530: 6f72 2c20 7363 6865 6d61 732e 4665 6174  or, schemas.Feat
-00013540: 7572 6556 6563 746f 7229 3a0a 2020 2020  ureVector):.    
-00013550: 2020 2020 2020 2020 6665 6174 7572 655f          feature_
-00013560: 7665 6374 6f72 203d 2066 6561 7475 7265  vector = feature
-00013570: 5f76 6563 746f 722e 6469 6374 2829 0a20  _vector.dict(). 
-00013580: 2020 2020 2020 2065 6c69 6620 6973 696e         elif isin
-00013590: 7374 616e 6365 2866 6561 7475 7265 5f76  stance(feature_v
-000135a0: 6563 746f 722c 2046 6561 7475 7265 5665  ector, FeatureVe
-000135b0: 6374 6f72 293a 0a20 2020 2020 2020 2020  ctor):.         
-000135c0: 2020 2066 6561 7475 7265 5f76 6563 746f     feature_vecto
-000135d0: 7220 3d20 6665 6174 7572 655f 7665 6374  r = feature_vect
-000135e0: 6f72 2e74 6f5f 6469 6374 2829 0a0a 2020  or.to_dict()..  
-000135f0: 2020 2020 2020 7072 6f6a 6563 7420 3d20        project = 
-00013600: 280a 2020 2020 2020 2020 2020 2020 7072  (.            pr
-00013610: 6f6a 6563 740a 2020 2020 2020 2020 2020  oject.          
-00013620: 2020 6f72 2066 6561 7475 7265 5f76 6563    or feature_vec
-00013630: 746f 725b 226d 6574 6164 6174 6122 5d2e  tor["metadata"].
-00013640: 6765 7428 2270 726f 6a65 6374 222c 204e  get("project", N
-00013650: 6f6e 6529 0a20 2020 2020 2020 2020 2020  one).           
-00013660: 206f 7220 636f 6e66 6967 2e64 6566 6175   or config.defau
-00013670: 6c74 5f70 726f 6a65 6374 0a20 2020 2020  lt_project.     
-00013680: 2020 2029 0a20 2020 2020 2020 2070 6174     ).        pat
-00013690: 6820 3d20 6622 7072 6f6a 6563 7473 2f7b  h = f"projects/{
-000136a0: 7072 6f6a 6563 747d 2f66 6561 7475 7265  project}/feature
-000136b0: 2d76 6563 746f 7273 220a 2020 2020 2020  -vectors".      
-000136c0: 2020 7061 7261 6d73 203d 207b 2276 6572    params = {"ver
-000136d0: 7369 6f6e 6564 223a 2076 6572 7369 6f6e  sioned": version
-000136e0: 6564 7d0a 0a20 2020 2020 2020 206e 616d  ed}..        nam
-000136f0: 6520 3d20 6665 6174 7572 655f 7665 6374  e = feature_vect
-00013700: 6f72 5b22 6d65 7461 6461 7461 225d 5b22  or["metadata"]["
-00013710: 6e61 6d65 225d 0a20 2020 2020 2020 2065  name"].        e
-00013720: 7272 6f72 5f6d 6573 7361 6765 203d 2066  rror_message = f
-00013730: 2246 6169 6c65 6420 6372 6561 7469 6e67  "Failed creating
-00013740: 2066 6561 7475 7265 2d76 6563 746f 7220   feature-vector 
-00013750: 7b70 726f 6a65 6374 7d2f 7b6e 616d 657d  {project}/{name}
-00013760: 220a 2020 2020 2020 2020 7265 7370 203d  ".        resp =
-00013770: 2073 656c 662e 6170 695f 6361 6c6c 280a   self.api_call(.
-00013780: 2020 2020 2020 2020 2020 2020 2250 4f53              "POS
-00013790: 5422 2c0a 2020 2020 2020 2020 2020 2020  T",.            
-000137a0: 7061 7468 2c0a 2020 2020 2020 2020 2020  path,.          
-000137b0: 2020 6572 726f 725f 6d65 7373 6167 652c    error_message,
-000137c0: 0a20 2020 2020 2020 2020 2020 2070 6172  .            par
-000137d0: 616d 733d 7061 7261 6d73 2c0a 2020 2020  ams=params,.    
-000137e0: 2020 2020 2020 2020 626f 6479 3d64 6963          body=dic
-000137f0: 745f 746f 5f6a 736f 6e28 6665 6174 7572  t_to_json(featur
-00013800: 655f 7665 6374 6f72 292c 0a20 2020 2020  e_vector),.     
-00013810: 2020 2029 0a20 2020 2020 2020 2072 6574     ).        ret
-00013820: 7572 6e20 7265 7370 2e6a 736f 6e28 290a  urn resp.json().
-00013830: 0a20 2020 2064 6566 2067 6574 5f66 6561  .    def get_fea
-00013840: 7475 7265 5f76 6563 746f 7228 0a20 2020  ture_vector(.   
-00013850: 2020 2020 2073 656c 662c 206e 616d 653a       self, name:
-00013860: 2073 7472 2c20 7072 6f6a 6563 743a 2073   str, project: s
-00013870: 7472 203d 2022 222c 2074 6167 3a20 7374  tr = "", tag: st
-00013880: 7220 3d20 4e6f 6e65 2c20 7569 643a 2073  r = None, uid: s
-00013890: 7472 203d 204e 6f6e 650a 2020 2020 2920  tr = None.    ) 
-000138a0: 2d3e 2046 6561 7475 7265 5665 6374 6f72  -> FeatureVector
-000138b0: 3a0a 2020 2020 2020 2020 2222 2252 6574  :.        """Ret
-000138c0: 7572 6e20 6120 7370 6563 6966 6963 2066  urn a specific f
-000138d0: 6561 7475 7265 2d76 6563 746f 7220 7265  eature-vector re
-000138e0: 6665 7265 6e63 6564 2062 7920 6974 7320  ferenced by its 
-000138f0: 7461 6720 6f72 2075 6964 2e20 4966 206e  tag or uid. If n
-00013900: 6f6e 6520 6172 6520 7072 6f76 6964 6564  one are provided
-00013910: 2c20 6060 6c61 7465 7374 6060 2074 6167  , ``latest`` tag
-00013920: 2077 696c 6c0a 2020 2020 2020 2020 6265   will.        be
-00013930: 2075 7365 642e 2222 220a 0a20 2020 2020   used."""..     
-00013940: 2020 2070 726f 6a65 6374 203d 2070 726f     project = pro
-00013950: 6a65 6374 206f 7220 636f 6e66 6967 2e64  ject or config.d
-00013960: 6566 6175 6c74 5f70 726f 6a65 6374 0a20  efault_project. 
-00013970: 2020 2020 2020 2072 6566 6572 656e 6365         reference
-00013980: 203d 2073 656c 662e 5f72 6573 6f6c 7665   = self._resolve
-00013990: 5f72 6566 6572 656e 6365 2874 6167 2c20  _reference(tag, 
-000139a0: 7569 6429 0a20 2020 2020 2020 2070 6174  uid).        pat
-000139b0: 6820 3d20 6622 7072 6f6a 6563 7473 2f7b  h = f"projects/{
-000139c0: 7072 6f6a 6563 747d 2f66 6561 7475 7265  project}/feature
-000139d0: 2d76 6563 746f 7273 2f7b 6e61 6d65 7d2f  -vectors/{name}/
-000139e0: 7265 6665 7265 6e63 6573 2f7b 7265 6665  references/{refe
-000139f0: 7265 6e63 657d 220a 2020 2020 2020 2020  rence}".        
-00013a00: 6572 726f 725f 6d65 7373 6167 6520 3d20  error_message = 
-00013a10: 6622 4661 696c 6564 2072 6574 7269 6576  f"Failed retriev
-00013a20: 696e 6720 6665 6174 7572 652d 7665 6374  ing feature-vect
-00013a30: 6f72 207b 7072 6f6a 6563 747d 2f7b 6e61  or {project}/{na
-00013a40: 6d65 7d22 0a20 2020 2020 2020 2072 6573  me}".        res
-00013a50: 7020 3d20 7365 6c66 2e61 7069 5f63 616c  p = self.api_cal
-00013a60: 6c28 2247 4554 222c 2070 6174 682c 2065  l("GET", path, e
-00013a70: 7272 6f72 5f6d 6573 7361 6765 290a 2020  rror_message).  
-00013a80: 2020 2020 2020 7265 7475 726e 2046 6561        return Fea
-00013a90: 7475 7265 5665 6374 6f72 2e66 726f 6d5f  tureVector.from_
-00013aa0: 6469 6374 2872 6573 702e 6a73 6f6e 2829  dict(resp.json()
-00013ab0: 290a 0a20 2020 2064 6566 206c 6973 745f  )..    def list_
-00013ac0: 6665 6174 7572 655f 7665 6374 6f72 7328  feature_vectors(
-00013ad0: 0a20 2020 2020 2020 2073 656c 662c 0a20  .        self,. 
-00013ae0: 2020 2020 2020 2070 726f 6a65 6374 3a20         project: 
-00013af0: 7374 7220 3d20 2222 2c0a 2020 2020 2020  str = "",.      
-00013b00: 2020 6e61 6d65 3a20 7374 7220 3d20 4e6f    name: str = No
-00013b10: 6e65 2c0a 2020 2020 2020 2020 7461 673a  ne,.        tag:
-00013b20: 2073 7472 203d 204e 6f6e 652c 0a20 2020   str = None,.   
-00013b30: 2020 2020 2073 7461 7465 3a20 7374 7220       state: str 
-00013b40: 3d20 4e6f 6e65 2c0a 2020 2020 2020 2020  = None,.        
-00013b50: 6c61 6265 6c73 3a20 4c69 7374 5b73 7472  labels: List[str
-00013b60: 5d20 3d20 4e6f 6e65 2c0a 2020 2020 2020  ] = None,.      
-00013b70: 2020 7061 7274 6974 696f 6e5f 6279 3a20    partition_by: 
-00013b80: 556e 696f 6e5b 7363 6865 6d61 732e 4665  Union[schemas.Fe
-00013b90: 6174 7572 6553 746f 7265 5061 7274 6974  atureStorePartit
-00013ba0: 696f 6e42 7946 6965 6c64 2c20 7374 725d  ionByField, str]
-00013bb0: 203d 204e 6f6e 652c 0a20 2020 2020 2020   = None,.       
-00013bc0: 2072 6f77 735f 7065 725f 7061 7274 6974   rows_per_partit
-00013bd0: 696f 6e3a 2069 6e74 203d 2031 2c0a 2020  ion: int = 1,.  
-00013be0: 2020 2020 2020 7061 7274 6974 696f 6e5f        partition_
-00013bf0: 736f 7274 5f62 793a 2055 6e69 6f6e 5b73  sort_by: Union[s
-00013c00: 6368 656d 6173 2e53 6f72 7446 6965 6c64  chemas.SortField
-00013c10: 2c20 7374 725d 203d 204e 6f6e 652c 0a20  , str] = None,. 
-00013c20: 2020 2020 2020 2070 6172 7469 7469 6f6e         partition
-00013c30: 5f6f 7264 6572 3a20 556e 696f 6e5b 7363  _order: Union[sc
-00013c40: 6865 6d61 732e 4f72 6465 7254 7970 652c  hemas.OrderType,
-00013c50: 2073 7472 5d20 3d20 7363 6865 6d61 732e   str] = schemas.
-00013c60: 4f72 6465 7254 7970 652e 6465 7363 2c0a  OrderType.desc,.
-00013c70: 2020 2020 2920 2d3e 204c 6973 745b 4665      ) -> List[Fe
-00013c80: 6174 7572 6556 6563 746f 725d 3a0a 2020  atureVector]:.  
-00013c90: 2020 2020 2020 2222 2252 6574 7269 6576        """Retriev
-00013ca0: 6520 6120 6c69 7374 206f 6620 6665 6174  e a list of feat
-00013cb0: 7572 652d 7665 6374 6f72 7320 6d61 7463  ure-vectors matc
-00013cc0: 6869 6e67 2074 6865 2063 7269 7465 7269  hing the criteri
-00013cd0: 6120 7072 6f76 6964 6564 2e0a 0a20 2020  a provided...   
-00013ce0: 2020 2020 203a 7061 7261 6d20 7072 6f6a       :param proj
-00013cf0: 6563 743a 2050 726f 6a65 6374 206e 616d  ect: Project nam
-00013d00: 652e 0a20 2020 2020 2020 203a 7061 7261  e..        :para
-00013d10: 6d20 6e61 6d65 3a20 4e61 6d65 206f 6620  m name: Name of 
-00013d20: 6665 6174 7572 652d 7665 6374 6f72 2074  feature-vector t
-00013d30: 6f20 6d61 7463 682e 2054 6869 7320 6973  o match. This is
-00013d40: 2061 206c 696b 6520 7175 6572 792c 2061   a like query, a
-00013d50: 6e64 2069 7320 6361 7365 2d69 6e73 656e  nd is case-insen
-00013d60: 7369 7469 7665 2e0a 2020 2020 2020 2020  sitive..        
-00013d70: 3a70 6172 616d 2074 6167 3a20 4d61 7463  :param tag: Matc
-00013d80: 6820 6665 6174 7572 652d 7665 6374 6f72  h feature-vector
-00013d90: 7320 7769 7468 2073 7065 6369 6669 6320  s with specific 
-00013da0: 7461 672e 0a20 2020 2020 2020 203a 7061  tag..        :pa
-00013db0: 7261 6d20 7374 6174 653a 204d 6174 6368  ram state: Match
-00013dc0: 2066 6561 7475 7265 2d76 6563 746f 7273   feature-vectors
-00013dd0: 2077 6974 6820 6120 7370 6563 6966 6963   with a specific
-00013de0: 2073 7461 7465 2e0a 2020 2020 2020 2020   state..        
-00013df0: 3a70 6172 616d 206c 6162 656c 733a 204d  :param labels: M
-00013e00: 6174 6368 2066 6561 7475 7265 2d76 6563  atch feature-vec
-00013e10: 746f 7273 2077 6869 6368 2068 6176 6520  tors which have 
-00013e20: 7468 6573 6520 6c61 6265 6c73 2e0a 2020  these labels..  
-00013e30: 2020 2020 2020 3a70 6172 616d 2070 6172        :param par
-00013e40: 7469 7469 6f6e 5f62 793a 2046 6965 6c64  tition_by: Field
-00013e50: 2074 6f20 6772 6f75 7020 7265 7375 6c74   to group result
-00013e60: 7320 6279 2e20 4f6e 6c79 2061 6c6c 6f77  s by. Only allow
-00013e70: 6564 2076 616c 7565 2069 7320 606e 616d  ed value is `nam
-00013e80: 6560 2e20 5768 656e 2060 7061 7274 6974  e`. When `partit
-00013e90: 696f 6e5f 6279 6020 6973 2073 7065 6369  ion_by` is speci
-00013ea0: 6669 6564 2c0a 2020 2020 2020 2020 2020  fied,.          
-00013eb0: 2020 7468 6520 6070 6172 7469 7469 6f6e    the `partition
-00013ec0: 5f73 6f72 745f 6279 6020 7061 7261 6d65  _sort_by` parame
-00013ed0: 7465 7220 6d75 7374 2062 6520 7072 6f76  ter must be prov
-00013ee0: 6964 6564 2061 7320 7765 6c6c 2e0a 2020  ided as well..  
-00013ef0: 2020 2020 2020 3a70 6172 616d 2072 6f77        :param row
-00013f00: 735f 7065 725f 7061 7274 6974 696f 6e3a  s_per_partition:
-00013f10: 2048 6f77 206d 616e 7920 746f 7020 726f   How many top ro
-00013f20: 7773 2028 7065 7220 736f 7274 696e 6720  ws (per sorting 
-00013f30: 6465 6669 6e65 6420 6279 2060 7061 7274  defined by `part
-00013f40: 6974 696f 6e5f 736f 7274 5f62 7960 2061  ition_sort_by` a
-00013f50: 6e64 2060 7061 7274 6974 696f 6e5f 6f72  nd `partition_or
-00013f60: 6465 7260 290a 2020 2020 2020 2020 2020  der`).          
-00013f70: 2020 746f 2072 6574 7572 6e20 7065 7220    to return per 
-00013f80: 6772 6f75 702e 2044 6566 6175 6c74 2076  group. Default v
-00013f90: 616c 7565 2069 7320 312e 0a20 2020 2020  alue is 1..     
-00013fa0: 2020 203a 7061 7261 6d20 7061 7274 6974     :param partit
-00013fb0: 696f 6e5f 736f 7274 5f62 793a 2057 6861  ion_sort_by: Wha
-00013fc0: 7420 6669 656c 6420 746f 2073 6f72 7420  t field to sort 
-00013fd0: 7468 6520 7265 7375 6c74 7320 6279 2c20  the results by, 
-00013fe0: 7769 7468 696e 2065 6163 6820 7061 7274  within each part
-00013ff0: 6974 696f 6e20 6465 6669 6e65 6420 6279  ition defined by
-00014000: 2060 7061 7274 6974 696f 6e5f 6279 602e   `partition_by`.
-00014010: 0a20 2020 2020 2020 2020 2020 2043 7572  .            Cur
-00014020: 7265 6e74 6c79 2074 6865 206f 6e6c 7920  rently the only 
-00014030: 616c 6c6f 7765 6420 7661 6c75 6573 2061  allowed values a
-00014040: 7265 2060 6372 6561 7465 6460 2061 6e64  re `created` and
-00014050: 2060 7570 6461 7465 6460 2e0a 2020 2020   `updated`..    
-00014060: 2020 2020 3a70 6172 616d 2070 6172 7469      :param parti
-00014070: 7469 6f6e 5f6f 7264 6572 3a20 4f72 6465  tion_order: Orde
-00014080: 7220 6f66 2073 6f72 7469 6e67 2077 6974  r of sorting wit
-00014090: 6869 6e20 7061 7274 6974 696f 6e73 202d  hin partitions -
-000140a0: 2060 6173 6360 206f 7220 6064 6573 6360   `asc` or `desc`
-000140b0: 2e20 4465 6661 756c 7420 6973 2060 6465  . Default is `de
-000140c0: 7363 602e 0a20 2020 2020 2020 203a 7265  sc`..        :re
-000140d0: 7475 726e 733a 204c 6973 7420 6f66 206d  turns: List of m
-000140e0: 6174 6368 696e 6720 3a70 793a 636c 6173  atching :py:clas
-000140f0: 733a 607e 6d6c 7275 6e2e 6665 6174 7572  s:`~mlrun.featur
-00014100: 655f 7374 6f72 652e 4665 6174 7572 6556  e_store.FeatureV
-00014110: 6563 746f 7260 206f 626a 6563 7473 2e0a  ector` objects..
-00014120: 2020 2020 2020 2020 2222 220a 0a20 2020          """..   
-00014130: 2020 2020 2070 726f 6a65 6374 203d 2070       project = p
-00014140: 726f 6a65 6374 206f 7220 636f 6e66 6967  roject or config
-00014150: 2e64 6566 6175 6c74 5f70 726f 6a65 6374  .default_project
-00014160: 0a0a 2020 2020 2020 2020 7061 7261 6d73  ..        params
-00014170: 203d 207b 0a20 2020 2020 2020 2020 2020   = {.           
-00014180: 2022 6e61 6d65 223a 206e 616d 652c 0a20   "name": name,. 
-00014190: 2020 2020 2020 2020 2020 2022 7374 6174             "stat
-000141a0: 6522 3a20 7374 6174 652c 0a20 2020 2020  e": state,.     
-000141b0: 2020 2020 2020 2022 7461 6722 3a20 7461         "tag": ta
-000141c0: 672c 0a20 2020 2020 2020 2020 2020 2022  g,.            "
-000141d0: 6c61 6265 6c22 3a20 6c61 6265 6c73 206f  label": labels o
-000141e0: 7220 5b5d 2c0a 2020 2020 2020 2020 7d0a  r [],.        }.
-000141f0: 2020 2020 2020 2020 6966 2070 6172 7469          if parti
-00014200: 7469 6f6e 5f62 793a 0a20 2020 2020 2020  tion_by:.       
-00014210: 2020 2020 2070 6172 616d 732e 7570 6461       params.upda
-00014220: 7465 280a 2020 2020 2020 2020 2020 2020  te(.            
-00014230: 2020 2020 7365 6c66 2e5f 6765 6e65 7261      self._genera
-00014240: 7465 5f70 6172 7469 7469 6f6e 5f62 795f  te_partition_by_
-00014250: 7061 7261 6d73 280a 2020 2020 2020 2020  params(.        
-00014260: 2020 2020 2020 2020 2020 2020 7363 6865              sche
-00014270: 6d61 732e 4665 6174 7572 6553 746f 7265  mas.FeatureStore
-00014280: 5061 7274 6974 696f 6e42 7946 6965 6c64  PartitionByField
-00014290: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-000142a0: 2020 2020 2020 7061 7274 6974 696f 6e5f        partition_
-000142b0: 6279 2c0a 2020 2020 2020 2020 2020 2020  by,.            
-000142c0: 2020 2020 2020 2020 726f 7773 5f70 6572          rows_per
-000142d0: 5f70 6172 7469 7469 6f6e 2c0a 2020 2020  _partition,.    
-000142e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000142f0: 7061 7274 6974 696f 6e5f 736f 7274 5f62  partition_sort_b
-00014300: 792c 0a20 2020 2020 2020 2020 2020 2020  y,.             
-00014310: 2020 2020 2020 2070 6172 7469 7469 6f6e         partition
-00014320: 5f6f 7264 6572 2c0a 2020 2020 2020 2020  _order,.        
-00014330: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-00014340: 2020 2020 2020 290a 0a20 2020 2020 2020        )..       
-00014350: 2070 6174 6820 3d20 6622 7072 6f6a 6563   path = f"projec
-00014360: 7473 2f7b 7072 6f6a 6563 747d 2f66 6561  ts/{project}/fea
-00014370: 7475 7265 2d76 6563 746f 7273 220a 0a20  ture-vectors".. 
-00014380: 2020 2020 2020 2065 7272 6f72 5f6d 6573         error_mes
-00014390: 7361 6765 203d 2028 0a20 2020 2020 2020  sage = (.       
-000143a0: 2020 2020 2066 2246 6169 6c65 6420 6c69       f"Failed li
-000143b0: 7374 696e 6720 6665 6174 7572 652d 7665  sting feature-ve
-000143c0: 6374 6f72 732c 2070 726f 6a65 6374 3a20  ctors, project: 
-000143d0: 7b70 726f 6a65 6374 7d2c 2071 7565 7279  {project}, query
-000143e0: 3a20 7b70 6172 616d 737d 220a 2020 2020  : {params}".    
-000143f0: 2020 2020 290a 2020 2020 2020 2020 7265      ).        re
-00014400: 7370 203d 2073 656c 662e 6170 695f 6361  sp = self.api_ca
-00014410: 6c6c 2822 4745 5422 2c20 7061 7468 2c20  ll("GET", path, 
-00014420: 6572 726f 725f 6d65 7373 6167 652c 2070  error_message, p
-00014430: 6172 616d 733d 7061 7261 6d73 290a 2020  arams=params).  
-00014440: 2020 2020 2020 6665 6174 7572 655f 7665        feature_ve
-00014450: 6374 6f72 7320 3d20 7265 7370 2e6a 736f  ctors = resp.jso
-00014460: 6e28 295b 2266 6561 7475 7265 5f76 6563  n()["feature_vec
-00014470: 746f 7273 225d 0a20 2020 2020 2020 2069  tors"].        i
-00014480: 6620 6665 6174 7572 655f 7665 6374 6f72  f feature_vector
-00014490: 733a 0a20 2020 2020 2020 2020 2020 2072  s:.            r
-000144a0: 6574 7572 6e20 5b46 6561 7475 7265 5665  eturn [FeatureVe
-000144b0: 6374 6f72 2e66 726f 6d5f 6469 6374 286f  ctor.from_dict(o
-000144c0: 626a 2920 666f 7220 6f62 6a20 696e 2066  bj) for obj in f
-000144d0: 6561 7475 7265 5f76 6563 746f 7273 5d0a  eature_vectors].
-000144e0: 0a20 2020 2064 6566 2073 746f 7265 5f66  .    def store_f
-000144f0: 6561 7475 7265 5f76 6563 746f 7228 0a20  eature_vector(. 
-00014500: 2020 2020 2020 2073 656c 662c 0a20 2020         self,.   
-00014510: 2020 2020 2066 6561 7475 7265 5f76 6563       feature_vec
-00014520: 746f 723a 2055 6e69 6f6e 5b64 6963 742c  tor: Union[dict,
-00014530: 2073 6368 656d 6173 2e46 6561 7475 7265   schemas.Feature
-00014540: 5665 6374 6f72 2c20 4665 6174 7572 6556  Vector, FeatureV
-00014550: 6563 746f 725d 2c0a 2020 2020 2020 2020  ector],.        
-00014560: 6e61 6d65 3d4e 6f6e 652c 0a20 2020 2020  name=None,.     
-00014570: 2020 2070 726f 6a65 6374 3d22 222c 0a20     project="",. 
-00014580: 2020 2020 2020 2074 6167 3d4e 6f6e 652c         tag=None,
-00014590: 0a20 2020 2020 2020 2075 6964 3d4e 6f6e  .        uid=Non
-000145a0: 652c 0a20 2020 2020 2020 2076 6572 7369  e,.        versi
-000145b0: 6f6e 6564 3d54 7275 652c 0a20 2020 2029  oned=True,.    )
-000145c0: 202d 3e20 6469 6374 3a0a 2020 2020 2020   -> dict:.      
-000145d0: 2020 2222 2253 746f 7265 2061 203a 7079    """Store a :py
-000145e0: 3a63 6c61 7373 3a60 7e6d 6c72 756e 2e66  :class:`~mlrun.f
-000145f0: 6561 7475 7265 5f73 746f 7265 2e46 6561  eature_store.Fea
-00014600: 7475 7265 5665 6374 6f72 6020 6f62 6a65  tureVector` obje
-00014610: 6374 2069 6e20 7468 6520 3a70 793a 6d6f  ct in the :py:mo
-00014620: 643a 606d 6c72 756e 6020 4442 2e20 5468  d:`mlrun` DB. Th
-00014630: 650a 2020 2020 2020 2020 6665 6174 7572  e.        featur
-00014640: 652d 7665 6374 6f72 2063 616e 2062 6520  e-vector can be 
-00014650: 6569 7468 6572 2061 206e 6577 206f 626a  either a new obj
-00014660: 6563 7420 6f72 2061 206d 6f64 6966 6963  ect or a modific
-00014670: 6174 696f 6e20 746f 2065 7869 7374 696e  ation to existin
-00014680: 6720 6f62 6a65 6374 2072 6566 6572 656e  g object referen
-00014690: 6365 6420 6279 2074 6865 2070 6172 616d  ced by the param
-000146a0: 730a 2020 2020 2020 2020 6f66 2074 6865  s.        of the
-000146b0: 2066 756e 6374 696f 6e2e 0a0a 2020 2020   function...    
-000146c0: 2020 2020 3a70 6172 616d 2066 6561 7475      :param featu
-000146d0: 7265 5f76 6563 746f 723a 2054 6865 203a  re_vector: The :
-000146e0: 7079 3a63 6c61 7373 3a60 7e6d 6c72 756e  py:class:`~mlrun
-000146f0: 2e66 6561 7475 7265 5f73 746f 7265 2e46  .feature_store.F
-00014700: 6561 7475 7265 5665 6374 6f72 6020 746f  eatureVector` to
-00014710: 2073 746f 7265 2e0a 2020 2020 2020 2020   store..        
-00014720: 3a70 6172 616d 206e 616d 653a 2020 2020  :param name:    
-00014730: 4e61 6d65 206f 6620 6665 6174 7572 6520  Name of feature 
-00014740: 7665 6374 6f72 2e0a 2020 2020 2020 2020  vector..        
-00014750: 3a70 6172 616d 2070 726f 6a65 6374 3a20  :param project: 
-00014760: 4e61 6d65 206f 6620 7072 6f6a 6563 7420  Name of project 
-00014770: 7468 6973 2066 6561 7475 7265 2d76 6563  this feature-vec
-00014780: 746f 7220 6265 6c6f 6e67 7320 746f 2e0a  tor belongs to..
-00014790: 2020 2020 2020 2020 3a70 6172 616d 2074          :param t
-000147a0: 6167 3a20 5468 6520 6060 7461 6760 6020  ag: The ``tag`` 
-000147b0: 6f66 2074 6865 206f 626a 6563 7420 746f  of the object to
-000147c0: 2072 6570 6c61 6365 2069 6e20 7468 6520   replace in the 
-000147d0: 4442 2c20 666f 7220 6578 616d 706c 6520  DB, for example 
-000147e0: 6060 6c61 7465 7374 6060 2e0a 2020 2020  ``latest``..    
-000147f0: 2020 2020 3a70 6172 616d 2075 6964 3a20      :param uid: 
-00014800: 5468 6520 6060 7569 6460 6020 6f66 2074  The ``uid`` of t
-00014810: 6865 206f 626a 6563 7420 746f 2072 6570  he object to rep
-00014820: 6c61 6365 2069 6e20 7468 6520 4442 2e20  lace in the DB. 
-00014830: 4966 2075 7369 6e67 2074 6869 7320 7061  If using this pa
-00014840: 7261 6d65 7465 722c 2074 6865 206d 6f64  rameter, the mod
-00014850: 6966 6965 6420 6f62 6a65 6374 0a20 2020  ified object.   
-00014860: 2020 2020 2020 2020 206d 7573 7420 6861           must ha
-00014870: 7665 2074 6865 2073 616d 6520 6060 7569  ve the same ``ui
-00014880: 6460 6020 6f66 2074 6865 2070 7265 7669  d`` of the previ
-00014890: 6f75 736c 792d 6578 6973 7469 6e67 206f  ously-existing o
-000148a0: 626a 6563 742e 2054 6869 7320 6361 6e6e  bject. This cann
-000148b0: 6f74 2062 6520 7573 6564 2066 6f72 206e  ot be used for n
-000148c0: 6f6e 2d76 6572 7369 6f6e 6564 206f 626a  on-versioned obj
-000148d0: 6563 7473 2e0a 2020 2020 2020 2020 3a70  ects..        :p
-000148e0: 6172 616d 2076 6572 7369 6f6e 6564 3a20  aram versioned: 
-000148f0: 5768 6574 6865 7220 746f 206d 6169 6e74  Whether to maint
-00014900: 6169 6e20 7665 7273 696f 6e73 2066 6f72  ain versions for
-00014910: 2074 6869 7320 6665 6174 7572 652d 7665   this feature-ve
-00014920: 6374 6f72 2e20 416c 6c20 7665 7273 696f  ctor. All versio
-00014930: 6e73 206f 6620 6120 7665 7273 696f 6e65  ns of a versione
-00014940: 6420 6f62 6a65 6374 0a20 2020 2020 2020  d object.       
-00014950: 2020 2020 2077 696c 6c20 6265 206b 6570       will be kep
-00014960: 7420 696e 2074 6865 2044 4220 616e 6420  t in the DB and 
-00014970: 6361 6e20 6265 2072 6574 7269 6576 6564  can be retrieved
-00014980: 2075 6e74 696c 2065 7870 6c69 6369 746c   until explicitl
-00014990: 7920 6465 6c65 7465 642e 0a20 2020 2020  y deleted..     
-000149a0: 2020 203a 7265 7475 726e 733a 2054 6865     :returns: The
-000149b0: 203a 7079 3a63 6c61 7373 3a60 7e6d 6c72   :py:class:`~mlr
-000149c0: 756e 2e66 6561 7475 7265 5f73 746f 7265  un.feature_store
-000149d0: 2e46 6561 7475 7265 5665 6374 6f72 6020  .FeatureVector` 
-000149e0: 6f62 6a65 6374 2028 6173 2064 6963 7429  object (as dict)
-000149f0: 2e0a 2020 2020 2020 2020 2222 220a 0a20  ..        """.. 
-00014a00: 2020 2020 2020 2072 6566 6572 656e 6365         reference
-00014a10: 203d 2073 656c 662e 5f72 6573 6f6c 7665   = self._resolve
-00014a20: 5f72 6566 6572 656e 6365 2874 6167 2c20  _reference(tag, 
-00014a30: 7569 6429 0a20 2020 2020 2020 2070 6172  uid).        par
-00014a40: 616d 7320 3d20 7b22 7665 7273 696f 6e65  ams = {"versione
-00014a50: 6422 3a20 7665 7273 696f 6e65 647d 0a0a  d": versioned}..
-00014a60: 2020 2020 2020 2020 6966 2069 7369 6e73          if isins
-00014a70: 7461 6e63 6528 6665 6174 7572 655f 7665  tance(feature_ve
-00014a80: 6374 6f72 2c20 7363 6865 6d61 732e 4665  ctor, schemas.Fe
-00014a90: 6174 7572 6556 6563 746f 7229 3a0a 2020  atureVector):.  
-00014aa0: 2020 2020 2020 2020 2020 6665 6174 7572            featur
-00014ab0: 655f 7665 6374 6f72 203d 2066 6561 7475  e_vector = featu
-00014ac0: 7265 5f76 6563 746f 722e 6469 6374 2829  re_vector.dict()
-00014ad0: 0a20 2020 2020 2020 2065 6c69 6620 6973  .        elif is
-00014ae0: 696e 7374 616e 6365 2866 6561 7475 7265  instance(feature
-00014af0: 5f76 6563 746f 722c 2046 6561 7475 7265  _vector, Feature
-00014b00: 5665 6374 6f72 293a 0a20 2020 2020 2020  Vector):.       
-00014b10: 2020 2020 2066 6561 7475 7265 5f76 6563       feature_vec
-00014b20: 746f 7220 3d20 6665 6174 7572 655f 7665  tor = feature_ve
-00014b30: 6374 6f72 2e74 6f5f 6469 6374 2829 0a0a  ctor.to_dict()..
-00014b40: 2020 2020 2020 2020 6e61 6d65 203d 206e          name = n
-00014b50: 616d 6520 6f72 2066 6561 7475 7265 5f76  ame or feature_v
-00014b60: 6563 746f 725b 226d 6574 6164 6174 6122  ector["metadata"
-00014b70: 5d5b 226e 616d 6522 5d0a 2020 2020 2020  ]["name"].      
-00014b80: 2020 7072 6f6a 6563 7420 3d20 280a 2020    project = (.  
-00014b90: 2020 2020 2020 2020 2020 7072 6f6a 6563            projec
-00014ba0: 740a 2020 2020 2020 2020 2020 2020 6f72  t.            or
-00014bb0: 2066 6561 7475 7265 5f76 6563 746f 725b   feature_vector[
-00014bc0: 226d 6574 6164 6174 6122 5d2e 6765 7428  "metadata"].get(
-00014bd0: 2270 726f 6a65 6374 2229 0a20 2020 2020  "project").     
-00014be0: 2020 2020 2020 206f 7220 636f 6e66 6967         or config
-00014bf0: 2e64 6566 6175 6c74 5f70 726f 6a65 6374  .default_project
-00014c00: 0a20 2020 2020 2020 2029 0a20 2020 2020  .        ).     
-00014c10: 2020 2070 6174 6820 3d20 6622 7072 6f6a     path = f"proj
-00014c20: 6563 7473 2f7b 7072 6f6a 6563 747d 2f66  ects/{project}/f
-00014c30: 6561 7475 7265 2d76 6563 746f 7273 2f7b  eature-vectors/{
-00014c40: 6e61 6d65 7d2f 7265 6665 7265 6e63 6573  name}/references
-00014c50: 2f7b 7265 6665 7265 6e63 657d 220a 2020  /{reference}".  
-00014c60: 2020 2020 2020 6572 726f 725f 6d65 7373        error_mess
-00014c70: 6167 6520 3d20 6622 4661 696c 6564 2073  age = f"Failed s
-00014c80: 746f 7269 6e67 2066 6561 7475 7265 2d76  toring feature-v
-00014c90: 6563 746f 7220 7b70 726f 6a65 6374 7d2f  ector {project}/
-00014ca0: 7b6e 616d 657d 220a 2020 2020 2020 2020  {name}".        
-00014cb0: 7265 7370 203d 2073 656c 662e 6170 695f  resp = self.api_
-00014cc0: 6361 6c6c 280a 2020 2020 2020 2020 2020  call(.          
-00014cd0: 2020 2250 5554 222c 2070 6174 682c 2065    "PUT", path, e
-00014ce0: 7272 6f72 5f6d 6573 7361 6765 2c20 7061  rror_message, pa
-00014cf0: 7261 6d73 3d70 6172 616d 732c 2062 6f64  rams=params, bod
-00014d00: 793d 6469 6374 5f74 6f5f 6a73 6f6e 2866  y=dict_to_json(f
-00014d10: 6561 7475 7265 5f76 6563 746f 7229 0a20  eature_vector). 
-00014d20: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-00014d30: 2072 6574 7572 6e20 7265 7370 2e6a 736f   return resp.jso
-00014d40: 6e28 290a 0a20 2020 2064 6566 2070 6174  n()..    def pat
-00014d50: 6368 5f66 6561 7475 7265 5f76 6563 746f  ch_feature_vecto
-00014d60: 7228 0a20 2020 2020 2020 2073 656c 662c  r(.        self,
-00014d70: 0a20 2020 2020 2020 206e 616d 652c 0a20  .        name,. 
-00014d80: 2020 2020 2020 2066 6561 7475 7265 5f76         feature_v
-00014d90: 6563 746f 725f 7570 6461 7465 3a20 6469  ector_update: di
-00014da0: 6374 2c0a 2020 2020 2020 2020 7072 6f6a  ct,.        proj
-00014db0: 6563 743d 2222 2c0a 2020 2020 2020 2020  ect="",.        
-00014dc0: 7461 673d 4e6f 6e65 2c0a 2020 2020 2020  tag=None,.      
-00014dd0: 2020 7569 643d 4e6f 6e65 2c0a 2020 2020    uid=None,.    
-00014de0: 2020 2020 7061 7463 685f 6d6f 6465 3a20      patch_mode: 
-00014df0: 556e 696f 6e5b 7374 722c 2073 6368 656d  Union[str, schem
-00014e00: 6173 2e50 6174 6368 4d6f 6465 5d20 3d20  as.PatchMode] = 
-00014e10: 7363 6865 6d61 732e 5061 7463 684d 6f64  schemas.PatchMod
-00014e20: 652e 7265 706c 6163 652c 0a20 2020 2029  e.replace,.    )
-00014e30: 3a0a 2020 2020 2020 2020 2222 224d 6f64  :.        """Mod
-00014e40: 6966 7920 2870 6174 6368 2920 616e 2065  ify (patch) an e
-00014e50: 7869 7374 696e 6720 3a70 793a 636c 6173  xisting :py:clas
-00014e60: 733a 607e 6d6c 7275 6e2e 6665 6174 7572  s:`~mlrun.featur
-00014e70: 655f 7374 6f72 652e 4665 6174 7572 6556  e_store.FeatureV
-00014e80: 6563 746f 7260 206f 626a 6563 742e 0a20  ector` object.. 
-00014e90: 2020 2020 2020 2054 6865 206f 626a 6563         The objec
-00014ea0: 7420 6973 2069 6465 6e74 6966 6965 6420  t is identified 
-00014eb0: 6279 2069 7473 206e 616d 6520 2861 6e64  by its name (and
-00014ec0: 2070 726f 6a65 6374 2069 7420 6265 6c6f   project it belo
-00014ed0: 6e67 7320 746f 292c 2061 7320 7765 6c6c  ngs to), as well
-00014ee0: 2061 7320 6f70 7469 6f6e 616c 6c79 2061   as optionally a
-00014ef0: 2060 6074 6167 6060 206f 7220 6974 730a   ``tag`` or its.
-00014f00: 2020 2020 2020 2020 6060 7569 6460 6020          ``uid`` 
-00014f10: 2866 6f72 2076 6572 7369 6f6e 6564 206f  (for versioned o
-00014f20: 626a 6563 7429 2e20 4966 2062 6f74 6820  bject). If both 
-00014f30: 6060 7461 6760 6020 616e 6420 6060 7569  ``tag`` and ``ui
-00014f40: 6460 6020 6172 6520 6f6d 6974 7465 6420  d`` are omitted 
-00014f50: 7468 656e 2074 6865 206f 626a 6563 7420  then the object 
-00014f60: 7769 7468 2074 6167 2060 606c 6174 6573  with tag ``lates
-00014f70: 7460 600a 2020 2020 2020 2020 6973 206d  t``.        is m
-00014f80: 6f64 6966 6965 642e 0a0a 2020 2020 2020  odified...      
-00014f90: 2020 3a70 6172 616d 206e 616d 653a 204e    :param name: N
-00014fa0: 616d 6520 6f66 2074 6865 206f 626a 6563  ame of the objec
-00014fb0: 7420 746f 2070 6174 6368 2e0a 2020 2020  t to patch..    
-00014fc0: 2020 2020 3a70 6172 616d 2066 6561 7475      :param featu
-00014fd0: 7265 5f76 6563 746f 725f 7570 6461 7465  re_vector_update
-00014fe0: 3a20 5468 6520 6d6f 6469 6669 6361 7469  : The modificati
-00014ff0: 6f6e 7320 6e65 6564 6564 2069 6e20 7468  ons needed in th
-00015000: 6520 6f62 6a65 6374 2e20 5468 6973 2070  e object. This p
-00015010: 6172 616d 6574 6572 206f 6e6c 7920 6861  arameter only ha
-00015020: 7320 7468 6520 6368 616e 6765 7320 696e  s the changes in
-00015030: 2069 742c 0a20 2020 2020 2020 2020 2020   it,.           
-00015040: 206e 6f74 2061 2066 756c 6c20 6f62 6a65   not a full obje
-00015050: 6374 2e0a 2020 2020 2020 2020 3a70 6172  ct..        :par
-00015060: 616d 2070 726f 6a65 6374 3a20 5072 6f6a  am project: Proj
-00015070: 6563 7420 7768 6963 6820 636f 6e74 6169  ect which contai
-00015080: 6e73 2074 6865 206d 6f64 6966 6965 6420  ns the modified 
-00015090: 6f62 6a65 6374 2e0a 2020 2020 2020 2020  object..        
-000150a0: 3a70 6172 616d 2074 6167 3a20 5468 6520  :param tag: The 
-000150b0: 7461 6720 6f66 2074 6865 206f 626a 6563  tag of the objec
-000150c0: 7420 746f 206d 6f64 6966 792e 0a20 2020  t to modify..   
-000150d0: 2020 2020 203a 7061 7261 6d20 7569 643a       :param uid:
-000150e0: 2075 6964 206f 6620 7468 6520 6f62 6a65   uid of the obje
-000150f0: 6374 2074 6f20 6d6f 6469 6679 2e0a 2020  ct to modify..  
-00015100: 2020 2020 2020 3a70 6172 616d 2070 6174        :param pat
-00015110: 6368 5f6d 6f64 653a 2054 6865 2073 7472  ch_mode: The str
-00015120: 6174 6567 7920 666f 7220 6d65 7267 696e  ategy for mergin
-00015130: 6720 7468 6520 6368 616e 6765 7320 7769  g the changes wi
-00015140: 7468 2074 6865 2065 7869 7374 696e 6720  th the existing 
-00015150: 6f62 6a65 6374 2e20 4361 6e20 6265 2065  object. Can be e
-00015160: 6974 6865 7220 6060 7265 706c 6163 6560  ither ``replace`
-00015170: 600a 2020 2020 2020 2020 2020 2020 6f72  `.            or
-00015180: 2060 6061 6464 6974 6976 6560 602e 0a20   ``additive``.. 
-00015190: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-000151a0: 2020 2072 6566 6572 656e 6365 203d 2073     reference = s
-000151b0: 656c 662e 5f72 6573 6f6c 7665 5f72 6566  elf._resolve_ref
-000151c0: 6572 656e 6365 2874 6167 2c20 7569 6429  erence(tag, uid)
-000151d0: 0a20 2020 2020 2020 2070 726f 6a65 6374  .        project
-000151e0: 203d 2070 726f 6a65 6374 206f 7220 636f   = project or co
-000151f0: 6e66 6967 2e64 6566 6175 6c74 5f70 726f  nfig.default_pro
-00015200: 6a65 6374 0a20 2020 2020 2020 2068 6561  ject.        hea
-00015210: 6465 7273 203d 207b 7363 6865 6d61 732e  ders = {schemas.
-00015220: 4865 6164 6572 4e61 6d65 732e 7061 7463  HeaderNames.patc
-00015230: 685f 6d6f 6465 3a20 7061 7463 685f 6d6f  h_mode: patch_mo
-00015240: 6465 7d0a 2020 2020 2020 2020 7061 7468  de}.        path
-00015250: 203d 2066 2270 726f 6a65 6374 732f 7b70   = f"projects/{p
-00015260: 726f 6a65 6374 7d2f 6665 6174 7572 652d  roject}/feature-
-00015270: 7665 6374 6f72 732f 7b6e 616d 657d 2f72  vectors/{name}/r
-00015280: 6566 6572 656e 6365 732f 7b72 6566 6572  eferences/{refer
-00015290: 656e 6365 7d22 0a20 2020 2020 2020 2065  ence}".        e
-000152a0: 7272 6f72 5f6d 6573 7361 6765 203d 2066  rror_message = f
-000152b0: 2246 6169 6c65 6420 7570 6461 7469 6e67  "Failed updating
-000152c0: 2066 6561 7475 7265 2d76 6563 746f 7220   feature-vector 
-000152d0: 7b70 726f 6a65 6374 7d2f 7b6e 616d 657d  {project}/{name}
-000152e0: 220a 2020 2020 2020 2020 7365 6c66 2e61  ".        self.a
-000152f0: 7069 5f63 616c 6c28 0a20 2020 2020 2020  pi_call(.       
-00015300: 2020 2020 2022 5041 5443 4822 2c0a 2020       "PATCH",.  
-00015310: 2020 2020 2020 2020 2020 7061 7468 2c0a            path,.
-00015320: 2020 2020 2020 2020 2020 2020 6572 726f              erro
-00015330: 725f 6d65 7373 6167 652c 0a20 2020 2020  r_message,.     
-00015340: 2020 2020 2020 2062 6f64 793d 6469 6374         body=dict
-00015350: 5f74 6f5f 6a73 6f6e 2866 6561 7475 7265  _to_json(feature
-00015360: 5f76 6563 746f 725f 7570 6461 7465 292c  _vector_update),
-00015370: 0a20 2020 2020 2020 2020 2020 2068 6561  .            hea
-00015380: 6465 7273 3d68 6561 6465 7273 2c0a 2020  ders=headers,.  
-00015390: 2020 2020 2020 290a 0a20 2020 2064 6566        )..    def
-000153a0: 2064 656c 6574 655f 6665 6174 7572 655f   delete_feature_
-000153b0: 7665 6374 6f72 2873 656c 662c 206e 616d  vector(self, nam
-000153c0: 652c 2070 726f 6a65 6374 3d22 222c 2074  e, project="", t
-000153d0: 6167 3d4e 6f6e 652c 2075 6964 3d4e 6f6e  ag=None, uid=Non
-000153e0: 6529 3a0a 2020 2020 2020 2020 2222 2244  e):.        """D
-000153f0: 656c 6574 6520 6120 3a70 793a 636c 6173  elete a :py:clas
-00015400: 733a 607e 6d6c 7275 6e2e 6665 6174 7572  s:`~mlrun.featur
-00015410: 655f 7374 6f72 652e 4665 6174 7572 6556  e_store.FeatureV
-00015420: 6563 746f 7260 206f 626a 6563 7420 6672  ector` object fr
-00015430: 6f6d 2074 6865 2044 422e 0a20 2020 2020  om the DB..     
-00015440: 2020 2049 6620 6060 7461 6760 6020 6f72     If ``tag`` or
-00015450: 2060 6075 6964 6060 2061 7265 2073 7065   ``uid`` are spe
-00015460: 6369 6669 6564 2c20 7468 656e 206a 7573  cified, then jus
-00015470: 7420 7468 6520 7665 7273 696f 6e20 7265  t the version re
-00015480: 6665 7265 6e63 6564 2062 7920 7468 656d  ferenced by them
-00015490: 2077 696c 6c20 6265 2064 656c 6574 6564   will be deleted
-000154a0: 2e20 5573 696e 6720 626f 7468 0a20 2020  . Using both.   
-000154b0: 2020 2020 2069 7320 6e6f 7420 616c 6c6f       is not allo
-000154c0: 7765 642e 0a20 2020 2020 2020 2049 6620  wed..        If 
-000154d0: 6e6f 6e65 2061 7265 2073 7065 6369 6669  none are specifi
-000154e0: 6564 2c20 7468 656e 2061 6c6c 2069 6e73  ed, then all ins
-000154f0: 7461 6e63 6573 206f 6620 7468 6520 6f62  tances of the ob
-00015500: 6a65 6374 2077 686f 7365 206e 616d 6520  ject whose name 
-00015510: 6973 2060 606e 616d 6560 6020 7769 6c6c  is ``name`` will
-00015520: 2062 6520 6465 6c65 7465 642e 0a20 2020   be deleted..   
-00015530: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-00015540: 2070 726f 6a65 6374 203d 2070 726f 6a65   project = proje
-00015550: 6374 206f 7220 636f 6e66 6967 2e64 6566  ct or config.def
-00015560: 6175 6c74 5f70 726f 6a65 6374 0a20 2020  ault_project.   
-00015570: 2020 2020 2070 6174 6820 3d20 6622 7072       path = f"pr
-00015580: 6f6a 6563 7473 2f7b 7072 6f6a 6563 747d  ojects/{project}
-00015590: 2f66 6561 7475 7265 2d76 6563 746f 7273  /feature-vectors
-000155a0: 2f7b 6e61 6d65 7d22 0a20 2020 2020 2020  /{name}".       
-000155b0: 2069 6620 7461 6720 6f72 2075 6964 3a0a   if tag or uid:.
-000155c0: 2020 2020 2020 2020 2020 2020 7265 6665              refe
-000155d0: 7265 6e63 6520 3d20 7365 6c66 2e5f 7265  rence = self._re
-000155e0: 736f 6c76 655f 7265 6665 7265 6e63 6528  solve_reference(
-000155f0: 7461 672c 2075 6964 290a 2020 2020 2020  tag, uid).      
-00015600: 2020 2020 2020 7061 7468 203d 2070 6174        path = pat
-00015610: 6820 2b20 6622 2f72 6566 6572 656e 6365  h + f"/reference
-00015620: 732f 7b72 6566 6572 656e 6365 7d22 0a0a  s/{reference}"..
-00015630: 2020 2020 2020 2020 6572 726f 725f 6d65          error_me
-00015640: 7373 6167 6520 3d20 6622 4661 696c 6564  ssage = f"Failed
-00015650: 2064 656c 6574 696e 6720 6665 6174 7572   deleting featur
-00015660: 652d 7665 6374 6f72 207b 6e61 6d65 7d22  e-vector {name}"
-00015670: 0a20 2020 2020 2020 2073 656c 662e 6170  .        self.ap
-00015680: 695f 6361 6c6c 2822 4445 4c45 5445 222c  i_call("DELETE",
-00015690: 2070 6174 682c 2065 7272 6f72 5f6d 6573   path, error_mes
-000156a0: 7361 6765 290a 0a20 2020 2064 6566 2074  sage)..    def t
-000156b0: 6167 5f6f 626a 6563 7473 280a 2020 2020  ag_objects(.    
-000156c0: 2020 2020 7365 6c66 2c0a 2020 2020 2020      self,.      
-000156d0: 2020 7072 6f6a 6563 743a 2073 7472 2c0a    project: str,.
-000156e0: 2020 2020 2020 2020 7461 675f 6e61 6d65          tag_name
-000156f0: 3a20 7374 722c 0a20 2020 2020 2020 206f  : str,.        o
-00015700: 626a 6563 7473 3a20 556e 696f 6e5b 6d6c  bjects: Union[ml
-00015710: 7275 6e2e 6170 692e 7363 6865 6d61 732e  run.api.schemas.
-00015720: 5461 674f 626a 6563 7473 2c20 6469 6374  TagObjects, dict
-00015730: 5d2c 0a20 2020 2020 2020 2072 6570 6c61  ],.        repla
-00015740: 6365 3a20 626f 6f6c 203d 2046 616c 7365  ce: bool = False
-00015750: 2c0a 2020 2020 293a 0a20 2020 2020 2020  ,.    ):.       
-00015760: 2022 2222 5461 6720 6120 6c69 7374 206f   """Tag a list o
-00015770: 6620 6f62 6a65 6374 732e 0a0a 2020 2020  f objects...    
-00015780: 2020 2020 3a70 6172 616d 2070 726f 6a65      :param proje
-00015790: 6374 3a20 5072 6f6a 6563 7420 7768 6963  ct: Project whic
-000157a0: 6820 636f 6e74 6169 6e73 2074 6865 206f  h contains the o
-000157b0: 626a 6563 7473 2e0a 2020 2020 2020 2020  bjects..        
-000157c0: 3a70 6172 616d 2074 6167 5f6e 616d 653a  :param tag_name:
-000157d0: 2054 6865 2074 6167 2074 6f20 7365 7420   The tag to set 
-000157e0: 6f6e 2074 6865 206f 626a 6563 7473 2e0a  on the objects..
-000157f0: 2020 2020 2020 2020 3a70 6172 616d 206f          :param o
-00015800: 626a 6563 7473 3a20 5468 6520 6f62 6a65  bjects: The obje
-00015810: 6374 7320 746f 2074 6167 2e0a 2020 2020  cts to tag..    
-00015820: 2020 2020 3a70 6172 616d 2072 6570 6c61      :param repla
-00015830: 6365 3a20 5768 6574 6865 7220 746f 2072  ce: Whether to r
-00015840: 6570 6c61 6365 2074 6865 2065 7869 7374  eplace the exist
-00015850: 696e 6720 7461 6773 206f 6620 7468 6520  ing tags of the 
-00015860: 6f62 6a65 6374 7320 6f72 2074 6f20 6164  objects or to ad
-00015870: 6420 7468 6520 6e65 7720 7461 6720 746f  d the new tag to
-00015880: 2074 6865 6d2e 0a20 2020 2020 2020 2022   them..        "
-00015890: 2222 0a0a 2020 2020 2020 2020 7061 7468  ""..        path
-000158a0: 203d 2066 2270 726f 6a65 6374 732f 7b70   = f"projects/{p
-000158b0: 726f 6a65 6374 7d2f 7461 6773 2f7b 7461  roject}/tags/{ta
-000158c0: 675f 6e61 6d65 7d22 0a20 2020 2020 2020  g_name}".       
-000158d0: 2065 7272 6f72 5f6d 6573 7361 6765 203d   error_message =
-000158e0: 2066 2246 6169 6c65 6420 746f 2074 6167   f"Failed to tag
-000158f0: 207b 7461 675f 6e61 6d65 7d20 6f6e 206f   {tag_name} on o
-00015900: 626a 6563 7473 207b 6f62 6a65 6374 737d  bjects {objects}
-00015910: 220a 2020 2020 2020 2020 6d65 7468 6f64  ".        method
-00015920: 203d 2022 504f 5354 2220 6966 2072 6570   = "POST" if rep
-00015930: 6c61 6365 2065 6c73 6520 2250 5554 220a  lace else "PUT".
-00015940: 2020 2020 2020 2020 7365 6c66 2e61 7069          self.api
-00015950: 5f63 616c 6c28 0a20 2020 2020 2020 2020  _call(.         
-00015960: 2020 206d 6574 686f 642c 0a20 2020 2020     method,.     
-00015970: 2020 2020 2020 2070 6174 682c 0a20 2020         path,.   
-00015980: 2020 2020 2020 2020 2065 7272 6f72 5f6d           error_m
-00015990: 6573 7361 6765 2c0a 2020 2020 2020 2020  essage,.        
-000159a0: 2020 2020 626f 6479 3d64 6963 745f 746f      body=dict_to
-000159b0: 5f6a 736f 6e28 0a20 2020 2020 2020 2020  _json(.         
-000159c0: 2020 2020 2020 206f 626a 6563 7473 2e64         objects.d
-000159d0: 6963 7428 290a 2020 2020 2020 2020 2020  ict().          
-000159e0: 2020 2020 2020 6966 2069 7369 6e73 7461        if isinsta
-000159f0: 6e63 6528 6f62 6a65 6374 732c 206d 6c72  nce(objects, mlr
-00015a00: 756e 2e61 7069 2e73 6368 656d 6173 2e54  un.api.schemas.T
-00015a10: 6167 4f62 6a65 6374 7329 0a20 2020 2020  agObjects).     
-00015a20: 2020 2020 2020 2020 2020 2065 6c73 6520             else 
-00015a30: 6f62 6a65 6374 730a 2020 2020 2020 2020  objects.        
-00015a40: 2020 2020 292c 0a20 2020 2020 2020 2029      ),.        )
-00015a50: 0a0a 2020 2020 6465 6620 6465 6c65 7465  ..    def delete
-00015a60: 5f6f 626a 6563 7473 5f74 6167 280a 2020  _objects_tag(.  
-00015a70: 2020 2020 2020 7365 6c66 2c0a 2020 2020        self,.    
-00015a80: 2020 2020 7072 6f6a 6563 743a 2073 7472      project: str
-00015a90: 2c0a 2020 2020 2020 2020 7461 675f 6e61  ,.        tag_na
-00015aa0: 6d65 3a20 7374 722c 0a20 2020 2020 2020  me: str,.       
-00015ab0: 2074 6167 5f6f 626a 6563 7473 3a20 556e   tag_objects: Un
-00015ac0: 696f 6e5b 6d6c 7275 6e2e 6170 692e 7363  ion[mlrun.api.sc
-00015ad0: 6865 6d61 732e 5461 674f 626a 6563 7473  hemas.TagObjects
-00015ae0: 2c20 6469 6374 5d2c 0a20 2020 2029 3a0a  , dict],.    ):.
-00015af0: 2020 2020 2020 2020 2222 2244 656c 6574          """Delet
-00015b00: 6520 6120 7461 6720 6672 6f6d 2061 206c  e a tag from a l
-00015b10: 6973 7420 6f66 206f 626a 6563 7473 2e0a  ist of objects..
-00015b20: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
-00015b30: 7072 6f6a 6563 743a 2050 726f 6a65 6374  project: Project
-00015b40: 2077 6869 6368 2063 6f6e 7461 696e 7320   which contains 
-00015b50: 7468 6520 6f62 6a65 6374 732e 0a20 2020  the objects..   
-00015b60: 2020 2020 203a 7061 7261 6d20 7461 675f       :param tag_
-00015b70: 6e61 6d65 3a20 5468 6520 7461 6720 746f  name: The tag to
-00015b80: 2064 656c 6574 6520 6672 6f6d 2074 6865   delete from the
-00015b90: 206f 626a 6563 7473 2e0a 2020 2020 2020   objects..      
-00015ba0: 2020 3a70 6172 616d 2074 6167 5f6f 626a    :param tag_obj
-00015bb0: 6563 7473 3a20 5468 6520 6f62 6a65 6374  ects: The object
-00015bc0: 7320 746f 2064 656c 6574 6520 7468 6520  s to delete the 
-00015bd0: 7461 6720 6672 6f6d 2e0a 0a20 2020 2020  tag from...     
-00015be0: 2020 2022 2222 0a20 2020 2020 2020 2070     """.        p
-00015bf0: 6174 6820 3d20 6622 7072 6f6a 6563 7473  ath = f"projects
-00015c00: 2f7b 7072 6f6a 6563 747d 2f74 6167 732f  /{project}/tags/
-00015c10: 7b74 6167 5f6e 616d 657d 220a 2020 2020  {tag_name}".    
-00015c20: 2020 2020 6572 726f 725f 6d65 7373 6167      error_messag
-00015c30: 6520 3d20 6622 4661 696c 6564 2064 656c  e = f"Failed del
-00015c40: 6574 696e 6720 7461 6720 6672 6f6d 207b  eting tag from {
-00015c50: 7461 675f 6e61 6d65 7d22 0a20 2020 2020  tag_name}".     
-00015c60: 2020 2073 656c 662e 6170 695f 6361 6c6c     self.api_call
-00015c70: 280a 2020 2020 2020 2020 2020 2020 2244  (.            "D
-00015c80: 454c 4554 4522 2c0a 2020 2020 2020 2020  ELETE",.        
-00015c90: 2020 2020 7061 7468 2c0a 2020 2020 2020      path,.      
-00015ca0: 2020 2020 2020 6572 726f 725f 6d65 7373        error_mess
-00015cb0: 6167 652c 0a20 2020 2020 2020 2020 2020  age,.           
-00015cc0: 2062 6f64 793d 6469 6374 5f74 6f5f 6a73   body=dict_to_js
-00015cd0: 6f6e 280a 2020 2020 2020 2020 2020 2020  on(.            
-00015ce0: 2020 2020 7461 675f 6f62 6a65 6374 732e      tag_objects.
-00015cf0: 6469 6374 2829 0a20 2020 2020 2020 2020  dict().         
-00015d00: 2020 2020 2020 2069 6620 6973 696e 7374         if isinst
-00015d10: 616e 6365 2874 6167 5f6f 626a 6563 7473  ance(tag_objects
-00015d20: 2c20 6d6c 7275 6e2e 6170 692e 7363 6865  , mlrun.api.sche
-00015d30: 6d61 732e 5461 674f 626a 6563 7473 290a  mas.TagObjects).
-00015d40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015d50: 656c 7365 2074 6167 5f6f 626a 6563 7473  else tag_objects
-00015d60: 0a20 2020 2020 2020 2020 2020 2029 2c0a  .            ),.
-00015d70: 2020 2020 2020 2020 290a 0a20 2020 2064          )..    d
-00015d80: 6566 2074 6167 5f61 7274 6966 6163 7473  ef tag_artifacts
-00015d90: 280a 2020 2020 2020 2020 7365 6c66 2c0a  (.        self,.
-00015da0: 2020 2020 2020 2020 6172 7469 6661 6374          artifact
-00015db0: 733a 2055 6e69 6f6e 5b4c 6973 745b 4172  s: Union[List[Ar
-00015dc0: 7469 6661 6374 5d2c 204c 6973 745b 6469  tifact], List[di
-00015dd0: 6374 5d2c 2041 7274 6966 6163 742c 2064  ct], Artifact, d
-00015de0: 6963 745d 2c0a 2020 2020 2020 2020 7072  ict],.        pr
-00015df0: 6f6a 6563 743a 2073 7472 2c0a 2020 2020  oject: str,.    
-00015e00: 2020 2020 7461 675f 6e61 6d65 3a20 7374      tag_name: st
-00015e10: 722c 0a20 2020 2020 2020 2072 6570 6c61  r,.        repla
-00015e20: 6365 3a20 626f 6f6c 203d 2046 616c 7365  ce: bool = False
-00015e30: 2c0a 2020 2020 293a 0a20 2020 2020 2020  ,.    ):.       
-00015e40: 2022 2222 5461 6720 6120 6c69 7374 206f   """Tag a list o
-00015e50: 6620 6172 7469 6661 6374 732e 0a0a 2020  f artifacts...  
-00015e60: 2020 2020 2020 3a70 6172 616d 2061 7274        :param art
-00015e70: 6966 6163 7473 3a20 5468 6520 6172 7469  ifacts: The arti
-00015e80: 6661 6374 7320 746f 2074 6167 2e20 4361  facts to tag. Ca
-00015e90: 6e20 6265 2061 206c 6973 7420 6f66 203a  n be a list of :
-00015ea0: 7079 3a63 6c61 7373 3a60 7e6d 6c72 756e  py:class:`~mlrun
-00015eb0: 2e61 7274 6966 6163 7473 2e41 7274 6966  .artifacts.Artif
-00015ec0: 6163 7460 206f 626a 6563 7473 206f 720a  act` objects or.
-00015ed0: 2020 2020 2020 2020 2020 2020 6469 6374              dict
-00015ee0: 696f 6e61 7269 6573 2c20 6f72 2061 2073  ionaries, or a s
-00015ef0: 696e 676c 6520 6f62 6a65 6374 2e0a 2020  ingle object..  
-00015f00: 2020 2020 2020 3a70 6172 616d 2070 726f        :param pro
-00015f10: 6a65 6374 3a20 5072 6f6a 6563 7420 7768  ject: Project wh
-00015f20: 6963 6820 636f 6e74 6169 6e73 2074 6865  ich contains the
-00015f30: 2061 7274 6966 6163 7473 2e0a 2020 2020   artifacts..    
-00015f40: 2020 2020 3a70 6172 616d 2074 6167 5f6e      :param tag_n
-00015f50: 616d 653a 2054 6865 2074 6167 2074 6f20  ame: The tag to 
-00015f60: 7365 7420 6f6e 2074 6865 2061 7274 6966  set on the artif
-00015f70: 6163 7473 2e0a 2020 2020 2020 2020 3a70  acts..        :p
-00015f80: 6172 616d 2072 6570 6c61 6365 3a20 4966  aram replace: If
-00015f90: 2054 7275 652c 2072 6570 6c61 6365 2065   True, replace e
-00015fa0: 7869 7374 696e 6720 7461 6773 2c20 6f74  xisting tags, ot
-00015fb0: 6865 7277 6973 6520 6170 7065 6e64 2074  herwise append t
-00015fc0: 6f20 6578 6973 7469 6e67 2074 6167 732e  o existing tags.
-00015fd0: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-00015fe0: 2020 2020 2074 6167 5f6f 626a 6563 7473       tag_objects
-00015ff0: 203d 2073 656c 662e 5f72 6573 6f6c 7665   = self._resolve
-00016000: 5f61 7274 6966 6163 7473 5f74 6f5f 7461  _artifacts_to_ta
-00016010: 675f 6f62 6a65 6374 7328 6172 7469 6661  g_objects(artifa
-00016020: 6374 7329 0a20 2020 2020 2020 2073 656c  cts).        sel
-00016030: 662e 7461 675f 6f62 6a65 6374 7328 7072  f.tag_objects(pr
-00016040: 6f6a 6563 742c 2074 6167 5f6e 616d 652c  oject, tag_name,
-00016050: 206f 626a 6563 7473 3d74 6167 5f6f 626a   objects=tag_obj
-00016060: 6563 7473 2c20 7265 706c 6163 653d 7265  ects, replace=re
-00016070: 706c 6163 6529 0a0a 2020 2020 6465 6620  place)..    def 
-00016080: 6465 6c65 7465 5f61 7274 6966 6163 7473  delete_artifacts
-00016090: 5f74 6167 7328 0a20 2020 2020 2020 2073  _tags(.        s
-000160a0: 656c 662c 0a20 2020 2020 2020 2061 7274  elf,.        art
-000160b0: 6966 6163 7473 2c0a 2020 2020 2020 2020  ifacts,.        
-000160c0: 7072 6f6a 6563 743a 2073 7472 2c0a 2020  project: str,.  
-000160d0: 2020 2020 2020 7461 675f 6e61 6d65 3a20        tag_name: 
-000160e0: 7374 722c 0a20 2020 2029 3a0a 2020 2020  str,.    ):.    
-000160f0: 2020 2020 2222 2244 656c 6574 6520 7461      """Delete ta
-00016100: 6720 6672 6f6d 2061 206c 6973 7420 6f66  g from a list of
-00016110: 2061 7274 6966 6163 7473 2e0a 0a20 2020   artifacts...   
-00016120: 2020 2020 203a 7061 7261 6d20 6172 7469       :param arti
-00016130: 6661 6374 733a 2054 6865 2061 7274 6966  facts: The artif
-00016140: 6163 7473 2074 6f20 6465 6c65 7465 2074  acts to delete t
-00016150: 6865 2074 6167 2066 726f 6d2e 2043 616e  he tag from. Can
-00016160: 2062 6520 6120 6c69 7374 206f 6620 3a70   be a list of :p
-00016170: 793a 636c 6173 733a 607e 6d6c 7275 6e2e  y:class:`~mlrun.
-00016180: 6172 7469 6661 6374 732e 4172 7469 6661  artifacts.Artifa
-00016190: 6374 600a 2020 2020 2020 2020 2020 2020  ct`.            
-000161a0: 6f62 6a65 6374 7320 6f72 2064 6963 7469  objects or dicti
-000161b0: 6f6e 6172 6965 732c 206f 7220 6120 7369  onaries, or a si
-000161c0: 6e67 6c65 206f 626a 6563 742e 0a20 2020  ngle object..   
-000161d0: 2020 2020 203a 7061 7261 6d20 7072 6f6a       :param proj
-000161e0: 6563 743a 2050 726f 6a65 6374 2077 6869  ect: Project whi
-000161f0: 6368 2063 6f6e 7461 696e 7320 7468 6520  ch contains the 
-00016200: 6172 7469 6661 6374 732e 0a20 2020 2020  artifacts..     
-00016210: 2020 203a 7061 7261 6d20 7461 675f 6e61     :param tag_na
-00016220: 6d65 3a20 5468 6520 7461 6720 746f 2073  me: The tag to s
-00016230: 6574 206f 6e20 7468 6520 6172 7469 6661  et on the artifa
-00016240: 6374 732e 0a20 2020 2020 2020 2022 2222  cts..        """
-00016250: 0a20 2020 2020 2020 2074 6167 5f6f 626a  .        tag_obj
-00016260: 6563 7473 203d 2073 656c 662e 5f72 6573  ects = self._res
-00016270: 6f6c 7665 5f61 7274 6966 6163 7473 5f74  olve_artifacts_t
-00016280: 6f5f 7461 675f 6f62 6a65 6374 7328 6172  o_tag_objects(ar
-00016290: 7469 6661 6374 7329 0a20 2020 2020 2020  tifacts).       
-000162a0: 2073 656c 662e 6465 6c65 7465 5f6f 626a   self.delete_obj
-000162b0: 6563 7473 5f74 6167 2870 726f 6a65 6374  ects_tag(project
-000162c0: 2c20 7461 675f 6e61 6d65 2c20 7461 675f  , tag_name, tag_
-000162d0: 6f62 6a65 6374 7329 0a0a 2020 2020 6465  objects)..    de
-000162e0: 6620 6c69 7374 5f70 726f 6a65 6374 7328  f list_projects(
-000162f0: 0a20 2020 2020 2020 2073 656c 662c 0a20  .        self,. 
-00016300: 2020 2020 2020 206f 776e 6572 3a20 7374         owner: st
-00016310: 7220 3d20 4e6f 6e65 2c0a 2020 2020 2020  r = None,.      
-00016320: 2020 666f 726d 6174 5f3a 2055 6e69 6f6e    format_: Union
-00016330: 5b0a 2020 2020 2020 2020 2020 2020 7374  [.            st
-00016340: 722c 206d 6c72 756e 2e61 7069 2e73 6368  r, mlrun.api.sch
-00016350: 656d 6173 2e50 726f 6a65 6374 7346 6f72  emas.ProjectsFor
-00016360: 6d61 740a 2020 2020 2020 2020 5d20 3d20  mat.        ] = 
-00016370: 6d6c 7275 6e2e 6170 692e 7363 6865 6d61  mlrun.api.schema
-00016380: 732e 5072 6f6a 6563 7473 466f 726d 6174  s.ProjectsFormat
-00016390: 2e66 756c 6c2c 0a20 2020 2020 2020 206c  .full,.        l
-000163a0: 6162 656c 733a 204c 6973 745b 7374 725d  abels: List[str]
-000163b0: 203d 204e 6f6e 652c 0a20 2020 2020 2020   = None,.       
-000163c0: 2073 7461 7465 3a20 556e 696f 6e5b 7374   state: Union[st
-000163d0: 722c 206d 6c72 756e 2e61 7069 2e73 6368  r, mlrun.api.sch
-000163e0: 656d 6173 2e50 726f 6a65 6374 5374 6174  emas.ProjectStat
-000163f0: 655d 203d 204e 6f6e 652c 0a20 2020 2029  e] = None,.    )
-00016400: 202d 3e20 4c69 7374 5b55 6e69 6f6e 5b6d   -> List[Union[m
-00016410: 6c72 756e 2e70 726f 6a65 6374 732e 4d6c  lrun.projects.Ml
-00016420: 7275 6e50 726f 6a65 6374 2c20 7374 725d  runProject, str]
-00016430: 5d3a 0a20 2020 2020 2020 2022 2222 5265  ]:.        """Re
-00016440: 7475 726e 2061 206c 6973 7420 6f66 2074  turn a list of t
-00016450: 6865 2065 7869 7374 696e 6720 7072 6f6a  he existing proj
-00016460: 6563 7473 2c20 706f 7465 6e74 6961 6c6c  ects, potentiall
-00016470: 7920 6669 6c74 6572 6564 2062 7920 7370  y filtered by sp
-00016480: 6563 6966 6963 2063 7269 7465 7269 612e  ecific criteria.
-00016490: 0a0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
-000164a0: 206f 776e 6572 3a20 4c69 7374 206f 6e6c   owner: List onl
-000164b0: 7920 7072 6f6a 6563 7473 2062 656c 6f6e  y projects belon
-000164c0: 6769 6e67 2074 6f20 7468 6973 2073 7065  ging to this spe
-000164d0: 6369 6669 6320 6f77 6e65 722e 0a20 2020  cific owner..   
-000164e0: 2020 2020 203a 7061 7261 6d20 666f 726d       :param form
-000164f0: 6174 5f3a 2046 6f72 6d61 7420 6f66 2074  at_: Format of t
-00016500: 6865 2072 6573 756c 7473 2e20 506f 7373  he results. Poss
-00016510: 6962 6c65 2076 616c 7565 7320 6172 653a  ible values are:
-00016520: 0a0a 2020 2020 2020 2020 2020 2020 2d20  ..            - 
-00016530: 6060 6675 6c6c 6060 2028 6465 6661 756c  ``full`` (defaul
-00016540: 7420 7661 6c75 6529 202d 2052 6574 7572  t value) - Retur
-00016550: 6e20 6675 6c6c 2070 726f 6a65 6374 206f  n full project o
-00016560: 626a 6563 7473 2e0a 2020 2020 2020 2020  bjects..        
-00016570: 2020 2020 2d20 6060 6e61 6d65 5f6f 6e6c      - ``name_onl
-00016580: 7960 6020 2d20 5265 7475 726e 206a 7573  y`` - Return jus
-00016590: 7420 7468 6520 6e61 6d65 7320 6f66 2074  t the names of t
-000165a0: 6865 2070 726f 6a65 6374 732e 0a0a 2020  he projects...  
-000165b0: 2020 2020 2020 3a70 6172 616d 206c 6162        :param lab
-000165c0: 656c 733a 2046 696c 7465 7220 6279 206c  els: Filter by l
-000165d0: 6162 656c 7320 6174 7461 6368 6564 2074  abels attached t
-000165e0: 6f20 7468 6520 7072 6f6a 6563 742e 0a20  o the project.. 
-000165f0: 2020 2020 2020 203a 7061 7261 6d20 7374         :param st
-00016600: 6174 653a 2046 696c 7465 7220 6279 2070  ate: Filter by p
-00016610: 726f 6a65 6374 2773 2073 7461 7465 2e20  roject's state. 
-00016620: 4361 6e20 6265 2065 6974 6865 7220 6060  Can be either ``
-00016630: 6f6e 6c69 6e65 6060 206f 7220 6060 6172  online`` or ``ar
-00016640: 6368 6976 6564 6060 2e0a 2020 2020 2020  chived``..      
-00016650: 2020 2222 220a 0a20 2020 2020 2020 2070    """..        p
-00016660: 6172 616d 7320 3d20 7b0a 2020 2020 2020  arams = {.      
-00016670: 2020 2020 2020 226f 776e 6572 223a 206f        "owner": o
-00016680: 776e 6572 2c0a 2020 2020 2020 2020 2020  wner,.          
-00016690: 2020 2273 7461 7465 223a 2073 7461 7465    "state": state
-000166a0: 2c0a 2020 2020 2020 2020 2020 2020 2266  ,.            "f
-000166b0: 6f72 6d61 7422 3a20 666f 726d 6174 5f2c  ormat": format_,
-000166c0: 0a20 2020 2020 2020 2020 2020 2022 6c61  .            "la
-000166d0: 6265 6c22 3a20 6c61 6265 6c73 206f 7220  bel": labels or 
-000166e0: 5b5d 2c0a 2020 2020 2020 2020 7d0a 0a20  [],.        }.. 
-000166f0: 2020 2020 2020 2065 7272 6f72 5f6d 6573         error_mes
-00016700: 7361 6765 203d 2066 2246 6169 6c65 6420  sage = f"Failed 
-00016710: 6c69 7374 696e 6720 7072 6f6a 6563 7473  listing projects
-00016720: 2c20 7175 6572 793a 207b 7061 7261 6d73  , query: {params
-00016730: 7d22 0a20 2020 2020 2020 2072 6573 706f  }".        respo
-00016740: 6e73 6520 3d20 7365 6c66 2e61 7069 5f63  nse = self.api_c
-00016750: 616c 6c28 2247 4554 222c 2022 7072 6f6a  all("GET", "proj
-00016760: 6563 7473 222c 2065 7272 6f72 5f6d 6573  ects", error_mes
-00016770: 7361 6765 2c20 7061 7261 6d73 3d70 6172  sage, params=par
-00016780: 616d 7329 0a20 2020 2020 2020 2069 6620  ams).        if 
-00016790: 666f 726d 6174 5f20 3d3d 206d 6c72 756e  format_ == mlrun
-000167a0: 2e61 7069 2e73 6368 656d 6173 2e50 726f  .api.schemas.Pro
-000167b0: 6a65 6374 7346 6f72 6d61 742e 6e61 6d65  jectsFormat.name
-000167c0: 5f6f 6e6c 793a 0a20 2020 2020 2020 2020  _only:.         
-000167d0: 2020 2072 6574 7572 6e20 7265 7370 6f6e     return respon
-000167e0: 7365 2e6a 736f 6e28 295b 2270 726f 6a65  se.json()["proje
-000167f0: 6374 7322 5d0a 2020 2020 2020 2020 656c  cts"].        el
-00016800: 6966 2066 6f72 6d61 745f 203d 3d20 6d6c  if format_ == ml
-00016810: 7275 6e2e 6170 692e 7363 6865 6d61 732e  run.api.schemas.
-00016820: 5072 6f6a 6563 7473 466f 726d 6174 2e66  ProjectsFormat.f
-00016830: 756c 6c3a 0a20 2020 2020 2020 2020 2020  ull:.           
-00016840: 2072 6574 7572 6e20 5b0a 2020 2020 2020   return [.      
-00016850: 2020 2020 2020 2020 2020 6d6c 7275 6e2e            mlrun.
-00016860: 7072 6f6a 6563 7473 2e4d 6c72 756e 5072  projects.MlrunPr
-00016870: 6f6a 6563 742e 6672 6f6d 5f64 6963 7428  oject.from_dict(
-00016880: 7072 6f6a 6563 745f 6469 6374 290a 2020  project_dict).  
-00016890: 2020 2020 2020 2020 2020 2020 2020 666f                fo
-000168a0: 7220 7072 6f6a 6563 745f 6469 6374 2069  r project_dict i
-000168b0: 6e20 7265 7370 6f6e 7365 2e6a 736f 6e28  n response.json(
-000168c0: 295b 2270 726f 6a65 6374 7322 5d0a 2020  )["projects"].  
-000168d0: 2020 2020 2020 2020 2020 5d0a 2020 2020            ].    
-000168e0: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-000168f0: 2020 2020 2020 7261 6973 6520 4e6f 7449        raise NotI
-00016900: 6d70 6c65 6d65 6e74 6564 4572 726f 7228  mplementedError(
-00016910: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00016920: 2066 2250 726f 7669 6465 6420 666f 726d   f"Provided form
-00016930: 6174 2069 7320 6e6f 7420 7375 7070 6f72  at is not suppor
-00016940: 7465 642e 2066 6f72 6d61 743d 7b66 6f72  ted. format={for
-00016950: 6d61 745f 7d22 0a20 2020 2020 2020 2020  mat_}".         
-00016960: 2020 2029 0a0a 2020 2020 6465 6620 6765     )..    def ge
-00016970: 745f 7072 6f6a 6563 7428 7365 6c66 2c20  t_project(self, 
-00016980: 6e61 6d65 3a20 7374 7229 202d 3e20 6d6c  name: str) -> ml
-00016990: 7275 6e2e 7072 6f6a 6563 7473 2e4d 6c72  run.projects.Mlr
-000169a0: 756e 5072 6f6a 6563 743a 0a20 2020 2020  unProject:.     
-000169b0: 2020 2022 2222 4765 7420 6465 7461 696c     """Get detail
-000169c0: 7320 666f 7220 6120 7370 6563 6966 6963  s for a specific
-000169d0: 2070 726f 6a65 6374 2e22 2222 0a0a 2020   project."""..  
-000169e0: 2020 2020 2020 6966 206e 6f74 206e 616d        if not nam
-000169f0: 653a 0a20 2020 2020 2020 2020 2020 2072  e:.            r
-00016a00: 6169 7365 204d 4c52 756e 496e 7661 6c69  aise MLRunInvali
-00016a10: 6441 7267 756d 656e 7445 7272 6f72 2822  dArgumentError("
-00016a20: 4e61 6d65 206d 7573 7420 6265 2070 726f  Name must be pro
-00016a30: 7669 6465 6422 290a 0a20 2020 2020 2020  vided")..       
-00016a40: 2070 6174 6820 3d20 6622 7072 6f6a 6563   path = f"projec
-00016a50: 7473 2f7b 6e61 6d65 7d22 0a20 2020 2020  ts/{name}".     
-00016a60: 2020 2065 7272 6f72 5f6d 6573 7361 6765     error_message
-00016a70: 203d 2066 2246 6169 6c65 6420 7265 7472   = f"Failed retr
-00016a80: 6965 7669 6e67 2070 726f 6a65 6374 207b  ieving project {
-00016a90: 6e61 6d65 7d22 0a20 2020 2020 2020 2072  name}".        r
-00016aa0: 6573 706f 6e73 6520 3d20 7365 6c66 2e61  esponse = self.a
-00016ab0: 7069 5f63 616c 6c28 2247 4554 222c 2070  pi_call("GET", p
-00016ac0: 6174 682c 2065 7272 6f72 5f6d 6573 7361  ath, error_messa
-00016ad0: 6765 290a 2020 2020 2020 2020 7265 7475  ge).        retu
-00016ae0: 726e 206d 6c72 756e 2e70 726f 6a65 6374  rn mlrun.project
-00016af0: 732e 4d6c 7275 6e50 726f 6a65 6374 2e66  s.MlrunProject.f
-00016b00: 726f 6d5f 6469 6374 2872 6573 706f 6e73  rom_dict(respons
-00016b10: 652e 6a73 6f6e 2829 290a 0a20 2020 2064  e.json())..    d
-00016b20: 6566 2064 656c 6574 655f 7072 6f6a 6563  ef delete_projec
-00016b30: 7428 0a20 2020 2020 2020 2073 656c 662c  t(.        self,
-00016b40: 0a20 2020 2020 2020 206e 616d 653a 2073  .        name: s
-00016b50: 7472 2c0a 2020 2020 2020 2020 6465 6c65  tr,.        dele
-00016b60: 7469 6f6e 5f73 7472 6174 6567 793a 2055  tion_strategy: U
-00016b70: 6e69 6f6e 5b0a 2020 2020 2020 2020 2020  nion[.          
-00016b80: 2020 7374 722c 206d 6c72 756e 2e61 7069    str, mlrun.api
-00016b90: 2e73 6368 656d 6173 2e44 656c 6574 696f  .schemas.Deletio
-00016ba0: 6e53 7472 6174 6567 790a 2020 2020 2020  nStrategy.      
-00016bb0: 2020 5d20 3d20 6d6c 7275 6e2e 6170 692e    ] = mlrun.api.
-00016bc0: 7363 6865 6d61 732e 4465 6c65 7469 6f6e  schemas.Deletion
-00016bd0: 5374 7261 7465 6779 2e64 6566 6175 6c74  Strategy.default
-00016be0: 2829 2c0a 2020 2020 293a 0a20 2020 2020  (),.    ):.     
-00016bf0: 2020 2022 2222 4465 6c65 7465 2061 2070     """Delete a p
-00016c00: 726f 6a65 6374 2e0a 0a20 2020 2020 2020  roject...       
-00016c10: 203a 7061 7261 6d20 6e61 6d65 3a20 4e61   :param name: Na
-00016c20: 6d65 206f 6620 7468 6520 7072 6f6a 6563  me of the projec
-00016c30: 7420 746f 2064 656c 6574 652e 0a20 2020  t to delete..   
-00016c40: 2020 2020 203a 7061 7261 6d20 6465 6c65       :param dele
-00016c50: 7469 6f6e 5f73 7472 6174 6567 793a 2048  tion_strategy: H
-00016c60: 6f77 2074 6f20 7472 6561 7420 6368 696c  ow to treat chil
-00016c70: 6420 6f62 6a65 6374 7320 6f66 2074 6865  d objects of the
-00016c80: 2070 726f 6a65 6374 2e20 506f 7373 6962   project. Possib
-00016c90: 6c65 2076 616c 7565 7320 6172 653a 0a0a  le values are:..
-00016ca0: 2020 2020 2020 2020 2020 2020 2d20 6060              - ``
-00016cb0: 7265 7374 7269 6374 6060 2028 6465 6661  restrict`` (defa
-00016cc0: 756c 7429 202d 2050 726f 6a65 6374 206d  ult) - Project m
-00016cd0: 7573 7420 6e6f 7420 6861 7665 2061 6e79  ust not have any
-00016ce0: 2063 6869 6c64 206f 626a 6563 7473 2077   child objects w
-00016cf0: 6865 6e20 6465 6c65 7465 642e 2049 6620  hen deleted. If 
-00016d00: 7573 696e 6720 7468 6973 206d 6f64 6520  using this mode 
-00016d10: 7768 696c 650a 2020 2020 2020 2020 2020  while.          
-00016d20: 2020 2020 6368 696c 6420 6f62 6a65 6374      child object
-00016d30: 7320 6578 6973 742c 2074 6865 206f 7065  s exist, the ope
-00016d40: 7261 7469 6f6e 2077 696c 6c20 6661 696c  ration will fail
-00016d50: 2e0a 2020 2020 2020 2020 2020 2020 2d20  ..            - 
-00016d60: 6060 6361 7363 6164 6560 6020 2d20 4175  ``cascade`` - Au
-00016d70: 746f 6d61 7469 6361 6c6c 7920 6465 6c65  tomatically dele
-00016d80: 7465 2061 6c6c 2063 6869 6c64 206f 626a  te all child obj
-00016d90: 6563 7473 2077 6865 6e20 6465 6c65 7469  ects when deleti
-00016da0: 6e67 2074 6865 2070 726f 6a65 6374 2e0a  ng the project..
-00016db0: 2020 2020 2020 2020 2222 220a 0a20 2020          """..   
-00016dc0: 2020 2020 2070 6174 6820 3d20 6622 7072       path = f"pr
-00016dd0: 6f6a 6563 7473 2f7b 6e61 6d65 7d22 0a20  ojects/{name}". 
-00016de0: 2020 2020 2020 2068 6561 6465 7273 203d         headers =
-00016df0: 207b 7363 6865 6d61 732e 4865 6164 6572   {schemas.Header
-00016e00: 4e61 6d65 732e 6465 6c65 7469 6f6e 5f73  Names.deletion_s
-00016e10: 7472 6174 6567 793a 2064 656c 6574 696f  trategy: deletio
-00016e20: 6e5f 7374 7261 7465 6779 7d0a 2020 2020  n_strategy}.    
-00016e30: 2020 2020 6572 726f 725f 6d65 7373 6167      error_messag
-00016e40: 6520 3d20 6622 4661 696c 6564 2064 656c  e = f"Failed del
-00016e50: 6574 696e 6720 7072 6f6a 6563 7420 7b6e  eting project {n
-00016e60: 616d 657d 220a 2020 2020 2020 2020 7265  ame}".        re
-00016e70: 7370 6f6e 7365 203d 2073 656c 662e 6170  sponse = self.ap
-00016e80: 695f 6361 6c6c 2822 4445 4c45 5445 222c  i_call("DELETE",
-00016e90: 2070 6174 682c 2065 7272 6f72 5f6d 6573   path, error_mes
-00016ea0: 7361 6765 2c20 6865 6164 6572 733d 6865  sage, headers=he
-00016eb0: 6164 6572 7329 0a20 2020 2020 2020 2069  aders).        i
-00016ec0: 6620 7265 7370 6f6e 7365 2e73 7461 7475  f response.statu
-00016ed0: 735f 636f 6465 203d 3d20 6874 7470 2e48  s_code == http.H
-00016ee0: 5454 5053 7461 7475 732e 4143 4345 5054  TTPStatus.ACCEPT
-00016ef0: 4544 3a0a 2020 2020 2020 2020 2020 2020  ED:.            
-00016f00: 7265 7475 726e 2073 656c 662e 5f77 6169  return self._wai
-00016f10: 745f 666f 725f 7072 6f6a 6563 745f 746f  t_for_project_to
-00016f20: 5f62 655f 6465 6c65 7465 6428 6e61 6d65  _be_deleted(name
-00016f30: 290a 0a20 2020 2064 6566 2073 746f 7265  )..    def store
-00016f40: 5f70 726f 6a65 6374 280a 2020 2020 2020  _project(.      
-00016f50: 2020 7365 6c66 2c0a 2020 2020 2020 2020    self,.        
-00016f60: 6e61 6d65 3a20 7374 722c 0a20 2020 2020  name: str,.     
-00016f70: 2020 2070 726f 6a65 6374 3a20 556e 696f     project: Unio
-00016f80: 6e5b 6469 6374 2c20 6d6c 7275 6e2e 7072  n[dict, mlrun.pr
-00016f90: 6f6a 6563 7473 2e4d 6c72 756e 5072 6f6a  ojects.MlrunProj
-00016fa0: 6563 742c 206d 6c72 756e 2e61 7069 2e73  ect, mlrun.api.s
-00016fb0: 6368 656d 6173 2e50 726f 6a65 6374 5d2c  chemas.Project],
-00016fc0: 0a20 2020 2029 202d 3e20 6d6c 7275 6e2e  .    ) -> mlrun.
-00016fd0: 7072 6f6a 6563 7473 2e4d 6c72 756e 5072  projects.MlrunPr
-00016fe0: 6f6a 6563 743a 0a20 2020 2020 2020 2022  oject:.        "
-00016ff0: 2222 5374 6f72 6520 6120 7072 6f6a 6563  ""Store a projec
-00017000: 7420 696e 2074 6865 2044 422e 2054 6869  t in the DB. Thi
-00017010: 7320 6f70 6572 6174 696f 6e20 7769 6c6c  s operation will
-00017020: 206f 7665 7277 7269 7465 2065 7869 7374   overwrite exist
-00017030: 696e 6720 7072 6f6a 6563 7420 6f66 2074  ing project of t
-00017040: 6865 2073 616d 6520 6e61 6d65 2069 6620  he same name if 
-00017050: 6578 6973 7473 2e22 2222 0a0a 2020 2020  exists."""..    
-00017060: 2020 2020 7061 7468 203d 2066 2270 726f      path = f"pro
-00017070: 6a65 6374 732f 7b6e 616d 657d 220a 2020  jects/{name}".  
-00017080: 2020 2020 2020 6572 726f 725f 6d65 7373        error_mess
-00017090: 6167 6520 3d20 6622 4661 696c 6564 2073  age = f"Failed s
-000170a0: 746f 7269 6e67 2070 726f 6a65 6374 207b  toring project {
-000170b0: 6e61 6d65 7d22 0a20 2020 2020 2020 2069  name}".        i
-000170c0: 6620 6973 696e 7374 616e 6365 2870 726f  f isinstance(pro
-000170d0: 6a65 6374 2c20 6d6c 7275 6e2e 6170 692e  ject, mlrun.api.
-000170e0: 7363 6865 6d61 732e 5072 6f6a 6563 7429  schemas.Project)
-000170f0: 3a0a 2020 2020 2020 2020 2020 2020 7072  :.            pr
-00017100: 6f6a 6563 7420 3d20 7072 6f6a 6563 742e  oject = project.
-00017110: 6469 6374 2829 0a20 2020 2020 2020 2065  dict().        e
-00017120: 6c69 6620 6973 696e 7374 616e 6365 2870  lif isinstance(p
-00017130: 726f 6a65 6374 2c20 6d6c 7275 6e2e 7072  roject, mlrun.pr
-00017140: 6f6a 6563 7473 2e4d 6c72 756e 5072 6f6a  ojects.MlrunProj
-00017150: 6563 7429 3a0a 2020 2020 2020 2020 2020  ect):.          
-00017160: 2020 7072 6f6a 6563 7420 3d20 7072 6f6a    project = proj
-00017170: 6563 742e 746f 5f64 6963 7428 290a 2020  ect.to_dict().  
-00017180: 2020 2020 2020 7265 7370 6f6e 7365 203d        response =
-00017190: 2073 656c 662e 6170 695f 6361 6c6c 280a   self.api_call(.
-000171a0: 2020 2020 2020 2020 2020 2020 2250 5554              "PUT
-000171b0: 222c 0a20 2020 2020 2020 2020 2020 2070  ",.            p
-000171c0: 6174 682c 0a20 2020 2020 2020 2020 2020  ath,.           
-000171d0: 2065 7272 6f72 5f6d 6573 7361 6765 2c0a   error_message,.
-000171e0: 2020 2020 2020 2020 2020 2020 626f 6479              body
-000171f0: 3d64 6963 745f 746f 5f6a 736f 6e28 7072  =dict_to_json(pr
-00017200: 6f6a 6563 7429 2c0a 2020 2020 2020 2020  oject),.        
-00017210: 290a 2020 2020 2020 2020 6966 2072 6573  ).        if res
-00017220: 706f 6e73 652e 7374 6174 7573 5f63 6f64  ponse.status_cod
-00017230: 6520 3d3d 2068 7474 702e 4854 5450 5374  e == http.HTTPSt
-00017240: 6174 7573 2e41 4343 4550 5445 443a 0a20  atus.ACCEPTED:. 
-00017250: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-00017260: 6e20 7365 6c66 2e5f 7761 6974 5f66 6f72  n self._wait_for
-00017270: 5f70 726f 6a65 6374 5f74 6f5f 7265 6163  _project_to_reac
-00017280: 685f 7465 726d 696e 616c 5f73 7461 7465  h_terminal_state
-00017290: 286e 616d 6529 0a20 2020 2020 2020 2072  (name).        r
-000172a0: 6574 7572 6e20 6d6c 7275 6e2e 7072 6f6a  eturn mlrun.proj
-000172b0: 6563 7473 2e4d 6c72 756e 5072 6f6a 6563  ects.MlrunProjec
-000172c0: 742e 6672 6f6d 5f64 6963 7428 7265 7370  t.from_dict(resp
-000172d0: 6f6e 7365 2e6a 736f 6e28 2929 0a0a 2020  onse.json())..  
-000172e0: 2020 6465 6620 7061 7463 685f 7072 6f6a    def patch_proj
-000172f0: 6563 7428 0a20 2020 2020 2020 2073 656c  ect(.        sel
-00017300: 662c 0a20 2020 2020 2020 206e 616d 653a  f,.        name:
-00017310: 2073 7472 2c0a 2020 2020 2020 2020 7072   str,.        pr
-00017320: 6f6a 6563 743a 2064 6963 742c 0a20 2020  oject: dict,.   
-00017330: 2020 2020 2070 6174 6368 5f6d 6f64 653a       patch_mode:
-00017340: 2055 6e69 6f6e 5b73 7472 2c20 7363 6865   Union[str, sche
-00017350: 6d61 732e 5061 7463 684d 6f64 655d 203d  mas.PatchMode] =
-00017360: 2073 6368 656d 6173 2e50 6174 6368 4d6f   schemas.PatchMo
-00017370: 6465 2e72 6570 6c61 6365 2c0a 2020 2020  de.replace,.    
-00017380: 2920 2d3e 206d 6c72 756e 2e70 726f 6a65  ) -> mlrun.proje
-00017390: 6374 732e 4d6c 7275 6e50 726f 6a65 6374  cts.MlrunProject
-000173a0: 3a0a 2020 2020 2020 2020 2222 2250 6174  :.        """Pat
-000173b0: 6368 2061 6e20 6578 6973 7469 6e67 2070  ch an existing p
-000173c0: 726f 6a65 6374 206f 626a 6563 742e 0a0a  roject object...
-000173d0: 2020 2020 2020 2020 3a70 6172 616d 206e          :param n
-000173e0: 616d 653a 204e 616d 6520 6f66 2070 726f  ame: Name of pro
-000173f0: 6a65 6374 2074 6f20 7061 7463 682e 0a20  ject to patch.. 
-00017400: 2020 2020 2020 203a 7061 7261 6d20 7072         :param pr
-00017410: 6f6a 6563 743a 2054 6865 2061 6374 7561  oject: The actua
-00017420: 6c20 6368 616e 6765 7320 746f 2074 6865  l changes to the
-00017430: 2070 726f 6a65 6374 206f 626a 6563 742e   project object.
-00017440: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
-00017450: 7061 7463 685f 6d6f 6465 3a20 5468 6520  patch_mode: The 
-00017460: 7374 7261 7465 6779 2066 6f72 206d 6572  strategy for mer
-00017470: 6769 6e67 2074 6865 2063 6861 6e67 6573  ging the changes
-00017480: 2077 6974 6820 7468 6520 6578 6973 7469   with the existi
-00017490: 6e67 206f 626a 6563 742e 2043 616e 2062  ng object. Can b
-000174a0: 6520 6569 7468 6572 2060 6072 6570 6c61  e either ``repla
-000174b0: 6365 6060 0a20 2020 2020 2020 2020 2020  ce``.           
-000174c0: 206f 7220 6060 6164 6469 7469 7665 6060   or ``additive``
-000174d0: 2e0a 2020 2020 2020 2020 2222 220a 0a20  ..        """.. 
-000174e0: 2020 2020 2020 2070 6174 6820 3d20 6622         path = f"
-000174f0: 7072 6f6a 6563 7473 2f7b 6e61 6d65 7d22  projects/{name}"
-00017500: 0a20 2020 2020 2020 2068 6561 6465 7273  .        headers
-00017510: 203d 207b 7363 6865 6d61 732e 4865 6164   = {schemas.Head
-00017520: 6572 4e61 6d65 732e 7061 7463 685f 6d6f  erNames.patch_mo
-00017530: 6465 3a20 7061 7463 685f 6d6f 6465 7d0a  de: patch_mode}.
-00017540: 2020 2020 2020 2020 6572 726f 725f 6d65          error_me
-00017550: 7373 6167 6520 3d20 6622 4661 696c 6564  ssage = f"Failed
-00017560: 2070 6174 6368 696e 6720 7072 6f6a 6563   patching projec
-00017570: 7420 7b6e 616d 657d 220a 2020 2020 2020  t {name}".      
-00017580: 2020 7265 7370 6f6e 7365 203d 2073 656c    response = sel
-00017590: 662e 6170 695f 6361 6c6c 280a 2020 2020  f.api_call(.    
-000175a0: 2020 2020 2020 2020 2250 4154 4348 222c          "PATCH",
-000175b0: 2070 6174 682c 2065 7272 6f72 5f6d 6573   path, error_mes
-000175c0: 7361 6765 2c20 626f 6479 3d64 6963 745f  sage, body=dict_
-000175d0: 746f 5f6a 736f 6e28 7072 6f6a 6563 7429  to_json(project)
-000175e0: 2c20 6865 6164 6572 733d 6865 6164 6572  , headers=header
-000175f0: 730a 2020 2020 2020 2020 290a 2020 2020  s.        ).    
-00017600: 2020 2020 7265 7475 726e 206d 6c72 756e      return mlrun
-00017610: 2e70 726f 6a65 6374 732e 4d6c 7275 6e50  .projects.MlrunP
-00017620: 726f 6a65 6374 2e66 726f 6d5f 6469 6374  roject.from_dict
-00017630: 2872 6573 706f 6e73 652e 6a73 6f6e 2829  (response.json()
-00017640: 290a 0a20 2020 2064 6566 2063 7265 6174  )..    def creat
-00017650: 655f 7072 6f6a 6563 7428 0a20 2020 2020  e_project(.     
-00017660: 2020 2073 656c 662c 0a20 2020 2020 2020     self,.       
-00017670: 2070 726f 6a65 6374 3a20 556e 696f 6e5b   project: Union[
-00017680: 6469 6374 2c20 6d6c 7275 6e2e 7072 6f6a  dict, mlrun.proj
-00017690: 6563 7473 2e4d 6c72 756e 5072 6f6a 6563  ects.MlrunProjec
-000176a0: 742c 206d 6c72 756e 2e61 7069 2e73 6368  t, mlrun.api.sch
-000176b0: 656d 6173 2e50 726f 6a65 6374 5d2c 0a20  emas.Project],. 
-000176c0: 2020 2029 202d 3e20 6d6c 7275 6e2e 7072     ) -> mlrun.pr
-000176d0: 6f6a 6563 7473 2e4d 6c72 756e 5072 6f6a  ojects.MlrunProj
-000176e0: 6563 743a 0a20 2020 2020 2020 2022 2222  ect:.        """
-000176f0: 4372 6561 7465 2061 206e 6577 2070 726f  Create a new pro
-00017700: 6a65 6374 2e20 4120 7072 6f6a 6563 7420  ject. A project 
-00017710: 7769 7468 2074 6865 2073 616d 6520 6e61  with the same na
-00017720: 6d65 206d 7573 7420 6e6f 7420 6578 6973  me must not exis
-00017730: 7420 7072 696f 7220 746f 2063 7265 6174  t prior to creat
-00017740: 696f 6e2e 2222 220a 0a20 2020 2020 2020  ion."""..       
-00017750: 2069 6620 6973 696e 7374 616e 6365 2870   if isinstance(p
-00017760: 726f 6a65 6374 2c20 6d6c 7275 6e2e 6170  roject, mlrun.ap
-00017770: 692e 7363 6865 6d61 732e 5072 6f6a 6563  i.schemas.Projec
-00017780: 7429 3a0a 2020 2020 2020 2020 2020 2020  t):.            
-00017790: 7072 6f6a 6563 7420 3d20 7072 6f6a 6563  project = projec
-000177a0: 742e 6469 6374 2829 0a20 2020 2020 2020  t.dict().       
-000177b0: 2065 6c69 6620 6973 696e 7374 616e 6365   elif isinstance
-000177c0: 2870 726f 6a65 6374 2c20 6d6c 7275 6e2e  (project, mlrun.
-000177d0: 7072 6f6a 6563 7473 2e4d 6c72 756e 5072  projects.MlrunPr
-000177e0: 6f6a 6563 7429 3a0a 2020 2020 2020 2020  oject):.        
-000177f0: 2020 2020 7072 6f6a 6563 7420 3d20 7072      project = pr
-00017800: 6f6a 6563 742e 746f 5f64 6963 7428 290a  oject.to_dict().
-00017810: 2020 2020 2020 2020 7072 6f6a 6563 745f          project_
-00017820: 6e61 6d65 203d 2070 726f 6a65 6374 5b22  name = project["
-00017830: 6d65 7461 6461 7461 225d 5b22 6e61 6d65  metadata"]["name
-00017840: 225d 0a20 2020 2020 2020 2065 7272 6f72  "].        error
-00017850: 5f6d 6573 7361 6765 203d 2066 2246 6169  _message = f"Fai
-00017860: 6c65 6420 6372 6561 7469 6e67 2070 726f  led creating pro
-00017870: 6a65 6374 207b 7072 6f6a 6563 745f 6e61  ject {project_na
-00017880: 6d65 7d22 0a20 2020 2020 2020 2072 6573  me}".        res
-00017890: 706f 6e73 6520 3d20 7365 6c66 2e61 7069  ponse = self.api
-000178a0: 5f63 616c 6c28 0a20 2020 2020 2020 2020  _call(.         
-000178b0: 2020 2022 504f 5354 222c 0a20 2020 2020     "POST",.     
-000178c0: 2020 2020 2020 2022 7072 6f6a 6563 7473         "projects
-000178d0: 222c 0a20 2020 2020 2020 2020 2020 2065  ",.            e
-000178e0: 7272 6f72 5f6d 6573 7361 6765 2c0a 2020  rror_message,.  
-000178f0: 2020 2020 2020 2020 2020 626f 6479 3d64            body=d
-00017900: 6963 745f 746f 5f6a 736f 6e28 7072 6f6a  ict_to_json(proj
-00017910: 6563 7429 2c0a 2020 2020 2020 2020 290a  ect),.        ).
-00017920: 2020 2020 2020 2020 6966 2072 6573 706f          if respo
-00017930: 6e73 652e 7374 6174 7573 5f63 6f64 6520  nse.status_code 
-00017940: 3d3d 2068 7474 702e 4854 5450 5374 6174  == http.HTTPStat
-00017950: 7573 2e41 4343 4550 5445 443a 0a20 2020  us.ACCEPTED:.   
-00017960: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-00017970: 7365 6c66 2e5f 7761 6974 5f66 6f72 5f70  self._wait_for_p
-00017980: 726f 6a65 6374 5f74 6f5f 7265 6163 685f  roject_to_reach_
-00017990: 7465 726d 696e 616c 5f73 7461 7465 2870  terminal_state(p
-000179a0: 726f 6a65 6374 5f6e 616d 6529 0a20 2020  roject_name).   
-000179b0: 2020 2020 2072 6574 7572 6e20 6d6c 7275       return mlru
-000179c0: 6e2e 7072 6f6a 6563 7473 2e4d 6c72 756e  n.projects.Mlrun
-000179d0: 5072 6f6a 6563 742e 6672 6f6d 5f64 6963  Project.from_dic
-000179e0: 7428 7265 7370 6f6e 7365 2e6a 736f 6e28  t(response.json(
-000179f0: 2929 0a0a 2020 2020 6465 6620 5f77 6169  ))..    def _wai
-00017a00: 745f 666f 725f 7072 6f6a 6563 745f 746f  t_for_project_to
-00017a10: 5f72 6561 6368 5f74 6572 6d69 6e61 6c5f  _reach_terminal_
-00017a20: 7374 6174 6528 0a20 2020 2020 2020 2073  state(.        s
-00017a30: 656c 662c 2070 726f 6a65 6374 5f6e 616d  elf, project_nam
-00017a40: 653a 2073 7472 0a20 2020 2029 202d 3e20  e: str.    ) -> 
-00017a50: 6d6c 7275 6e2e 7072 6f6a 6563 7473 2e4d  mlrun.projects.M
-00017a60: 6c72 756e 5072 6f6a 6563 743a 0a20 2020  lrunProject:.   
-00017a70: 2020 2020 2064 6566 205f 7665 7269 6679       def _verify
-00017a80: 5f70 726f 6a65 6374 5f69 6e5f 7465 726d  _project_in_term
-00017a90: 696e 616c 5f73 7461 7465 2829 3a0a 2020  inal_state():.  
-00017aa0: 2020 2020 2020 2020 2020 7072 6f6a 6563            projec
-00017ab0: 7420 3d20 7365 6c66 2e67 6574 5f70 726f  t = self.get_pro
-00017ac0: 6a65 6374 2870 726f 6a65 6374 5f6e 616d  ject(project_nam
-00017ad0: 6529 0a20 2020 2020 2020 2020 2020 2069  e).            i
-00017ae0: 6620 280a 2020 2020 2020 2020 2020 2020  f (.            
-00017af0: 2020 2020 7072 6f6a 6563 742e 7374 6174      project.stat
-00017b00: 7573 2e73 7461 7465 0a20 2020 2020 2020  us.state.       
-00017b10: 2020 2020 2020 2020 206e 6f74 2069 6e20           not in 
-00017b20: 6d6c 7275 6e2e 6170 692e 7363 6865 6d61  mlrun.api.schema
-00017b30: 732e 5072 6f6a 6563 7453 7461 7465 2e74  s.ProjectState.t
-00017b40: 6572 6d69 6e61 6c5f 7374 6174 6573 2829  erminal_states()
-00017b50: 0a20 2020 2020 2020 2020 2020 2029 3a0a  .            ):.
-00017b60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017b70: 7261 6973 6520 4578 6365 7074 696f 6e28  raise Exception(
-00017b80: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00017b90: 2020 2020 2066 2250 726f 6a65 6374 206e       f"Project n
-00017ba0: 6f74 2069 6e20 7465 726d 696e 616c 2073  ot in terminal s
-00017bb0: 7461 7465 2e20 5374 6174 653a 207b 7072  tate. State: {pr
-00017bc0: 6f6a 6563 742e 7374 6174 7573 2e73 7461  oject.status.sta
-00017bd0: 7465 7d22 0a20 2020 2020 2020 2020 2020  te}".           
-00017be0: 2020 2020 2029 0a20 2020 2020 2020 2020       ).         
-00017bf0: 2020 2072 6574 7572 6e20 7072 6f6a 6563     return projec
-00017c00: 740a 0a20 2020 2020 2020 2072 6574 7572  t..        retur
-00017c10: 6e20 6d6c 7275 6e2e 7574 696c 732e 6865  n mlrun.utils.he
-00017c20: 6c70 6572 732e 7265 7472 795f 756e 7469  lpers.retry_unti
-00017c30: 6c5f 7375 6363 6573 7366 756c 280a 2020  l_successful(.  
-00017c40: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
-00017c50: 7761 6974 5f66 6f72 5f70 726f 6a65 6374  wait_for_project
-00017c60: 5f74 6572 6d69 6e61 6c5f 7374 6174 655f  _terminal_state_
-00017c70: 7265 7472 795f 696e 7465 7276 616c 2c0a  retry_interval,.
-00017c80: 2020 2020 2020 2020 2020 2020 3132 302c              120,
-00017c90: 0a20 2020 2020 2020 2020 2020 206c 6f67  .            log
-00017ca0: 6765 722c 0a20 2020 2020 2020 2020 2020  ger,.           
-00017cb0: 2046 616c 7365 2c0a 2020 2020 2020 2020   False,.        
-00017cc0: 2020 2020 5f76 6572 6966 795f 7072 6f6a      _verify_proj
-00017cd0: 6563 745f 696e 5f74 6572 6d69 6e61 6c5f  ect_in_terminal_
-00017ce0: 7374 6174 652c 0a20 2020 2020 2020 2029  state,.        )
-00017cf0: 0a0a 2020 2020 6465 6620 5f77 6169 745f  ..    def _wait_
-00017d00: 666f 725f 6261 636b 6772 6f75 6e64 5f74  for_background_t
-00017d10: 6173 6b5f 746f 5f72 6561 6368 5f74 6572  ask_to_reach_ter
-00017d20: 6d69 6e61 6c5f 7374 6174 6528 0a20 2020  minal_state(.   
-00017d30: 2020 2020 2073 656c 662c 206e 616d 653a       self, name:
-00017d40: 2073 7472 0a20 2020 2029 202d 3e20 7363   str.    ) -> sc
-00017d50: 6865 6d61 732e 4261 636b 6772 6f75 6e64  hemas.Background
-00017d60: 5461 736b 3a0a 2020 2020 2020 2020 6465  Task:.        de
-00017d70: 6620 5f76 6572 6966 795f 6261 636b 6772  f _verify_backgr
-00017d80: 6f75 6e64 5f74 6173 6b5f 696e 5f74 6572  ound_task_in_ter
-00017d90: 6d69 6e61 6c5f 7374 6174 6528 293a 0a20  minal_state():. 
-00017da0: 2020 2020 2020 2020 2020 2062 6163 6b67             backg
-00017db0: 726f 756e 645f 7461 736b 203d 2073 656c  round_task = sel
-00017dc0: 662e 6765 745f 6261 636b 6772 6f75 6e64  f.get_background
-00017dd0: 5f74 6173 6b28 6e61 6d65 290a 2020 2020  _task(name).    
-00017de0: 2020 2020 2020 2020 7374 6174 6520 3d20          state = 
-00017df0: 6261 636b 6772 6f75 6e64 5f74 6173 6b2e  background_task.
-00017e00: 7374 6174 7573 2e73 7461 7465 0a20 2020  status.state.   
-00017e10: 2020 2020 2020 2020 2069 6620 7374 6174           if stat
-00017e20: 6520 6e6f 7420 696e 206d 6c72 756e 2e61  e not in mlrun.a
-00017e30: 7069 2e73 6368 656d 6173 2e42 6163 6b67  pi.schemas.Backg
-00017e40: 726f 756e 6454 6173 6b53 7461 7465 2e74  roundTaskState.t
-00017e50: 6572 6d69 6e61 6c5f 7374 6174 6573 2829  erminal_states()
-00017e60: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00017e70: 2020 7261 6973 6520 4578 6365 7074 696f    raise Exceptio
-00017e80: 6e28 0a20 2020 2020 2020 2020 2020 2020  n(.             
-00017e90: 2020 2020 2020 2066 2242 6163 6b67 726f         f"Backgro
-00017ea0: 756e 6420 7461 736b 206e 6f74 2069 6e20  und task not in 
-00017eb0: 7465 726d 696e 616c 2073 7461 7465 2e20  terminal state. 
-00017ec0: 6e61 6d65 3d7b 6e61 6d65 7d2c 2073 7461  name={name}, sta
-00017ed0: 7465 3d7b 7374 6174 657d 220a 2020 2020  te={state}".    
-00017ee0: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
-00017ef0: 2020 2020 2020 2020 2020 7265 7475 726e            return
-00017f00: 2062 6163 6b67 726f 756e 645f 7461 736b   background_task
-00017f10: 0a0a 2020 2020 2020 2020 7265 7475 726e  ..        return
-00017f20: 206d 6c72 756e 2e75 7469 6c73 2e68 656c   mlrun.utils.hel
-00017f30: 7065 7273 2e72 6574 7279 5f75 6e74 696c  pers.retry_until
-00017f40: 5f73 7563 6365 7373 6675 6c28 0a20 2020  _successful(.   
-00017f50: 2020 2020 2020 2020 2073 656c 662e 5f77           self._w
-00017f60: 6169 745f 666f 725f 6261 636b 6772 6f75  ait_for_backgrou
-00017f70: 6e64 5f74 6173 6b5f 7465 726d 696e 616c  nd_task_terminal
-00017f80: 5f73 7461 7465 5f72 6574 7279 5f69 6e74  _state_retry_int
-00017f90: 6572 7661 6c2c 0a20 2020 2020 2020 2020  erval,.         
-00017fa0: 2020 2036 3020 2a20 3630 2c0a 2020 2020     60 * 60,.    
-00017fb0: 2020 2020 2020 2020 6c6f 6767 6572 2c0a          logger,.
-00017fc0: 2020 2020 2020 2020 2020 2020 4661 6c73              Fals
-00017fd0: 652c 0a20 2020 2020 2020 2020 2020 205f  e,.            _
-00017fe0: 7665 7269 6679 5f62 6163 6b67 726f 756e  verify_backgroun
-00017ff0: 645f 7461 736b 5f69 6e5f 7465 726d 696e  d_task_in_termin
-00018000: 616c 5f73 7461 7465 2c0a 2020 2020 2020  al_state,.      
-00018010: 2020 290a 0a20 2020 2064 6566 205f 7761    )..    def _wa
-00018020: 6974 5f66 6f72 5f70 726f 6a65 6374 5f74  it_for_project_t
-00018030: 6f5f 6265 5f64 656c 6574 6564 2873 656c  o_be_deleted(sel
-00018040: 662c 2070 726f 6a65 6374 5f6e 616d 653a  f, project_name:
-00018050: 2073 7472 293a 0a20 2020 2020 2020 2064   str):.        d
-00018060: 6566 205f 7665 7269 6679 5f70 726f 6a65  ef _verify_proje
-00018070: 6374 5f64 656c 6574 6564 2829 3a0a 2020  ct_deleted():.  
-00018080: 2020 2020 2020 2020 2020 7072 6f6a 6563            projec
-00018090: 7473 203d 2073 656c 662e 6c69 7374 5f70  ts = self.list_p
-000180a0: 726f 6a65 6374 7328 0a20 2020 2020 2020  rojects(.       
-000180b0: 2020 2020 2020 2020 2066 6f72 6d61 745f           format_
-000180c0: 3d6d 6c72 756e 2e61 7069 2e73 6368 656d  =mlrun.api.schem
-000180d0: 6173 2e50 726f 6a65 6374 7346 6f72 6d61  as.ProjectsForma
-000180e0: 742e 6e61 6d65 5f6f 6e6c 790a 2020 2020  t.name_only.    
-000180f0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-00018100: 2020 2020 2020 6966 2070 726f 6a65 6374        if project
-00018110: 5f6e 616d 6520 696e 2070 726f 6a65 6374  _name in project
-00018120: 733a 0a20 2020 2020 2020 2020 2020 2020  s:.             
-00018130: 2020 2072 6169 7365 2045 7863 6570 7469     raise Excepti
-00018140: 6f6e 2822 5072 6f6a 6563 7420 7374 696c  on("Project stil
-00018150: 6c20 6578 6973 7473 2229 0a0a 2020 2020  l exists")..    
-00018160: 2020 2020 7265 7475 726e 206d 6c72 756e      return mlrun
-00018170: 2e75 7469 6c73 2e68 656c 7065 7273 2e72  .utils.helpers.r
-00018180: 6574 7279 5f75 6e74 696c 5f73 7563 6365  etry_until_succe
-00018190: 7373 6675 6c28 0a20 2020 2020 2020 2020  ssful(.         
-000181a0: 2020 2073 656c 662e 5f77 6169 745f 666f     self._wait_fo
-000181b0: 725f 7072 6f6a 6563 745f 6465 6c65 7469  r_project_deleti
-000181c0: 6f6e 5f69 6e74 6572 7661 6c2c 0a20 2020  on_interval,.   
-000181d0: 2020 2020 2020 2020 2031 3230 2c0a 2020           120,.  
-000181e0: 2020 2020 2020 2020 2020 6c6f 6767 6572            logger
-000181f0: 2c0a 2020 2020 2020 2020 2020 2020 4661  ,.            Fa
-00018200: 6c73 652c 0a20 2020 2020 2020 2020 2020  lse,.           
-00018210: 205f 7665 7269 6679 5f70 726f 6a65 6374   _verify_project
-00018220: 5f64 656c 6574 6564 2c0a 2020 2020 2020  _deleted,.      
-00018230: 2020 290a 0a20 2020 2064 6566 2063 7265    )..    def cre
-00018240: 6174 655f 7072 6f6a 6563 745f 7365 6372  ate_project_secr
-00018250: 6574 7328 0a20 2020 2020 2020 2073 656c  ets(.        sel
-00018260: 662c 0a20 2020 2020 2020 2070 726f 6a65  f,.        proje
-00018270: 6374 3a20 7374 722c 0a20 2020 2020 2020  ct: str,.       
-00018280: 2070 726f 7669 6465 723a 2055 6e69 6f6e   provider: Union
-00018290: 5b0a 2020 2020 2020 2020 2020 2020 7374  [.            st
-000182a0: 722c 2073 6368 656d 6173 2e53 6563 7265  r, schemas.Secre
-000182b0: 7450 726f 7669 6465 724e 616d 650a 2020  tProviderName.  
-000182c0: 2020 2020 2020 5d20 3d20 7363 6865 6d61        ] = schema
-000182d0: 732e 5365 6372 6574 5072 6f76 6964 6572  s.SecretProvider
-000182e0: 4e61 6d65 2e6b 7562 6572 6e65 7465 732c  Name.kubernetes,
-000182f0: 0a20 2020 2020 2020 2073 6563 7265 7473  .        secrets
-00018300: 3a20 6469 6374 203d 204e 6f6e 652c 0a20  : dict = None,. 
-00018310: 2020 2029 3a0a 2020 2020 2020 2020 2222     ):.        ""
-00018320: 2243 7265 6174 6520 7072 6f6a 6563 742d  "Create project-
-00018330: 636f 6e74 6578 7420 7365 6372 6574 7320  context secrets 
-00018340: 7573 696e 6720 6569 7468 6572 2060 6076  using either ``v
-00018350: 6175 6c74 6060 206f 7220 6060 6b75 6265  ault`` or ``kube
-00018360: 726e 6574 6573 6060 2070 726f 7669 6465  rnetes`` provide
-00018370: 722e 0a20 2020 2020 2020 2057 6865 6e20  r..        When 
-00018380: 7573 696e 6720 7769 7468 2056 6175 6c74  using with Vault
-00018390: 2c20 7468 6973 2077 696c 6c20 6372 6561  , this will crea
-000183a0: 7465 206e 6565 6465 6420 5661 756c 7420  te needed Vault 
-000183b0: 7374 7275 6374 7572 6573 2066 6f72 2073  structures for s
-000183c0: 746f 7269 6e67 2073 6563 7265 7473 2069  toring secrets i
-000183d0: 6e20 7072 6f6a 6563 742d 636f 6e74 6578  n project-contex
-000183e0: 742c 2061 6e64 0a20 2020 2020 2020 2073  t, and.        s
-000183f0: 746f 7265 2061 2073 6574 206f 6620 7365  tore a set of se
-00018400: 6372 6574 2076 616c 7565 732e 2054 6865  cret values. The
-00018410: 206d 6574 686f 6420 6765 6e65 7261 7465   method generate
-00018420: 7320 4b75 6265 726e 6574 6573 2073 6572  s Kubernetes ser
-00018430: 7669 6365 2d61 6363 6f75 6e74 2061 6e64  vice-account and
-00018440: 2074 6865 2056 6175 6c74 2061 7574 6865   the Vault authe
-00018450: 6e74 6963 6174 696f 6e0a 2020 2020 2020  ntication.      
-00018460: 2020 7374 7275 6374 7572 6573 2074 6861    structures tha
-00018470: 7420 6172 6520 7265 7175 6972 6564 2066  t are required f
-00018480: 6f72 2066 756e 6374 696f 6e20 506f 6473  or function Pods
-00018490: 2074 6f20 6175 7468 656e 7469 6361 7465   to authenticate
-000184a0: 2077 6974 6820 5661 756c 7420 616e 6420   with Vault and 
-000184b0: 6265 2061 626c 6520 746f 2065 7874 7261  be able to extra
-000184c0: 6374 2073 6563 7265 7420 7661 6c75 6573  ct secret values
-000184d0: 0a20 2020 2020 2020 2070 6173 7365 6420  .        passed 
-000184e0: 6173 2070 6172 7420 6f66 2074 6865 6972  as part of their
-000184f0: 2063 6f6e 7465 7874 2e0a 0a20 2020 2020   context...     
-00018500: 2020 204e 6f74 653a 0a20 2020 2020 2020     Note:.       
-00018510: 2020 2020 2020 2020 2054 6869 7320 6d65           This me
-00018520: 7468 6f64 2075 7365 6420 7769 7468 2056  thod used with V
-00018530: 6175 6c74 2069 7320 6375 7272 656e 746c  ault is currentl
-00018540: 7920 696e 2074 6563 686e 6963 616c 2070  y in technical p
-00018550: 7265 7669 6577 2c20 616e 6420 7265 7175  review, and requ
-00018560: 6972 6573 2061 2048 6173 6869 436f 7270  ires a HashiCorp
-00018570: 2056 6175 6c74 0a20 2020 2020 2020 2020   Vault.         
-00018580: 2020 2020 2020 2069 6e66 7261 7374 7275         infrastru
-00018590: 6374 7572 6520 7072 6f70 6572 6c79 2073  cture properly s
-000185a0: 6574 2075 7020 616e 6420 636f 6e6e 6563  et up and connec
-000185b0: 7465 6420 746f 2074 6865 204d 4c52 756e  ted to the MLRun
-000185c0: 2041 5049 2073 6572 7665 722e 0a0a 2020   API server...  
-000185d0: 2020 2020 2020 5768 656e 2075 7365 6420        When used 
-000185e0: 7769 7468 204b 7562 6572 6e65 7465 732c  with Kubernetes,
-000185f0: 2074 6869 7320 7769 6c6c 206d 616b 6520   this will make 
-00018600: 7375 7265 2074 6861 7420 7468 6520 7072  sure that the pr
-00018610: 6f6a 6563 742d 7370 6563 6966 6963 206b  oject-specific k
-00018620: 3873 2073 6563 7265 7420 6973 2063 7265  8s secret is cre
-00018630: 6174 6564 2c20 616e 6420 7769 6c6c 0a20  ated, and will. 
-00018640: 2020 2020 2020 2070 6f70 756c 6174 6520         populate 
-00018650: 6974 2077 6974 6820 7468 6520 7365 6372  it with the secr
-00018660: 6574 7320 7072 6f76 6964 6564 2c20 7265  ets provided, re
-00018670: 706c 6163 696e 6720 7468 6569 7220 7661  placing their va
-00018680: 6c75 6573 2069 6620 7468 6579 2065 7869  lues if they exi
-00018690: 7374 2e0a 0a20 2020 2020 2020 203a 7061  st...        :pa
-000186a0: 7261 6d20 7072 6f6a 6563 743a 2054 6865  ram project: The
-000186b0: 2070 726f 6a65 6374 2063 6f6e 7465 7874   project context
-000186c0: 2066 6f72 2077 6869 6368 2074 6f20 6765   for which to ge
-000186d0: 6e65 7261 7465 2074 6865 2069 6e66 7261  nerate the infra
-000186e0: 2061 6e64 2073 746f 7265 2073 6563 7265   and store secre
-000186f0: 7473 2e0a 2020 2020 2020 2020 3a70 6172  ts..        :par
-00018700: 616d 2070 726f 7669 6465 723a 2054 6865  am provider: The
-00018710: 206e 616d 6520 6f66 2074 6865 2073 6563   name of the sec
-00018720: 7265 7473 2d70 726f 7669 6465 7220 746f  rets-provider to
-00018730: 2077 6f72 6b20 7769 7468 2e20 4163 6365   work with. Acce
-00018740: 7074 7320 610a 2020 2020 2020 2020 2020  pts a.          
-00018750: 2020 3a70 793a 636c 6173 733a 607e 6d6c    :py:class:`~ml
-00018760: 7275 6e2e 6170 692e 7363 6865 6d61 732e  run.api.schemas.
-00018770: 7365 6372 6574 2e53 6563 7265 7450 726f  secret.SecretPro
-00018780: 7669 6465 724e 616d 6560 2065 6e75 6d2e  viderName` enum.
-00018790: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
-000187a0: 7365 6372 6574 733a 2041 2073 6574 206f  secrets: A set o
-000187b0: 6620 7365 6372 6574 2076 616c 7565 7320  f secret values 
-000187c0: 746f 2073 746f 7265 2e0a 2020 2020 2020  to store..      
-000187d0: 2020 2020 2020 4578 616d 706c 653a 3a0a        Example::.
-000187e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000187f0: 2073 6563 7265 7473 203d 207b 2770 6173   secrets = {'pas
-00018800: 7377 6f72 6427 3a20 276d 7950 6173 7377  sword': 'myPassw
-00018810: 3072 6427 2c20 2761 7773 5f6b 6579 273a  0rd', 'aws_key':
-00018820: 2027 3131 3132 3232 3333 3327 7d0a 2020   '111222333'}.  
-00018830: 2020 2020 2020 2020 2020 2020 2020 6462                db
-00018840: 2e63 7265 6174 655f 7072 6f6a 6563 745f  .create_project_
-00018850: 7365 6372 6574 7328 0a20 2020 2020 2020  secrets(.       
-00018860: 2020 2020 2020 2020 2020 2020 2022 7072               "pr
-00018870: 6f6a 6563 7431 222c 0a20 2020 2020 2020  oject1",.       
-00018880: 2020 2020 2020 2020 2020 2020 2070 726f               pro
-00018890: 7669 6465 723d 6d6c 7275 6e2e 6170 692e  vider=mlrun.api.
-000188a0: 7363 6865 6d61 732e 5365 6372 6574 5072  schemas.SecretPr
-000188b0: 6f76 6964 6572 4e61 6d65 2e6b 7562 6572  oviderName.kuber
-000188c0: 6e65 7465 732c 0a20 2020 2020 2020 2020  netes,.         
-000188d0: 2020 2020 2020 2020 2020 2073 6563 7265             secre
-000188e0: 7473 3d73 6563 7265 7473 0a20 2020 2020  ts=secrets.     
-000188f0: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
-00018900: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-00018910: 2070 6174 6820 3d20 6622 7072 6f6a 6563   path = f"projec
-00018920: 7473 2f7b 7072 6f6a 6563 747d 2f73 6563  ts/{project}/sec
-00018930: 7265 7473 220a 2020 2020 2020 2020 7365  rets".        se
-00018940: 6372 6574 735f 696e 7075 7420 3d20 7363  crets_input = sc
-00018950: 6865 6d61 732e 5365 6372 6574 7344 6174  hemas.SecretsDat
-00018960: 6128 7365 6372 6574 733d 7365 6372 6574  a(secrets=secret
-00018970: 732c 2070 726f 7669 6465 723d 7072 6f76  s, provider=prov
-00018980: 6964 6572 290a 2020 2020 2020 2020 626f  ider).        bo
-00018990: 6479 203d 2073 6563 7265 7473 5f69 6e70  dy = secrets_inp
-000189a0: 7574 2e64 6963 7428 290a 2020 2020 2020  ut.dict().      
-000189b0: 2020 6572 726f 725f 6d65 7373 6167 6520    error_message 
-000189c0: 3d20 6622 4661 696c 6564 2063 7265 6174  = f"Failed creat
-000189d0: 696e 6720 7365 6372 6574 2070 726f 7669  ing secret provi
-000189e0: 6465 7220 7b70 726f 6a65 6374 7d2f 7b70  der {project}/{p
-000189f0: 726f 7669 6465 727d 220a 2020 2020 2020  rovider}".      
-00018a00: 2020 7365 6c66 2e61 7069 5f63 616c 6c28    self.api_call(
-00018a10: 0a20 2020 2020 2020 2020 2020 2022 504f  .            "PO
-00018a20: 5354 222c 0a20 2020 2020 2020 2020 2020  ST",.           
-00018a30: 2070 6174 682c 0a20 2020 2020 2020 2020   path,.         
-00018a40: 2020 2065 7272 6f72 5f6d 6573 7361 6765     error_message
-00018a50: 2c0a 2020 2020 2020 2020 2020 2020 626f  ,.            bo
-00018a60: 6479 3d64 6963 745f 746f 5f6a 736f 6e28  dy=dict_to_json(
-00018a70: 626f 6479 292c 0a20 2020 2020 2020 2029  body),.        )
-00018a80: 0a0a 2020 2020 6465 6620 6c69 7374 5f70  ..    def list_p
-00018a90: 726f 6a65 6374 5f73 6563 7265 7473 280a  roject_secrets(.
-00018aa0: 2020 2020 2020 2020 7365 6c66 2c0a 2020          self,.  
-00018ab0: 2020 2020 2020 7072 6f6a 6563 743a 2073        project: s
-00018ac0: 7472 2c0a 2020 2020 2020 2020 746f 6b65  tr,.        toke
-00018ad0: 6e3a 2073 7472 203d 204e 6f6e 652c 0a20  n: str = None,. 
-00018ae0: 2020 2020 2020 2070 726f 7669 6465 723a         provider:
-00018af0: 2055 6e69 6f6e 5b0a 2020 2020 2020 2020   Union[.        
-00018b00: 2020 2020 7374 722c 2073 6368 656d 6173      str, schemas
-00018b10: 2e53 6563 7265 7450 726f 7669 6465 724e  .SecretProviderN
-00018b20: 616d 650a 2020 2020 2020 2020 5d20 3d20  ame.        ] = 
-00018b30: 7363 6865 6d61 732e 5365 6372 6574 5072  schemas.SecretPr
-00018b40: 6f76 6964 6572 4e61 6d65 2e6b 7562 6572  oviderName.kuber
-00018b50: 6e65 7465 732c 0a20 2020 2020 2020 2073  netes,.        s
-00018b60: 6563 7265 7473 3a20 4c69 7374 5b73 7472  ecrets: List[str
-00018b70: 5d20 3d20 4e6f 6e65 2c0a 2020 2020 2920  ] = None,.    ) 
-00018b80: 2d3e 2073 6368 656d 6173 2e53 6563 7265  -> schemas.Secre
-00018b90: 7473 4461 7461 3a0a 2020 2020 2020 2020  tsData:.        
-00018ba0: 2222 2252 6574 7269 6576 6520 7072 6f6a  """Retrieve proj
-00018bb0: 6563 742d 636f 6e74 6578 7420 7365 6372  ect-context secr
-00018bc0: 6574 7320 6672 6f6d 2056 6175 6c74 2e0a  ets from Vault..
-00018bd0: 0a20 2020 2020 2020 204e 6f74 653a 0a20  .        Note:. 
-00018be0: 2020 2020 2020 2020 2020 2020 2020 2054                 T
-00018bf0: 6869 7320 6d65 7468 6f64 2066 6f72 2056  his method for V
-00018c00: 6175 6c74 2066 756e 6374 696f 6e61 6c69  ault functionali
-00018c10: 7479 2069 7320 6375 7272 656e 746c 7920  ty is currently 
-00018c20: 696e 2074 6563 686e 6963 616c 2070 7265  in technical pre
-00018c30: 7669 6577 2c20 616e 6420 7265 7175 6972  view, and requir
-00018c40: 6573 2061 2048 6173 6869 436f 7270 2056  es a HashiCorp V
-00018c50: 6175 6c74 0a20 2020 2020 2020 2020 2020  ault.           
-00018c60: 2020 2020 2069 6e66 7261 7374 7275 6374       infrastruct
-00018c70: 7572 6520 7072 6f70 6572 6c79 2073 6574  ure properly set
-00018c80: 2075 7020 616e 6420 636f 6e6e 6563 7465   up and connecte
-00018c90: 6420 746f 2074 6865 204d 4c52 756e 2041  d to the MLRun A
-00018ca0: 5049 2073 6572 7665 722e 0a0a 2020 2020  PI server...    
-00018cb0: 2020 2020 3a70 6172 616d 2070 726f 6a65      :param proje
-00018cc0: 6374 3a20 5468 6520 7072 6f6a 6563 7420  ct: The project 
-00018cd0: 6e61 6d65 2e0a 2020 2020 2020 2020 3a70  name..        :p
-00018ce0: 6172 616d 2074 6f6b 656e 3a20 5661 756c  aram token: Vaul
-00018cf0: 7420 746f 6b65 6e20 746f 2075 7365 2066  t token to use f
-00018d00: 6f72 2072 6574 7269 6576 696e 6720 7365  or retrieving se
-00018d10: 6372 6574 732e 0a20 2020 2020 2020 2020  crets..         
-00018d20: 2020 204d 7573 7420 6265 2061 2076 616c     Must be a val
-00018d30: 6964 2056 6175 6c74 2074 6f6b 656e 2c20  id Vault token, 
-00018d40: 7769 7468 2070 6572 6d69 7373 696f 6e73  with permissions
-00018d50: 2074 6f20 7265 7472 6965 7665 2073 6563   to retrieve sec
-00018d60: 7265 7473 206f 6620 7468 6520 7072 6f6a  rets of the proj
-00018d70: 6563 7420 696e 2071 7565 7374 696f 6e2e  ect in question.
-00018d80: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
-00018d90: 7072 6f76 6964 6572 3a20 5468 6520 6e61  provider: The na
-00018da0: 6d65 206f 6620 7468 6520 7365 6372 6574  me of the secret
-00018db0: 732d 7072 6f76 6964 6572 2074 6f20 776f  s-provider to wo
-00018dc0: 726b 2077 6974 682e 2043 7572 7265 6e74  rk with. Current
-00018dd0: 6c79 206f 6e6c 7920 6060 7661 756c 7460  ly only ``vault`
-00018de0: 6020 6973 2061 6363 6570 7465 642e 0a20  ` is accepted.. 
-00018df0: 2020 2020 2020 203a 7061 7261 6d20 7365         :param se
-00018e00: 6372 6574 733a 2041 206c 6973 7420 6f66  crets: A list of
-00018e10: 2073 6563 7265 7420 6e61 6d65 7320 746f   secret names to
-00018e20: 2072 6574 7269 6576 652e 2041 6e20 656d   retrieve. An em
-00018e30: 7074 7920 6c69 7374 2060 605b 5d60 6020  pty list ``[]`` 
-00018e40: 7769 6c6c 2072 6574 7269 6576 6520 616c  will retrieve al
-00018e50: 6c20 7365 6372 6574 7320 6173 7369 676e  l secrets assign
-00018e60: 6564 0a20 2020 2020 2020 2020 2020 2074  ed.            t
-00018e70: 6f20 7468 6973 2073 7065 6369 6669 6320  o this specific 
-00018e80: 7072 6f6a 6563 742e 2060 606b 7562 6572  project. ``kuber
-00018e90: 6e65 7465 7360 6020 7072 6f76 6964 6572  netes`` provider
-00018ea0: 206f 6e6c 7920 7375 7070 6f72 7473 2061   only supports a
-00018eb0: 6e20 656d 7074 7920 6c69 7374 2e0a 2020  n empty list..  
-00018ec0: 2020 2020 2020 2222 220a 0a20 2020 2020        """..     
-00018ed0: 2020 2069 6620 7072 6f76 6964 6572 203d     if provider =
-00018ee0: 3d20 7363 6865 6d61 732e 5365 6372 6574  = schemas.Secret
-00018ef0: 5072 6f76 6964 6572 4e61 6d65 2e76 6175  ProviderName.vau
-00018f00: 6c74 2e76 616c 7565 2061 6e64 206e 6f74  lt.value and not
-00018f10: 2074 6f6b 656e 3a0a 2020 2020 2020 2020   token:.        
-00018f20: 2020 2020 7261 6973 6520 4d4c 5275 6e49      raise MLRunI
-00018f30: 6e76 616c 6964 4172 6775 6d65 6e74 4572  nvalidArgumentEr
-00018f40: 726f 7228 0a20 2020 2020 2020 2020 2020  ror(.           
-00018f50: 2020 2020 2022 4120 7661 756c 7420 746f       "A vault to
-00018f60: 6b65 6e20 6d75 7374 2062 6520 7072 6f76  ken must be prov
-00018f70: 6964 6564 2077 6865 6e20 6163 6365 7373  ided when access
-00018f80: 696e 6720 7661 756c 7420 7365 6372 6574  ing vault secret
-00018f90: 7322 0a20 2020 2020 2020 2020 2020 2029  s".            )
-00018fa0: 0a0a 2020 2020 2020 2020 7061 7468 203d  ..        path =
-00018fb0: 2066 2270 726f 6a65 6374 732f 7b70 726f   f"projects/{pro
-00018fc0: 6a65 6374 7d2f 7365 6372 6574 7322 0a20  ject}/secrets". 
-00018fd0: 2020 2020 2020 2070 6172 616d 7320 3d20         params = 
-00018fe0: 7b22 7072 6f76 6964 6572 223a 2070 726f  {"provider": pro
-00018ff0: 7669 6465 722c 2022 7365 6372 6574 223a  vider, "secret":
-00019000: 2073 6563 7265 7473 7d0a 2020 2020 2020   secrets}.      
-00019010: 2020 6865 6164 6572 7320 3d20 7b73 6368    headers = {sch
-00019020: 656d 6173 2e48 6561 6465 724e 616d 6573  emas.HeaderNames
-00019030: 2e73 6563 7265 745f 7374 6f72 655f 746f  .secret_store_to
-00019040: 6b65 6e3a 2074 6f6b 656e 7d0a 2020 2020  ken: token}.    
-00019050: 2020 2020 6572 726f 725f 6d65 7373 6167      error_messag
-00019060: 6520 3d20 6622 4661 696c 6564 2072 6574  e = f"Failed ret
-00019070: 7269 6576 696e 6720 7365 6372 6574 7320  rieving secrets 
-00019080: 7b70 726f 6a65 6374 7d2f 7b70 726f 7669  {project}/{provi
-00019090: 6465 727d 220a 2020 2020 2020 2020 7265  der}".        re
-000190a0: 7375 6c74 203d 2073 656c 662e 6170 695f  sult = self.api_
-000190b0: 6361 6c6c 280a 2020 2020 2020 2020 2020  call(.          
-000190c0: 2020 2247 4554 222c 0a20 2020 2020 2020    "GET",.       
-000190d0: 2020 2020 2070 6174 682c 0a20 2020 2020       path,.     
-000190e0: 2020 2020 2020 2065 7272 6f72 5f6d 6573         error_mes
-000190f0: 7361 6765 2c0a 2020 2020 2020 2020 2020  sage,.          
-00019100: 2020 7061 7261 6d73 3d70 6172 616d 732c    params=params,
-00019110: 0a20 2020 2020 2020 2020 2020 2068 6561  .            hea
-00019120: 6465 7273 3d68 6561 6465 7273 2c0a 2020  ders=headers,.  
-00019130: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-00019140: 7265 7475 726e 2073 6368 656d 6173 2e53  return schemas.S
-00019150: 6563 7265 7473 4461 7461 282a 2a72 6573  ecretsData(**res
-00019160: 756c 742e 6a73 6f6e 2829 290a 0a20 2020  ult.json())..   
-00019170: 2064 6566 206c 6973 745f 7072 6f6a 6563   def list_projec
-00019180: 745f 7365 6372 6574 5f6b 6579 7328 0a20  t_secret_keys(. 
-00019190: 2020 2020 2020 2073 656c 662c 0a20 2020         self,.   
-000191a0: 2020 2020 2070 726f 6a65 6374 3a20 7374       project: st
-000191b0: 722c 0a20 2020 2020 2020 2070 726f 7669  r,.        provi
-000191c0: 6465 723a 2055 6e69 6f6e 5b0a 2020 2020  der: Union[.    
-000191d0: 2020 2020 2020 2020 7374 722c 2073 6368          str, sch
-000191e0: 656d 6173 2e53 6563 7265 7450 726f 7669  emas.SecretProvi
-000191f0: 6465 724e 616d 650a 2020 2020 2020 2020  derName.        
-00019200: 5d20 3d20 7363 6865 6d61 732e 5365 6372  ] = schemas.Secr
-00019210: 6574 5072 6f76 6964 6572 4e61 6d65 2e6b  etProviderName.k
-00019220: 7562 6572 6e65 7465 732c 0a20 2020 2020  ubernetes,.     
-00019230: 2020 2074 6f6b 656e 3a20 7374 7220 3d20     token: str = 
-00019240: 4e6f 6e65 2c0a 2020 2020 2920 2d3e 2073  None,.    ) -> s
-00019250: 6368 656d 6173 2e53 6563 7265 744b 6579  chemas.SecretKey
-00019260: 7344 6174 613a 0a20 2020 2020 2020 2022  sData:.        "
-00019270: 2222 5265 7472 6965 7665 2070 726f 6a65  ""Retrieve proje
-00019280: 6374 2d63 6f6e 7465 7874 2073 6563 7265  ct-context secre
-00019290: 7420 6b65 7973 2066 726f 6d20 5661 756c  t keys from Vaul
-000192a0: 7420 6f72 204b 7562 6572 6e65 7465 732e  t or Kubernetes.
-000192b0: 0a0a 2020 2020 2020 2020 4e6f 7465 3a0a  ..        Note:.
-000192c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000192d0: 5468 6973 206d 6574 686f 6420 666f 7220  This method for 
-000192e0: 5661 756c 7420 6675 6e63 7469 6f6e 616c  Vault functional
-000192f0: 6974 7920 6973 2063 7572 7265 6e74 6c79  ity is currently
-00019300: 2069 6e20 7465 6368 6e69 6361 6c20 7072   in technical pr
-00019310: 6576 6965 772c 2061 6e64 2072 6571 7569  eview, and requi
-00019320: 7265 7320 6120 4861 7368 6943 6f72 7020  res a HashiCorp 
-00019330: 5661 756c 740a 2020 2020 2020 2020 2020  Vault.          
-00019340: 2020 2020 2020 696e 6672 6173 7472 7563        infrastruc
-00019350: 7475 7265 2070 726f 7065 726c 7920 7365  ture properly se
-00019360: 7420 7570 2061 6e64 2063 6f6e 6e65 6374  t up and connect
-00019370: 6564 2074 6f20 7468 6520 4d4c 5275 6e20  ed to the MLRun 
-00019380: 4150 4920 7365 7276 6572 2e0a 0a20 2020  API server...   
-00019390: 2020 2020 203a 7061 7261 6d20 7072 6f6a       :param proj
-000193a0: 6563 743a 2054 6865 2070 726f 6a65 6374  ect: The project
-000193b0: 206e 616d 652e 0a20 2020 2020 2020 203a   name..        :
-000193c0: 7061 7261 6d20 7072 6f76 6964 6572 3a20  param provider: 
-000193d0: 5468 6520 6e61 6d65 206f 6620 7468 6520  The name of the 
-000193e0: 7365 6372 6574 732d 7072 6f76 6964 6572  secrets-provider
-000193f0: 2074 6f20 776f 726b 2077 6974 682e 2041   to work with. A
-00019400: 6363 6570 7473 2061 0a20 2020 2020 2020  ccepts a.       
-00019410: 2020 2020 203a 7079 3a63 6c61 7373 3a60       :py:class:`
-00019420: 7e6d 6c72 756e 2e61 7069 2e73 6368 656d  ~mlrun.api.schem
-00019430: 6173 2e73 6563 7265 742e 5365 6372 6574  as.secret.Secret
-00019440: 5072 6f76 6964 6572 4e61 6d65 6020 656e  ProviderName` en
-00019450: 756d 2e0a 2020 2020 2020 2020 3a70 6172  um..        :par
-00019460: 616d 2074 6f6b 656e 3a20 5661 756c 7420  am token: Vault 
-00019470: 746f 6b65 6e20 746f 2075 7365 2066 6f72  token to use for
-00019480: 2072 6574 7269 6576 696e 6720 7365 6372   retrieving secr
-00019490: 6574 732e 204f 6e6c 7920 696e 2075 7365  ets. Only in use
-000194a0: 2069 6620 6060 7072 6f76 6964 6572 6060   if ``provider``
-000194b0: 2069 7320 6060 7661 756c 7460 602e 0a20   is ``vault``.. 
-000194c0: 2020 2020 2020 2020 2020 204d 7573 7420             Must 
-000194d0: 6265 2061 2076 616c 6964 2056 6175 6c74  be a valid Vault
-000194e0: 2074 6f6b 656e 2c20 7769 7468 2070 6572   token, with per
-000194f0: 6d69 7373 696f 6e73 2074 6f20 7265 7472  missions to retr
-00019500: 6965 7665 2073 6563 7265 7473 206f 6620  ieve secrets of 
-00019510: 7468 6520 7072 6f6a 6563 7420 696e 2071  the project in q
-00019520: 7565 7374 696f 6e2e 0a20 2020 2020 2020  uestion..       
-00019530: 2022 2222 0a0a 2020 2020 2020 2020 6966   """..        if
-00019540: 2070 726f 7669 6465 7220 3d3d 2073 6368   provider == sch
-00019550: 656d 6173 2e53 6563 7265 7450 726f 7669  emas.SecretProvi
-00019560: 6465 724e 616d 652e 7661 756c 742e 7661  derName.vault.va
-00019570: 6c75 6520 616e 6420 6e6f 7420 746f 6b65  lue and not toke
-00019580: 6e3a 0a20 2020 2020 2020 2020 2020 2072  n:.            r
-00019590: 6169 7365 204d 4c52 756e 496e 7661 6c69  aise MLRunInvali
-000195a0: 6441 7267 756d 656e 7445 7272 6f72 280a  dArgumentError(.
-000195b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000195c0: 2241 2076 6175 6c74 2074 6f6b 656e 206d  "A vault token m
-000195d0: 7573 7420 6265 2070 726f 7669 6465 6420  ust be provided 
-000195e0: 7768 656e 2061 6363 6573 7369 6e67 2076  when accessing v
-000195f0: 6175 6c74 2073 6563 7265 7473 220a 2020  ault secrets".  
-00019600: 2020 2020 2020 2020 2020 290a 0a20 2020            )..   
-00019610: 2020 2020 2070 6174 6820 3d20 6622 7072       path = f"pr
-00019620: 6f6a 6563 7473 2f7b 7072 6f6a 6563 747d  ojects/{project}
-00019630: 2f73 6563 7265 742d 6b65 7973 220a 2020  /secret-keys".  
-00019640: 2020 2020 2020 7061 7261 6d73 203d 207b        params = {
-00019650: 2270 726f 7669 6465 7222 3a20 7072 6f76  "provider": prov
-00019660: 6964 6572 7d0a 2020 2020 2020 2020 6865  ider}.        he
-00019670: 6164 6572 7320 3d20 280a 2020 2020 2020  aders = (.      
-00019680: 2020 2020 2020 7b73 6368 656d 6173 2e48        {schemas.H
-00019690: 6561 6465 724e 616d 6573 2e73 6563 7265  eaderNames.secre
-000196a0: 745f 7374 6f72 655f 746f 6b65 6e3a 2074  t_store_token: t
-000196b0: 6f6b 656e 7d0a 2020 2020 2020 2020 2020  oken}.          
-000196c0: 2020 6966 2070 726f 7669 6465 7220 3d3d    if provider ==
-000196d0: 2073 6368 656d 6173 2e53 6563 7265 7450   schemas.SecretP
-000196e0: 726f 7669 6465 724e 616d 652e 7661 756c  roviderName.vaul
-000196f0: 742e 7661 6c75 650a 2020 2020 2020 2020  t.value.        
-00019700: 2020 2020 656c 7365 204e 6f6e 650a 2020      else None.  
-00019710: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-00019720: 6572 726f 725f 6d65 7373 6167 6520 3d20  error_message = 
-00019730: 6622 4661 696c 6564 2072 6574 7269 6576  f"Failed retriev
-00019740: 696e 6720 7365 6372 6574 206b 6579 7320  ing secret keys 
-00019750: 7b70 726f 6a65 6374 7d2f 7b70 726f 7669  {project}/{provi
-00019760: 6465 727d 220a 2020 2020 2020 2020 7265  der}".        re
-00019770: 7375 6c74 203d 2073 656c 662e 6170 695f  sult = self.api_
-00019780: 6361 6c6c 280a 2020 2020 2020 2020 2020  call(.          
-00019790: 2020 2247 4554 222c 0a20 2020 2020 2020    "GET",.       
-000197a0: 2020 2020 2070 6174 682c 0a20 2020 2020       path,.     
-000197b0: 2020 2020 2020 2065 7272 6f72 5f6d 6573         error_mes
-000197c0: 7361 6765 2c0a 2020 2020 2020 2020 2020  sage,.          
-000197d0: 2020 7061 7261 6d73 3d70 6172 616d 732c    params=params,
-000197e0: 0a20 2020 2020 2020 2020 2020 2068 6561  .            hea
-000197f0: 6465 7273 3d68 6561 6465 7273 2c0a 2020  ders=headers,.  
-00019800: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-00019810: 7265 7475 726e 2073 6368 656d 6173 2e53  return schemas.S
-00019820: 6563 7265 744b 6579 7344 6174 6128 2a2a  ecretKeysData(**
-00019830: 7265 7375 6c74 2e6a 736f 6e28 2929 0a0a  result.json())..
-00019840: 2020 2020 6465 6620 6465 6c65 7465 5f70      def delete_p
-00019850: 726f 6a65 6374 5f73 6563 7265 7473 280a  roject_secrets(.
-00019860: 2020 2020 2020 2020 7365 6c66 2c0a 2020          self,.  
-00019870: 2020 2020 2020 7072 6f6a 6563 743a 2073        project: s
-00019880: 7472 2c0a 2020 2020 2020 2020 7072 6f76  tr,.        prov
-00019890: 6964 6572 3a20 556e 696f 6e5b 0a20 2020  ider: Union[.   
-000198a0: 2020 2020 2020 2020 2073 7472 2c20 7363           str, sc
-000198b0: 6865 6d61 732e 5365 6372 6574 5072 6f76  hemas.SecretProv
-000198c0: 6964 6572 4e61 6d65 0a20 2020 2020 2020  iderName.       
-000198d0: 205d 203d 2073 6368 656d 6173 2e53 6563   ] = schemas.Sec
-000198e0: 7265 7450 726f 7669 6465 724e 616d 652e  retProviderName.
-000198f0: 6b75 6265 726e 6574 6573 2c0a 2020 2020  kubernetes,.    
-00019900: 2020 2020 7365 6372 6574 733a 204c 6973      secrets: Lis
-00019910: 745b 7374 725d 203d 204e 6f6e 652c 0a20  t[str] = None,. 
-00019920: 2020 2029 3a0a 2020 2020 2020 2020 2222     ):.        ""
-00019930: 2244 656c 6574 6520 7072 6f6a 6563 742d  "Delete project-
-00019940: 636f 6e74 6578 7420 7365 6372 6574 7320  context secrets 
-00019950: 6672 6f6d 204b 7562 6572 6e65 7465 732e  from Kubernetes.
-00019960: 0a0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
-00019970: 2070 726f 6a65 6374 3a20 5468 6520 7072   project: The pr
-00019980: 6f6a 6563 7420 6e61 6d65 2e0a 2020 2020  oject name..    
-00019990: 2020 2020 3a70 6172 616d 2070 726f 7669      :param provi
-000199a0: 6465 723a 2054 6865 206e 616d 6520 6f66  der: The name of
-000199b0: 2074 6865 2073 6563 7265 7473 2d70 726f   the secrets-pro
-000199c0: 7669 6465 7220 746f 2077 6f72 6b20 7769  vider to work wi
-000199d0: 7468 2e20 4375 7272 656e 746c 7920 6f6e  th. Currently on
-000199e0: 6c79 2060 606b 7562 6572 6e65 7465 7360  ly ``kubernetes`
-000199f0: 6020 6973 2073 7570 706f 7274 6564 2e0a  ` is supported..
-00019a00: 2020 2020 2020 2020 3a70 6172 616d 2073          :param s
-00019a10: 6563 7265 7473 3a20 4120 6c69 7374 206f  ecrets: A list o
-00019a20: 6620 7365 6372 6574 206e 616d 6573 2074  f secret names t
-00019a30: 6f20 6465 6c65 7465 2e20 416e 2065 6d70  o delete. An emp
-00019a40: 7479 206c 6973 7420 7769 6c6c 2064 656c  ty list will del
-00019a50: 6574 6520 616c 6c20 7365 6372 6574 7320  ete all secrets 
-00019a60: 6173 7369 676e 6564 0a20 2020 2020 2020  assigned.       
-00019a70: 2020 2020 2074 6f20 7468 6973 2073 7065       to this spe
-00019a80: 6369 6669 6320 7072 6f6a 6563 742e 0a20  cific project.. 
-00019a90: 2020 2020 2020 2022 2222 0a0a 2020 2020         """..    
-00019aa0: 2020 2020 7061 7468 203d 2066 2270 726f      path = f"pro
-00019ab0: 6a65 6374 732f 7b70 726f 6a65 6374 7d2f  jects/{project}/
-00019ac0: 7365 6372 6574 7322 0a20 2020 2020 2020  secrets".       
-00019ad0: 2070 6172 616d 7320 3d20 7b22 7072 6f76   params = {"prov
-00019ae0: 6964 6572 223a 2070 726f 7669 6465 722c  ider": provider,
-00019af0: 2022 7365 6372 6574 223a 2073 6563 7265   "secret": secre
-00019b00: 7473 7d0a 2020 2020 2020 2020 6572 726f  ts}.        erro
-00019b10: 725f 6d65 7373 6167 6520 3d20 6622 4661  r_message = f"Fa
-00019b20: 696c 6564 2064 656c 6574 696e 6720 7365  iled deleting se
-00019b30: 6372 6574 7320 7b70 726f 6a65 6374 7d2f  crets {project}/
-00019b40: 7b70 726f 7669 6465 727d 220a 2020 2020  {provider}".    
-00019b50: 2020 2020 7365 6c66 2e61 7069 5f63 616c      self.api_cal
-00019b60: 6c28 0a20 2020 2020 2020 2020 2020 2022  l(.            "
-00019b70: 4445 4c45 5445 222c 0a20 2020 2020 2020  DELETE",.       
-00019b80: 2020 2020 2070 6174 682c 0a20 2020 2020       path,.     
-00019b90: 2020 2020 2020 2065 7272 6f72 5f6d 6573         error_mes
-00019ba0: 7361 6765 2c0a 2020 2020 2020 2020 2020  sage,.          
-00019bb0: 2020 7061 7261 6d73 3d70 6172 616d 732c    params=params,
-00019bc0: 0a20 2020 2020 2020 2029 0a0a 2020 2020  .        )..    
-00019bd0: 6465 6620 6372 6561 7465 5f75 7365 725f  def create_user_
-00019be0: 7365 6372 6574 7328 0a20 2020 2020 2020  secrets(.       
-00019bf0: 2073 656c 662c 0a20 2020 2020 2020 2075   self,.        u
-00019c00: 7365 723a 2073 7472 2c0a 2020 2020 2020  ser: str,.      
-00019c10: 2020 7072 6f76 6964 6572 3a20 556e 696f    provider: Unio
-00019c20: 6e5b 0a20 2020 2020 2020 2020 2020 2073  n[.            s
-00019c30: 7472 2c20 7363 6865 6d61 732e 5365 6372  tr, schemas.Secr
-00019c40: 6574 5072 6f76 6964 6572 4e61 6d65 0a20  etProviderName. 
-00019c50: 2020 2020 2020 205d 203d 2073 6368 656d         ] = schem
-00019c60: 6173 2e53 6563 7265 7450 726f 7669 6465  as.SecretProvide
-00019c70: 724e 616d 652e 7661 756c 742c 0a20 2020  rName.vault,.   
-00019c80: 2020 2020 2073 6563 7265 7473 3a20 6469       secrets: di
-00019c90: 6374 203d 204e 6f6e 652c 0a20 2020 2029  ct = None,.    )
-00019ca0: 3a0a 2020 2020 2020 2020 2222 2243 7265  :.        """Cre
-00019cb0: 6174 6520 7573 6572 2d63 6f6e 7465 7874  ate user-context
-00019cc0: 2073 6563 7265 7420 696e 2056 6175 6c74   secret in Vault
-00019cd0: 2e20 506c 6561 7365 2072 6566 6572 2074  . Please refer t
-00019ce0: 6f20 3a70 793a 6675 6e63 3a60 6372 6561  o :py:func:`crea
-00019cf0: 7465 5f70 726f 6a65 6374 5f73 6563 7265  te_project_secre
-00019d00: 7473 6020 666f 7220 6d6f 7265 2064 6574  ts` for more det
-00019d10: 6169 6c73 0a20 2020 2020 2020 2061 6e64  ails.        and
-00019d20: 2073 7461 7475 7320 6f66 2074 6869 7320   status of this 
-00019d30: 6675 6e63 7469 6f6e 616c 6974 792e 0a0a  functionality...
-00019d40: 2020 2020 2020 2020 4e6f 7465 3a0a 2020          Note:.  
-00019d50: 2020 2020 2020 2020 2020 2020 2020 5468                Th
-00019d60: 6973 206d 6574 686f 6420 6973 2063 7572  is method is cur
-00019d70: 7265 6e74 6c79 2069 6e20 7465 6368 6e69  rently in techni
-00019d80: 6361 6c20 7072 6576 6965 772c 2061 6e64  cal preview, and
-00019d90: 2072 6571 7569 7265 7320 6120 4861 7368   requires a Hash
-00019da0: 6943 6f72 7020 5661 756c 7420 696e 6672  iCorp Vault infr
-00019db0: 6173 7472 7563 7475 7265 0a20 2020 2020  astructure.     
-00019dc0: 2020 2020 2020 2020 2020 2070 726f 7065             prope
-00019dd0: 726c 7920 7365 7420 7570 2061 6e64 2063  rly set up and c
-00019de0: 6f6e 6e65 6374 6564 2074 6f20 7468 6520  onnected to the 
-00019df0: 4d4c 5275 6e20 4150 4920 7365 7276 6572  MLRun API server
-00019e00: 2e0a 0a20 2020 2020 2020 203a 7061 7261  ...        :para
-00019e10: 6d20 7573 6572 3a20 5468 6520 7573 6572  m user: The user
-00019e20: 2063 6f6e 7465 7874 2066 6f72 2077 6869   context for whi
-00019e30: 6368 2074 6f20 6765 6e65 7261 7465 2074  ch to generate t
-00019e40: 6865 2069 6e66 7261 2061 6e64 2073 746f  he infra and sto
-00019e50: 7265 2073 6563 7265 7473 2e0a 2020 2020  re secrets..    
-00019e60: 2020 2020 3a70 6172 616d 2070 726f 7669      :param provi
-00019e70: 6465 723a 2054 6865 206e 616d 6520 6f66  der: The name of
-00019e80: 2074 6865 2073 6563 7265 7473 2d70 726f   the secrets-pro
-00019e90: 7669 6465 7220 746f 2077 6f72 6b20 7769  vider to work wi
-00019ea0: 7468 2e20 4375 7272 656e 746c 7920 6f6e  th. Currently on
-00019eb0: 6c79 2060 6076 6175 6c74 6060 2069 7320  ly ``vault`` is 
-00019ec0: 7375 7070 6f72 7465 642e 0a20 2020 2020  supported..     
-00019ed0: 2020 203a 7061 7261 6d20 7365 6372 6574     :param secret
-00019ee0: 733a 2041 2073 6574 206f 6620 7365 6372  s: A set of secr
-00019ef0: 6574 2076 616c 7565 7320 746f 2073 746f  et values to sto
-00019f00: 7265 2077 6974 6869 6e20 7468 6520 5661  re within the Va
-00019f10: 756c 742e 0a20 2020 2020 2020 2022 2222  ult..        """
-00019f20: 0a20 2020 2020 2020 2070 6174 6820 3d20  .        path = 
-00019f30: 2275 7365 722d 7365 6372 6574 7322 0a20  "user-secrets". 
-00019f40: 2020 2020 2020 2073 6563 7265 7473 5f63         secrets_c
-00019f50: 7265 6174 696f 6e5f 7265 7175 6573 7420  reation_request 
-00019f60: 3d20 7363 6865 6d61 732e 5573 6572 5365  = schemas.UserSe
-00019f70: 6372 6574 4372 6561 7469 6f6e 5265 7175  cretCreationRequ
-00019f80: 6573 7428 0a20 2020 2020 2020 2020 2020  est(.           
-00019f90: 2075 7365 723d 7573 6572 2c0a 2020 2020   user=user,.    
-00019fa0: 2020 2020 2020 2020 7072 6f76 6964 6572          provider
-00019fb0: 3d70 726f 7669 6465 722c 0a20 2020 2020  =provider,.     
-00019fc0: 2020 2020 2020 2073 6563 7265 7473 3d73         secrets=s
-00019fd0: 6563 7265 7473 2c0a 2020 2020 2020 2020  ecrets,.        
-00019fe0: 290a 2020 2020 2020 2020 626f 6479 203d  ).        body =
-00019ff0: 2073 6563 7265 7473 5f63 7265 6174 696f   secrets_creatio
-0001a000: 6e5f 7265 7175 6573 742e 6469 6374 2829  n_request.dict()
-0001a010: 0a20 2020 2020 2020 2065 7272 6f72 5f6d  .        error_m
-0001a020: 6573 7361 6765 203d 2066 2246 6169 6c65  essage = f"Faile
-0001a030: 6420 6372 6561 7469 6e67 2075 7365 7220  d creating user 
-0001a040: 7365 6372 6574 7320 2d20 7b75 7365 727d  secrets - {user}
-0001a050: 220a 2020 2020 2020 2020 7365 6c66 2e61  ".        self.a
-0001a060: 7069 5f63 616c 6c28 0a20 2020 2020 2020  pi_call(.       
-0001a070: 2020 2020 2022 504f 5354 222c 0a20 2020       "POST",.   
-0001a080: 2020 2020 2020 2020 2070 6174 682c 0a20           path,. 
-0001a090: 2020 2020 2020 2020 2020 2065 7272 6f72             error
-0001a0a0: 5f6d 6573 7361 6765 2c0a 2020 2020 2020  _message,.      
-0001a0b0: 2020 2020 2020 626f 6479 3d64 6963 745f        body=dict_
-0001a0c0: 746f 5f6a 736f 6e28 626f 6479 292c 0a20  to_json(body),. 
-0001a0d0: 2020 2020 2020 2029 0a0a 2020 2020 4073         )..    @s
-0001a0e0: 7461 7469 636d 6574 686f 640a 2020 2020  taticmethod.    
-0001a0f0: 6465 6620 5f76 616c 6964 6174 655f 7665  def _validate_ve
-0001a100: 7273 696f 6e5f 636f 6d70 6174 6962 696c  rsion_compatibil
-0001a110: 6974 7928 7365 7276 6572 5f76 6572 7369  ity(server_versi
-0001a120: 6f6e 2c20 636c 6965 6e74 5f76 6572 7369  on, client_versi
-0001a130: 6f6e 2920 2d3e 2062 6f6f 6c3a 0a20 2020  on) -> bool:.   
-0001a140: 2020 2020 2074 7279 3a0a 2020 2020 2020       try:.      
-0001a150: 2020 2020 2020 7061 7273 6564 5f73 6572        parsed_ser
-0001a160: 7665 725f 7665 7273 696f 6e20 3d20 7365  ver_version = se
-0001a170: 6d76 6572 2e56 6572 7369 6f6e 496e 666f  mver.VersionInfo
-0001a180: 2e70 6172 7365 2873 6572 7665 725f 7665  .parse(server_ve
-0001a190: 7273 696f 6e29 0a20 2020 2020 2020 2020  rsion).         
-0001a1a0: 2020 2070 6172 7365 645f 636c 6965 6e74     parsed_client
-0001a1b0: 5f76 6572 7369 6f6e 203d 2073 656d 7665  _version = semve
-0001a1c0: 722e 5665 7273 696f 6e49 6e66 6f2e 7061  r.VersionInfo.pa
-0001a1d0: 7273 6528 636c 6965 6e74 5f76 6572 7369  rse(client_versi
-0001a1e0: 6f6e 290a 2020 2020 2020 2020 6578 6365  on).        exce
-0001a1f0: 7074 2056 616c 7565 4572 726f 723a 0a20  pt ValueError:. 
-0001a200: 2020 2020 2020 2020 2020 2023 2054 6869             # Thi
-0001a210: 7320 7769 6c6c 206d 6f73 746c 7920 6861  s will mostly ha
-0001a220: 7070 656e 2069 6e20 6465 7620 7363 656e  ppen in dev scen
-0001a230: 6172 696f 7320 7768 656e 2074 6865 2076  arios when the v
-0001a240: 6572 7369 6f6e 2069 7320 756e 7374 6162  ersion is unstab
-0001a250: 6c65 2061 6e64 2073 7563 6820 2d20 7468  le and such - th
-0001a260: 6572 6566 6f72 6520 7765 2772 6520 6967  erefore we're ig
-0001a270: 6e6f 7269 6e67 0a20 2020 2020 2020 2020  noring.         
-0001a280: 2020 206c 6f67 6765 722e 7761 726e 696e     logger.warnin
-0001a290: 6728 0a20 2020 2020 2020 2020 2020 2020  g(.             
-0001a2a0: 2020 2022 556e 6162 6c65 2074 6f20 7061     "Unable to pa
-0001a2b0: 7273 6520 7365 7276 6572 206f 7220 636c  rse server or cl
-0001a2c0: 6965 6e74 2076 6572 7369 6f6e 2e20 4173  ient version. As
-0001a2d0: 7375 6d69 6e67 2063 6f6d 7061 7469 626c  suming compatibl
-0001a2e0: 6522 2c0a 2020 2020 2020 2020 2020 2020  e",.            
-0001a2f0: 2020 2020 7365 7276 6572 5f76 6572 7369      server_versi
-0001a300: 6f6e 3d73 6572 7665 725f 7665 7273 696f  on=server_versio
-0001a310: 6e2c 0a20 2020 2020 2020 2020 2020 2020  n,.             
-0001a320: 2020 2063 6c69 656e 745f 7665 7273 696f     client_versio
-0001a330: 6e3d 636c 6965 6e74 5f76 6572 7369 6f6e  n=client_version
-0001a340: 2c0a 2020 2020 2020 2020 2020 2020 290a  ,.            ).
-0001a350: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-0001a360: 726e 2054 7275 650a 2020 2020 2020 2020  rn True.        
-0001a370: 6966 2028 7061 7273 6564 5f73 6572 7665  if (parsed_serve
-0001a380: 725f 7665 7273 696f 6e2e 6d61 6a6f 7220  r_version.major 
-0001a390: 3d3d 2030 2061 6e64 2070 6172 7365 645f  == 0 and parsed_
-0001a3a0: 7365 7276 6572 5f76 6572 7369 6f6e 2e6d  server_version.m
-0001a3b0: 696e 6f72 203d 3d20 3029 206f 7220 280a  inor == 0) or (.
-0001a3c0: 2020 2020 2020 2020 2020 2020 7061 7273              pars
-0001a3d0: 6564 5f63 6c69 656e 745f 7665 7273 696f  ed_client_versio
-0001a3e0: 6e2e 6d61 6a6f 7220 3d3d 2030 2061 6e64  n.major == 0 and
-0001a3f0: 2070 6172 7365 645f 636c 6965 6e74 5f76   parsed_client_v
-0001a400: 6572 7369 6f6e 2e6d 696e 6f72 203d 3d20  ersion.minor == 
-0001a410: 300a 2020 2020 2020 2020 293a 0a20 2020  0.        ):.   
-0001a420: 2020 2020 2020 2020 206c 6f67 6765 722e           logger.
-0001a430: 7761 726e 696e 6728 0a20 2020 2020 2020  warning(.       
-0001a440: 2020 2020 2020 2020 2022 5365 7276 6572           "Server
-0001a450: 206f 7220 636c 6965 6e74 2076 6572 7369   or client versi
-0001a460: 6f6e 2069 7320 756e 7374 6162 6c65 2e20  on is unstable. 
-0001a470: 4173 7375 6d69 6e67 2063 6f6d 7061 7469  Assuming compati
-0001a480: 626c 6522 2c0a 2020 2020 2020 2020 2020  ble",.          
-0001a490: 2020 2020 2020 7365 7276 6572 5f76 6572        server_ver
-0001a4a0: 7369 6f6e 3d73 6572 7665 725f 7665 7273  sion=server_vers
-0001a4b0: 696f 6e2c 0a20 2020 2020 2020 2020 2020  ion,.           
-0001a4c0: 2020 2020 2063 6c69 656e 745f 7665 7273       client_vers
-0001a4d0: 696f 6e3d 636c 6965 6e74 5f76 6572 7369  ion=client_versi
-0001a4e0: 6f6e 2c0a 2020 2020 2020 2020 2020 2020  on,.            
-0001a4f0: 290a 2020 2020 2020 2020 2020 2020 7265  ).            re
-0001a500: 7475 726e 2054 7275 650a 2020 2020 2020  turn True.      
-0001a510: 2020 6966 2070 6172 7365 645f 7365 7276    if parsed_serv
-0001a520: 6572 5f76 6572 7369 6f6e 2e6d 616a 6f72  er_version.major
-0001a530: 2021 3d20 7061 7273 6564 5f63 6c69 656e   != parsed_clien
-0001a540: 745f 7665 7273 696f 6e2e 6d61 6a6f 723a  t_version.major:
-0001a550: 0a20 2020 2020 2020 2020 2020 206c 6f67  .            log
-0001a560: 6765 722e 7761 726e 696e 6728 0a20 2020  ger.warning(.   
-0001a570: 2020 2020 2020 2020 2020 2020 2022 5365               "Se
-0001a580: 7276 6572 2061 6e64 2063 6c69 656e 7420  rver and client 
-0001a590: 7665 7273 696f 6e73 2061 7265 2069 6e63  versions are inc
-0001a5a0: 6f6d 7061 7469 626c 6522 2c0a 2020 2020  ompatible",.    
-0001a5b0: 2020 2020 2020 2020 2020 2020 7061 7273              pars
-0001a5c0: 6564 5f73 6572 7665 725f 7665 7273 696f  ed_server_versio
-0001a5d0: 6e3d 7061 7273 6564 5f73 6572 7665 725f  n=parsed_server_
-0001a5e0: 7665 7273 696f 6e2c 0a20 2020 2020 2020  version,.       
-0001a5f0: 2020 2020 2020 2020 2070 6172 7365 645f           parsed_
-0001a600: 636c 6965 6e74 5f76 6572 7369 6f6e 3d70  client_version=p
-0001a610: 6172 7365 645f 636c 6965 6e74 5f76 6572  arsed_client_ver
-0001a620: 7369 6f6e 2c0a 2020 2020 2020 2020 2020  sion,.          
-0001a630: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
-0001a640: 7265 7475 726e 2046 616c 7365 0a20 2020  return False.   
-0001a650: 2020 2020 2069 6620 7061 7273 6564 5f73       if parsed_s
-0001a660: 6572 7665 725f 7665 7273 696f 6e2e 6d69  erver_version.mi
-0001a670: 6e6f 7220 3e20 7061 7273 6564 5f63 6c69  nor > parsed_cli
-0001a680: 656e 745f 7665 7273 696f 6e2e 6d69 6e6f  ent_version.mino
-0001a690: 7220 2b20 323a 0a20 2020 2020 2020 2020  r + 2:.         
-0001a6a0: 2020 206c 6f67 6765 722e 696e 666f 280a     logger.info(.
-0001a6b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001a6c0: 2242 6163 6b77 6172 6473 2063 6f6d 7061  "Backwards compa
-0001a6d0: 7469 6269 6c69 7479 206d 6967 6874 206e  tibility might n
-0001a6e0: 6f74 2061 7070 6c79 2062 6574 7765 656e  ot apply between
-0001a6f0: 2074 6865 2073 6572 7665 7220 616e 6420   the server and 
-0001a700: 636c 6965 6e74 2076 6572 7369 6f6e 222c  client version",
-0001a710: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001a720: 2070 6172 7365 645f 7365 7276 6572 5f76   parsed_server_v
-0001a730: 6572 7369 6f6e 3d70 6172 7365 645f 7365  ersion=parsed_se
-0001a740: 7276 6572 5f76 6572 7369 6f6e 2c0a 2020  rver_version,.  
-0001a750: 2020 2020 2020 2020 2020 2020 2020 7061                pa
-0001a760: 7273 6564 5f63 6c69 656e 745f 7665 7273  rsed_client_vers
-0001a770: 696f 6e3d 7061 7273 6564 5f63 6c69 656e  ion=parsed_clien
-0001a780: 745f 7665 7273 696f 6e2c 0a20 2020 2020  t_version,.     
-0001a790: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-0001a7a0: 2020 2020 2072 6574 7572 6e20 4661 6c73       return Fals
-0001a7b0: 650a 2020 2020 2020 2020 6966 2070 6172  e.        if par
-0001a7c0: 7365 645f 636c 6965 6e74 5f76 6572 7369  sed_client_versi
-0001a7d0: 6f6e 2e6d 696e 6f72 203e 2070 6172 7365  on.minor > parse
-0001a7e0: 645f 7365 7276 6572 5f76 6572 7369 6f6e  d_server_version
-0001a7f0: 2e6d 696e 6f72 3a0a 2020 2020 2020 2020  .minor:.        
-0001a800: 2020 2020 6c6f 6767 6572 2e77 6172 6e69      logger.warni
-0001a810: 6e67 280a 2020 2020 2020 2020 2020 2020  ng(.            
-0001a820: 2020 2020 2243 6c69 656e 7420 7665 7273      "Client vers
-0001a830: 696f 6e20 7769 7468 2068 6967 6865 7220  ion with higher 
-0001a840: 7665 7273 696f 6e20 7468 616e 2073 6572  version than ser
-0001a850: 7665 7220 7665 7273 696f 6e20 6973 6e27  ver version isn'
-0001a860: 7420 7375 7070 6f72 7465 642c 220a 2020  t supported,".  
-0001a870: 2020 2020 2020 2020 2020 2020 2020 2220                " 
-0001a880: 616c 6967 6e20 796f 7572 2063 6c69 656e  align your clien
-0001a890: 7420 746f 2074 6865 2073 6572 7665 7220  t to the server 
-0001a8a0: 7665 7273 696f 6e22 2c0a 2020 2020 2020  version",.      
-0001a8b0: 2020 2020 2020 2020 2020 7061 7273 6564            parsed
-0001a8c0: 5f73 6572 7665 725f 7665 7273 696f 6e3d  _server_version=
-0001a8d0: 7061 7273 6564 5f73 6572 7665 725f 7665  parsed_server_ve
-0001a8e0: 7273 696f 6e2c 0a20 2020 2020 2020 2020  rsion,.         
-0001a8f0: 2020 2020 2020 2070 6172 7365 645f 636c         parsed_cl
-0001a900: 6965 6e74 5f76 6572 7369 6f6e 3d70 6172  ient_version=par
-0001a910: 7365 645f 636c 6965 6e74 5f76 6572 7369  sed_client_versi
-0001a920: 6f6e 2c0a 2020 2020 2020 2020 2020 2020  on,.            
-0001a930: 290a 2020 2020 2020 2020 2020 2020 7265  ).            re
-0001a940: 7475 726e 2046 616c 7365 0a20 2020 2020  turn False.     
-0001a950: 2020 2069 6620 7061 7273 6564 5f73 6572     if parsed_ser
-0001a960: 7665 725f 7665 7273 696f 6e2e 6d69 6e6f  ver_version.mino
-0001a970: 7220 213d 2070 6172 7365 645f 636c 6965  r != parsed_clie
-0001a980: 6e74 5f76 6572 7369 6f6e 2e6d 696e 6f72  nt_version.minor
-0001a990: 3a0a 2020 2020 2020 2020 2020 2020 6c6f  :.            lo
-0001a9a0: 6767 6572 2e69 6e66 6f28 0a20 2020 2020  gger.info(.     
-0001a9b0: 2020 2020 2020 2020 2020 2022 5365 7276             "Serv
-0001a9c0: 6572 2061 6e64 2063 6c69 656e 7420 7665  er and client ve
-0001a9d0: 7273 696f 6e73 2061 7265 206e 6f74 2074  rsions are not t
-0001a9e0: 6865 2073 616d 6520 6275 7420 636f 6d70  he same but comp
-0001a9f0: 6174 6962 6c65 222c 0a20 2020 2020 2020  atible",.       
-0001aa00: 2020 2020 2020 2020 2070 6172 7365 645f           parsed_
-0001aa10: 7365 7276 6572 5f76 6572 7369 6f6e 3d70  server_version=p
-0001aa20: 6172 7365 645f 7365 7276 6572 5f76 6572  arsed_server_ver
-0001aa30: 7369 6f6e 2c0a 2020 2020 2020 2020 2020  sion,.          
-0001aa40: 2020 2020 2020 7061 7273 6564 5f63 6c69        parsed_cli
-0001aa50: 656e 745f 7665 7273 696f 6e3d 7061 7273  ent_version=pars
-0001aa60: 6564 5f63 6c69 656e 745f 7665 7273 696f  ed_client_versio
-0001aa70: 6e2c 0a20 2020 2020 2020 2020 2020 2029  n,.            )
-0001aa80: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-0001aa90: 5472 7565 0a0a 2020 2020 6465 6620 6372  True..    def cr
-0001aaa0: 6561 7465 5f6d 6f64 656c 5f65 6e64 706f  eate_model_endpo
-0001aab0: 696e 7428 0a20 2020 2020 2020 2073 656c  int(.        sel
-0001aac0: 662c 0a20 2020 2020 2020 2070 726f 6a65  f,.        proje
-0001aad0: 6374 3a20 7374 722c 0a20 2020 2020 2020  ct: str,.       
-0001aae0: 2065 6e64 706f 696e 745f 6964 3a20 7374   endpoint_id: st
-0001aaf0: 722c 0a20 2020 2020 2020 206d 6f64 656c  r,.        model
-0001ab00: 5f65 6e64 706f 696e 743a 2055 6e69 6f6e  _endpoint: Union
-0001ab10: 5b0a 2020 2020 2020 2020 2020 2020 6d6c  [.            ml
-0001ab20: 7275 6e2e 6d6f 6465 6c5f 6d6f 6e69 746f  run.model_monito
-0001ab30: 7269 6e67 2e6d 6f64 656c 5f65 6e64 706f  ring.model_endpo
-0001ab40: 696e 742e 4d6f 6465 6c45 6e64 706f 696e  int.ModelEndpoin
-0001ab50: 742c 2064 6963 740a 2020 2020 2020 2020  t, dict.        
-0001ab60: 5d2c 0a20 2020 2029 3a0a 2020 2020 2020  ],.    ):.      
-0001ab70: 2020 2222 220a 2020 2020 2020 2020 4372    """.        Cr
-0001ab80: 6561 7465 7320 6120 4442 2072 6563 6f72  eates a DB recor
-0001ab90: 6420 7769 7468 2074 6865 2067 6976 656e  d with the given
-0001aba0: 206d 6f64 656c 5f65 6e64 706f 696e 7420   model_endpoint 
-0001abb0: 7265 636f 7264 2e0a 0a20 2020 2020 2020  record...       
-0001abc0: 203a 7061 7261 6d20 7072 6f6a 6563 743a   :param project:
-0001abd0: 2054 6865 206e 616d 6520 6f66 2074 6865   The name of the
-0001abe0: 2070 726f 6a65 6374 2e0a 2020 2020 2020   project..      
-0001abf0: 2020 3a70 6172 616d 2065 6e64 706f 696e    :param endpoin
-0001ac00: 745f 6964 3a20 5468 6520 6964 206f 6620  t_id: The id of 
-0001ac10: 7468 6520 656e 6470 6f69 6e74 2e0a 2020  the endpoint..  
-0001ac20: 2020 2020 2020 3a70 6172 616d 206d 6f64        :param mod
-0001ac30: 656c 5f65 6e64 706f 696e 743a 2041 6e20  el_endpoint: An 
-0001ac40: 6f62 6a65 6374 2072 6570 7265 7365 6e74  object represent
-0001ac50: 696e 6720 7468 6520 6d6f 6465 6c20 656e  ing the model en
-0001ac60: 6470 6f69 6e74 2e0a 2020 2020 2020 2020  dpoint..        
-0001ac70: 2222 220a 0a20 2020 2020 2020 2069 6620  """..        if 
-0001ac80: 6973 696e 7374 616e 6365 280a 2020 2020  isinstance(.    
-0001ac90: 2020 2020 2020 2020 6d6f 6465 6c5f 656e          model_en
-0001aca0: 6470 6f69 6e74 2c20 6d6c 7275 6e2e 6d6f  dpoint, mlrun.mo
-0001acb0: 6465 6c5f 6d6f 6e69 746f 7269 6e67 2e6d  del_monitoring.m
-0001acc0: 6f64 656c 5f65 6e64 706f 696e 742e 4d6f  odel_endpoint.Mo
-0001acd0: 6465 6c45 6e64 706f 696e 740a 2020 2020  delEndpoint.    
-0001ace0: 2020 2020 293a 0a20 2020 2020 2020 2020      ):.         
-0001acf0: 2020 206d 6f64 656c 5f65 6e64 706f 696e     model_endpoin
-0001ad00: 7420 3d20 6d6f 6465 6c5f 656e 6470 6f69  t = model_endpoi
-0001ad10: 6e74 2e74 6f5f 6469 6374 2829 0a0a 2020  nt.to_dict()..  
-0001ad20: 2020 2020 2020 7061 7468 203d 2066 2270        path = f"p
-0001ad30: 726f 6a65 6374 732f 7b70 726f 6a65 6374  rojects/{project
-0001ad40: 7d2f 6d6f 6465 6c2d 656e 6470 6f69 6e74  }/model-endpoint
-0001ad50: 732f 7b65 6e64 706f 696e 745f 6964 7d22  s/{endpoint_id}"
-0001ad60: 0a20 2020 2020 2020 2073 656c 662e 6170  .        self.ap
-0001ad70: 695f 6361 6c6c 280a 2020 2020 2020 2020  i_call(.        
-0001ad80: 2020 2020 6d65 7468 6f64 3d22 504f 5354      method="POST
-0001ad90: 222c 0a20 2020 2020 2020 2020 2020 2070  ",.            p
-0001ada0: 6174 683d 7061 7468 2c0a 2020 2020 2020  ath=path,.      
-0001adb0: 2020 2020 2020 626f 6479 3d64 6963 745f        body=dict_
-0001adc0: 746f 5f6a 736f 6e28 6d6f 6465 6c5f 656e  to_json(model_en
-0001add0: 6470 6f69 6e74 292c 0a20 2020 2020 2020  dpoint),.       
-0001ade0: 2029 0a0a 2020 2020 6465 6620 6465 6c65   )..    def dele
-0001adf0: 7465 5f6d 6f64 656c 5f65 6e64 706f 696e  te_model_endpoin
-0001ae00: 7428 0a20 2020 2020 2020 2073 656c 662c  t(.        self,
-0001ae10: 0a20 2020 2020 2020 2070 726f 6a65 6374  .        project
-0001ae20: 3a20 7374 722c 0a20 2020 2020 2020 2065  : str,.        e
-0001ae30: 6e64 706f 696e 745f 6964 3a20 7374 722c  ndpoint_id: str,
-0001ae40: 0a20 2020 2029 3a0a 2020 2020 2020 2020  .    ):.        
-0001ae50: 2222 220a 2020 2020 2020 2020 4465 6c65  """.        Dele
-0001ae60: 7465 7320 7468 6520 4442 2072 6563 6f72  tes the DB recor
-0001ae70: 6420 6f66 2061 2067 6976 656e 206d 6f64  d of a given mod
-0001ae80: 656c 2065 6e64 706f 696e 742c 2070 726f  el endpoint, pro
-0001ae90: 6a65 6374 2061 6e64 2065 6e64 706f 696e  ject and endpoin
-0001aea0: 745f 6964 2061 7265 2075 7365 6420 666f  t_id are used fo
-0001aeb0: 7220 6c6f 6f6b 7570 0a0a 2020 2020 2020  r lookup..      
-0001aec0: 2020 3a70 6172 616d 2070 726f 6a65 6374    :param project
-0001aed0: 3a20 5468 6520 6e61 6d65 206f 6620 7468  : The name of th
-0001aee0: 6520 7072 6f6a 6563 740a 2020 2020 2020  e project.      
-0001aef0: 2020 3a70 6172 616d 2065 6e64 706f 696e    :param endpoin
-0001af00: 745f 6964 3a20 5468 6520 6964 206f 6620  t_id: The id of 
-0001af10: 7468 6520 656e 6470 6f69 6e74 0a20 2020  the endpoint.   
-0001af20: 2020 2020 2022 2222 0a0a 2020 2020 2020       """..      
-0001af30: 2020 7061 7468 203d 2066 2270 726f 6a65    path = f"proje
-0001af40: 6374 732f 7b70 726f 6a65 6374 7d2f 6d6f  cts/{project}/mo
-0001af50: 6465 6c2d 656e 6470 6f69 6e74 732f 7b65  del-endpoints/{e
-0001af60: 6e64 706f 696e 745f 6964 7d22 0a20 2020  ndpoint_id}".   
-0001af70: 2020 2020 2073 656c 662e 6170 695f 6361       self.api_ca
-0001af80: 6c6c 280a 2020 2020 2020 2020 2020 2020  ll(.            
-0001af90: 6d65 7468 6f64 3d22 4445 4c45 5445 222c  method="DELETE",
-0001afa0: 0a20 2020 2020 2020 2020 2020 2070 6174  .            pat
-0001afb0: 683d 7061 7468 2c0a 2020 2020 2020 2020  h=path,.        
-0001afc0: 290a 0a20 2020 2064 6566 206c 6973 745f  )..    def list_
-0001afd0: 6d6f 6465 6c5f 656e 6470 6f69 6e74 7328  model_endpoints(
-0001afe0: 0a20 2020 2020 2020 2073 656c 662c 0a20  .        self,. 
-0001aff0: 2020 2020 2020 2070 726f 6a65 6374 3a20         project: 
-0001b000: 7374 722c 0a20 2020 2020 2020 206d 6f64  str,.        mod
-0001b010: 656c 3a20 4f70 7469 6f6e 616c 5b73 7472  el: Optional[str
-0001b020: 5d20 3d20 4e6f 6e65 2c0a 2020 2020 2020  ] = None,.      
-0001b030: 2020 6675 6e63 7469 6f6e 3a20 4f70 7469    function: Opti
-0001b040: 6f6e 616c 5b73 7472 5d20 3d20 4e6f 6e65  onal[str] = None
-0001b050: 2c0a 2020 2020 2020 2020 6c61 6265 6c73  ,.        labels
-0001b060: 3a20 4c69 7374 5b73 7472 5d20 3d20 4e6f  : List[str] = No
-0001b070: 6e65 2c0a 2020 2020 2020 2020 7374 6172  ne,.        star
-0001b080: 743a 2073 7472 203d 2022 6e6f 772d 3168  t: str = "now-1h
-0001b090: 222c 0a20 2020 2020 2020 2065 6e64 3a20  ",.        end: 
-0001b0a0: 7374 7220 3d20 226e 6f77 222c 0a20 2020  str = "now",.   
-0001b0b0: 2020 2020 206d 6574 7269 6373 3a20 4f70       metrics: Op
-0001b0c0: 7469 6f6e 616c 5b4c 6973 745b 7374 725d  tional[List[str]
-0001b0d0: 5d20 3d20 4e6f 6e65 2c0a 2020 2020 2020  ] = None,.      
-0001b0e0: 2020 746f 705f 6c65 7665 6c3a 2062 6f6f    top_level: boo
-0001b0f0: 6c20 3d20 4661 6c73 652c 0a20 2020 2020  l = False,.     
-0001b100: 2020 2075 6964 733a 204f 7074 696f 6e61     uids: Optiona
-0001b110: 6c5b 4c69 7374 5b73 7472 5d5d 203d 204e  l[List[str]] = N
-0001b120: 6f6e 652c 0a20 2020 2029 202d 3e20 4c69  one,.    ) -> Li
-0001b130: 7374 5b6d 6c72 756e 2e6d 6f64 656c 5f6d  st[mlrun.model_m
-0001b140: 6f6e 6974 6f72 696e 672e 6d6f 6465 6c5f  onitoring.model_
-0001b150: 656e 6470 6f69 6e74 2e4d 6f64 656c 456e  endpoint.ModelEn
-0001b160: 6470 6f69 6e74 5d3a 0a20 2020 2020 2020  dpoint]:.       
-0001b170: 2022 2222 0a20 2020 2020 2020 2052 6574   """.        Ret
-0001b180: 7572 6e73 2061 206c 6973 7420 6f66 204d  urns a list of M
-0001b190: 6f64 656c 456e 6470 6f69 6e74 5374 6174  odelEndpointStat
-0001b1a0: 6520 6f62 6a65 6374 732e 2045 6163 6820  e objects. Each 
-0001b1b0: 6f62 6a65 6374 2072 6570 7265 7365 6e74  object represent
-0001b1c0: 7320 7468 6520 6375 7272 656e 7420 7374  s the current st
-0001b1d0: 6174 6520 6f66 2061 206d 6f64 656c 2065  ate of a model e
-0001b1e0: 6e64 706f 696e 742e 0a20 2020 2020 2020  ndpoint..       
-0001b1f0: 2054 6869 7320 6675 6e63 7469 6f6e 7320   This functions 
-0001b200: 7375 7070 6f72 7473 2066 696c 7465 7269  supports filteri
-0001b210: 6e67 2062 7920 7468 6520 666f 6c6c 6f77  ng by the follow
-0001b220: 696e 6720 7061 7261 6d65 7465 7273 3a0a  ing parameters:.
-0001b230: 2020 2020 2020 2020 3129 206d 6f64 656c          1) model
-0001b240: 0a20 2020 2020 2020 2032 2920 6675 6e63  .        2) func
-0001b250: 7469 6f6e 0a20 2020 2020 2020 2033 2920  tion.        3) 
-0001b260: 6c61 6265 6c73 0a20 2020 2020 2020 2042  labels.        B
-0001b270: 7920 6465 6661 756c 742c 2077 6865 6e20  y default, when 
-0001b280: 6e6f 2066 696c 7465 7273 2061 7265 2061  no filters are a
-0001b290: 7070 6c69 6564 2c20 616c 6c20 6176 6169  pplied, all avai
-0001b2a0: 6c61 626c 6520 656e 6470 6f69 6e74 7320  lable endpoints 
-0001b2b0: 666f 7220 7468 6520 6769 7665 6e20 7072  for the given pr
-0001b2c0: 6f6a 6563 7420 7769 6c6c 2062 6520 6c69  oject will be li
-0001b2d0: 7374 6564 2e0a 0a20 2020 2020 2020 2049  sted...        I
-0001b2e0: 6e20 6164 6469 7469 6f6e 2c20 7468 6973  n addition, this
-0001b2f0: 2066 756e 6374 696f 6e73 2070 726f 7669   functions provi
-0001b300: 6465 7320 6120 6661 6361 6465 2066 6f72  des a facade for
-0001b310: 206c 6973 7469 6e67 2065 6e64 706f 696e   listing endpoin
-0001b320: 7420 7265 6c61 7465 6420 6d65 7472 6963  t related metric
-0001b330: 732e 2054 6869 7320 6661 6361 6465 2069  s. This facade i
-0001b340: 7320 7469 6d65 2d62 6173 6564 0a20 2020  s time-based.   
-0001b350: 2020 2020 2061 6e64 2064 6570 656e 6473       and depends
-0001b360: 206f 6e20 7468 6520 2773 7461 7274 2720   on the 'start' 
-0001b370: 616e 6420 2765 6e64 2720 7061 7261 6d65  and 'end' parame
-0001b380: 7465 7273 2e20 4279 2064 6566 6175 6c74  ters. By default
-0001b390: 2c20 7768 656e 2074 6865 206d 6574 7269  , when the metri
-0001b3a0: 6373 2070 6172 616d 6574 6572 2069 7320  cs parameter is 
-0001b3b0: 4e6f 6e65 2c20 6e6f 206d 6574 7269 6373  None, no metrics
-0001b3c0: 2061 7265 0a20 2020 2020 2020 2061 6464   are.        add
-0001b3d0: 6564 2074 6f20 7468 6520 6f75 7470 7574  ed to the output
-0001b3e0: 206f 6620 7468 6973 2066 756e 6374 696f   of this functio
-0001b3f0: 6e2e 0a0a 2020 2020 2020 2020 3a70 6172  n...        :par
-0001b400: 616d 2070 726f 6a65 6374 3a20 5468 6520  am project: The 
-0001b410: 6e61 6d65 206f 6620 7468 6520 7072 6f6a  name of the proj
-0001b420: 6563 740a 2020 2020 2020 2020 3a70 6172  ect.        :par
-0001b430: 616d 206d 6f64 656c 3a20 5468 6520 6e61  am model: The na
-0001b440: 6d65 206f 6620 7468 6520 6d6f 6465 6c20  me of the model 
-0001b450: 746f 2066 696c 7465 7220 6279 0a20 2020  to filter by.   
-0001b460: 2020 2020 203a 7061 7261 6d20 6675 6e63       :param func
-0001b470: 7469 6f6e 3a20 5468 6520 6e61 6d65 206f  tion: The name o
-0001b480: 6620 7468 6520 6675 6e63 7469 6f6e 2074  f the function t
-0001b490: 6f20 6669 6c74 6572 2062 790a 2020 2020  o filter by.    
-0001b4a0: 2020 2020 3a70 6172 616d 206c 6162 656c      :param label
-0001b4b0: 733a 2041 206c 6973 7420 6f66 206c 6162  s: A list of lab
-0001b4c0: 656c 7320 746f 2066 696c 7465 7220 6279  els to filter by
-0001b4d0: 2e20 4c61 6265 6c20 6669 6c74 6572 7320  . Label filters 
-0001b4e0: 776f 726b 2062 7920 6569 7468 6572 2066  work by either f
-0001b4f0: 696c 7465 7269 6e67 2061 2073 7065 6369  iltering a speci
-0001b500: 6669 6320 7661 6c75 6520 6f66 2061 0a20  fic value of a. 
-0001b510: 2020 2020 2020 2020 6c61 6265 6c20 2869          label (i
-0001b520: 2e65 2e20 6c69 7374 2822 6b65 793d 7661  .e. list("key=va
-0001b530: 6c75 6522 2929 206f 7220 6279 206c 6f6f  lue")) or by loo
-0001b540: 6b69 6e67 2066 6f72 2074 6865 2065 7869  king for the exi
-0001b550: 7374 656e 6365 206f 6620 6120 6769 7665  stence of a give
-0001b560: 6e20 6b65 7920 2869 2e65 2e20 226b 6579  n key (i.e. "key
-0001b570: 2229 0a20 2020 2020 2020 203a 7061 7261  ").        :para
-0001b580: 6d20 6d65 7472 6963 733a 2041 206c 6973  m metrics: A lis
-0001b590: 7420 6f66 206d 6574 7269 6373 2074 6f20  t of metrics to 
-0001b5a0: 7265 7475 726e 2066 6f72 2065 6163 6820  return for each 
-0001b5b0: 656e 6470 6f69 6e74 2c20 7265 6164 206d  endpoint, read m
-0001b5c0: 6f72 6520 696e 2027 5469 6d65 4d65 7472  ore in 'TimeMetr
-0001b5d0: 6963 270a 2020 2020 2020 2020 3a70 6172  ic'.        :par
-0001b5e0: 616d 2073 7461 7274 3a20 5468 6520 7374  am start: The st
-0001b5f0: 6172 7420 7469 6d65 206f 6620 7468 6520  art time of the 
-0001b600: 6d65 7472 6963 732e 2043 616e 2062 6520  metrics. Can be 
-0001b610: 7265 7072 6573 656e 7465 6420 6279 2061  represented by a
-0001b620: 2073 7472 696e 6720 636f 6e74 6169 6e69   string containi
-0001b630: 6e67 2061 6e20 5246 4320 3333 3339 0a20  ng an RFC 3339. 
-0001b640: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b650: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b660: 7469 6d65 2c20 6120 556e 6978 2074 696d  time, a Unix tim
-0001b670: 6573 7461 6d70 2069 6e20 6d69 6c6c 6973  estamp in millis
-0001b680: 6563 6f6e 6473 2c20 6120 7265 6c61 7469  econds, a relati
-0001b690: 7665 2074 696d 6520 2860 276e 6f77 2760  ve time (`'now'`
-0001b6a0: 206f 720a 2020 2020 2020 2020 2020 2020   or.            
-0001b6b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b6c0: 2020 2020 2060 276e 6f77 2d5b 302d 395d       `'now-[0-9]
-0001b6d0: 2b5b 6d68 645d 2760 2c20 7768 6572 6520  +[mhd]'`, where 
-0001b6e0: 606d 6020 3d20 6d69 6e75 7465 732c 2060  `m` = minutes, `
-0001b6f0: 6860 203d 2068 6f75 7273 2c20 616e 6420  h` = hours, and 
-0001b700: 6027 6427 6020 3d0a 2020 2020 2020 2020  `'d'` =.        
-0001b710: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b720: 2020 2020 2020 2020 2064 6179 7329 2c20           days), 
-0001b730: 6f72 2030 2066 6f72 2074 6865 2065 6172  or 0 for the ear
-0001b740: 6c69 6573 7420 7469 6d65 2e0a 2020 2020  liest time..    
-0001b750: 2020 2020 3a70 6172 616d 2065 6e64 3a20      :param end: 
-0001b760: 5468 6520 656e 6420 7469 6d65 206f 6620  The end time of 
-0001b770: 7468 6520 6d65 7472 6963 732e 2043 616e  the metrics. Can
-0001b780: 2062 6520 7265 7072 6573 656e 7465 6420   be represented 
-0001b790: 6279 2061 2073 7472 696e 6720 636f 6e74  by a string cont
-0001b7a0: 6169 6e69 6e67 2061 6e20 5246 4320 3333  aining an RFC 33
-0001b7b0: 3339 0a20 2020 2020 2020 2020 2020 2020  39.             
-0001b7c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b7d0: 2020 2020 7469 6d65 2c20 6120 556e 6978      time, a Unix
-0001b7e0: 2074 696d 6573 7461 6d70 2069 6e20 6d69   timestamp in mi
-0001b7f0: 6c6c 6973 6563 6f6e 6473 2c20 6120 7265  lliseconds, a re
-0001b800: 6c61 7469 7665 2074 696d 6520 2860 276e  lative time (`'n
-0001b810: 6f77 2760 206f 720a 2020 2020 2020 2020  ow'` or.        
-0001b820: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b830: 2020 2020 2020 2020 2060 276e 6f77 2d5b           `'now-[
-0001b840: 302d 395d 2b5b 6d68 645d 2760 2c20 7768  0-9]+[mhd]'`, wh
-0001b850: 6572 6520 606d 6020 3d20 6d69 6e75 7465  ere `m` = minute
-0001b860: 732c 2060 6860 203d 2068 6f75 7273 2c20  s, `h` = hours, 
-0001b870: 616e 6420 6027 6427 6020 3d0a 2020 2020  and `'d'` =.    
-0001b880: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b890: 2020 2020 2020 2020 2020 2020 2064 6179               day
-0001b8a0: 7329 2c20 6f72 2030 2066 6f72 2074 6865  s), or 0 for the
-0001b8b0: 2065 6172 6c69 6573 7420 7469 6d65 2e0a   earliest time..
-0001b8c0: 2020 2020 2020 2020 3a70 6172 616d 2074          :param t
-0001b8d0: 6f70 5f6c 6576 656c 3a20 6966 2074 7275  op_level: if tru
-0001b8e0: 6520 7769 6c6c 2072 6574 7572 6e20 6f6e  e will return on
-0001b8f0: 6c79 2072 6f75 7465 7273 2061 6e64 2065  ly routers and e
-0001b900: 6e64 706f 696e 7420 7468 6174 2061 7265  ndpoint that are
-0001b910: 204e 4f54 2063 6869 6c64 7265 6e20 6f66   NOT children of
-0001b920: 2061 6e79 2072 6f75 7465 720a 2020 2020   any router.    
-0001b930: 2020 2020 3a70 6172 616d 2075 6964 733a      :param uids:
-0001b940: 2069 6620 7061 7373 6564 2077 696c 6c20   if passed will 
-0001b950: 7265 7475 726e 2060 4d6f 6465 6c45 6e64  return `ModelEnd
-0001b960: 706f 696e 744c 6973 7460 206f 6620 656e  pointList` of en
-0001b970: 6470 6f69 6e74 7320 7769 7468 2075 6964  dpoints with uid
-0001b980: 2069 6e20 7569 6473 0a20 2020 2020 2020   in uids.       
-0001b990: 2022 2222 0a0a 2020 2020 2020 2020 7061   """..        pa
-0001b9a0: 7468 203d 2066 2270 726f 6a65 6374 732f  th = f"projects/
-0001b9b0: 7b70 726f 6a65 6374 7d2f 6d6f 6465 6c2d  {project}/model-
-0001b9c0: 656e 6470 6f69 6e74 7322 0a0a 2020 2020  endpoints"..    
-0001b9d0: 2020 2020 6966 206c 6162 656c 7320 616e      if labels an
-0001b9e0: 6420 6973 696e 7374 616e 6365 286c 6162  d isinstance(lab
-0001b9f0: 656c 732c 2064 6963 7429 3a0a 2020 2020  els, dict):.    
-0001ba00: 2020 2020 2020 2020 6c61 6265 6c73 203d          labels =
-0001ba10: 205b 6622 7b6b 6579 7d3d 7b76 616c 7565   [f"{key}={value
-0001ba20: 7d22 2066 6f72 206b 6579 2c20 7661 6c75  }" for key, valu
-0001ba30: 6520 696e 206c 6162 656c 732e 6974 656d  e in labels.item
-0001ba40: 7328 295d 0a0a 2020 2020 2020 2020 7265  s()]..        re
-0001ba50: 7370 6f6e 7365 203d 2073 656c 662e 6170  sponse = self.ap
-0001ba60: 695f 6361 6c6c 280a 2020 2020 2020 2020  i_call(.        
-0001ba70: 2020 2020 6d65 7468 6f64 3d22 4745 5422      method="GET"
-0001ba80: 2c0a 2020 2020 2020 2020 2020 2020 7061  ,.            pa
-0001ba90: 7468 3d70 6174 682c 0a20 2020 2020 2020  th=path,.       
-0001baa0: 2020 2020 2070 6172 616d 733d 7b0a 2020       params={.  
-0001bab0: 2020 2020 2020 2020 2020 2020 2020 226d                "m
-0001bac0: 6f64 656c 223a 206d 6f64 656c 2c0a 2020  odel": model,.  
-0001bad0: 2020 2020 2020 2020 2020 2020 2020 2266                "f
-0001bae0: 756e 6374 696f 6e22 3a20 6675 6e63 7469  unction": functi
-0001baf0: 6f6e 2c0a 2020 2020 2020 2020 2020 2020  on,.            
-0001bb00: 2020 2020 226c 6162 656c 223a 206c 6162      "label": lab
-0001bb10: 656c 7320 6f72 205b 5d2c 0a20 2020 2020  els or [],.     
-0001bb20: 2020 2020 2020 2020 2020 2022 7374 6172             "star
-0001bb30: 7422 3a20 7374 6172 742c 0a20 2020 2020  t": start,.     
-0001bb40: 2020 2020 2020 2020 2020 2022 656e 6422             "end"
-0001bb50: 3a20 656e 642c 0a20 2020 2020 2020 2020  : end,.         
-0001bb60: 2020 2020 2020 2022 6d65 7472 6963 223a         "metric":
-0001bb70: 206d 6574 7269 6373 206f 7220 5b5d 2c0a   metrics or [],.
-0001bb80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001bb90: 2274 6f70 2d6c 6576 656c 223a 2074 6f70  "top-level": top
-0001bba0: 5f6c 6576 656c 2c0a 2020 2020 2020 2020  _level,.        
-0001bbb0: 2020 2020 2020 2020 2275 6964 223a 2075          "uid": u
-0001bbc0: 6964 732c 0a20 2020 2020 2020 2020 2020  ids,.           
-0001bbd0: 207d 2c0a 2020 2020 2020 2020 290a 0a20   },.        ).. 
-0001bbe0: 2020 2020 2020 2023 2047 656e 6572 6174         # Generat
-0001bbf0: 6520 6120 6c69 7374 206f 6620 6120 6d6f  e a list of a mo
-0001bc00: 6465 6c20 656e 6470 6f69 6e74 2064 6963  del endpoint dic
-0001bc10: 7469 6f6e 6172 6965 730a 2020 2020 2020  tionaries.      
-0001bc20: 2020 6d6f 6465 6c5f 656e 6470 6f69 6e74    model_endpoint
-0001bc30: 7320 3d20 7265 7370 6f6e 7365 2e6a 736f  s = response.jso
-0001bc40: 6e28 295b 2265 6e64 706f 696e 7473 225d  n()["endpoints"]
-0001bc50: 0a20 2020 2020 2020 2069 6620 6d6f 6465  .        if mode
-0001bc60: 6c5f 656e 6470 6f69 6e74 733a 0a20 2020  l_endpoints:.   
-0001bc70: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-0001bc80: 5b0a 2020 2020 2020 2020 2020 2020 2020  [.              
-0001bc90: 2020 6d6c 7275 6e2e 6d6f 6465 6c5f 6d6f    mlrun.model_mo
-0001bca0: 6e69 746f 7269 6e67 2e6d 6f64 656c 5f65  nitoring.model_e
-0001bcb0: 6e64 706f 696e 742e 4d6f 6465 6c45 6e64  ndpoint.ModelEnd
-0001bcc0: 706f 696e 742e 6672 6f6d 5f64 6963 7428  point.from_dict(
-0001bcd0: 6f62 6a29 0a20 2020 2020 2020 2020 2020  obj).           
-0001bce0: 2020 2020 2066 6f72 206f 626a 2069 6e20       for obj in 
-0001bcf0: 6d6f 6465 6c5f 656e 6470 6f69 6e74 730a  model_endpoints.
-0001bd00: 2020 2020 2020 2020 2020 2020 5d0a 2020              ].  
-0001bd10: 2020 2020 2020 7265 7475 726e 205b 5d0a        return [].
-0001bd20: 0a20 2020 2064 6566 2067 6574 5f6d 6f64  .    def get_mod
-0001bd30: 656c 5f65 6e64 706f 696e 7428 0a20 2020  el_endpoint(.   
-0001bd40: 2020 2020 2073 656c 662c 0a20 2020 2020       self,.     
-0001bd50: 2020 2070 726f 6a65 6374 3a20 7374 722c     project: str,
-0001bd60: 0a20 2020 2020 2020 2065 6e64 706f 696e  .        endpoin
-0001bd70: 745f 6964 3a20 7374 722c 0a20 2020 2020  t_id: str,.     
-0001bd80: 2020 2073 7461 7274 3a20 4f70 7469 6f6e     start: Option
-0001bd90: 616c 5b73 7472 5d20 3d20 4e6f 6e65 2c0a  al[str] = None,.
-0001bda0: 2020 2020 2020 2020 656e 643a 204f 7074          end: Opt
-0001bdb0: 696f 6e61 6c5b 7374 725d 203d 204e 6f6e  ional[str] = Non
-0001bdc0: 652c 0a20 2020 2020 2020 206d 6574 7269  e,.        metri
-0001bdd0: 6373 3a20 4f70 7469 6f6e 616c 5b4c 6973  cs: Optional[Lis
-0001bde0: 745b 7374 725d 5d20 3d20 4e6f 6e65 2c0a  t[str]] = None,.
-0001bdf0: 2020 2020 2020 2020 6665 6174 7572 655f          feature_
-0001be00: 616e 616c 7973 6973 3a20 626f 6f6c 203d  analysis: bool =
-0001be10: 2046 616c 7365 2c0a 2020 2020 2920 2d3e   False,.    ) ->
-0001be20: 206d 6c72 756e 2e6d 6f64 656c 5f6d 6f6e   mlrun.model_mon
-0001be30: 6974 6f72 696e 672e 6d6f 6465 6c5f 656e  itoring.model_en
-0001be40: 6470 6f69 6e74 2e4d 6f64 656c 456e 6470  dpoint.ModelEndp
-0001be50: 6f69 6e74 3a0a 2020 2020 2020 2020 2222  oint:.        ""
-0001be60: 220a 2020 2020 2020 2020 5265 7475 726e  ".        Return
-0001be70: 7320 6120 7369 6e67 6c65 2060 4d6f 6465  s a single `Mode
-0001be80: 6c45 6e64 706f 696e 7460 206f 626a 6563  lEndpoint` objec
-0001be90: 7420 7769 7468 2061 6464 6974 696f 6e61  t with additiona
-0001bea0: 6c20 6d65 7472 6963 7320 616e 6420 6665  l metrics and fe
-0001beb0: 6174 7572 6520 7265 6c61 7465 6420 6461  ature related da
-0001bec0: 7461 2e0a 0a20 2020 2020 2020 203a 7061  ta...        :pa
-0001bed0: 7261 6d20 7072 6f6a 6563 743a 2020 2020  ram project:    
-0001bee0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001bef0: 5468 6520 6e61 6d65 206f 6620 7468 6520  The name of the 
-0001bf00: 7072 6f6a 6563 740a 2020 2020 2020 2020  project.        
-0001bf10: 3a70 6172 616d 2065 6e64 706f 696e 745f  :param endpoint_
-0001bf20: 6964 3a20 2020 2020 2020 2020 2020 2020  id:             
-0001bf30: 2020 2054 6865 2075 6e69 7175 6520 6964     The unique id
-0001bf40: 206f 6620 7468 6520 6d6f 6465 6c20 656e   of the model en
-0001bf50: 6470 6f69 6e74 2e0a 2020 2020 2020 2020  dpoint..        
-0001bf60: 3a70 6172 616d 2073 7461 7274 3a20 2020  :param start:   
-0001bf70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001bf80: 2020 2054 6865 2073 7461 7274 2074 696d     The start tim
-0001bf90: 6520 6f66 2074 6865 206d 6574 7269 6373  e of the metrics
-0001bfa0: 2e20 4361 6e20 6265 2072 6570 7265 7365  . Can be represe
-0001bfb0: 6e74 6564 2062 7920 6120 7374 7269 6e67  nted by a string
-0001bfc0: 2063 6f6e 7461 696e 696e 6720 616e 0a20   containing an. 
-0001bfd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001bfe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001bff0: 2020 2020 2020 2020 2020 5246 4320 3333            RFC 33
-0001c000: 3339 2074 696d 652c 2061 2055 6e69 7820  39 time, a Unix 
-0001c010: 7469 6d65 7374 616d 7020 696e 206d 696c  timestamp in mil
-0001c020: 6c69 7365 636f 6e64 732c 2061 2072 656c  liseconds, a rel
-0001c030: 6174 6976 6520 7469 6d65 2028 6027 6e6f  ative time (`'no
-0001c040: 7727 6020 6f72 0a20 2020 2020 2020 2020  w'` or.         
-0001c050: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c060: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c070: 2020 6027 6e6f 772d 5b30 2d39 5d2b 5b6d    `'now-[0-9]+[m
-0001c080: 6864 5d27 602c 2077 6865 7265 2060 6d60  hd]'`, where `m`
-0001c090: 203d 206d 696e 7574 6573 2c20 6068 6020   = minutes, `h` 
-0001c0a0: 3d20 686f 7572 732c 2061 6e64 2060 2764  = hours, and `'d
-0001c0b0: 2760 203d 2064 6179 7329 2c20 6f72 0a20  '` = days), or. 
+0000d100: 6572 732e 6765 7428 0a20 2020 2020 2020  ers.get(.       
+0000d110: 2020 2020 2020 2020 2020 2020 2022 782d               "x-
+0000d120: 6d6c 7275 6e2d 636f 6e74 6169 6e65 722d  mlrun-container-
+0000d130: 696d 6167 6522 2c20 2222 0a20 2020 2020  image", "".     
+0000d140: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
+0000d150: 2020 2020 2020 2020 2065 6c73 653a 0a20           else:. 
+0000d160: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+0000d170: 756e 632e 7374 6174 7573 2e62 7569 6c64  unc.status.build
+0000d180: 5f70 6f64 203d 2072 6573 702e 6865 6164  _pod = resp.head
+0000d190: 6572 732e 6765 7428 2262 7569 6c64 6572  ers.get("builder
+0000d1a0: 5f70 6f64 222c 2022 2229 0a20 2020 2020  _pod", "").     
+0000d1b0: 2020 2020 2020 2020 2020 2066 756e 632e             func.
+0000d1c0: 7370 6563 2e69 6d61 6765 203d 2072 6573  spec.image = res
+0000d1d0: 702e 6865 6164 6572 732e 6765 7428 2266  p.headers.get("f
+0000d1e0: 756e 6374 696f 6e5f 696d 6167 6522 2c20  unction_image", 
+0000d1f0: 2222 290a 0a20 2020 2020 2020 2074 6578  "")..        tex
+0000d200: 7420 3d20 2222 0a20 2020 2020 2020 2069  t = "".        i
+0000d210: 6620 7265 7370 2e63 6f6e 7465 6e74 3a0a  f resp.content:.
+0000d220: 2020 2020 2020 2020 2020 2020 7465 7874              text
+0000d230: 203d 2072 6573 702e 636f 6e74 656e 742e   = resp.content.
+0000d240: 6465 636f 6465 2829 0a20 2020 2020 2020  decode().       
+0000d250: 2072 6574 7572 6e20 7465 7874 2c20 6c61   return text, la
+0000d260: 7374 5f6c 6f67 5f74 696d 6573 7461 6d70  st_log_timestamp
+0000d270: 0a0a 2020 2020 6465 6620 7265 6d6f 7465  ..    def remote
+0000d280: 5f73 7461 7274 2873 656c 662c 2066 756e  _start(self, fun
+0000d290: 635f 7572 6c29 202d 3e20 7363 6865 6d61  c_url) -> schema
+0000d2a0: 732e 4261 636b 6772 6f75 6e64 5461 736b  s.BackgroundTask
+0000d2b0: 3a0a 2020 2020 2020 2020 2222 2245 7865  :.        """Exe
+0000d2c0: 6375 7465 2061 2066 756e 6374 696f 6e20  cute a function 
+0000d2d0: 7265 6d6f 7465 6c79 2c20 5573 6564 2066  remotely, Used f
+0000d2e0: 6f72 2060 6064 6173 6b60 6020 6675 6e63  or ``dask`` func
+0000d2f0: 7469 6f6e 732e 0a0a 2020 2020 2020 2020  tions...        
+0000d300: 3a70 6172 616d 2066 756e 635f 7572 6c3a  :param func_url:
+0000d310: 2055 524c 2074 6f20 7468 6520 6675 6e63   URL to the func
+0000d320: 7469 6f6e 2074 6f20 6265 2065 7865 6375  tion to be execu
+0000d330: 7465 642e 0a20 2020 2020 2020 203a 7265  ted..        :re
+0000d340: 7475 726e 733a 2041 2042 6163 6b67 726f  turns: A Backgro
+0000d350: 756e 6454 6173 6b20 6f62 6a65 6374 2c20  undTask object, 
+0000d360: 7769 7468 2064 6574 6169 6c73 206f 6e20  with details on 
+0000d370: 6578 6563 7574 696f 6e20 7072 6f63 6573  execution proces
+0000d380: 7320 616e 6420 6974 7320 7374 6174 7573  s and its status
+0000d390: 2e0a 2020 2020 2020 2020 2222 220a 0a20  ..        """.. 
+0000d3a0: 2020 2020 2020 2074 7279 3a0a 2020 2020         try:.    
+0000d3b0: 2020 2020 2020 2020 7265 7120 3d20 7b22          req = {"
+0000d3c0: 6675 6e63 7469 6f6e 5572 6c22 3a20 6675  functionUrl": fu
+0000d3d0: 6e63 5f75 726c 7d0a 2020 2020 2020 2020  nc_url}.        
+0000d3e0: 2020 2020 7265 7370 203d 2073 656c 662e      resp = self.
+0000d3f0: 6170 695f 6361 6c6c 280a 2020 2020 2020  api_call(.      
+0000d400: 2020 2020 2020 2020 2020 2250 4f53 5422            "POST"
+0000d410: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0000d420: 2020 2273 7461 7274 2f66 756e 6374 696f    "start/functio
+0000d430: 6e22 2c0a 2020 2020 2020 2020 2020 2020  n",.            
+0000d440: 2020 2020 6a73 6f6e 3d72 6571 2c0a 2020      json=req,.  
+0000d450: 2020 2020 2020 2020 2020 2020 2020 7469                ti
+0000d460: 6d65 6f75 743d 696e 7428 636f 6e66 6967  meout=int(config
+0000d470: 2e73 7562 6d69 745f 7469 6d65 6f75 7429  .submit_timeout)
+0000d480: 206f 7220 3630 2c0a 2020 2020 2020 2020   or 60,.        
+0000d490: 2020 2020 290a 2020 2020 2020 2020 6578      ).        ex
+0000d4a0: 6365 7074 204f 5345 7272 6f72 2061 7320  cept OSError as 
+0000d4b0: 6572 723a 0a20 2020 2020 2020 2020 2020  err:.           
+0000d4c0: 206c 6f67 6765 722e 6572 726f 7228 6622   logger.error(f"
+0000d4d0: 6572 726f 7220 7374 6172 7469 6e67 2066  error starting f
+0000d4e0: 756e 6374 696f 6e3a 207b 6572 725f 746f  unction: {err_to
+0000d4f0: 5f73 7472 2865 7272 297d 2229 0a20 2020  _str(err)}").   
+0000d500: 2020 2020 2020 2020 2072 6169 7365 204f           raise O
+0000d510: 5345 7272 6f72 2866 2265 7272 6f72 3a20  SError(f"error: 
+0000d520: 6361 6e6e 6f74 2073 7461 7274 2066 756e  cannot start fun
+0000d530: 6374 696f 6e2c 207b 6572 725f 746f 5f73  ction, {err_to_s
+0000d540: 7472 2865 7272 297d 2229 0a0a 2020 2020  tr(err)}")..    
+0000d550: 2020 2020 6966 206e 6f74 2072 6573 702e      if not resp.
+0000d560: 6f6b 3a0a 2020 2020 2020 2020 2020 2020  ok:.            
+0000d570: 6c6f 6767 6572 2e65 7272 6f72 2866 2262  logger.error(f"b
+0000d580: 6164 2072 6573 7021 215c 6e7b 7265 7370  ad resp!!\n{resp
+0000d590: 2e74 6578 747d 2229 0a20 2020 2020 2020  .text}").       
+0000d5a0: 2020 2020 2072 6169 7365 2056 616c 7565       raise Value
+0000d5b0: 4572 726f 7228 2262 6164 2066 756e 6374  Error("bad funct
+0000d5c0: 696f 6e20 7374 6172 7420 7265 7370 6f6e  ion start respon
+0000d5d0: 7365 2229 0a0a 2020 2020 2020 2020 7265  se")..        re
+0000d5e0: 7475 726e 2073 6368 656d 6173 2e42 6163  turn schemas.Bac
+0000d5f0: 6b67 726f 756e 6454 6173 6b28 2a2a 7265  kgroundTask(**re
+0000d600: 7370 2e6a 736f 6e28 2929 0a0a 2020 2020  sp.json())..    
+0000d610: 6465 6620 6765 745f 7072 6f6a 6563 745f  def get_project_
+0000d620: 6261 636b 6772 6f75 6e64 5f74 6173 6b28  background_task(
+0000d630: 0a20 2020 2020 2020 2073 656c 662c 0a20  .        self,. 
+0000d640: 2020 2020 2020 2070 726f 6a65 6374 3a20         project: 
+0000d650: 7374 722c 0a20 2020 2020 2020 206e 616d  str,.        nam
+0000d660: 653a 2073 7472 2c0a 2020 2020 2920 2d3e  e: str,.    ) ->
+0000d670: 2073 6368 656d 6173 2e42 6163 6b67 726f   schemas.Backgro
+0000d680: 756e 6454 6173 6b3a 0a20 2020 2020 2020  undTask:.       
+0000d690: 2022 2222 5265 7472 6965 7665 2075 7064   """Retrieve upd
+0000d6a0: 6174 6564 2069 6e66 6f72 6d61 7469 6f6e  ated information
+0000d6b0: 206f 6e20 6120 7072 6f6a 6563 7420 6261   on a project ba
+0000d6c0: 636b 6772 6f75 6e64 2074 6173 6b20 6265  ckground task be
+0000d6d0: 696e 6720 6578 6563 7574 6564 2e22 2222  ing executed."""
+0000d6e0: 0a0a 2020 2020 2020 2020 7072 6f6a 6563  ..        projec
+0000d6f0: 7420 3d20 7072 6f6a 6563 7420 6f72 2063  t = project or c
+0000d700: 6f6e 6669 672e 6465 6661 756c 745f 7072  onfig.default_pr
+0000d710: 6f6a 6563 740a 2020 2020 2020 2020 7061  oject.        pa
+0000d720: 7468 203d 2066 2270 726f 6a65 6374 732f  th = f"projects/
+0000d730: 7b70 726f 6a65 6374 7d2f 6261 636b 6772  {project}/backgr
+0000d740: 6f75 6e64 2d74 6173 6b73 2f7b 6e61 6d65  ound-tasks/{name
+0000d750: 7d22 0a20 2020 2020 2020 2065 7272 6f72  }".        error
+0000d760: 5f6d 6573 7361 6765 203d 2028 0a20 2020  _message = (.   
+0000d770: 2020 2020 2020 2020 2066 2246 6169 6c65           f"Faile
+0000d780: 6420 6765 7474 696e 6720 7072 6f6a 6563  d getting projec
+0000d790: 7420 6261 636b 6772 6f75 6e64 2074 6173  t background tas
+0000d7a0: 6b2e 2070 726f 6a65 6374 3d7b 7072 6f6a  k. project={proj
+0000d7b0: 6563 747d 2c20 6e61 6d65 3d7b 6e61 6d65  ect}, name={name
+0000d7c0: 7d22 0a20 2020 2020 2020 2029 0a20 2020  }".        ).   
+0000d7d0: 2020 2020 2072 6573 706f 6e73 6520 3d20       response = 
+0000d7e0: 7365 6c66 2e61 7069 5f63 616c 6c28 2247  self.api_call("G
+0000d7f0: 4554 222c 2070 6174 682c 2065 7272 6f72  ET", path, error
+0000d800: 5f6d 6573 7361 6765 290a 2020 2020 2020  _message).      
+0000d810: 2020 7265 7475 726e 2073 6368 656d 6173    return schemas
+0000d820: 2e42 6163 6b67 726f 756e 6454 6173 6b28  .BackgroundTask(
+0000d830: 2a2a 7265 7370 6f6e 7365 2e6a 736f 6e28  **response.json(
+0000d840: 2929 0a0a 2020 2020 6465 6620 6765 745f  ))..    def get_
+0000d850: 6261 636b 6772 6f75 6e64 5f74 6173 6b28  background_task(
+0000d860: 7365 6c66 2c20 6e61 6d65 3a20 7374 7229  self, name: str)
+0000d870: 202d 3e20 7363 6865 6d61 732e 4261 636b   -> schemas.Back
+0000d880: 6772 6f75 6e64 5461 736b 3a0a 2020 2020  groundTask:.    
+0000d890: 2020 2020 2222 2252 6574 7269 6576 6520      """Retrieve 
+0000d8a0: 7570 6461 7465 6420 696e 666f 726d 6174  updated informat
+0000d8b0: 696f 6e20 6f6e 2061 2062 6163 6b67 726f  ion on a backgro
+0000d8c0: 756e 6420 7461 736b 2062 6569 6e67 2065  und task being e
+0000d8d0: 7865 6375 7465 642e 2222 220a 0a20 2020  xecuted."""..   
+0000d8e0: 2020 2020 2070 6174 6820 3d20 6622 6261       path = f"ba
+0000d8f0: 636b 6772 6f75 6e64 2d74 6173 6b73 2f7b  ckground-tasks/{
+0000d900: 6e61 6d65 7d22 0a20 2020 2020 2020 2065  name}".        e
+0000d910: 7272 6f72 5f6d 6573 7361 6765 203d 2066  rror_message = f
+0000d920: 2246 6169 6c65 6420 6765 7474 696e 6720  "Failed getting 
+0000d930: 6261 636b 6772 6f75 6e64 2074 6173 6b2e  background task.
+0000d940: 206e 616d 653d 7b6e 616d 657d 220a 2020   name={name}".  
+0000d950: 2020 2020 2020 7265 7370 6f6e 7365 203d        response =
+0000d960: 2073 656c 662e 6170 695f 6361 6c6c 2822   self.api_call("
+0000d970: 4745 5422 2c20 7061 7468 2c20 6572 726f  GET", path, erro
+0000d980: 725f 6d65 7373 6167 6529 0a20 2020 2020  r_message).     
+0000d990: 2020 2072 6574 7572 6e20 7363 6865 6d61     return schema
+0000d9a0: 732e 4261 636b 6772 6f75 6e64 5461 736b  s.BackgroundTask
+0000d9b0: 282a 2a72 6573 706f 6e73 652e 6a73 6f6e  (**response.json
+0000d9c0: 2829 290a 0a20 2020 2064 6566 2072 656d  ())..    def rem
+0000d9d0: 6f74 655f 7374 6174 7573 2873 656c 662c  ote_status(self,
+0000d9e0: 2070 726f 6a65 6374 2c20 6e61 6d65 2c20   project, name, 
+0000d9f0: 6b69 6e64 2c20 7365 6c65 6374 6f72 293a  kind, selector):
+0000da00: 0a20 2020 2020 2020 2022 2222 5265 7472  .        """Retr
+0000da10: 6965 7665 2073 7461 7475 7320 6f66 2061  ieve status of a
+0000da20: 2066 756e 6374 696f 6e20 6265 696e 6720   function being 
+0000da30: 6578 6563 7574 6564 2072 656d 6f74 656c  executed remotel
+0000da40: 7920 2872 656c 6576 616e 7420 746f 2060  y (relevant to `
+0000da50: 6064 6173 6b60 6020 6675 6e63 7469 6f6e  `dask`` function
+0000da60: 7329 2e0a 0a20 2020 2020 2020 203a 7061  s)...        :pa
+0000da70: 7261 6d20 7072 6f6a 6563 743a 2054 6865  ram project: The
+0000da80: 2070 726f 6a65 6374 206f 6620 7468 6520   project of the 
+0000da90: 6675 6e63 7469 6f6e 0a20 2020 2020 2020  function.       
+0000daa0: 203a 7061 7261 6d20 6e61 6d65 3a20 5468   :param name: Th
+0000dab0: 6520 6e61 6d65 206f 6620 7468 6520 6675  e name of the fu
+0000dac0: 6e63 7469 6f6e 0a20 2020 2020 2020 203a  nction.        :
+0000dad0: 7061 7261 6d20 6b69 6e64 3a20 5468 6520  param kind: The 
+0000dae0: 6b69 6e64 206f 6620 7468 6520 6675 6e63  kind of the func
+0000daf0: 7469 6f6e 2c20 6375 7272 656e 746c 7920  tion, currently 
+0000db00: 6060 6461 736b 6060 2069 7320 7375 7070  ``dask`` is supp
+0000db10: 6f72 7465 642e 0a20 2020 2020 2020 203a  orted..        :
+0000db20: 7061 7261 6d20 7365 6c65 6374 6f72 3a20  param selector: 
+0000db30: 5365 6c65 6374 6f72 2063 6c61 7573 6520  Selector clause 
+0000db40: 746f 2062 6520 6170 706c 6965 6420 746f  to be applied to
+0000db50: 2074 6865 204b 7562 6572 6e65 7465 7320   the Kubernetes 
+0000db60: 7374 6174 7573 2071 7565 7279 2074 6f20  status query to 
+0000db70: 6669 6c74 6572 2074 6865 2072 6573 756c  filter the resul
+0000db80: 7473 2e0a 2020 2020 2020 2020 2222 220a  ts..        """.
+0000db90: 0a20 2020 2020 2020 2074 7279 3a0a 2020  .        try:.  
+0000dba0: 2020 2020 2020 2020 2020 7265 7120 3d20            req = 
+0000dbb0: 7b22 6b69 6e64 223a 206b 696e 642c 2022  {"kind": kind, "
+0000dbc0: 7365 6c65 6374 6f72 223a 2073 656c 6563  selector": selec
+0000dbd0: 746f 722c 2022 7072 6f6a 6563 7422 3a20  tor, "project": 
+0000dbe0: 7072 6f6a 6563 742c 2022 6e61 6d65 223a  project, "name":
+0000dbf0: 206e 616d 657d 0a20 2020 2020 2020 2020   name}.         
+0000dc00: 2020 2072 6573 7020 3d20 7365 6c66 2e61     resp = self.a
+0000dc10: 7069 5f63 616c 6c28 2250 4f53 5422 2c20  pi_call("POST", 
+0000dc20: 2273 7461 7475 732f 6675 6e63 7469 6f6e  "status/function
+0000dc30: 222c 206a 736f 6e3d 7265 7129 0a20 2020  ", json=req).   
+0000dc40: 2020 2020 2065 7863 6570 7420 4f53 4572       except OSEr
+0000dc50: 726f 7220 6173 2065 7272 3a0a 2020 2020  ror as err:.    
+0000dc60: 2020 2020 2020 2020 6c6f 6767 6572 2e65          logger.e
+0000dc70: 7272 6f72 2866 2265 7272 6f72 2073 7461  rror(f"error sta
+0000dc80: 7274 696e 6720 6675 6e63 7469 6f6e 3a20  rting function: 
+0000dc90: 7b65 7272 5f74 6f5f 7374 7228 6572 7229  {err_to_str(err)
+0000dca0: 7d22 290a 2020 2020 2020 2020 2020 2020  }").            
+0000dcb0: 7261 6973 6520 4f53 4572 726f 7228 6622  raise OSError(f"
+0000dcc0: 6572 726f 723a 2063 616e 6e6f 7420 7374  error: cannot st
+0000dcd0: 6172 7420 6675 6e63 7469 6f6e 2c20 7b65  art function, {e
+0000dce0: 7272 5f74 6f5f 7374 7228 6572 7229 7d22  rr_to_str(err)}"
+0000dcf0: 290a 0a20 2020 2020 2020 2069 6620 6e6f  )..        if no
+0000dd00: 7420 7265 7370 2e6f 6b3a 0a20 2020 2020  t resp.ok:.     
+0000dd10: 2020 2020 2020 206c 6f67 6765 722e 6572         logger.er
+0000dd20: 726f 7228 6622 6261 6420 7265 7370 2121  ror(f"bad resp!!
+0000dd30: 5c6e 7b72 6573 702e 7465 7874 7d22 290a  \n{resp.text}").
+0000dd40: 2020 2020 2020 2020 2020 2020 7261 6973              rais
+0000dd50: 6520 5661 6c75 6545 7272 6f72 2822 6261  e ValueError("ba
+0000dd60: 6420 6675 6e63 7469 6f6e 2073 7461 7475  d function statu
+0000dd70: 7320 7265 7370 6f6e 7365 2229 0a0a 2020  s response")..  
+0000dd80: 2020 2020 2020 7265 7475 726e 2072 6573        return res
+0000dd90: 702e 6a73 6f6e 2829 5b22 6461 7461 225d  p.json()["data"]
+0000dda0: 0a0a 2020 2020 6465 6620 7375 626d 6974  ..    def submit
+0000ddb0: 5f6a 6f62 280a 2020 2020 2020 2020 7365  _job(.        se
+0000ddc0: 6c66 2c20 7275 6e73 7065 632c 2073 6368  lf, runspec, sch
+0000ddd0: 6564 756c 653a 2055 6e69 6f6e 5b73 7472  edule: Union[str
+0000dde0: 2c20 7363 6865 6d61 732e 5363 6865 6475  , schemas.Schedu
+0000ddf0: 6c65 4372 6f6e 5472 6967 6765 725d 203d  leCronTrigger] =
+0000de00: 204e 6f6e 650a 2020 2020 293a 0a20 2020   None.    ):.   
+0000de10: 2020 2020 2022 2222 5375 626d 6974 2061       """Submit a
+0000de20: 206a 6f62 2066 6f72 2072 656d 6f74 6520   job for remote 
+0000de30: 6578 6563 7574 696f 6e2e 0a0a 2020 2020  execution...    
+0000de40: 2020 2020 3a70 6172 616d 2072 756e 7370      :param runsp
+0000de50: 6563 3a20 5468 6520 7275 6e74 696d 6520  ec: The runtime 
+0000de60: 6f62 6a65 6374 2073 7065 6320 2854 6173  object spec (Tas
+0000de70: 6b29 2074 6f20 6578 6563 7574 652e 0a20  k) to execute.. 
+0000de80: 2020 2020 2020 203a 7061 7261 6d20 7363         :param sc
+0000de90: 6865 6475 6c65 3a20 5768 6574 6865 7220  hedule: Whether 
+0000dea0: 746f 2073 6368 6564 756c 6520 7468 6973  to schedule this
+0000deb0: 206a 6f62 2075 7369 6e67 2061 2043 726f   job using a Cro
+0000dec0: 6e20 7472 6967 6765 722e 2049 6620 6e6f  n trigger. If no
+0000ded0: 7420 7370 6563 6966 6965 642c 2074 6865  t specified, the
+0000dee0: 206a 6f62 2077 696c 6c20 6265 2073 7562   job will be sub
+0000def0: 6d69 7474 6564 0a20 2020 2020 2020 2020  mitted.         
+0000df00: 2020 2069 6d6d 6564 6961 7465 6c79 2e0a     immediately..
+0000df10: 2020 2020 2020 2020 2222 220a 0a20 2020          """..   
+0000df20: 2020 2020 2074 7279 3a0a 2020 2020 2020       try:.      
+0000df30: 2020 2020 2020 7265 7120 3d20 7b22 7461        req = {"ta
+0000df40: 736b 223a 2072 756e 7370 6563 2e74 6f5f  sk": runspec.to_
+0000df50: 6469 6374 2829 7d0a 2020 2020 2020 2020  dict()}.        
+0000df60: 2020 2020 6966 2073 6368 6564 756c 653a      if schedule:
+0000df70: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000df80: 2069 6620 6973 696e 7374 616e 6365 2873   if isinstance(s
+0000df90: 6368 6564 756c 652c 2073 6368 656d 6173  chedule, schemas
+0000dfa0: 2e53 6368 6564 756c 6543 726f 6e54 7269  .ScheduleCronTri
+0000dfb0: 6767 6572 293a 0a20 2020 2020 2020 2020  gger):.         
+0000dfc0: 2020 2020 2020 2020 2020 2073 6368 6564             sched
+0000dfd0: 756c 6520 3d20 7363 6865 6475 6c65 2e64  ule = schedule.d
+0000dfe0: 6963 7428 290a 2020 2020 2020 2020 2020  ict().          
+0000dff0: 2020 2020 2020 7265 715b 2273 6368 6564        req["sched
+0000e000: 756c 6522 5d20 3d20 7363 6865 6475 6c65  ule"] = schedule
+0000e010: 0a20 2020 2020 2020 2020 2020 2074 696d  .            tim
+0000e020: 656f 7574 203d 2028 696e 7428 636f 6e66  eout = (int(conf
+0000e030: 6967 2e73 7562 6d69 745f 7469 6d65 6f75  ig.submit_timeou
+0000e040: 7429 206f 7220 3132 3029 202b 2032 300a  t) or 120) + 20.
+0000e050: 2020 2020 2020 2020 2020 2020 7265 7370              resp
+0000e060: 203d 2073 656c 662e 6170 695f 6361 6c6c   = self.api_call
+0000e070: 2822 504f 5354 222c 2022 7375 626d 6974  ("POST", "submit
+0000e080: 5f6a 6f62 222c 206a 736f 6e3d 7265 712c  _job", json=req,
+0000e090: 2074 696d 656f 7574 3d74 696d 656f 7574   timeout=timeout
+0000e0a0: 290a 0a20 2020 2020 2020 2065 7863 6570  )..        excep
+0000e0b0: 7420 7265 7175 6573 7473 2e48 5454 5045  t requests.HTTPE
+0000e0c0: 7272 6f72 2061 7320 6572 723a 0a20 2020  rror as err:.   
+0000e0d0: 2020 2020 2020 2020 206c 6f67 6765 722e           logger.
+0000e0e0: 6572 726f 7228 6622 6572 726f 7220 7375  error(f"error su
+0000e0f0: 626d 6974 7469 6e67 2074 6173 6b3a 207b  bmitting task: {
+0000e100: 6572 725f 746f 5f73 7472 2865 7272 297d  err_to_str(err)}
+0000e110: 2229 0a20 2020 2020 2020 2020 2020 2023  ").            #
+0000e120: 206e 6f74 2063 7265 6174 696e 6720 6120   not creating a 
+0000e130: 6e65 7720 6578 6365 7074 696f 6e20 6865  new exception he
+0000e140: 7265 2c20 696e 206f 7264 6572 2074 6f20  re, in order to 
+0000e150: 6b65 6570 2074 6865 2072 6573 706f 6e73  keep the respons
+0000e160: 6520 616e 6420 7374 6174 7573 2063 6f64  e and status cod
+0000e170: 6520 696e 2074 6865 2065 7863 6570 7469  e in the excepti
+0000e180: 6f6e 0a20 2020 2020 2020 2020 2020 2072  on.            r
+0000e190: 6169 7365 0a0a 2020 2020 2020 2020 6578  aise..        ex
+0000e1a0: 6365 7074 204f 5345 7272 6f72 2061 7320  cept OSError as 
+0000e1b0: 6572 723a 0a20 2020 2020 2020 2020 2020  err:.           
+0000e1c0: 206c 6f67 6765 722e 6572 726f 7228 6622   logger.error(f"
+0000e1d0: 6572 726f 7220 7375 626d 6974 7469 6e67  error submitting
+0000e1e0: 2074 6173 6b3a 207b 6572 725f 746f 5f73   task: {err_to_s
+0000e1f0: 7472 2865 7272 297d 2229 0a20 2020 2020  tr(err)}").     
+0000e200: 2020 2020 2020 2072 6169 7365 204f 5345         raise OSE
+0000e210: 7272 6f72 2822 6572 726f 723a 2063 616e  rror("error: can
+0000e220: 6e6f 7420 7375 626d 6974 2074 6173 6b22  not submit task"
+0000e230: 2920 6672 6f6d 2065 7272 0a0a 2020 2020  ) from err..    
+0000e240: 2020 2020 6966 206e 6f74 2072 6573 702e      if not resp.
+0000e250: 6f6b 3a0a 2020 2020 2020 2020 2020 2020  ok:.            
+0000e260: 6c6f 6767 6572 2e65 7272 6f72 2866 2262  logger.error(f"b
+0000e270: 6164 2072 6573 7021 215c 6e7b 7265 7370  ad resp!!\n{resp
+0000e280: 2e74 6578 747d 2229 0a20 2020 2020 2020  .text}").       
+0000e290: 2020 2020 2072 6169 7365 2056 616c 7565       raise Value
+0000e2a0: 4572 726f 7228 6622 6261 6420 6675 6e63  Error(f"bad func
+0000e2b0: 7469 6f6e 2072 756e 2072 6573 706f 6e73  tion run respons
+0000e2c0: 652c 207b 7265 7370 2e74 6578 747d 2229  e, {resp.text}")
+0000e2d0: 0a0a 2020 2020 2020 2020 7265 7370 203d  ..        resp =
+0000e2e0: 2072 6573 702e 6a73 6f6e 2829 0a20 2020   resp.json().   
+0000e2f0: 2020 2020 2072 6574 7572 6e20 7265 7370       return resp
+0000e300: 5b22 6461 7461 225d 0a0a 2020 2020 6465  ["data"]..    de
+0000e310: 6620 7375 626d 6974 5f70 6970 656c 696e  f submit_pipelin
+0000e320: 6528 0a20 2020 2020 2020 2073 656c 662c  e(.        self,
+0000e330: 0a20 2020 2020 2020 2070 726f 6a65 6374  .        project
+0000e340: 2c0a 2020 2020 2020 2020 7069 7065 6c69  ,.        pipeli
+0000e350: 6e65 2c0a 2020 2020 2020 2020 6172 6775  ne,.        argu
+0000e360: 6d65 6e74 733d 4e6f 6e65 2c0a 2020 2020  ments=None,.    
+0000e370: 2020 2020 6578 7065 7269 6d65 6e74 3d4e      experiment=N
+0000e380: 6f6e 652c 0a20 2020 2020 2020 2072 756e  one,.        run
+0000e390: 3d4e 6f6e 652c 0a20 2020 2020 2020 206e  =None,.        n
+0000e3a0: 616d 6573 7061 6365 3d4e 6f6e 652c 0a20  amespace=None,. 
+0000e3b0: 2020 2020 2020 2061 7274 6966 6163 745f         artifact_
+0000e3c0: 7061 7468 3d4e 6f6e 652c 0a20 2020 2020  path=None,.     
+0000e3d0: 2020 206f 7073 3d4e 6f6e 652c 0a20 2020     ops=None,.   
+0000e3e0: 2020 2020 2023 2054 4f44 4f3a 2064 6570       # TODO: dep
+0000e3f0: 7265 6361 7465 642c 2072 656d 6f76 6520  recated, remove 
+0000e400: 696e 2031 2e35 2e30 0a20 2020 2020 2020  in 1.5.0.       
+0000e410: 2074 746c 3d4e 6f6e 652c 0a20 2020 2020   ttl=None,.     
+0000e420: 2020 2063 6c65 616e 7570 5f74 746c 3d4e     cleanup_ttl=N
+0000e430: 6f6e 652c 0a20 2020 2029 3a0a 2020 2020  one,.    ):.    
+0000e440: 2020 2020 2222 2253 7562 6d69 7420 6120      """Submit a 
+0000e450: 4b46 5020 7069 7065 6c69 6e65 2066 6f72  KFP pipeline for
+0000e460: 2065 7865 6375 7469 6f6e 2e0a 0a20 2020   execution...   
+0000e470: 2020 2020 203a 7061 7261 6d20 7072 6f6a       :param proj
+0000e480: 6563 743a 2054 6865 2070 726f 6a65 6374  ect: The project
+0000e490: 206f 6620 7468 6520 7069 7065 6c69 6e65   of the pipeline
+0000e4a0: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
+0000e4b0: 7069 7065 6c69 6e65 3a20 5069 7065 6c69  pipeline: Pipeli
+0000e4c0: 6e65 2066 756e 6374 696f 6e20 6f72 2070  ne function or p
+0000e4d0: 6174 6820 746f 202e 7961 6d6c 2f2e 7a69  ath to .yaml/.zi
+0000e4e0: 7020 7069 7065 6c69 6e65 2066 696c 652e  p pipeline file.
+0000e4f0: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
+0000e500: 6172 6775 6d65 6e74 733a 2041 2064 6963  arguments: A dic
+0000e510: 7469 6f6e 6172 7920 6f66 2061 7267 756d  tionary of argum
+0000e520: 656e 7473 2074 6f20 7061 7373 2074 6f20  ents to pass to 
+0000e530: 7468 6520 7069 7065 6c69 6e65 2e0a 2020  the pipeline..  
+0000e540: 2020 2020 2020 3a70 6172 616d 2065 7870        :param exp
+0000e550: 6572 696d 656e 743a 2041 206e 616d 6520  eriment: A name 
+0000e560: 746f 2061 7373 6967 6e20 666f 7220 7468  to assign for th
+0000e570: 6520 7370 6563 6966 6963 2065 7870 6572  e specific exper
+0000e580: 696d 656e 742e 0a20 2020 2020 2020 203a  iment..        :
+0000e590: 7061 7261 6d20 7275 6e3a 2041 206e 616d  param run: A nam
+0000e5a0: 6520 666f 7220 7468 6973 2073 7065 6369  e for this speci
+0000e5b0: 6669 6320 7275 6e2e 0a20 2020 2020 2020  fic run..       
+0000e5c0: 203a 7061 7261 6d20 6e61 6d65 7370 6163   :param namespac
+0000e5d0: 653a 204b 7562 6572 6e65 7465 7320 6e61  e: Kubernetes na
+0000e5e0: 6d65 7370 6163 6520 746f 2065 7865 6375  mespace to execu
+0000e5f0: 7465 2074 6865 2070 6970 656c 696e 6520  te the pipeline 
+0000e600: 696e 2e0a 2020 2020 2020 2020 3a70 6172  in..        :par
+0000e610: 616d 2061 7274 6966 6163 745f 7061 7468  am artifact_path
+0000e620: 3a20 4120 7061 7468 2074 6f20 6172 7469  : A path to arti
+0000e630: 6661 6374 7320 7573 6564 2062 7920 7468  facts used by th
+0000e640: 6973 2070 6970 656c 696e 652e 0a20 2020  is pipeline..   
+0000e650: 2020 2020 203a 7061 7261 6d20 6f70 733a       :param ops:
+0000e660: 2054 7261 6e73 666f 726d 6572 7320 746f   Transformers to
+0000e670: 2061 7070 6c79 206f 6e20 616c 6c20 6f70   apply on all op
+0000e680: 7320 696e 2074 6865 2070 6970 656c 696e  s in the pipelin
+0000e690: 652e 0a20 2020 2020 2020 203a 7061 7261  e..        :para
+0000e6a0: 6d20 7474 6c3a 2070 6970 656c 696e 6520  m ttl: pipeline 
+0000e6b0: 636c 6561 6e75 7020 7474 6c20 696e 2073  cleanup ttl in s
+0000e6c0: 6563 7320 2874 696d 6520 746f 2077 6169  ecs (time to wai
+0000e6d0: 7420 6166 7465 7220 776f 726b 666c 6f77  t after workflow
+0000e6e0: 2063 6f6d 706c 6574 696f 6e2c 2061 7420   completion, at 
+0000e6f0: 7768 6963 6820 706f 696e 7420 7468 6520  which point the 
+0000e700: 776f 726b 666c 6f77 0a20 2020 2020 2020  workflow.       
+0000e710: 2020 2020 2020 2020 2020 2020 2061 6e64               and
+0000e720: 2061 6c6c 2069 7473 2072 6573 6f75 7263   all its resourc
+0000e730: 6573 2061 7265 2064 656c 6574 6564 2920  es are deleted) 
+0000e740: 2864 6570 7265 6361 7465 642c 2075 7365  (deprecated, use
+0000e750: 2063 6c65 616e 7570 5f74 746c 2069 6e73   cleanup_ttl ins
+0000e760: 7465 6164 290a 2020 2020 2020 2020 3a70  tead).        :p
+0000e770: 6172 616d 2063 6c65 616e 7570 5f74 746c  aram cleanup_ttl
+0000e780: 3a20 7069 7065 6c69 6e65 2063 6c65 616e  : pipeline clean
+0000e790: 7570 2074 746c 2069 6e20 7365 6373 2028  up ttl in secs (
+0000e7a0: 7469 6d65 2074 6f20 7761 6974 2061 6674  time to wait aft
+0000e7b0: 6572 2077 6f72 6b66 6c6f 7720 636f 6d70  er workflow comp
+0000e7c0: 6c65 7469 6f6e 2c20 6174 2077 6869 6368  letion, at which
+0000e7d0: 2070 6f69 6e74 2074 6865 0a20 2020 2020   point the.     
+0000e7e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e7f0: 2020 2020 2020 2077 6f72 6b66 6c6f 7720         workflow 
+0000e800: 616e 6420 616c 6c20 6974 7320 7265 736f  and all its reso
+0000e810: 7572 6365 7320 6172 6520 6465 6c65 7465  urces are delete
+0000e820: 6429 0a20 2020 2020 2020 2022 2222 0a0a  d).        """..
+0000e830: 2020 2020 2020 2020 6966 2074 746c 3a0a          if ttl:.
+0000e840: 2020 2020 2020 2020 2020 2020 7761 726e              warn
+0000e850: 696e 6773 2e77 6172 6e28 0a20 2020 2020  ings.warn(.     
+0000e860: 2020 2020 2020 2020 2020 2022 2774 746c             "'ttl
+0000e870: 2720 6973 2064 6570 7265 6361 7465 642c  ' is deprecated,
+0000e880: 2075 7365 2027 636c 6561 6e75 705f 7474   use 'cleanup_tt
+0000e890: 6c27 2069 6e73 7465 6164 2e20 220a 2020  l' instead. ".  
+0000e8a0: 2020 2020 2020 2020 2020 2020 2020 2254                "T
+0000e8b0: 6869 7320 7769 6c6c 2062 6520 7265 6d6f  his will be remo
+0000e8c0: 7665 6420 696e 2031 2e35 2e30 222c 0a20  ved in 1.5.0",. 
+0000e8d0: 2020 2020 2020 2020 2020 2020 2020 2023                 #
+0000e8e0: 2054 4f44 4f3a 2052 656d 6f76 6520 7468   TODO: Remove th
+0000e8f0: 6973 2069 6e20 312e 352e 300a 2020 2020  is in 1.5.0.    
+0000e900: 2020 2020 2020 2020 2020 2020 4675 7475              Futu
+0000e910: 7265 5761 726e 696e 672c 0a20 2020 2020  reWarning,.     
+0000e920: 2020 2020 2020 2029 0a0a 2020 2020 2020         )..      
+0000e930: 2020 6966 2069 7369 6e73 7461 6e63 6528    if isinstance(
+0000e940: 7069 7065 6c69 6e65 2c20 7374 7229 3a0a  pipeline, str):.
+0000e950: 2020 2020 2020 2020 2020 2020 7069 7065              pipe
+0000e960: 5f66 696c 6520 3d20 7069 7065 6c69 6e65  _file = pipeline
+0000e970: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
+0000e980: 2020 2020 2020 2020 2020 2070 6970 655f             pipe_
+0000e990: 6669 6c65 203d 2074 656d 7066 696c 652e  file = tempfile.
+0000e9a0: 4e61 6d65 6454 656d 706f 7261 7279 4669  NamedTemporaryFi
+0000e9b0: 6c65 2873 7566 6669 783d 222e 7961 6d6c  le(suffix=".yaml
+0000e9c0: 222c 2064 656c 6574 653d 4661 6c73 6529  ", delete=False)
+0000e9d0: 2e6e 616d 650a 2020 2020 2020 2020 2020  .name.          
+0000e9e0: 2020 636f 6e66 203d 206e 6577 5f70 6970    conf = new_pip
+0000e9f0: 655f 6d65 7461 6461 7461 280a 2020 2020  e_metadata(.    
+0000ea00: 2020 2020 2020 2020 2020 2020 6172 7469              arti
+0000ea10: 6661 6374 5f70 6174 683d 6172 7469 6661  fact_path=artifa
+0000ea20: 6374 5f70 6174 682c 0a20 2020 2020 2020  ct_path,.       
+0000ea30: 2020 2020 2020 2020 2063 6c65 616e 7570           cleanup
+0000ea40: 5f74 746c 3d63 6c65 616e 7570 5f74 746c  _ttl=cleanup_ttl
+0000ea50: 206f 7220 7474 6c2c 0a20 2020 2020 2020   or ttl,.       
+0000ea60: 2020 2020 2020 2020 206f 705f 7472 616e           op_tran
+0000ea70: 7366 6f72 6d65 7273 3d6f 7073 2c0a 2020  sformers=ops,.  
+0000ea80: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
+0000ea90: 2020 2020 2020 2020 6b66 702e 636f 6d70          kfp.comp
+0000eaa0: 696c 6572 2e43 6f6d 7069 6c65 7228 292e  iler.Compiler().
+0000eab0: 636f 6d70 696c 6528 0a20 2020 2020 2020  compile(.       
+0000eac0: 2020 2020 2020 2020 2070 6970 656c 696e           pipelin
+0000ead0: 652c 2070 6970 655f 6669 6c65 2c20 7479  e, pipe_file, ty
+0000eae0: 7065 5f63 6865 636b 3d46 616c 7365 2c20  pe_check=False, 
+0000eaf0: 7069 7065 6c69 6e65 5f63 6f6e 663d 636f  pipeline_conf=co
+0000eb00: 6e66 0a20 2020 2020 2020 2020 2020 2029  nf.            )
+0000eb10: 0a0a 2020 2020 2020 2020 6966 2070 6970  ..        if pip
+0000eb20: 655f 6669 6c65 2e65 6e64 7377 6974 6828  e_file.endswith(
+0000eb30: 222e 7961 6d6c 2229 3a0a 2020 2020 2020  ".yaml"):.      
+0000eb40: 2020 2020 2020 6865 6164 6572 7320 3d20        headers = 
+0000eb50: 7b22 636f 6e74 656e 742d 7479 7065 223a  {"content-type":
+0000eb60: 2022 6170 706c 6963 6174 696f 6e2f 7961   "application/ya
+0000eb70: 6d6c 227d 0a20 2020 2020 2020 2065 6c69  ml"}.        eli
+0000eb80: 6620 7069 7065 5f66 696c 652e 656e 6473  f pipe_file.ends
+0000eb90: 7769 7468 2822 2e7a 6970 2229 3a0a 2020  with(".zip"):.  
+0000eba0: 2020 2020 2020 2020 2020 6865 6164 6572            header
+0000ebb0: 7320 3d20 7b22 636f 6e74 656e 742d 7479  s = {"content-ty
+0000ebc0: 7065 223a 2022 6170 706c 6963 6174 696f  pe": "applicatio
+0000ebd0: 6e2f 7a69 7022 7d0a 2020 2020 2020 2020  n/zip"}.        
+0000ebe0: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+0000ebf0: 2020 7261 6973 6520 5661 6c75 6545 7272    raise ValueErr
+0000ec00: 6f72 2822 7069 7065 6c69 6e65 2066 696c  or("pipeline fil
+0000ec10: 6520 6d75 7374 2062 6520 2e79 616d 6c20  e must be .yaml 
+0000ec20: 6f72 202e 7a69 7022 290a 2020 2020 2020  or .zip").      
+0000ec30: 2020 6966 2061 7267 756d 656e 7473 3a0a    if arguments:.
+0000ec40: 2020 2020 2020 2020 2020 2020 6966 206e              if n
+0000ec50: 6f74 2069 7369 6e73 7461 6e63 6528 6172  ot isinstance(ar
+0000ec60: 6775 6d65 6e74 732c 2064 6963 7429 3a0a  guments, dict):.
+0000ec70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ec80: 7261 6973 6520 5661 6c75 6545 7272 6f72  raise ValueError
+0000ec90: 2822 6172 6775 6d65 6e74 7320 6d75 7374  ("arguments must
+0000eca0: 2062 6520 6469 6374 2074 7970 6522 290a   be dict type").
+0000ecb0: 2020 2020 2020 2020 2020 2020 6865 6164              head
+0000ecc0: 6572 735b 7363 6865 6d61 732e 4865 6164  ers[schemas.Head
+0000ecd0: 6572 4e61 6d65 732e 7069 7065 6c69 6e65  erNames.pipeline
+0000ece0: 5f61 7267 756d 656e 7473 5d20 3d20 7374  _arguments] = st
+0000ecf0: 7228 6172 6775 6d65 6e74 7329 0a0a 2020  r(arguments)..  
+0000ed00: 2020 2020 2020 6966 206e 6f74 2070 6174        if not pat
+0000ed10: 682e 6973 6669 6c65 2870 6970 655f 6669  h.isfile(pipe_fi
+0000ed20: 6c65 293a 0a20 2020 2020 2020 2020 2020  le):.           
+0000ed30: 2072 6169 7365 204f 5345 7272 6f72 2866   raise OSError(f
+0000ed40: 2266 696c 6520 7b70 6970 655f 6669 6c65  "file {pipe_file
+0000ed50: 7d20 646f 6573 6e74 2065 7869 7374 2229  } doesnt exist")
+0000ed60: 0a20 2020 2020 2020 2077 6974 6820 6f70  .        with op
+0000ed70: 656e 2870 6970 655f 6669 6c65 2c20 2272  en(pipe_file, "r
+0000ed80: 6222 2920 6173 2066 703a 0a20 2020 2020  b") as fp:.     
+0000ed90: 2020 2020 2020 2064 6174 6120 3d20 6670         data = fp
+0000eda0: 2e72 6561 6428 290a 2020 2020 2020 2020  .read().        
+0000edb0: 6966 206e 6f74 2069 7369 6e73 7461 6e63  if not isinstanc
+0000edc0: 6528 7069 7065 6c69 6e65 2c20 7374 7229  e(pipeline, str)
+0000edd0: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
+0000ede0: 6d6f 7665 2870 6970 655f 6669 6c65 290a  move(pipe_file).
+0000edf0: 0a20 2020 2020 2020 2074 7279 3a0a 2020  .        try:.  
+0000ee00: 2020 2020 2020 2020 2020 7061 7261 6d73            params
+0000ee10: 203d 207b 226e 616d 6573 7061 6365 223a   = {"namespace":
+0000ee20: 206e 616d 6573 7061 6365 2c20 2265 7870   namespace, "exp
+0000ee30: 6572 696d 656e 7422 3a20 6578 7065 7269  eriment": experi
+0000ee40: 6d65 6e74 2c20 2272 756e 223a 2072 756e  ment, "run": run
+0000ee50: 7d0a 2020 2020 2020 2020 2020 2020 7265  }.            re
+0000ee60: 7370 203d 2073 656c 662e 6170 695f 6361  sp = self.api_ca
+0000ee70: 6c6c 280a 2020 2020 2020 2020 2020 2020  ll(.            
+0000ee80: 2020 2020 2250 4f53 5422 2c0a 2020 2020      "POST",.    
+0000ee90: 2020 2020 2020 2020 2020 2020 6622 7072              f"pr
+0000eea0: 6f6a 6563 7473 2f7b 7072 6f6a 6563 747d  ojects/{project}
+0000eeb0: 2f70 6970 656c 696e 6573 222c 0a20 2020  /pipelines",.   
+0000eec0: 2020 2020 2020 2020 2020 2020 2070 6172               par
+0000eed0: 616d 733d 7061 7261 6d73 2c0a 2020 2020  ams=params,.    
+0000eee0: 2020 2020 2020 2020 2020 2020 7469 6d65              time
+0000eef0: 6f75 743d 3230 2c0a 2020 2020 2020 2020  out=20,.        
+0000ef00: 2020 2020 2020 2020 626f 6479 3d64 6174          body=dat
+0000ef10: 612c 0a20 2020 2020 2020 2020 2020 2020  a,.             
+0000ef20: 2020 2068 6561 6465 7273 3d68 6561 6465     headers=heade
+0000ef30: 7273 2c0a 2020 2020 2020 2020 2020 2020  rs,.            
+0000ef40: 290a 2020 2020 2020 2020 6578 6365 7074  ).        except
+0000ef50: 204f 5345 7272 6f72 2061 7320 6572 723a   OSError as err:
+0000ef60: 0a20 2020 2020 2020 2020 2020 206c 6f67  .            log
+0000ef70: 6765 722e 6572 726f 7228 6622 6572 726f  ger.error(f"erro
+0000ef80: 7220 6361 6e6e 6f74 2073 7562 6d69 7420  r cannot submit 
+0000ef90: 7069 7065 6c69 6e65 3a20 7b65 7272 5f74  pipeline: {err_t
+0000efa0: 6f5f 7374 7228 6572 7229 7d22 290a 2020  o_str(err)}").  
+0000efb0: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+0000efc0: 4f53 4572 726f 7228 6622 6572 726f 723a  OSError(f"error:
+0000efd0: 2063 616e 6e6f 7420 6361 6e6e 6f74 2073   cannot cannot s
+0000efe0: 7562 6d69 7420 7069 7065 6c69 6e65 2c20  ubmit pipeline, 
+0000eff0: 7b65 7272 5f74 6f5f 7374 7228 6572 7229  {err_to_str(err)
+0000f000: 7d22 290a 0a20 2020 2020 2020 2069 6620  }")..        if 
+0000f010: 6e6f 7420 7265 7370 2e6f 6b3a 0a20 2020  not resp.ok:.   
+0000f020: 2020 2020 2020 2020 206c 6f67 6765 722e           logger.
+0000f030: 6572 726f 7228 6622 6261 6420 7265 7370  error(f"bad resp
+0000f040: 2121 5c6e 7b72 6573 702e 7465 7874 7d22  !!\n{resp.text}"
+0000f050: 290a 2020 2020 2020 2020 2020 2020 7261  ).            ra
+0000f060: 6973 6520 5661 6c75 6545 7272 6f72 2866  ise ValueError(f
+0000f070: 2262 6164 2073 7562 6d69 7420 7069 7065  "bad submit pipe
+0000f080: 6c69 6e65 2072 6573 706f 6e73 652c 207b  line response, {
+0000f090: 7265 7370 2e74 6578 747d 2229 0a0a 2020  resp.text}")..  
+0000f0a0: 2020 2020 2020 7265 7370 203d 2072 6573        resp = res
+0000f0b0: 702e 6a73 6f6e 2829 0a20 2020 2020 2020  p.json().       
+0000f0c0: 206c 6f67 6765 722e 696e 666f 2866 2273   logger.info(f"s
+0000f0d0: 7562 6d69 7474 6564 2070 6970 656c 696e  ubmitted pipelin
+0000f0e0: 6520 7b72 6573 705b 276e 616d 6527 5d7d  e {resp['name']}
+0000f0f0: 2069 643d 7b72 6573 705b 2769 6427 5d7d   id={resp['id']}
+0000f100: 2229 0a20 2020 2020 2020 2072 6574 7572  ").        retur
+0000f110: 6e20 7265 7370 5b22 6964 225d 0a0a 2020  n resp["id"]..  
+0000f120: 2020 6465 6620 6c69 7374 5f70 6970 656c    def list_pipel
+0000f130: 696e 6573 280a 2020 2020 2020 2020 7365  ines(.        se
+0000f140: 6c66 2c0a 2020 2020 2020 2020 7072 6f6a  lf,.        proj
+0000f150: 6563 743a 2073 7472 2c0a 2020 2020 2020  ect: str,.      
+0000f160: 2020 6e61 6d65 7370 6163 653a 2073 7472    namespace: str
+0000f170: 203d 204e 6f6e 652c 0a20 2020 2020 2020   = None,.       
+0000f180: 2073 6f72 745f 6279 3a20 7374 7220 3d20   sort_by: str = 
+0000f190: 2222 2c0a 2020 2020 2020 2020 7061 6765  "",.        page
+0000f1a0: 5f74 6f6b 656e 3a20 7374 7220 3d20 2222  _token: str = ""
+0000f1b0: 2c0a 2020 2020 2020 2020 6669 6c74 6572  ,.        filter
+0000f1c0: 5f3a 2073 7472 203d 2022 222c 0a20 2020  _: str = "",.   
+0000f1d0: 2020 2020 2066 6f72 6d61 745f 3a20 556e       format_: Un
+0000f1e0: 696f 6e5b 0a20 2020 2020 2020 2020 2020  ion[.           
+0000f1f0: 2073 7472 2c20 6d6c 7275 6e2e 6170 692e   str, mlrun.api.
+0000f200: 7363 6865 6d61 732e 5069 7065 6c69 6e65  schemas.Pipeline
+0000f210: 7346 6f72 6d61 740a 2020 2020 2020 2020  sFormat.        
+0000f220: 5d20 3d20 6d6c 7275 6e2e 6170 692e 7363  ] = mlrun.api.sc
+0000f230: 6865 6d61 732e 5069 7065 6c69 6e65 7346  hemas.PipelinesF
+0000f240: 6f72 6d61 742e 6d65 7461 6461 7461 5f6f  ormat.metadata_o
+0000f250: 6e6c 792c 0a20 2020 2020 2020 2070 6167  nly,.        pag
+0000f260: 655f 7369 7a65 3a20 696e 7420 3d20 4e6f  e_size: int = No
+0000f270: 6e65 2c0a 2020 2020 2920 2d3e 206d 6c72  ne,.    ) -> mlr
+0000f280: 756e 2e61 7069 2e73 6368 656d 6173 2e50  un.api.schemas.P
+0000f290: 6970 656c 696e 6573 4f75 7470 7574 3a0a  ipelinesOutput:.
+0000f2a0: 2020 2020 2020 2020 2222 2252 6574 7269          """Retri
+0000f2b0: 6576 6520 6120 6c69 7374 206f 6620 4b46  eve a list of KF
+0000f2c0: 5020 7069 7065 6c69 6e65 732e 2054 6869  P pipelines. Thi
+0000f2d0: 7320 6675 6e63 7469 6f6e 2063 616e 2062  s function can b
+0000f2e0: 6520 696e 766f 6b65 6420 746f 2067 6574  e invoked to get
+0000f2f0: 2061 6c6c 2070 6970 656c 696e 6573 2066   all pipelines f
+0000f300: 726f 6d20 616c 6c20 7072 6f6a 6563 7473  rom all projects
+0000f310: 2c0a 2020 2020 2020 2020 6279 2073 7065  ,.        by spe
+0000f320: 6369 6679 696e 6720 6060 7072 6f6a 6563  cifying ``projec
+0000f330: 743d 2a60 602c 2069 6e20 7768 6963 6820  t=*``, in which 
+0000f340: 6361 7365 2070 6167 696e 6174 696f 6e20  case pagination 
+0000f350: 6361 6e20 6265 2075 7365 6420 616e 6420  can be used and 
+0000f360: 7468 6520 7661 7269 6f75 7320 736f 7274  the various sort
+0000f370: 696e 6720 616e 6420 7061 6769 6e61 7469  ing and paginati
+0000f380: 6f6e 0a20 2020 2020 2020 2070 726f 7065  on.        prope
+0000f390: 7274 6965 7320 6361 6e20 6265 2061 7070  rties can be app
+0000f3a0: 6c69 6564 2e20 4966 2061 2073 7065 6369  lied. If a speci
+0000f3b0: 6669 6320 7072 6f6a 6563 7420 6973 2072  fic project is r
+0000f3c0: 6571 7565 7374 6564 2c20 7468 656e 2074  equested, then t
+0000f3d0: 6865 2070 6167 696e 6174 696f 6e20 6f70  he pagination op
+0000f3e0: 7469 6f6e 7320 6361 6e6e 6f74 2062 650a  tions cannot be.
+0000f3f0: 2020 2020 2020 2020 7573 6564 2061 6e64          used and
+0000f400: 2070 6167 696e 6174 696f 6e20 6973 206e   pagination is n
+0000f410: 6f74 2061 7070 6c69 6564 2e0a 0a20 2020  ot applied...   
+0000f420: 2020 2020 203a 7061 7261 6d20 7072 6f6a       :param proj
+0000f430: 6563 743a 2050 726f 6a65 6374 206e 616d  ect: Project nam
+0000f440: 652e 2043 616e 2062 6520 6060 2a60 6020  e. Can be ``*`` 
+0000f450: 666f 7220 7175 6572 7920 6163 726f 7373  for query across
+0000f460: 2061 6c6c 2070 726f 6a65 6374 732e 0a20   all projects.. 
+0000f470: 2020 2020 2020 203a 7061 7261 6d20 6e61         :param na
+0000f480: 6d65 7370 6163 653a 204b 7562 6572 6e65  mespace: Kuberne
+0000f490: 7465 7320 6e61 6d65 7370 6163 6520 696e  tes namespace in
+0000f4a0: 2077 6869 6368 2074 6865 2070 6970 656c   which the pipel
+0000f4b0: 696e 6573 2061 7265 2065 7865 6375 7469  ines are executi
+0000f4c0: 6e67 2e0a 2020 2020 2020 2020 3a70 6172  ng..        :par
+0000f4d0: 616d 2073 6f72 745f 6279 3a20 4669 656c  am sort_by: Fiel
+0000f4e0: 6420 746f 2073 6f72 7420 7468 6520 7265  d to sort the re
+0000f4f0: 7375 6c74 7320 6279 2e0a 2020 2020 2020  sults by..      
+0000f500: 2020 3a70 6172 616d 2070 6167 655f 746f    :param page_to
+0000f510: 6b65 6e3a 2055 7365 2066 6f72 2070 6167  ken: Use for pag
+0000f520: 696e 6174 696f 6e2c 2074 6f20 7265 7472  ination, to retr
+0000f530: 6965 7665 206e 6578 7420 7061 6765 2e0a  ieve next page..
+0000f540: 2020 2020 2020 2020 3a70 6172 616d 2066          :param f
+0000f550: 696c 7465 725f 3a20 4b75 6265 726e 6574  ilter_: Kubernet
+0000f560: 6573 2066 696c 7465 7220 746f 2061 7070  es filter to app
+0000f570: 6c79 2074 6f20 7468 6520 7175 6572 792c  ly to the query,
+0000f580: 2063 616e 2062 6520 7573 6564 2074 6f20   can be used to 
+0000f590: 6669 6c74 6572 206f 6e20 7370 6563 6966  filter on specif
+0000f5a0: 6963 206f 626a 6563 7420 6669 656c 6473  ic object fields
+0000f5b0: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
+0000f5c0: 2066 6f72 6d61 745f 3a20 5265 7375 6c74   format_: Result
+0000f5d0: 2066 6f72 6d61 742e 2043 616e 2062 6520   format. Can be 
+0000f5e0: 6f6e 6520 6f66 3a0a 0a20 2020 2020 2020  one of:..       
+0000f5f0: 2020 2020 202d 2060 6066 756c 6c60 6020       - ``full`` 
+0000f600: 2d20 7265 7475 726e 2074 6865 2066 756c  - return the ful
+0000f610: 6c20 6f62 6a65 6374 732e 0a20 2020 2020  l objects..     
+0000f620: 2020 2020 2020 202d 2060 606d 6574 6164         - ``metad
+0000f630: 6174 615f 6f6e 6c79 6060 2028 6465 6661  ata_only`` (defa
+0000f640: 756c 7429 202d 2072 6574 7572 6e20 6a75  ult) - return ju
+0000f650: 7374 206d 6574 6164 6174 6120 6f66 2074  st metadata of t
+0000f660: 6865 2070 6970 656c 696e 6573 206f 626a  he pipelines obj
+0000f670: 6563 7473 2e0a 2020 2020 2020 2020 2020  ects..          
+0000f680: 2020 2d20 6060 6e61 6d65 5f6f 6e6c 7960    - ``name_only`
+0000f690: 6020 2d20 7265 7475 726e 206a 7573 7420  ` - return just 
+0000f6a0: 7468 6520 6e61 6d65 7320 6f66 2074 6865  the names of the
+0000f6b0: 2070 6970 656c 696e 6520 6f62 6a65 6374   pipeline object
+0000f6c0: 732e 0a20 2020 2020 2020 203a 7061 7261  s..        :para
+0000f6d0: 6d20 7061 6765 5f73 697a 653a 2053 697a  m page_size: Siz
+0000f6e0: 6520 6f66 2061 2073 696e 676c 6520 7061  e of a single pa
+0000f6f0: 6765 2077 6865 6e20 6170 706c 7969 6e67  ge when applying
+0000f700: 2070 6167 696e 6174 696f 6e2e 0a20 2020   pagination..   
+0000f710: 2020 2020 2022 2222 0a0a 2020 2020 2020       """..      
+0000f720: 2020 6966 2070 726f 6a65 6374 2021 3d20    if project != 
+0000f730: 222a 2220 616e 6420 2870 6167 655f 746f  "*" and (page_to
+0000f740: 6b65 6e20 6f72 2070 6167 655f 7369 7a65  ken or page_size
+0000f750: 293a 0a20 2020 2020 2020 2020 2020 2072  ):.            r
+0000f760: 6169 7365 206d 6c72 756e 2e65 7272 6f72  aise mlrun.error
+0000f770: 732e 4d4c 5275 6e49 6e76 616c 6964 4172  s.MLRunInvalidAr
+0000f780: 6775 6d65 6e74 4572 726f 7228 0a20 2020  gumentError(.   
+0000f790: 2020 2020 2020 2020 2020 2020 2022 4669               "Fi
+0000f7a0: 6c74 6572 696e 6720 6279 2070 726f 6a65  ltering by proje
+0000f7b0: 6374 2063 616e 206e 6f74 2062 6520 7573  ct can not be us
+0000f7c0: 6564 2074 6f67 6574 6865 7220 7769 7468  ed together with
+0000f7d0: 2070 6167 696e 6174 696f 6e22 0a20 2020   pagination".   
+0000f7e0: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
+0000f7f0: 2020 2070 6172 616d 7320 3d20 7b0a 2020     params = {.  
+0000f800: 2020 2020 2020 2020 2020 226e 616d 6573            "names
+0000f810: 7061 6365 223a 206e 616d 6573 7061 6365  pace": namespace
+0000f820: 2c0a 2020 2020 2020 2020 2020 2020 2273  ,.            "s
+0000f830: 6f72 745f 6279 223a 2073 6f72 745f 6279  ort_by": sort_by
+0000f840: 2c0a 2020 2020 2020 2020 2020 2020 2270  ,.            "p
+0000f850: 6167 655f 746f 6b65 6e22 3a20 7061 6765  age_token": page
+0000f860: 5f74 6f6b 656e 2c0a 2020 2020 2020 2020  _token,.        
+0000f870: 2020 2020 2266 696c 7465 7222 3a20 6669      "filter": fi
+0000f880: 6c74 6572 5f2c 0a20 2020 2020 2020 2020  lter_,.         
+0000f890: 2020 2022 666f 726d 6174 223a 2066 6f72     "format": for
+0000f8a0: 6d61 745f 2c0a 2020 2020 2020 2020 2020  mat_,.          
+0000f8b0: 2020 2270 6167 655f 7369 7a65 223a 2070    "page_size": p
+0000f8c0: 6167 655f 7369 7a65 2c0a 2020 2020 2020  age_size,.      
+0000f8d0: 2020 7d0a 0a20 2020 2020 2020 2065 7272    }..        err
+0000f8e0: 6f72 5f6d 6573 7361 6765 203d 2066 2246  or_message = f"F
+0000f8f0: 6169 6c65 6420 6c69 7374 696e 6720 7069  ailed listing pi
+0000f900: 7065 6c69 6e65 732c 2071 7565 7279 3a20  pelines, query: 
+0000f910: 7b70 6172 616d 737d 220a 2020 2020 2020  {params}".      
+0000f920: 2020 7265 7370 6f6e 7365 203d 2073 656c    response = sel
+0000f930: 662e 6170 695f 6361 6c6c 280a 2020 2020  f.api_call(.    
+0000f940: 2020 2020 2020 2020 2247 4554 222c 2066          "GET", f
+0000f950: 2270 726f 6a65 6374 732f 7b70 726f 6a65  "projects/{proje
+0000f960: 6374 7d2f 7069 7065 6c69 6e65 7322 2c20  ct}/pipelines", 
+0000f970: 6572 726f 725f 6d65 7373 6167 652c 2070  error_message, p
+0000f980: 6172 616d 733d 7061 7261 6d73 0a20 2020  arams=params.   
+0000f990: 2020 2020 2029 0a20 2020 2020 2020 2072       ).        r
+0000f9a0: 6574 7572 6e20 6d6c 7275 6e2e 6170 692e  eturn mlrun.api.
+0000f9b0: 7363 6865 6d61 732e 5069 7065 6c69 6e65  schemas.Pipeline
+0000f9c0: 734f 7574 7075 7428 2a2a 7265 7370 6f6e  sOutput(**respon
+0000f9d0: 7365 2e6a 736f 6e28 2929 0a0a 2020 2020  se.json())..    
+0000f9e0: 6465 6620 6765 745f 7069 7065 6c69 6e65  def get_pipeline
+0000f9f0: 280a 2020 2020 2020 2020 7365 6c66 2c0a  (.        self,.
+0000fa00: 2020 2020 2020 2020 7275 6e5f 6964 3a20          run_id: 
+0000fa10: 7374 722c 0a20 2020 2020 2020 206e 616d  str,.        nam
+0000fa20: 6573 7061 6365 3a20 7374 7220 3d20 4e6f  espace: str = No
+0000fa30: 6e65 2c0a 2020 2020 2020 2020 7469 6d65  ne,.        time
+0000fa40: 6f75 743a 2069 6e74 203d 2031 302c 0a20  out: int = 10,. 
+0000fa50: 2020 2020 2020 2066 6f72 6d61 745f 3a20         format_: 
+0000fa60: 556e 696f 6e5b 0a20 2020 2020 2020 2020  Union[.         
+0000fa70: 2020 2073 7472 2c20 6d6c 7275 6e2e 6170     str, mlrun.ap
+0000fa80: 692e 7363 6865 6d61 732e 5069 7065 6c69  i.schemas.Pipeli
+0000fa90: 6e65 7346 6f72 6d61 740a 2020 2020 2020  nesFormat.      
+0000faa0: 2020 5d20 3d20 6d6c 7275 6e2e 6170 692e    ] = mlrun.api.
+0000fab0: 7363 6865 6d61 732e 5069 7065 6c69 6e65  schemas.Pipeline
+0000fac0: 7346 6f72 6d61 742e 7375 6d6d 6172 792c  sFormat.summary,
+0000fad0: 0a20 2020 2020 2020 2070 726f 6a65 6374  .        project
+0000fae0: 3a20 7374 7220 3d20 4e6f 6e65 2c0a 2020  : str = None,.  
+0000faf0: 2020 293a 0a20 2020 2020 2020 2022 2222    ):.        """
+0000fb00: 5265 7472 6965 7665 2064 6574 6169 6c73  Retrieve details
+0000fb10: 206f 6620 6120 7370 6563 6966 6963 2070   of a specific p
+0000fb20: 6970 656c 696e 6520 7573 696e 6720 6974  ipeline using it
+0000fb30: 7320 7275 6e20 4944 2028 6173 2070 726f  s run ID (as pro
+0000fb40: 7669 6465 6420 7768 656e 2074 6865 2070  vided when the p
+0000fb50: 6970 656c 696e 6520 7761 7320 6578 6563  ipeline was exec
+0000fb60: 7574 6564 292e 2222 220a 0a20 2020 2020  uted)."""..     
+0000fb70: 2020 2074 7279 3a0a 2020 2020 2020 2020     try:.        
+0000fb80: 2020 2020 7061 7261 6d73 203d 207b 7d0a      params = {}.
+0000fb90: 2020 2020 2020 2020 2020 2020 6966 206e              if n
+0000fba0: 616d 6573 7061 6365 3a0a 2020 2020 2020  amespace:.      
+0000fbb0: 2020 2020 2020 2020 2020 7061 7261 6d73            params
+0000fbc0: 5b22 6e61 6d65 7370 6163 6522 5d20 3d20  ["namespace"] = 
+0000fbd0: 6e61 6d65 7370 6163 650a 2020 2020 2020  namespace.      
+0000fbe0: 2020 2020 2020 7061 7261 6d73 5b22 666f        params["fo
+0000fbf0: 726d 6174 225d 203d 2066 6f72 6d61 745f  rmat"] = format_
+0000fc00: 0a20 2020 2020 2020 2020 2020 2070 726f  .            pro
+0000fc10: 6a65 6374 5f70 6174 6820 3d20 7072 6f6a  ject_path = proj
+0000fc20: 6563 7420 6966 2070 726f 6a65 6374 2065  ect if project e
+0000fc30: 6c73 6520 222a 220a 2020 2020 2020 2020  lse "*".        
+0000fc40: 2020 2020 7265 7370 203d 2073 656c 662e      resp = self.
+0000fc50: 6170 695f 6361 6c6c 280a 2020 2020 2020  api_call(.      
+0000fc60: 2020 2020 2020 2020 2020 2247 4554 222c            "GET",
+0000fc70: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000fc80: 2066 2270 726f 6a65 6374 732f 7b70 726f   f"projects/{pro
+0000fc90: 6a65 6374 5f70 6174 687d 2f70 6970 656c  ject_path}/pipel
+0000fca0: 696e 6573 2f7b 7275 6e5f 6964 7d22 2c0a  ines/{run_id}",.
+0000fcb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000fcc0: 7061 7261 6d73 3d70 6172 616d 732c 0a20  params=params,. 
+0000fcd0: 2020 2020 2020 2020 2020 2020 2020 2074                 t
+0000fce0: 696d 656f 7574 3d74 696d 656f 7574 2c0a  imeout=timeout,.
+0000fcf0: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
+0000fd00: 2020 2020 2020 6578 6365 7074 204f 5345        except OSE
+0000fd10: 7272 6f72 2061 7320 6572 723a 0a20 2020  rror as err:.   
+0000fd20: 2020 2020 2020 2020 206c 6f67 6765 722e           logger.
+0000fd30: 6572 726f 7228 6622 6572 726f 7220 6361  error(f"error ca
+0000fd40: 6e6e 6f74 2067 6574 2070 6970 656c 696e  nnot get pipelin
+0000fd50: 653a 207b 6572 725f 746f 5f73 7472 2865  e: {err_to_str(e
+0000fd60: 7272 297d 2229 0a20 2020 2020 2020 2020  rr)}").         
+0000fd70: 2020 2072 6169 7365 204f 5345 7272 6f72     raise OSError
+0000fd80: 2866 2265 7272 6f72 3a20 6361 6e6e 6f74  (f"error: cannot
+0000fd90: 2067 6574 2070 6970 656c 696e 652c 207b   get pipeline, {
+0000fda0: 6572 725f 746f 5f73 7472 2865 7272 297d  err_to_str(err)}
+0000fdb0: 2229 0a0a 2020 2020 2020 2020 6966 206e  ")..        if n
+0000fdc0: 6f74 2072 6573 702e 6f6b 3a0a 2020 2020  ot resp.ok:.    
+0000fdd0: 2020 2020 2020 2020 6c6f 6767 6572 2e65          logger.e
+0000fde0: 7272 6f72 2866 2262 6164 2072 6573 7021  rror(f"bad resp!
+0000fdf0: 215c 6e7b 7265 7370 2e74 6578 747d 2229  !\n{resp.text}")
+0000fe00: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
+0000fe10: 7365 2056 616c 7565 4572 726f 7228 6622  se ValueError(f"
+0000fe20: 6261 6420 6765 7420 7069 7065 6c69 6e65  bad get pipeline
+0000fe30: 2072 6573 706f 6e73 652c 207b 7265 7370   response, {resp
+0000fe40: 2e74 6578 747d 2229 0a0a 2020 2020 2020  .text}")..      
+0000fe50: 2020 7265 7475 726e 2072 6573 702e 6a73    return resp.js
+0000fe60: 6f6e 2829 0a0a 2020 2020 4073 7461 7469  on()..    @stati
+0000fe70: 636d 6574 686f 640a 2020 2020 6465 6620  cmethod.    def 
+0000fe80: 5f72 6573 6f6c 7665 5f72 6566 6572 656e  _resolve_referen
+0000fe90: 6365 2874 6167 2c20 7569 6429 3a0a 2020  ce(tag, uid):.  
+0000fea0: 2020 2020 2020 6966 2075 6964 2061 6e64        if uid and
+0000feb0: 2074 6167 3a0a 2020 2020 2020 2020 2020   tag:.          
+0000fec0: 2020 7261 6973 6520 4d4c 5275 6e49 6e76    raise MLRunInv
+0000fed0: 616c 6964 4172 6775 6d65 6e74 4572 726f  alidArgumentErro
+0000fee0: 7228 2262 6f74 6820 7569 6420 616e 6420  r("both uid and 
+0000fef0: 7461 6720 7765 7265 2070 726f 7669 6465  tag were provide
+0000ff00: 6422 290a 2020 2020 2020 2020 7265 7475  d").        retu
+0000ff10: 726e 2075 6964 206f 7220 7461 6720 6f72  rn uid or tag or
+0000ff20: 2022 6c61 7465 7374 220a 0a20 2020 2064   "latest"..    d
+0000ff30: 6566 2063 7265 6174 655f 6665 6174 7572  ef create_featur
+0000ff40: 655f 7365 7428 0a20 2020 2020 2020 2073  e_set(.        s
+0000ff50: 656c 662c 0a20 2020 2020 2020 2066 6561  elf,.        fea
+0000ff60: 7475 7265 5f73 6574 3a20 556e 696f 6e5b  ture_set: Union[
+0000ff70: 6469 6374 2c20 7363 6865 6d61 732e 4665  dict, schemas.Fe
+0000ff80: 6174 7572 6553 6574 2c20 4665 6174 7572  atureSet, Featur
+0000ff90: 6553 6574 5d2c 0a20 2020 2020 2020 2070  eSet],.        p
+0000ffa0: 726f 6a65 6374 3d22 222c 0a20 2020 2020  roject="",.     
+0000ffb0: 2020 2076 6572 7369 6f6e 6564 3d54 7275     versioned=Tru
+0000ffc0: 652c 0a20 2020 2029 202d 3e20 6469 6374  e,.    ) -> dict
+0000ffd0: 3a0a 2020 2020 2020 2020 2222 2243 7265  :.        """Cre
+0000ffe0: 6174 6520 6120 6e65 7720 3a70 793a 636c  ate a new :py:cl
+0000fff0: 6173 733a 607e 6d6c 7275 6e2e 6665 6174  ass:`~mlrun.feat
+00010000: 7572 655f 7374 6f72 652e 4665 6174 7572  ure_store.Featur
+00010010: 6553 6574 6020 616e 6420 7361 7665 2069  eSet` and save i
+00010020: 6e20 7468 6520 3a70 793a 6d6f 643a 606d  n the :py:mod:`m
+00010030: 6c72 756e 6020 4442 2e20 5468 650a 2020  lrun` DB. The.  
+00010040: 2020 2020 2020 6665 6174 7572 652d 7365        feature-se
+00010050: 7420 6d75 7374 206e 6f74 2070 7265 7669  t must not previ
+00010060: 6f75 736c 7920 6578 6973 7420 696e 2074  ously exist in t
+00010070: 6865 2044 422e 0a0a 2020 2020 2020 2020  he DB...        
+00010080: 3a70 6172 616d 2066 6561 7475 7265 5f73  :param feature_s
+00010090: 6574 3a20 5468 6520 6e65 7720 3a70 793a  et: The new :py:
+000100a0: 636c 6173 733a 607e 6d6c 7275 6e2e 6665  class:`~mlrun.fe
+000100b0: 6174 7572 655f 7374 6f72 652e 4665 6174  ature_store.Feat
+000100c0: 7572 6553 6574 6020 746f 2063 7265 6174  ureSet` to creat
+000100d0: 652e 0a20 2020 2020 2020 203a 7061 7261  e..        :para
+000100e0: 6d20 7072 6f6a 6563 743a 204e 616d 6520  m project: Name 
+000100f0: 6f66 2070 726f 6a65 6374 2074 6869 7320  of project this 
+00010100: 6665 6174 7572 652d 7365 7420 6265 6c6f  feature-set belo
+00010110: 6e67 7320 746f 2e0a 2020 2020 2020 2020  ngs to..        
+00010120: 3a70 6172 616d 2076 6572 7369 6f6e 6564  :param versioned
+00010130: 3a20 5768 6574 6865 7220 746f 206d 6169  : Whether to mai
+00010140: 6e74 6169 6e20 7665 7273 696f 6e73 2066  ntain versions f
+00010150: 6f72 2074 6869 7320 6665 6174 7572 652d  or this feature-
+00010160: 7365 742e 2041 6c6c 2076 6572 7369 6f6e  set. All version
+00010170: 7320 6f66 2061 2076 6572 7369 6f6e 6564  s of a versioned
+00010180: 206f 626a 6563 740a 2020 2020 2020 2020   object.        
+00010190: 2020 2020 7769 6c6c 2062 6520 6b65 7074      will be kept
+000101a0: 2069 6e20 7468 6520 4442 2061 6e64 2063   in the DB and c
+000101b0: 616e 2062 6520 7265 7472 6965 7665 6420  an be retrieved 
+000101c0: 756e 7469 6c20 6578 706c 6963 6974 6c79  until explicitly
+000101d0: 2064 656c 6574 6564 2e0a 2020 2020 2020   deleted..      
+000101e0: 2020 3a72 6574 7572 6e73 3a20 5468 6520    :returns: The 
+000101f0: 3a70 793a 636c 6173 733a 607e 6d6c 7275  :py:class:`~mlru
+00010200: 6e2e 6665 6174 7572 655f 7374 6f72 652e  n.feature_store.
+00010210: 4665 6174 7572 6553 6574 6020 6f62 6a65  FeatureSet` obje
+00010220: 6374 2028 6173 2064 6963 7429 2e0a 2020  ct (as dict)..  
+00010230: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+00010240: 2020 6966 2069 7369 6e73 7461 6e63 6528    if isinstance(
+00010250: 6665 6174 7572 655f 7365 742c 2073 6368  feature_set, sch
+00010260: 656d 6173 2e46 6561 7475 7265 5365 7429  emas.FeatureSet)
+00010270: 3a0a 2020 2020 2020 2020 2020 2020 6665  :.            fe
+00010280: 6174 7572 655f 7365 7420 3d20 6665 6174  ature_set = feat
+00010290: 7572 655f 7365 742e 6469 6374 2829 0a20  ure_set.dict(). 
+000102a0: 2020 2020 2020 2065 6c69 6620 6973 696e         elif isin
+000102b0: 7374 616e 6365 2866 6561 7475 7265 5f73  stance(feature_s
+000102c0: 6574 2c20 4665 6174 7572 6553 6574 293a  et, FeatureSet):
+000102d0: 0a20 2020 2020 2020 2020 2020 2066 6561  .            fea
+000102e0: 7475 7265 5f73 6574 203d 2066 6561 7475  ture_set = featu
+000102f0: 7265 5f73 6574 2e74 6f5f 6469 6374 2829  re_set.to_dict()
+00010300: 0a0a 2020 2020 2020 2020 7072 6f6a 6563  ..        projec
+00010310: 7420 3d20 280a 2020 2020 2020 2020 2020  t = (.          
+00010320: 2020 7072 6f6a 6563 740a 2020 2020 2020    project.      
+00010330: 2020 2020 2020 6f72 2066 6561 7475 7265        or feature
+00010340: 5f73 6574 5b22 6d65 7461 6461 7461 225d  _set["metadata"]
+00010350: 2e67 6574 2822 7072 6f6a 6563 7422 2c20  .get("project", 
+00010360: 4e6f 6e65 290a 2020 2020 2020 2020 2020  None).          
+00010370: 2020 6f72 2063 6f6e 6669 672e 6465 6661    or config.defa
+00010380: 756c 745f 7072 6f6a 6563 740a 2020 2020  ult_project.    
+00010390: 2020 2020 290a 2020 2020 2020 2020 7061      ).        pa
+000103a0: 7468 203d 2066 2270 726f 6a65 6374 732f  th = f"projects/
+000103b0: 7b70 726f 6a65 6374 7d2f 6665 6174 7572  {project}/featur
+000103c0: 652d 7365 7473 220a 2020 2020 2020 2020  e-sets".        
+000103d0: 7061 7261 6d73 203d 207b 2276 6572 7369  params = {"versi
+000103e0: 6f6e 6564 223a 2076 6572 7369 6f6e 6564  oned": versioned
+000103f0: 7d0a 0a20 2020 2020 2020 206e 616d 6520  }..        name 
+00010400: 3d20 6665 6174 7572 655f 7365 745b 226d  = feature_set["m
+00010410: 6574 6164 6174 6122 5d5b 226e 616d 6522  etadata"]["name"
+00010420: 5d0a 2020 2020 2020 2020 6572 726f 725f  ].        error_
+00010430: 6d65 7373 6167 6520 3d20 6622 4661 696c  message = f"Fail
+00010440: 6564 2063 7265 6174 696e 6720 6665 6174  ed creating feat
+00010450: 7572 652d 7365 7420 7b70 726f 6a65 6374  ure-set {project
+00010460: 7d2f 7b6e 616d 657d 220a 2020 2020 2020  }/{name}".      
+00010470: 2020 7265 7370 203d 2073 656c 662e 6170    resp = self.ap
+00010480: 695f 6361 6c6c 280a 2020 2020 2020 2020  i_call(.        
+00010490: 2020 2020 2250 4f53 5422 2c0a 2020 2020      "POST",.    
+000104a0: 2020 2020 2020 2020 7061 7468 2c0a 2020          path,.  
+000104b0: 2020 2020 2020 2020 2020 6572 726f 725f            error_
+000104c0: 6d65 7373 6167 652c 0a20 2020 2020 2020  message,.       
+000104d0: 2020 2020 2070 6172 616d 733d 7061 7261       params=para
+000104e0: 6d73 2c0a 2020 2020 2020 2020 2020 2020  ms,.            
+000104f0: 626f 6479 3d64 6963 745f 746f 5f6a 736f  body=dict_to_jso
+00010500: 6e28 6665 6174 7572 655f 7365 7429 2c0a  n(feature_set),.
+00010510: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+00010520: 2020 7265 7475 726e 2072 6573 702e 6a73    return resp.js
+00010530: 6f6e 2829 0a0a 2020 2020 6465 6620 6765  on()..    def ge
+00010540: 745f 6665 6174 7572 655f 7365 7428 0a20  t_feature_set(. 
+00010550: 2020 2020 2020 2073 656c 662c 206e 616d         self, nam
+00010560: 653a 2073 7472 2c20 7072 6f6a 6563 743a  e: str, project:
+00010570: 2073 7472 203d 2022 222c 2074 6167 3a20   str = "", tag: 
+00010580: 7374 7220 3d20 4e6f 6e65 2c20 7569 643a  str = None, uid:
+00010590: 2073 7472 203d 204e 6f6e 650a 2020 2020   str = None.    
+000105a0: 2920 2d3e 2046 6561 7475 7265 5365 743a  ) -> FeatureSet:
+000105b0: 0a20 2020 2020 2020 2022 2222 5265 7472  .        """Retr
+000105c0: 6965 7665 2061 207e 6d6c 7275 6e2e 6665  ieve a ~mlrun.fe
+000105d0: 6174 7572 655f 7374 6f72 652e 4665 6174  ature_store.Feat
+000105e0: 7572 6553 6574 6020 6f62 6a65 6374 2e20  ureSet` object. 
+000105f0: 4966 2062 6f74 6820 6060 7461 6760 6020  If both ``tag`` 
+00010600: 616e 6420 6060 7569 6460 6020 6172 6520  and ``uid`` are 
+00010610: 6e6f 7420 7370 6563 6966 6965 642c 2074  not specified, t
+00010620: 6865 6e0a 2020 2020 2020 2020 7468 6520  hen.        the 
+00010630: 6f62 6a65 6374 2074 6167 6765 6420 6060  object tagged ``
+00010640: 6c61 7465 7374 6060 2077 696c 6c20 6265  latest`` will be
+00010650: 2072 6574 7269 6576 6564 2e0a 0a20 2020   retrieved...   
+00010660: 2020 2020 203a 7061 7261 6d20 6e61 6d65       :param name
+00010670: 3a20 4e61 6d65 206f 6620 6f62 6a65 6374  : Name of object
+00010680: 2074 6f20 7265 7472 6965 7665 2e0a 2020   to retrieve..  
+00010690: 2020 2020 2020 3a70 6172 616d 2070 726f        :param pro
+000106a0: 6a65 6374 3a20 5072 6f6a 6563 7420 7468  ject: Project th
+000106b0: 6520 4665 6174 7572 6553 6574 2062 656c  e FeatureSet bel
+000106c0: 6f6e 6773 2074 6f2e 0a20 2020 2020 2020  ongs to..       
+000106d0: 203a 7061 7261 6d20 7461 673a 2054 6167   :param tag: Tag
+000106e0: 206f 6620 7468 6520 7370 6563 6966 6963   of the specific
+000106f0: 206f 626a 6563 7420 7665 7273 696f 6e20   object version 
+00010700: 746f 2072 6574 7269 6576 652e 0a20 2020  to retrieve..   
+00010710: 2020 2020 203a 7061 7261 6d20 7569 643a       :param uid:
+00010720: 2075 6964 206f 6620 7468 6520 6f62 6a65   uid of the obje
+00010730: 6374 2074 6f20 7265 7472 6965 7665 2028  ct to retrieve (
+00010740: 6361 6e20 6f6e 6c79 2062 6520 7573 6564  can only be used
+00010750: 2066 6f72 2076 6572 7369 6f6e 6564 206f   for versioned o
+00010760: 626a 6563 7473 292e 0a20 2020 2020 2020  bjects)..       
+00010770: 2022 2222 0a0a 2020 2020 2020 2020 7072   """..        pr
+00010780: 6f6a 6563 7420 3d20 7072 6f6a 6563 7420  oject = project 
+00010790: 6f72 2063 6f6e 6669 672e 6465 6661 756c  or config.defaul
+000107a0: 745f 7072 6f6a 6563 740a 2020 2020 2020  t_project.      
+000107b0: 2020 7265 6665 7265 6e63 6520 3d20 7365    reference = se
+000107c0: 6c66 2e5f 7265 736f 6c76 655f 7265 6665  lf._resolve_refe
+000107d0: 7265 6e63 6528 7461 672c 2075 6964 290a  rence(tag, uid).
+000107e0: 2020 2020 2020 2020 7061 7468 203d 2066          path = f
+000107f0: 2270 726f 6a65 6374 732f 7b70 726f 6a65  "projects/{proje
+00010800: 6374 7d2f 6665 6174 7572 652d 7365 7473  ct}/feature-sets
+00010810: 2f7b 6e61 6d65 7d2f 7265 6665 7265 6e63  /{name}/referenc
+00010820: 6573 2f7b 7265 6665 7265 6e63 657d 220a  es/{reference}".
+00010830: 2020 2020 2020 2020 6572 726f 725f 6d65          error_me
+00010840: 7373 6167 6520 3d20 6622 4661 696c 6564  ssage = f"Failed
+00010850: 2072 6574 7269 6576 696e 6720 6665 6174   retrieving feat
+00010860: 7572 652d 7365 7420 7b70 726f 6a65 6374  ure-set {project
+00010870: 7d2f 7b6e 616d 657d 220a 2020 2020 2020  }/{name}".      
+00010880: 2020 7265 7370 203d 2073 656c 662e 6170    resp = self.ap
+00010890: 695f 6361 6c6c 2822 4745 5422 2c20 7061  i_call("GET", pa
+000108a0: 7468 2c20 6572 726f 725f 6d65 7373 6167  th, error_messag
+000108b0: 6529 0a20 2020 2020 2020 2072 6574 7572  e).        retur
+000108c0: 6e20 4665 6174 7572 6553 6574 2e66 726f  n FeatureSet.fro
+000108d0: 6d5f 6469 6374 2872 6573 702e 6a73 6f6e  m_dict(resp.json
+000108e0: 2829 290a 0a20 2020 2064 6566 206c 6973  ())..    def lis
+000108f0: 745f 6665 6174 7572 6573 280a 2020 2020  t_features(.    
+00010900: 2020 2020 7365 6c66 2c0a 2020 2020 2020      self,.      
+00010910: 2020 7072 6f6a 6563 743a 2073 7472 2c0a    project: str,.
+00010920: 2020 2020 2020 2020 6e61 6d65 3a20 7374          name: st
+00010930: 7220 3d20 4e6f 6e65 2c0a 2020 2020 2020  r = None,.      
+00010940: 2020 7461 673a 2073 7472 203d 204e 6f6e    tag: str = Non
+00010950: 652c 0a20 2020 2020 2020 2065 6e74 6974  e,.        entit
+00010960: 6965 733a 204c 6973 745b 7374 725d 203d  ies: List[str] =
+00010970: 204e 6f6e 652c 0a20 2020 2020 2020 206c   None,.        l
+00010980: 6162 656c 733a 204c 6973 745b 7374 725d  abels: List[str]
+00010990: 203d 204e 6f6e 652c 0a20 2020 2029 202d   = None,.    ) -
+000109a0: 3e20 4c69 7374 5b64 6963 745d 3a0a 2020  > List[dict]:.  
+000109b0: 2020 2020 2020 2222 224c 6973 7420 6665        """List fe
+000109c0: 6174 7572 652d 7365 7473 2077 6869 6368  ature-sets which
+000109d0: 2063 6f6e 7461 696e 2073 7065 6369 6669   contain specifi
+000109e0: 6320 6665 6174 7572 6573 2e20 5468 6973  c features. This
+000109f0: 2066 756e 6374 696f 6e20 6d61 7920 7265   function may re
+00010a00: 7475 726e 206d 756c 7469 706c 6520 7665  turn multiple ve
+00010a10: 7273 696f 6e73 206f 6620 7468 6520 7361  rsions of the sa
+00010a20: 6d65 0a20 2020 2020 2020 2066 6561 7475  me.        featu
+00010a30: 7265 2d73 6574 2069 6620 6120 7370 6563  re-set if a spec
+00010a40: 6966 6963 2074 6167 2069 7320 6e6f 7420  ific tag is not 
+00010a50: 7265 7175 6573 7465 642e 204e 6f74 6520  requested. Note 
+00010a60: 7468 6174 2074 6865 2076 6172 696f 7573  that the various
+00010a70: 2066 696c 7465 7273 206f 6620 7468 6973   filters of this
+00010a80: 2066 756e 6374 696f 6e20 6163 7475 616c   function actual
+00010a90: 6c79 0a20 2020 2020 2020 2072 6566 6572  ly.        refer
+00010aa0: 2074 6f20 7468 6520 6665 6174 7572 652d   to the feature-
+00010ab0: 7365 7420 6f62 6a65 6374 2063 6f6e 7461  set object conta
+00010ac0: 696e 696e 6720 7468 6520 6665 6174 7572  ining the featur
+00010ad0: 6573 2c20 6e6f 7420 746f 2074 6865 2066  es, not to the f
+00010ae0: 6561 7475 7265 7320 7468 656d 7365 6c76  eatures themselv
+00010af0: 6573 2e0a 0a20 2020 2020 2020 203a 7061  es...        :pa
+00010b00: 7261 6d20 7072 6f6a 6563 743a 2050 726f  ram project: Pro
+00010b10: 6a65 6374 2077 6869 6368 2063 6f6e 7461  ject which conta
+00010b20: 696e 7320 7468 6573 6520 6665 6174 7572  ins these featur
+00010b30: 6573 2e0a 2020 2020 2020 2020 3a70 6172  es..        :par
+00010b40: 616d 206e 616d 653a 204e 616d 6520 6f66  am name: Name of
+00010b50: 2074 6865 2066 6561 7475 7265 2074 6f20   the feature to 
+00010b60: 6c6f 6f6b 2066 6f72 2e20 5468 6520 6e61  look for. The na
+00010b70: 6d65 2069 7320 7573 6564 2069 6e20 6120  me is used in a 
+00010b80: 6c69 6b65 2071 7565 7279 2c20 616e 6420  like query, and 
+00010b90: 6973 206e 6f74 2063 6173 652d 7365 6e73  is not case-sens
+00010ba0: 6974 6976 652e 2046 6f72 0a20 2020 2020  itive. For.     
+00010bb0: 2020 2020 2020 2065 7861 6d70 6c65 2c20         example, 
+00010bc0: 6c6f 6f6b 696e 6720 666f 7220 6060 6665  looking for ``fe
+00010bd0: 6174 6060 2077 696c 6c20 7265 7475 726e  at`` will return
+00010be0: 2066 6561 7475 7265 7320 7768 6963 6820   features which 
+00010bf0: 6172 6520 6e61 6d65 6420 6060 4d79 4665  are named ``MyFe
+00010c00: 6174 7572 6560 6020 6173 2077 656c 6c20  ature`` as well 
+00010c10: 6173 2060 6064 6566 6561 7460 602e 0a20  as ``defeat``.. 
+00010c20: 2020 2020 2020 203a 7061 7261 6d20 7461         :param ta
+00010c30: 673a 2052 6574 7572 6e20 6665 6174 7572  g: Return featur
+00010c40: 652d 7365 7473 2077 6869 6368 2063 6f6e  e-sets which con
+00010c50: 7461 696e 2074 6865 2066 6561 7475 7265  tain the feature
+00010c60: 7320 6c6f 6f6b 6564 2066 6f72 2c20 616e  s looked for, an
+00010c70: 6420 6172 6520 7461 6767 6564 2077 6974  d are tagged wit
+00010c80: 6820 7468 6520 7370 6563 6966 6963 2074  h the specific t
+00010c90: 6167 2e0a 2020 2020 2020 2020 3a70 6172  ag..        :par
+00010ca0: 616d 2065 6e74 6974 6965 733a 2052 6574  am entities: Ret
+00010cb0: 7572 6e20 6f6e 6c79 2066 6561 7475 7265  urn only feature
+00010cc0: 2d73 6574 7320 7768 6963 6820 636f 6e74  -sets which cont
+00010cd0: 6169 6e20 616e 2065 6e74 6974 7920 7768  ain an entity wh
+00010ce0: 6f73 6520 6e61 6d65 2069 7320 636f 6e74  ose name is cont
+00010cf0: 6169 6e65 6420 696e 2074 6869 7320 6c69  ained in this li
+00010d00: 7374 2e0a 2020 2020 2020 2020 3a70 6172  st..        :par
+00010d10: 616d 206c 6162 656c 733a 2052 6574 7572  am labels: Retur
+00010d20: 6e20 6f6e 6c79 2066 6561 7475 7265 2d73  n only feature-s
+00010d30: 6574 7320 7768 6963 6820 6172 6520 6c61  ets which are la
+00010d40: 6265 6c65 6420 6173 2072 6571 7565 7374  beled as request
+00010d50: 6564 2e0a 2020 2020 2020 2020 3a72 6574  ed..        :ret
+00010d60: 7572 6e73 3a20 4120 6c69 7374 206f 6620  urns: A list of 
+00010d70: 6d61 7070 696e 6720 6672 6f6d 2066 6561  mapping from fea
+00010d80: 7475 7265 2074 6f20 6120 6469 6765 7374  ture to a digest
+00010d90: 206f 6620 7468 6520 6665 6174 7572 652d   of the feature-
+00010da0: 7365 742c 2077 6869 6368 2063 6f6e 7461  set, which conta
+00010db0: 696e 7320 7468 6520 6665 6174 7572 652d  ins the feature-
+00010dc0: 7365 740a 2020 2020 2020 2020 2020 2020  set.            
+00010dd0: 6d65 7461 2d64 6174 612e 204d 756c 7469  meta-data. Multi
+00010de0: 706c 6520 656e 7472 6965 7320 6d61 7920  ple entries may 
+00010df0: 6265 2072 6574 7572 6e65 6420 666f 7220  be returned for 
+00010e00: 616e 7920 7370 6563 6966 6963 2066 6561  any specific fea
+00010e10: 7475 7265 2064 7565 2074 6f20 6d75 6c74  ture due to mult
+00010e20: 6970 6c65 2074 6167 7320 6f72 2076 6572  iple tags or ver
+00010e30: 7369 6f6e 730a 2020 2020 2020 2020 2020  sions.          
+00010e40: 2020 6f66 2074 6865 2066 6561 7475 7265    of the feature
+00010e50: 2d73 6574 2e0a 2020 2020 2020 2020 2222  -set..        ""
+00010e60: 220a 0a20 2020 2020 2020 2070 726f 6a65  "..        proje
+00010e70: 6374 203d 2070 726f 6a65 6374 206f 7220  ct = project or 
+00010e80: 636f 6e66 6967 2e64 6566 6175 6c74 5f70  config.default_p
+00010e90: 726f 6a65 6374 0a20 2020 2020 2020 2070  roject.        p
+00010ea0: 6172 616d 7320 3d20 7b0a 2020 2020 2020  arams = {.      
+00010eb0: 2020 2020 2020 226e 616d 6522 3a20 6e61        "name": na
+00010ec0: 6d65 2c0a 2020 2020 2020 2020 2020 2020  me,.            
+00010ed0: 2274 6167 223a 2074 6167 2c0a 2020 2020  "tag": tag,.    
+00010ee0: 2020 2020 2020 2020 2265 6e74 6974 7922          "entity"
+00010ef0: 3a20 656e 7469 7469 6573 206f 7220 5b5d  : entities or []
+00010f00: 2c0a 2020 2020 2020 2020 2020 2020 226c  ,.            "l
+00010f10: 6162 656c 223a 206c 6162 656c 7320 6f72  abel": labels or
+00010f20: 205b 5d2c 0a20 2020 2020 2020 207d 0a0a   [],.        }..
+00010f30: 2020 2020 2020 2020 7061 7468 203d 2066          path = f
+00010f40: 2270 726f 6a65 6374 732f 7b70 726f 6a65  "projects/{proje
+00010f50: 6374 7d2f 6665 6174 7572 6573 220a 0a20  ct}/features".. 
+00010f60: 2020 2020 2020 2065 7272 6f72 5f6d 6573         error_mes
+00010f70: 7361 6765 203d 2066 2246 6169 6c65 6420  sage = f"Failed 
+00010f80: 6c69 7374 696e 6720 6665 6174 7572 6573  listing features
+00010f90: 2c20 7072 6f6a 6563 743a 207b 7072 6f6a  , project: {proj
+00010fa0: 6563 747d 2c20 7175 6572 793a 207b 7061  ect}, query: {pa
+00010fb0: 7261 6d73 7d22 0a20 2020 2020 2020 2072  rams}".        r
+00010fc0: 6573 7020 3d20 7365 6c66 2e61 7069 5f63  esp = self.api_c
+00010fd0: 616c 6c28 2247 4554 222c 2070 6174 682c  all("GET", path,
+00010fe0: 2065 7272 6f72 5f6d 6573 7361 6765 2c20   error_message, 
+00010ff0: 7061 7261 6d73 3d70 6172 616d 7329 0a20  params=params). 
+00011000: 2020 2020 2020 2072 6574 7572 6e20 7265         return re
+00011010: 7370 2e6a 736f 6e28 295b 2266 6561 7475  sp.json()["featu
+00011020: 7265 7322 5d0a 0a20 2020 2064 6566 206c  res"]..    def l
+00011030: 6973 745f 656e 7469 7469 6573 280a 2020  ist_entities(.  
+00011040: 2020 2020 2020 7365 6c66 2c0a 2020 2020        self,.    
+00011050: 2020 2020 7072 6f6a 6563 743a 2073 7472      project: str
+00011060: 2c0a 2020 2020 2020 2020 6e61 6d65 3a20  ,.        name: 
+00011070: 7374 7220 3d20 4e6f 6e65 2c0a 2020 2020  str = None,.    
+00011080: 2020 2020 7461 673a 2073 7472 203d 204e      tag: str = N
+00011090: 6f6e 652c 0a20 2020 2020 2020 206c 6162  one,.        lab
+000110a0: 656c 733a 204c 6973 745b 7374 725d 203d  els: List[str] =
+000110b0: 204e 6f6e 652c 0a20 2020 2029 202d 3e20   None,.    ) -> 
+000110c0: 4c69 7374 5b64 6963 745d 3a0a 2020 2020  List[dict]:.    
+000110d0: 2020 2020 2222 2252 6574 7269 6576 6520      """Retrieve 
+000110e0: 6120 6c69 7374 206f 6620 656e 7469 7469  a list of entiti
+000110f0: 6573 2061 6e64 2074 6865 6972 206d 6170  es and their map
+00011100: 7069 6e67 2074 6f20 7468 6520 636f 6e74  ping to the cont
+00011110: 6169 6e69 6e67 2066 6561 7475 7265 2d73  aining feature-s
+00011120: 6574 732e 2054 6869 7320 6675 6e63 7469  ets. This functi
+00011130: 6f6e 2069 7320 7369 6d69 6c61 720a 2020  on is similar.  
+00011140: 2020 2020 2020 746f 2074 6865 203a 7079        to the :py
+00011150: 3a66 756e 633a 607e 6c69 7374 5f66 6561  :func:`~list_fea
+00011160: 7475 7265 7360 2066 756e 6374 696f 6e2c  tures` function,
+00011170: 2061 6e64 2075 7365 7320 7468 6520 7361   and uses the sa
+00011180: 6d65 206c 6f67 6963 2e20 486f 7765 7665  me logic. Howeve
+00011190: 722c 2074 6865 2065 6e74 6974 6965 7320  r, the entities 
+000111a0: 6172 6520 6d61 7463 6865 640a 2020 2020  are matched.    
+000111b0: 2020 2020 6167 6169 6e73 7420 7468 6520      against the 
+000111c0: 6e61 6d65 2072 6174 6865 7220 7468 616e  name rather than
+000111d0: 2074 6865 2066 6561 7475 7265 732e 0a20   the features.. 
+000111e0: 2020 2020 2020 2022 2222 0a0a 2020 2020         """..    
+000111f0: 2020 2020 7072 6f6a 6563 7420 3d20 7072      project = pr
+00011200: 6f6a 6563 7420 6f72 2063 6f6e 6669 672e  oject or config.
+00011210: 6465 6661 756c 745f 7072 6f6a 6563 740a  default_project.
+00011220: 2020 2020 2020 2020 7061 7261 6d73 203d          params =
+00011230: 207b 0a20 2020 2020 2020 2020 2020 2022   {.            "
+00011240: 6e61 6d65 223a 206e 616d 652c 0a20 2020  name": name,.   
+00011250: 2020 2020 2020 2020 2022 7461 6722 3a20           "tag": 
+00011260: 7461 672c 0a20 2020 2020 2020 2020 2020  tag,.           
+00011270: 2022 6c61 6265 6c22 3a20 6c61 6265 6c73   "label": labels
+00011280: 206f 7220 5b5d 2c0a 2020 2020 2020 2020   or [],.        
+00011290: 7d0a 0a20 2020 2020 2020 2070 6174 6820  }..        path 
+000112a0: 3d20 6622 7072 6f6a 6563 7473 2f7b 7072  = f"projects/{pr
+000112b0: 6f6a 6563 747d 2f65 6e74 6974 6965 7322  oject}/entities"
+000112c0: 0a0a 2020 2020 2020 2020 6572 726f 725f  ..        error_
+000112d0: 6d65 7373 6167 6520 3d20 6622 4661 696c  message = f"Fail
+000112e0: 6564 206c 6973 7469 6e67 2065 6e74 6974  ed listing entit
+000112f0: 6965 732c 2070 726f 6a65 6374 3a20 7b70  ies, project: {p
+00011300: 726f 6a65 6374 7d2c 2071 7565 7279 3a20  roject}, query: 
+00011310: 7b70 6172 616d 737d 220a 2020 2020 2020  {params}".      
+00011320: 2020 7265 7370 203d 2073 656c 662e 6170    resp = self.ap
+00011330: 695f 6361 6c6c 2822 4745 5422 2c20 7061  i_call("GET", pa
+00011340: 7468 2c20 6572 726f 725f 6d65 7373 6167  th, error_messag
+00011350: 652c 2070 6172 616d 733d 7061 7261 6d73  e, params=params
+00011360: 290a 2020 2020 2020 2020 7265 7475 726e  ).        return
+00011370: 2072 6573 702e 6a73 6f6e 2829 5b22 656e   resp.json()["en
+00011380: 7469 7469 6573 225d 0a0a 2020 2020 4073  tities"]..    @s
+00011390: 7461 7469 636d 6574 686f 640a 2020 2020  taticmethod.    
+000113a0: 6465 6620 5f67 656e 6572 6174 655f 7061  def _generate_pa
+000113b0: 7274 6974 696f 6e5f 6279 5f70 6172 616d  rtition_by_param
+000113c0: 7328 0a20 2020 2020 2020 2070 6172 7469  s(.        parti
+000113d0: 7469 6f6e 5f62 795f 636c 732c 0a20 2020  tion_by_cls,.   
+000113e0: 2020 2020 2070 6172 7469 7469 6f6e 5f62       partition_b
+000113f0: 792c 0a20 2020 2020 2020 2072 6f77 735f  y,.        rows_
+00011400: 7065 725f 7061 7274 6974 696f 6e2c 0a20  per_partition,. 
+00011410: 2020 2020 2020 2073 6f72 745f 6279 2c0a         sort_by,.
+00011420: 2020 2020 2020 2020 6f72 6465 722c 0a20          order,. 
+00011430: 2020 2020 2020 206d 6178 5f70 6172 7469         max_parti
+00011440: 7469 6f6e 733d 4e6f 6e65 2c0a 2020 2020  tions=None,.    
+00011450: 293a 0a0a 2020 2020 2020 2020 7061 7274  ):..        part
+00011460: 6974 696f 6e5f 7061 7261 6d73 203d 207b  ition_params = {
+00011470: 0a20 2020 2020 2020 2020 2020 2022 7061  .            "pa
+00011480: 7274 6974 696f 6e2d 6279 223a 2070 6172  rtition-by": par
+00011490: 7469 7469 6f6e 5f62 792c 0a20 2020 2020  tition_by,.     
+000114a0: 2020 2020 2020 2022 726f 7773 2d70 6572         "rows-per
+000114b0: 2d70 6172 7469 7469 6f6e 223a 2072 6f77  -partition": row
+000114c0: 735f 7065 725f 7061 7274 6974 696f 6e2c  s_per_partition,
+000114d0: 0a20 2020 2020 2020 2020 2020 2022 7061  .            "pa
+000114e0: 7274 6974 696f 6e2d 736f 7274 2d62 7922  rtition-sort-by"
+000114f0: 3a20 736f 7274 5f62 792c 0a20 2020 2020  : sort_by,.     
+00011500: 2020 2020 2020 2022 7061 7274 6974 696f         "partitio
+00011510: 6e2d 6f72 6465 7222 3a20 6f72 6465 722c  n-order": order,
+00011520: 0a20 2020 2020 2020 207d 0a20 2020 2020  .        }.     
+00011530: 2020 2069 6620 6d61 785f 7061 7274 6974     if max_partit
+00011540: 696f 6e73 2069 7320 6e6f 7420 4e6f 6e65  ions is not None
+00011550: 3a0a 2020 2020 2020 2020 2020 2020 7061  :.            pa
+00011560: 7274 6974 696f 6e5f 7061 7261 6d73 5b22  rtition_params["
+00011570: 6d61 782d 7061 7274 6974 696f 6e73 225d  max-partitions"]
+00011580: 203d 206d 6178 5f70 6172 7469 7469 6f6e   = max_partition
+00011590: 730a 2020 2020 2020 2020 7265 7475 726e  s.        return
+000115a0: 2070 6172 7469 7469 6f6e 5f70 6172 616d   partition_param
+000115b0: 730a 0a20 2020 2064 6566 206c 6973 745f  s..    def list_
+000115c0: 6665 6174 7572 655f 7365 7473 280a 2020  feature_sets(.  
+000115d0: 2020 2020 2020 7365 6c66 2c0a 2020 2020        self,.    
+000115e0: 2020 2020 7072 6f6a 6563 743a 2073 7472      project: str
+000115f0: 203d 2022 222c 0a20 2020 2020 2020 206e   = "",.        n
+00011600: 616d 653a 2073 7472 203d 204e 6f6e 652c  ame: str = None,
+00011610: 0a20 2020 2020 2020 2074 6167 3a20 7374  .        tag: st
+00011620: 7220 3d20 4e6f 6e65 2c0a 2020 2020 2020  r = None,.      
+00011630: 2020 7374 6174 653a 2073 7472 203d 204e    state: str = N
+00011640: 6f6e 652c 0a20 2020 2020 2020 2065 6e74  one,.        ent
+00011650: 6974 6965 733a 204c 6973 745b 7374 725d  ities: List[str]
+00011660: 203d 204e 6f6e 652c 0a20 2020 2020 2020   = None,.       
+00011670: 2066 6561 7475 7265 733a 204c 6973 745b   features: List[
+00011680: 7374 725d 203d 204e 6f6e 652c 0a20 2020  str] = None,.   
+00011690: 2020 2020 206c 6162 656c 733a 204c 6973       labels: Lis
+000116a0: 745b 7374 725d 203d 204e 6f6e 652c 0a20  t[str] = None,. 
+000116b0: 2020 2020 2020 2070 6172 7469 7469 6f6e         partition
+000116c0: 5f62 793a 2055 6e69 6f6e 5b73 6368 656d  _by: Union[schem
+000116d0: 6173 2e46 6561 7475 7265 5374 6f72 6550  as.FeatureStoreP
+000116e0: 6172 7469 7469 6f6e 4279 4669 656c 642c  artitionByField,
+000116f0: 2073 7472 5d20 3d20 4e6f 6e65 2c0a 2020   str] = None,.  
+00011700: 2020 2020 2020 726f 7773 5f70 6572 5f70        rows_per_p
+00011710: 6172 7469 7469 6f6e 3a20 696e 7420 3d20  artition: int = 
+00011720: 312c 0a20 2020 2020 2020 2070 6172 7469  1,.        parti
+00011730: 7469 6f6e 5f73 6f72 745f 6279 3a20 556e  tion_sort_by: Un
+00011740: 696f 6e5b 7363 6865 6d61 732e 536f 7274  ion[schemas.Sort
+00011750: 4669 656c 642c 2073 7472 5d20 3d20 4e6f  Field, str] = No
+00011760: 6e65 2c0a 2020 2020 2020 2020 7061 7274  ne,.        part
+00011770: 6974 696f 6e5f 6f72 6465 723a 2055 6e69  ition_order: Uni
+00011780: 6f6e 5b73 6368 656d 6173 2e4f 7264 6572  on[schemas.Order
+00011790: 5479 7065 2c20 7374 725d 203d 2073 6368  Type, str] = sch
+000117a0: 656d 6173 2e4f 7264 6572 5479 7065 2e64  emas.OrderType.d
+000117b0: 6573 632c 0a20 2020 2029 202d 3e20 4c69  esc,.    ) -> Li
+000117c0: 7374 5b46 6561 7475 7265 5365 745d 3a0a  st[FeatureSet]:.
+000117d0: 2020 2020 2020 2020 2222 2252 6574 7269          """Retri
+000117e0: 6576 6520 6120 6c69 7374 206f 6620 6665  eve a list of fe
+000117f0: 6174 7572 652d 7365 7473 206d 6174 6368  ature-sets match
+00011800: 696e 6720 7468 6520 6372 6974 6572 6961  ing the criteria
+00011810: 2070 726f 7669 6465 642e 0a0a 2020 2020   provided...    
+00011820: 2020 2020 3a70 6172 616d 2070 726f 6a65      :param proje
+00011830: 6374 3a20 5072 6f6a 6563 7420 6e61 6d65  ct: Project name
+00011840: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
+00011850: 206e 616d 653a 204e 616d 6520 6f66 2066   name: Name of f
+00011860: 6561 7475 7265 2d73 6574 2074 6f20 6d61  eature-set to ma
+00011870: 7463 682e 2054 6869 7320 6973 2061 206c  tch. This is a l
+00011880: 696b 6520 7175 6572 792c 2061 6e64 2069  ike query, and i
+00011890: 7320 6361 7365 2d69 6e73 656e 7369 7469  s case-insensiti
+000118a0: 7665 2e0a 2020 2020 2020 2020 3a70 6172  ve..        :par
+000118b0: 616d 2074 6167 3a20 4d61 7463 6820 6665  am tag: Match fe
+000118c0: 6174 7572 652d 7365 7473 2077 6974 6820  ature-sets with 
+000118d0: 7370 6563 6966 6963 2074 6167 2e0a 2020  specific tag..  
+000118e0: 2020 2020 2020 3a70 6172 616d 2073 7461        :param sta
+000118f0: 7465 3a20 4d61 7463 6820 6665 6174 7572  te: Match featur
+00011900: 652d 7365 7473 2077 6974 6820 6120 7370  e-sets with a sp
+00011910: 6563 6966 6963 2073 7461 7465 2e0a 2020  ecific state..  
+00011920: 2020 2020 2020 3a70 6172 616d 2065 6e74        :param ent
+00011930: 6974 6965 733a 204d 6174 6368 2066 6561  ities: Match fea
+00011940: 7475 7265 2d73 6574 7320 7768 6963 6820  ture-sets which 
+00011950: 636f 6e74 6169 6e20 656e 7469 7469 6573  contain entities
+00011960: 2077 686f 7365 206e 616d 6520 6973 2069   whose name is i
+00011970: 6e20 7468 6973 206c 6973 742e 0a20 2020  n this list..   
+00011980: 2020 2020 203a 7061 7261 6d20 6665 6174       :param feat
+00011990: 7572 6573 3a20 4d61 7463 6820 6665 6174  ures: Match feat
+000119a0: 7572 652d 7365 7473 2077 6869 6368 2063  ure-sets which c
+000119b0: 6f6e 7461 696e 2066 6561 7475 7265 7320  ontain features 
+000119c0: 7768 6f73 6520 6e61 6d65 2069 7320 696e  whose name is in
+000119d0: 2074 6869 7320 6c69 7374 2e0a 2020 2020   this list..    
+000119e0: 2020 2020 3a70 6172 616d 206c 6162 656c      :param label
+000119f0: 733a 204d 6174 6368 2066 6561 7475 7265  s: Match feature
+00011a00: 2d73 6574 7320 7768 6963 6820 6861 7665  -sets which have
+00011a10: 2074 6865 7365 206c 6162 656c 732e 0a20   these labels.. 
+00011a20: 2020 2020 2020 203a 7061 7261 6d20 7061         :param pa
+00011a30: 7274 6974 696f 6e5f 6279 3a20 4669 656c  rtition_by: Fiel
+00011a40: 6420 746f 2067 726f 7570 2072 6573 756c  d to group resul
+00011a50: 7473 2062 792e 204f 6e6c 7920 616c 6c6f  ts by. Only allo
+00011a60: 7765 6420 7661 6c75 6520 6973 2060 6e61  wed value is `na
+00011a70: 6d65 602e 2057 6865 6e20 6070 6172 7469  me`. When `parti
+00011a80: 7469 6f6e 5f62 7960 2069 7320 7370 6563  tion_by` is spec
+00011a90: 6966 6965 642c 0a20 2020 2020 2020 2020  ified,.         
+00011aa0: 2020 2074 6865 2060 7061 7274 6974 696f     the `partitio
+00011ab0: 6e5f 736f 7274 5f62 7960 2070 6172 616d  n_sort_by` param
+00011ac0: 6574 6572 206d 7573 7420 6265 2070 726f  eter must be pro
+00011ad0: 7669 6465 6420 6173 2077 656c 6c2e 0a20  vided as well.. 
+00011ae0: 2020 2020 2020 203a 7061 7261 6d20 726f         :param ro
+00011af0: 7773 5f70 6572 5f70 6172 7469 7469 6f6e  ws_per_partition
+00011b00: 3a20 486f 7720 6d61 6e79 2074 6f70 2072  : How many top r
+00011b10: 6f77 7320 2870 6572 2073 6f72 7469 6e67  ows (per sorting
+00011b20: 2064 6566 696e 6564 2062 7920 6070 6172   defined by `par
+00011b30: 7469 7469 6f6e 5f73 6f72 745f 6279 6020  tition_sort_by` 
+00011b40: 616e 6420 6070 6172 7469 7469 6f6e 5f6f  and `partition_o
+00011b50: 7264 6572 6029 0a20 2020 2020 2020 2020  rder`).         
+00011b60: 2020 2074 6f20 7265 7475 726e 2070 6572     to return per
+00011b70: 2067 726f 7570 2e20 4465 6661 756c 7420   group. Default 
+00011b80: 7661 6c75 6520 6973 2031 2e0a 2020 2020  value is 1..    
+00011b90: 2020 2020 3a70 6172 616d 2070 6172 7469      :param parti
+00011ba0: 7469 6f6e 5f73 6f72 745f 6279 3a20 5768  tion_sort_by: Wh
+00011bb0: 6174 2066 6965 6c64 2074 6f20 736f 7274  at field to sort
+00011bc0: 2074 6865 2072 6573 756c 7473 2062 792c   the results by,
+00011bd0: 2077 6974 6869 6e20 6561 6368 2070 6172   within each par
+00011be0: 7469 7469 6f6e 2064 6566 696e 6564 2062  tition defined b
+00011bf0: 7920 6070 6172 7469 7469 6f6e 5f62 7960  y `partition_by`
+00011c00: 2e0a 2020 2020 2020 2020 2020 2020 4375  ..            Cu
+00011c10: 7272 656e 746c 7920 7468 6520 6f6e 6c79  rrently the only
+00011c20: 2061 6c6c 6f77 6564 2076 616c 7565 2061   allowed value a
+00011c30: 7265 2060 6372 6561 7465 6460 2061 6e64  re `created` and
+00011c40: 2060 7570 6461 7465 6460 2e0a 2020 2020   `updated`..    
+00011c50: 2020 2020 3a70 6172 616d 2070 6172 7469      :param parti
+00011c60: 7469 6f6e 5f6f 7264 6572 3a20 4f72 6465  tion_order: Orde
+00011c70: 7220 6f66 2073 6f72 7469 6e67 2077 6974  r of sorting wit
+00011c80: 6869 6e20 7061 7274 6974 696f 6e73 202d  hin partitions -
+00011c90: 2060 6173 6360 206f 7220 6064 6573 6360   `asc` or `desc`
+00011ca0: 2e20 4465 6661 756c 7420 6973 2060 6465  . Default is `de
+00011cb0: 7363 602e 0a20 2020 2020 2020 203a 7265  sc`..        :re
+00011cc0: 7475 726e 733a 204c 6973 7420 6f66 206d  turns: List of m
+00011cd0: 6174 6368 696e 6720 3a70 793a 636c 6173  atching :py:clas
+00011ce0: 733a 607e 6d6c 7275 6e2e 6665 6174 7572  s:`~mlrun.featur
+00011cf0: 655f 7374 6f72 652e 4665 6174 7572 6553  e_store.FeatureS
+00011d00: 6574 6020 6f62 6a65 6374 732e 0a20 2020  et` objects..   
+00011d10: 2020 2020 2022 2222 0a0a 2020 2020 2020       """..      
+00011d20: 2020 7072 6f6a 6563 7420 3d20 7072 6f6a    project = proj
+00011d30: 6563 7420 6f72 2063 6f6e 6669 672e 6465  ect or config.de
+00011d40: 6661 756c 745f 7072 6f6a 6563 740a 0a20  fault_project.. 
+00011d50: 2020 2020 2020 2070 6172 616d 7320 3d20         params = 
+00011d60: 7b0a 2020 2020 2020 2020 2020 2020 226e  {.            "n
+00011d70: 616d 6522 3a20 6e61 6d65 2c0a 2020 2020  ame": name,.    
+00011d80: 2020 2020 2020 2020 2273 7461 7465 223a          "state":
+00011d90: 2073 7461 7465 2c0a 2020 2020 2020 2020   state,.        
+00011da0: 2020 2020 2274 6167 223a 2074 6167 2c0a      "tag": tag,.
+00011db0: 2020 2020 2020 2020 2020 2020 2265 6e74              "ent
+00011dc0: 6974 7922 3a20 656e 7469 7469 6573 206f  ity": entities o
+00011dd0: 7220 5b5d 2c0a 2020 2020 2020 2020 2020  r [],.          
+00011de0: 2020 2266 6561 7475 7265 223a 2066 6561    "feature": fea
+00011df0: 7475 7265 7320 6f72 205b 5d2c 0a20 2020  tures or [],.   
+00011e00: 2020 2020 2020 2020 2022 6c61 6265 6c22           "label"
+00011e10: 3a20 6c61 6265 6c73 206f 7220 5b5d 2c0a  : labels or [],.
+00011e20: 2020 2020 2020 2020 7d0a 2020 2020 2020          }.      
+00011e30: 2020 6966 2070 6172 7469 7469 6f6e 5f62    if partition_b
+00011e40: 793a 0a20 2020 2020 2020 2020 2020 2070  y:.            p
+00011e50: 6172 616d 732e 7570 6461 7465 280a 2020  arams.update(.  
+00011e60: 2020 2020 2020 2020 2020 2020 2020 7365                se
+00011e70: 6c66 2e5f 6765 6e65 7261 7465 5f70 6172  lf._generate_par
+00011e80: 7469 7469 6f6e 5f62 795f 7061 7261 6d73  tition_by_params
+00011e90: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+00011ea0: 2020 2020 2020 7363 6865 6d61 732e 4665        schemas.Fe
+00011eb0: 6174 7572 6553 746f 7265 5061 7274 6974  atureStorePartit
+00011ec0: 696f 6e42 7946 6965 6c64 2c0a 2020 2020  ionByField,.    
+00011ed0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011ee0: 7061 7274 6974 696f 6e5f 6279 2c0a 2020  partition_by,.  
+00011ef0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011f00: 2020 726f 7773 5f70 6572 5f70 6172 7469    rows_per_parti
+00011f10: 7469 6f6e 2c0a 2020 2020 2020 2020 2020  tion,.          
+00011f20: 2020 2020 2020 2020 2020 7061 7274 6974            partit
+00011f30: 696f 6e5f 736f 7274 5f62 792c 0a20 2020  ion_sort_by,.   
+00011f40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011f50: 2070 6172 7469 7469 6f6e 5f6f 7264 6572   partition_order
+00011f60: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00011f70: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
+00011f80: 290a 0a20 2020 2020 2020 2070 6174 6820  )..        path 
+00011f90: 3d20 6622 7072 6f6a 6563 7473 2f7b 7072  = f"projects/{pr
+00011fa0: 6f6a 6563 747d 2f66 6561 7475 7265 2d73  oject}/feature-s
+00011fb0: 6574 7322 0a0a 2020 2020 2020 2020 6572  ets"..        er
+00011fc0: 726f 725f 6d65 7373 6167 6520 3d20 280a  ror_message = (.
+00011fd0: 2020 2020 2020 2020 2020 2020 6622 4661              f"Fa
+00011fe0: 696c 6564 206c 6973 7469 6e67 2066 6561  iled listing fea
+00011ff0: 7475 7265 2d73 6574 732c 2070 726f 6a65  ture-sets, proje
+00012000: 6374 3a20 7b70 726f 6a65 6374 7d2c 2071  ct: {project}, q
+00012010: 7565 7279 3a20 7b70 6172 616d 737d 220a  uery: {params}".
+00012020: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+00012030: 2020 7265 7370 203d 2073 656c 662e 6170    resp = self.ap
+00012040: 695f 6361 6c6c 2822 4745 5422 2c20 7061  i_call("GET", pa
+00012050: 7468 2c20 6572 726f 725f 6d65 7373 6167  th, error_messag
+00012060: 652c 2070 6172 616d 733d 7061 7261 6d73  e, params=params
+00012070: 290a 2020 2020 2020 2020 6665 6174 7572  ).        featur
+00012080: 655f 7365 7473 203d 2072 6573 702e 6a73  e_sets = resp.js
+00012090: 6f6e 2829 5b22 6665 6174 7572 655f 7365  on()["feature_se
+000120a0: 7473 225d 0a20 2020 2020 2020 2069 6620  ts"].        if 
+000120b0: 6665 6174 7572 655f 7365 7473 3a0a 2020  feature_sets:.  
+000120c0: 2020 2020 2020 2020 2020 7265 7475 726e            return
+000120d0: 205b 4665 6174 7572 6553 6574 2e66 726f   [FeatureSet.fro
+000120e0: 6d5f 6469 6374 286f 626a 2920 666f 7220  m_dict(obj) for 
+000120f0: 6f62 6a20 696e 2066 6561 7475 7265 5f73  obj in feature_s
+00012100: 6574 735d 0a0a 2020 2020 6465 6620 7374  ets]..    def st
+00012110: 6f72 655f 6665 6174 7572 655f 7365 7428  ore_feature_set(
+00012120: 0a20 2020 2020 2020 2073 656c 662c 0a20  .        self,. 
+00012130: 2020 2020 2020 2066 6561 7475 7265 5f73         feature_s
+00012140: 6574 3a20 556e 696f 6e5b 6469 6374 2c20  et: Union[dict, 
+00012150: 7363 6865 6d61 732e 4665 6174 7572 6553  schemas.FeatureS
+00012160: 6574 2c20 4665 6174 7572 6553 6574 5d2c  et, FeatureSet],
+00012170: 0a20 2020 2020 2020 206e 616d 653d 4e6f  .        name=No
+00012180: 6e65 2c0a 2020 2020 2020 2020 7072 6f6a  ne,.        proj
+00012190: 6563 743d 2222 2c0a 2020 2020 2020 2020  ect="",.        
+000121a0: 7461 673d 4e6f 6e65 2c0a 2020 2020 2020  tag=None,.      
+000121b0: 2020 7569 643d 4e6f 6e65 2c0a 2020 2020    uid=None,.    
+000121c0: 2020 2020 7665 7273 696f 6e65 643d 5472      versioned=Tr
+000121d0: 7565 2c0a 2020 2020 2920 2d3e 2064 6963  ue,.    ) -> dic
+000121e0: 743a 0a20 2020 2020 2020 2022 2222 5361  t:.        """Sa
+000121f0: 7665 2061 203a 7079 3a63 6c61 7373 3a60  ve a :py:class:`
+00012200: 7e6d 6c72 756e 2e66 6561 7475 7265 5f73  ~mlrun.feature_s
+00012210: 746f 7265 2e46 6561 7475 7265 5365 7460  tore.FeatureSet`
+00012220: 206f 626a 6563 7420 696e 2074 6865 203a   object in the :
+00012230: 7079 3a6d 6f64 3a60 6d6c 7275 6e60 2044  py:mod:`mlrun` D
+00012240: 422e 2054 6865 0a20 2020 2020 2020 2066  B. The.        f
+00012250: 6561 7475 7265 2d73 6574 2063 616e 2062  eature-set can b
+00012260: 6520 6569 7468 6572 2061 206e 6577 206f  e either a new o
+00012270: 626a 6563 7420 6f72 2061 206d 6f64 6966  bject or a modif
+00012280: 6963 6174 696f 6e20 746f 2065 7869 7374  ication to exist
+00012290: 696e 6720 6f62 6a65 6374 2072 6566 6572  ing object refer
+000122a0: 656e 6365 6420 6279 2074 6865 2070 6172  enced by the par
+000122b0: 616d 7320 6f66 0a20 2020 2020 2020 2074  ams of.        t
+000122c0: 6865 2066 756e 6374 696f 6e2e 0a0a 2020  he function...  
+000122d0: 2020 2020 2020 3a70 6172 616d 2066 6561        :param fea
+000122e0: 7475 7265 5f73 6574 3a20 5468 6520 3a70  ture_set: The :p
+000122f0: 793a 636c 6173 733a 607e 6d6c 7275 6e2e  y:class:`~mlrun.
+00012300: 6665 6174 7572 655f 7374 6f72 652e 4665  feature_store.Fe
+00012310: 6174 7572 6553 6574 6020 746f 2073 746f  atureSet` to sto
+00012320: 7265 2e0a 2020 2020 2020 2020 3a70 6172  re..        :par
+00012330: 616d 206e 616d 653a 2020 2020 4e61 6d65  am name:    Name
+00012340: 206f 6620 6665 6174 7572 6520 7365 742e   of feature set.
+00012350: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
+00012360: 7072 6f6a 6563 743a 204e 616d 6520 6f66  project: Name of
+00012370: 2070 726f 6a65 6374 2074 6869 7320 6665   project this fe
+00012380: 6174 7572 652d 7365 7420 6265 6c6f 6e67  ature-set belong
+00012390: 7320 746f 2e0a 2020 2020 2020 2020 3a70  s to..        :p
+000123a0: 6172 616d 2074 6167 3a20 5468 6520 6060  aram tag: The ``
+000123b0: 7461 6760 6020 6f66 2074 6865 206f 626a  tag`` of the obj
+000123c0: 6563 7420 746f 2072 6570 6c61 6365 2069  ect to replace i
+000123d0: 6e20 7468 6520 4442 2c20 666f 7220 6578  n the DB, for ex
+000123e0: 616d 706c 6520 6060 6c61 7465 7374 6060  ample ``latest``
+000123f0: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
+00012400: 2075 6964 3a20 5468 6520 6060 7569 6460   uid: The ``uid`
+00012410: 6020 6f66 2074 6865 206f 626a 6563 7420  ` of the object 
+00012420: 746f 2072 6570 6c61 6365 2069 6e20 7468  to replace in th
+00012430: 6520 4442 2e20 4966 2075 7369 6e67 2074  e DB. If using t
+00012440: 6869 7320 7061 7261 6d65 7465 722c 2074  his parameter, t
+00012450: 6865 206d 6f64 6966 6965 6420 6f62 6a65  he modified obje
+00012460: 6374 0a20 2020 2020 2020 2020 2020 206d  ct.            m
+00012470: 7573 7420 6861 7665 2074 6865 2073 616d  ust have the sam
+00012480: 6520 6060 7569 6460 6020 6f66 2074 6865  e ``uid`` of the
+00012490: 2070 7265 7669 6f75 736c 792d 6578 6973   previously-exis
+000124a0: 7469 6e67 206f 626a 6563 742e 2054 6869  ting object. Thi
+000124b0: 7320 6361 6e6e 6f74 2062 6520 7573 6564  s cannot be used
+000124c0: 2066 6f72 206e 6f6e 2d76 6572 7369 6f6e   for non-version
+000124d0: 6564 206f 626a 6563 7473 2e0a 2020 2020  ed objects..    
+000124e0: 2020 2020 3a70 6172 616d 2076 6572 7369      :param versi
+000124f0: 6f6e 6564 3a20 5768 6574 6865 7220 746f  oned: Whether to
+00012500: 206d 6169 6e74 6169 6e20 7665 7273 696f   maintain versio
+00012510: 6e73 2066 6f72 2074 6869 7320 6665 6174  ns for this feat
+00012520: 7572 652d 7365 742e 2041 6c6c 2076 6572  ure-set. All ver
+00012530: 7369 6f6e 7320 6f66 2061 2076 6572 7369  sions of a versi
+00012540: 6f6e 6564 206f 626a 6563 740a 2020 2020  oned object.    
+00012550: 2020 2020 2020 2020 7769 6c6c 2062 6520          will be 
+00012560: 6b65 7074 2069 6e20 7468 6520 4442 2061  kept in the DB a
+00012570: 6e64 2063 616e 2062 6520 7265 7472 6965  nd can be retrie
+00012580: 7665 6420 756e 7469 6c20 6578 706c 6963  ved until explic
+00012590: 6974 6c79 2064 656c 6574 6564 2e0a 2020  itly deleted..  
+000125a0: 2020 2020 2020 3a72 6574 7572 6e73 3a20        :returns: 
+000125b0: 5468 6520 3a70 793a 636c 6173 733a 607e  The :py:class:`~
+000125c0: 6d6c 7275 6e2e 6665 6174 7572 655f 7374  mlrun.feature_st
+000125d0: 6f72 652e 4665 6174 7572 6553 6574 6020  ore.FeatureSet` 
+000125e0: 6f62 6a65 6374 2028 6173 2064 6963 7429  object (as dict)
+000125f0: 2e0a 2020 2020 2020 2020 2222 220a 0a20  ..        """.. 
+00012600: 2020 2020 2020 2072 6566 6572 656e 6365         reference
+00012610: 203d 2073 656c 662e 5f72 6573 6f6c 7665   = self._resolve
+00012620: 5f72 6566 6572 656e 6365 2874 6167 2c20  _reference(tag, 
+00012630: 7569 6429 0a20 2020 2020 2020 2070 6172  uid).        par
+00012640: 616d 7320 3d20 7b22 7665 7273 696f 6e65  ams = {"versione
+00012650: 6422 3a20 7665 7273 696f 6e65 647d 0a0a  d": versioned}..
+00012660: 2020 2020 2020 2020 6966 2069 7369 6e73          if isins
+00012670: 7461 6e63 6528 6665 6174 7572 655f 7365  tance(feature_se
+00012680: 742c 2073 6368 656d 6173 2e46 6561 7475  t, schemas.Featu
+00012690: 7265 5365 7429 3a0a 2020 2020 2020 2020  reSet):.        
+000126a0: 2020 2020 6665 6174 7572 655f 7365 7420      feature_set 
+000126b0: 3d20 6665 6174 7572 655f 7365 742e 6469  = feature_set.di
+000126c0: 6374 2829 0a20 2020 2020 2020 2065 6c69  ct().        eli
+000126d0: 6620 6973 696e 7374 616e 6365 2866 6561  f isinstance(fea
+000126e0: 7475 7265 5f73 6574 2c20 4665 6174 7572  ture_set, Featur
+000126f0: 6553 6574 293a 0a20 2020 2020 2020 2020  eSet):.         
+00012700: 2020 2066 6561 7475 7265 5f73 6574 203d     feature_set =
+00012710: 2066 6561 7475 7265 5f73 6574 2e74 6f5f   feature_set.to_
+00012720: 6469 6374 2829 0a0a 2020 2020 2020 2020  dict()..        
+00012730: 6e61 6d65 203d 206e 616d 6520 6f72 2066  name = name or f
+00012740: 6561 7475 7265 5f73 6574 5b22 6d65 7461  eature_set["meta
+00012750: 6461 7461 225d 5b22 6e61 6d65 225d 0a20  data"]["name"]. 
+00012760: 2020 2020 2020 2070 726f 6a65 6374 203d         project =
+00012770: 2028 0a20 2020 2020 2020 2020 2020 2070   (.            p
+00012780: 726f 6a65 6374 206f 7220 6665 6174 7572  roject or featur
+00012790: 655f 7365 745b 226d 6574 6164 6174 6122  e_set["metadata"
+000127a0: 5d2e 6765 7428 2270 726f 6a65 6374 2229  ].get("project")
+000127b0: 206f 7220 636f 6e66 6967 2e64 6566 6175   or config.defau
+000127c0: 6c74 5f70 726f 6a65 6374 0a20 2020 2020  lt_project.     
+000127d0: 2020 2029 0a20 2020 2020 2020 2070 6174     ).        pat
+000127e0: 6820 3d20 6622 7072 6f6a 6563 7473 2f7b  h = f"projects/{
+000127f0: 7072 6f6a 6563 747d 2f66 6561 7475 7265  project}/feature
+00012800: 2d73 6574 732f 7b6e 616d 657d 2f72 6566  -sets/{name}/ref
+00012810: 6572 656e 6365 732f 7b72 6566 6572 656e  erences/{referen
+00012820: 6365 7d22 0a20 2020 2020 2020 2065 7272  ce}".        err
+00012830: 6f72 5f6d 6573 7361 6765 203d 2066 2246  or_message = f"F
+00012840: 6169 6c65 6420 7374 6f72 696e 6720 6665  ailed storing fe
+00012850: 6174 7572 652d 7365 7420 7b70 726f 6a65  ature-set {proje
+00012860: 6374 7d2f 7b6e 616d 657d 220a 2020 2020  ct}/{name}".    
+00012870: 2020 2020 7265 7370 203d 2073 656c 662e      resp = self.
+00012880: 6170 695f 6361 6c6c 280a 2020 2020 2020  api_call(.      
+00012890: 2020 2020 2020 2250 5554 222c 2070 6174        "PUT", pat
+000128a0: 682c 2065 7272 6f72 5f6d 6573 7361 6765  h, error_message
+000128b0: 2c20 7061 7261 6d73 3d70 6172 616d 732c  , params=params,
+000128c0: 2062 6f64 793d 6469 6374 5f74 6f5f 6a73   body=dict_to_js
+000128d0: 6f6e 2866 6561 7475 7265 5f73 6574 290a  on(feature_set).
+000128e0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+000128f0: 2020 7265 7475 726e 2072 6573 702e 6a73    return resp.js
+00012900: 6f6e 2829 0a0a 2020 2020 6465 6620 7061  on()..    def pa
+00012910: 7463 685f 6665 6174 7572 655f 7365 7428  tch_feature_set(
+00012920: 0a20 2020 2020 2020 2073 656c 662c 0a20  .        self,. 
+00012930: 2020 2020 2020 206e 616d 652c 0a20 2020         name,.   
+00012940: 2020 2020 2066 6561 7475 7265 5f73 6574       feature_set
+00012950: 5f75 7064 6174 653a 2064 6963 742c 0a20  _update: dict,. 
+00012960: 2020 2020 2020 2070 726f 6a65 6374 3d22         project="
+00012970: 222c 0a20 2020 2020 2020 2074 6167 3d4e  ",.        tag=N
+00012980: 6f6e 652c 0a20 2020 2020 2020 2075 6964  one,.        uid
+00012990: 3d4e 6f6e 652c 0a20 2020 2020 2020 2070  =None,.        p
+000129a0: 6174 6368 5f6d 6f64 653a 2055 6e69 6f6e  atch_mode: Union
+000129b0: 5b73 7472 2c20 7363 6865 6d61 732e 5061  [str, schemas.Pa
+000129c0: 7463 684d 6f64 655d 203d 2073 6368 656d  tchMode] = schem
+000129d0: 6173 2e50 6174 6368 4d6f 6465 2e72 6570  as.PatchMode.rep
+000129e0: 6c61 6365 2c0a 2020 2020 293a 0a20 2020  lace,.    ):.   
+000129f0: 2020 2020 2022 2222 4d6f 6469 6679 2028       """Modify (
+00012a00: 7061 7463 6829 2061 6e20 6578 6973 7469  patch) an existi
+00012a10: 6e67 203a 7079 3a63 6c61 7373 3a60 7e6d  ng :py:class:`~m
+00012a20: 6c72 756e 2e66 6561 7475 7265 5f73 746f  lrun.feature_sto
+00012a30: 7265 2e46 6561 7475 7265 5365 7460 206f  re.FeatureSet` o
+00012a40: 626a 6563 742e 0a20 2020 2020 2020 2054  bject..        T
+00012a50: 6865 206f 626a 6563 7420 6973 2069 6465  he object is ide
+00012a60: 6e74 6966 6965 6420 6279 2069 7473 206e  ntified by its n
+00012a70: 616d 6520 2861 6e64 2070 726f 6a65 6374  ame (and project
+00012a80: 2069 7420 6265 6c6f 6e67 7320 746f 292c   it belongs to),
+00012a90: 2061 7320 7765 6c6c 2061 7320 6f70 7469   as well as opti
+00012aa0: 6f6e 616c 6c79 2061 2060 6074 6167 6060  onally a ``tag``
+00012ab0: 206f 7220 6974 730a 2020 2020 2020 2020   or its.        
+00012ac0: 6060 7569 6460 6020 2866 6f72 2076 6572  ``uid`` (for ver
+00012ad0: 7369 6f6e 6564 206f 626a 6563 7429 2e20  sioned object). 
+00012ae0: 4966 2062 6f74 6820 6060 7461 6760 6020  If both ``tag`` 
+00012af0: 616e 6420 6060 7569 6460 6020 6172 6520  and ``uid`` are 
+00012b00: 6f6d 6974 7465 6420 7468 656e 2074 6865  omitted then the
+00012b10: 206f 626a 6563 7420 7769 7468 2074 6167   object with tag
+00012b20: 2060 606c 6174 6573 7460 600a 2020 2020   ``latest``.    
+00012b30: 2020 2020 6973 206d 6f64 6966 6965 642e      is modified.
+00012b40: 0a0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
+00012b50: 206e 616d 653a 204e 616d 6520 6f66 2074   name: Name of t
+00012b60: 6865 206f 626a 6563 7420 746f 2070 6174  he object to pat
+00012b70: 6368 2e0a 2020 2020 2020 2020 3a70 6172  ch..        :par
+00012b80: 616d 2066 6561 7475 7265 5f73 6574 5f75  am feature_set_u
+00012b90: 7064 6174 653a 2054 6865 206d 6f64 6966  pdate: The modif
+00012ba0: 6963 6174 696f 6e73 206e 6565 6465 6420  ications needed 
+00012bb0: 696e 2074 6865 206f 626a 6563 742e 2054  in the object. T
+00012bc0: 6869 7320 7061 7261 6d65 7465 7220 6f6e  his parameter on
+00012bd0: 6c79 2068 6173 2074 6865 2063 6861 6e67  ly has the chang
+00012be0: 6573 2069 6e20 6974 2c0a 2020 2020 2020  es in it,.      
+00012bf0: 2020 2020 2020 6e6f 7420 6120 6675 6c6c        not a full
+00012c00: 206f 626a 6563 742e 0a20 2020 2020 2020   object..       
+00012c10: 2020 2020 2045 7861 6d70 6c65 3a3a 0a0a       Example::..
+00012c20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012c30: 6665 6174 7572 655f 7365 745f 7570 6461  feature_set_upda
+00012c40: 7465 203d 207b 2273 7461 7475 7322 3a20  te = {"status": 
+00012c50: 7b22 7072 6f63 6573 7365 6422 203a 2054  {"processed" : T
+00012c60: 7275 657d 7d0a 0a20 2020 2020 2020 2020  rue}}..         
+00012c70: 2020 2057 696c 6c20 6170 706c 7920 7468     Will apply th
+00012c80: 6520 6669 656c 6420 6060 7374 6174 7573  e field ``status
+00012c90: 2e70 726f 6365 7373 6564 6060 2074 6f20  .processed`` to 
+00012ca0: 7468 6520 6578 6973 7469 6e67 206f 626a  the existing obj
+00012cb0: 6563 742e 0a20 2020 2020 2020 203a 7061  ect..        :pa
+00012cc0: 7261 6d20 7072 6f6a 6563 743a 2050 726f  ram project: Pro
+00012cd0: 6a65 6374 2077 6869 6368 2063 6f6e 7461  ject which conta
+00012ce0: 696e 7320 7468 6520 6d6f 6469 6669 6564  ins the modified
+00012cf0: 206f 626a 6563 742e 0a20 2020 2020 2020   object..       
+00012d00: 203a 7061 7261 6d20 7461 673a 2054 6865   :param tag: The
+00012d10: 2074 6167 206f 6620 7468 6520 6f62 6a65   tag of the obje
+00012d20: 6374 2074 6f20 6d6f 6469 6679 2e0a 2020  ct to modify..  
+00012d30: 2020 2020 2020 3a70 6172 616d 2075 6964        :param uid
+00012d40: 3a20 7569 6420 6f66 2074 6865 206f 626a  : uid of the obj
+00012d50: 6563 7420 746f 206d 6f64 6966 792e 0a20  ect to modify.. 
+00012d60: 2020 2020 2020 203a 7061 7261 6d20 7061         :param pa
+00012d70: 7463 685f 6d6f 6465 3a20 5468 6520 7374  tch_mode: The st
+00012d80: 7261 7465 6779 2066 6f72 206d 6572 6769  rategy for mergi
+00012d90: 6e67 2074 6865 2063 6861 6e67 6573 2077  ng the changes w
+00012da0: 6974 6820 7468 6520 6578 6973 7469 6e67  ith the existing
+00012db0: 206f 626a 6563 742e 2043 616e 2062 6520   object. Can be 
+00012dc0: 6569 7468 6572 2060 6072 6570 6c61 6365  either ``replace
+00012dd0: 6060 0a20 2020 2020 2020 2020 2020 206f  ``.            o
+00012de0: 7220 6060 6164 6469 7469 7665 6060 2e0a  r ``additive``..
+00012df0: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+00012e00: 2020 2020 7072 6f6a 6563 7420 3d20 7072      project = pr
+00012e10: 6f6a 6563 7420 6f72 2063 6f6e 6669 672e  oject or config.
+00012e20: 6465 6661 756c 745f 7072 6f6a 6563 740a  default_project.
+00012e30: 2020 2020 2020 2020 7265 6665 7265 6e63          referenc
+00012e40: 6520 3d20 7365 6c66 2e5f 7265 736f 6c76  e = self._resolv
+00012e50: 655f 7265 6665 7265 6e63 6528 7461 672c  e_reference(tag,
+00012e60: 2075 6964 290a 2020 2020 2020 2020 6865   uid).        he
+00012e70: 6164 6572 7320 3d20 7b73 6368 656d 6173  aders = {schemas
+00012e80: 2e48 6561 6465 724e 616d 6573 2e70 6174  .HeaderNames.pat
+00012e90: 6368 5f6d 6f64 653a 2070 6174 6368 5f6d  ch_mode: patch_m
+00012ea0: 6f64 657d 0a20 2020 2020 2020 2070 6174  ode}.        pat
+00012eb0: 6820 3d20 6622 7072 6f6a 6563 7473 2f7b  h = f"projects/{
+00012ec0: 7072 6f6a 6563 747d 2f66 6561 7475 7265  project}/feature
+00012ed0: 2d73 6574 732f 7b6e 616d 657d 2f72 6566  -sets/{name}/ref
+00012ee0: 6572 656e 6365 732f 7b72 6566 6572 656e  erences/{referen
+00012ef0: 6365 7d22 0a20 2020 2020 2020 2065 7272  ce}".        err
+00012f00: 6f72 5f6d 6573 7361 6765 203d 2066 2246  or_message = f"F
+00012f10: 6169 6c65 6420 7570 6461 7469 6e67 2066  ailed updating f
+00012f20: 6561 7475 7265 2d73 6574 207b 7072 6f6a  eature-set {proj
+00012f30: 6563 747d 2f7b 6e61 6d65 7d22 0a20 2020  ect}/{name}".   
+00012f40: 2020 2020 2073 656c 662e 6170 695f 6361       self.api_ca
+00012f50: 6c6c 280a 2020 2020 2020 2020 2020 2020  ll(.            
+00012f60: 2250 4154 4348 222c 0a20 2020 2020 2020  "PATCH",.       
+00012f70: 2020 2020 2070 6174 682c 0a20 2020 2020       path,.     
+00012f80: 2020 2020 2020 2065 7272 6f72 5f6d 6573         error_mes
+00012f90: 7361 6765 2c0a 2020 2020 2020 2020 2020  sage,.          
+00012fa0: 2020 626f 6479 3d64 6963 745f 746f 5f6a    body=dict_to_j
+00012fb0: 736f 6e28 6665 6174 7572 655f 7365 745f  son(feature_set_
+00012fc0: 7570 6461 7465 292c 0a20 2020 2020 2020  update),.       
+00012fd0: 2020 2020 2068 6561 6465 7273 3d68 6561       headers=hea
+00012fe0: 6465 7273 2c0a 2020 2020 2020 2020 290a  ders,.        ).
+00012ff0: 0a20 2020 2064 6566 2064 656c 6574 655f  .    def delete_
+00013000: 6665 6174 7572 655f 7365 7428 7365 6c66  feature_set(self
+00013010: 2c20 6e61 6d65 2c20 7072 6f6a 6563 743d  , name, project=
+00013020: 2222 2c20 7461 673d 4e6f 6e65 2c20 7569  "", tag=None, ui
+00013030: 643d 4e6f 6e65 293a 0a20 2020 2020 2020  d=None):.       
+00013040: 2022 2222 4465 6c65 7465 2061 203a 7079   """Delete a :py
+00013050: 3a63 6c61 7373 3a60 7e6d 6c72 756e 2e66  :class:`~mlrun.f
+00013060: 6561 7475 7265 5f73 746f 7265 2e46 6561  eature_store.Fea
+00013070: 7475 7265 5365 7460 206f 626a 6563 7420  tureSet` object 
+00013080: 6672 6f6d 2074 6865 2044 422e 0a20 2020  from the DB..   
+00013090: 2020 2020 2049 6620 6060 7461 6760 6020       If ``tag`` 
+000130a0: 6f72 2060 6075 6964 6060 2061 7265 2073  or ``uid`` are s
+000130b0: 7065 6369 6669 6564 2c20 7468 656e 206a  pecified, then j
+000130c0: 7573 7420 7468 6520 7665 7273 696f 6e20  ust the version 
+000130d0: 7265 6665 7265 6e63 6564 2062 7920 7468  referenced by th
+000130e0: 656d 2077 696c 6c20 6265 2064 656c 6574  em will be delet
+000130f0: 6564 2e20 5573 696e 6720 626f 7468 0a20  ed. Using both. 
+00013100: 2020 2020 2020 2069 7320 6e6f 7420 616c         is not al
+00013110: 6c6f 7765 642e 0a20 2020 2020 2020 2049  lowed..        I
+00013120: 6620 6e6f 6e65 2061 7265 2073 7065 6369  f none are speci
+00013130: 6669 6564 2c20 7468 656e 2061 6c6c 2069  fied, then all i
+00013140: 6e73 7461 6e63 6573 206f 6620 7468 6520  nstances of the 
+00013150: 6f62 6a65 6374 2077 686f 7365 206e 616d  object whose nam
+00013160: 6520 6973 2060 606e 616d 6560 6020 7769  e is ``name`` wi
+00013170: 6c6c 2062 6520 6465 6c65 7465 642e 0a20  ll be deleted.. 
+00013180: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+00013190: 2020 2070 726f 6a65 6374 203d 2070 726f     project = pro
+000131a0: 6a65 6374 206f 7220 636f 6e66 6967 2e64  ject or config.d
+000131b0: 6566 6175 6c74 5f70 726f 6a65 6374 0a20  efault_project. 
+000131c0: 2020 2020 2020 2070 6174 6820 3d20 6622         path = f"
+000131d0: 7072 6f6a 6563 7473 2f7b 7072 6f6a 6563  projects/{projec
+000131e0: 747d 2f66 6561 7475 7265 2d73 6574 732f  t}/feature-sets/
+000131f0: 7b6e 616d 657d 220a 0a20 2020 2020 2020  {name}"..       
+00013200: 2069 6620 7461 6720 6f72 2075 6964 3a0a   if tag or uid:.
+00013210: 2020 2020 2020 2020 2020 2020 7265 6665              refe
+00013220: 7265 6e63 6520 3d20 7365 6c66 2e5f 7265  rence = self._re
+00013230: 736f 6c76 655f 7265 6665 7265 6e63 6528  solve_reference(
+00013240: 7461 672c 2075 6964 290a 2020 2020 2020  tag, uid).      
+00013250: 2020 2020 2020 7061 7468 203d 2070 6174        path = pat
+00013260: 6820 2b20 6622 2f72 6566 6572 656e 6365  h + f"/reference
+00013270: 732f 7b72 6566 6572 656e 6365 7d22 0a0a  s/{reference}"..
+00013280: 2020 2020 2020 2020 6572 726f 725f 6d65          error_me
+00013290: 7373 6167 6520 3d20 6622 4661 696c 6564  ssage = f"Failed
+000132a0: 2064 656c 6574 696e 6720 6665 6174 7572   deleting featur
+000132b0: 652d 7365 7420 7b6e 616d 657d 220a 2020  e-set {name}".  
+000132c0: 2020 2020 2020 7365 6c66 2e61 7069 5f63        self.api_c
+000132d0: 616c 6c28 2244 454c 4554 4522 2c20 7061  all("DELETE", pa
+000132e0: 7468 2c20 6572 726f 725f 6d65 7373 6167  th, error_messag
+000132f0: 6529 0a0a 2020 2020 6465 6620 6372 6561  e)..    def crea
+00013300: 7465 5f66 6561 7475 7265 5f76 6563 746f  te_feature_vecto
+00013310: 7228 0a20 2020 2020 2020 2073 656c 662c  r(.        self,
+00013320: 0a20 2020 2020 2020 2066 6561 7475 7265  .        feature
+00013330: 5f76 6563 746f 723a 2055 6e69 6f6e 5b64  _vector: Union[d
+00013340: 6963 742c 2073 6368 656d 6173 2e46 6561  ict, schemas.Fea
+00013350: 7475 7265 5665 6374 6f72 2c20 4665 6174  tureVector, Feat
+00013360: 7572 6556 6563 746f 725d 2c0a 2020 2020  ureVector],.    
+00013370: 2020 2020 7072 6f6a 6563 743d 2222 2c0a      project="",.
+00013380: 2020 2020 2020 2020 7665 7273 696f 6e65          versione
+00013390: 643d 5472 7565 2c0a 2020 2020 2920 2d3e  d=True,.    ) ->
+000133a0: 2064 6963 743a 0a20 2020 2020 2020 2022   dict:.        "
+000133b0: 2222 4372 6561 7465 2061 206e 6577 203a  ""Create a new :
+000133c0: 7079 3a63 6c61 7373 3a60 7e6d 6c72 756e  py:class:`~mlrun
+000133d0: 2e66 6561 7475 7265 5f73 746f 7265 2e46  .feature_store.F
+000133e0: 6561 7475 7265 5665 6374 6f72 6020 616e  eatureVector` an
+000133f0: 6420 7361 7665 2069 6e20 7468 6520 3a70  d save in the :p
+00013400: 793a 6d6f 643a 606d 6c72 756e 6020 4442  y:mod:`mlrun` DB
+00013410: 2e0a 0a20 2020 2020 2020 203a 7061 7261  ...        :para
+00013420: 6d20 6665 6174 7572 655f 7665 6374 6f72  m feature_vector
+00013430: 3a20 5468 6520 6e65 7720 3a70 793a 636c  : The new :py:cl
+00013440: 6173 733a 607e 6d6c 7275 6e2e 6665 6174  ass:`~mlrun.feat
+00013450: 7572 655f 7374 6f72 652e 4665 6174 7572  ure_store.Featur
+00013460: 6556 6563 746f 7260 2074 6f20 6372 6561  eVector` to crea
+00013470: 7465 2e0a 2020 2020 2020 2020 3a70 6172  te..        :par
+00013480: 616d 2070 726f 6a65 6374 3a20 4e61 6d65  am project: Name
+00013490: 206f 6620 7072 6f6a 6563 7420 7468 6973   of project this
+000134a0: 2066 6561 7475 7265 2d76 6563 746f 7220   feature-vector 
+000134b0: 6265 6c6f 6e67 7320 746f 2e0a 2020 2020  belongs to..    
+000134c0: 2020 2020 3a70 6172 616d 2076 6572 7369      :param versi
+000134d0: 6f6e 6564 3a20 5768 6574 6865 7220 746f  oned: Whether to
+000134e0: 206d 6169 6e74 6169 6e20 7665 7273 696f   maintain versio
+000134f0: 6e73 2066 6f72 2074 6869 7320 6665 6174  ns for this feat
+00013500: 7572 652d 7665 6374 6f72 2e20 416c 6c20  ure-vector. All 
+00013510: 7665 7273 696f 6e73 206f 6620 6120 7665  versions of a ve
+00013520: 7273 696f 6e65 6420 6f62 6a65 6374 0a20  rsioned object. 
+00013530: 2020 2020 2020 2020 2020 2077 696c 6c20             will 
+00013540: 6265 206b 6570 7420 696e 2074 6865 2044  be kept in the D
+00013550: 4220 616e 6420 6361 6e20 6265 2072 6574  B and can be ret
+00013560: 7269 6576 6564 2075 6e74 696c 2065 7870  rieved until exp
+00013570: 6c69 6369 746c 7920 6465 6c65 7465 642e  licitly deleted.
+00013580: 0a20 2020 2020 2020 203a 7265 7475 726e  .        :return
+00013590: 733a 2054 6865 203a 7079 3a63 6c61 7373  s: The :py:class
+000135a0: 3a60 7e6d 6c72 756e 2e66 6561 7475 7265  :`~mlrun.feature
+000135b0: 5f73 746f 7265 2e46 6561 7475 7265 5665  _store.FeatureVe
+000135c0: 6374 6f72 6020 6f62 6a65 6374 2028 6173  ctor` object (as
+000135d0: 2064 6963 7429 2e0a 2020 2020 2020 2020   dict)..        
+000135e0: 2222 220a 2020 2020 2020 2020 6966 2069  """.        if i
+000135f0: 7369 6e73 7461 6e63 6528 6665 6174 7572  sinstance(featur
+00013600: 655f 7665 6374 6f72 2c20 7363 6865 6d61  e_vector, schema
+00013610: 732e 4665 6174 7572 6556 6563 746f 7229  s.FeatureVector)
+00013620: 3a0a 2020 2020 2020 2020 2020 2020 6665  :.            fe
+00013630: 6174 7572 655f 7665 6374 6f72 203d 2066  ature_vector = f
+00013640: 6561 7475 7265 5f76 6563 746f 722e 6469  eature_vector.di
+00013650: 6374 2829 0a20 2020 2020 2020 2065 6c69  ct().        eli
+00013660: 6620 6973 696e 7374 616e 6365 2866 6561  f isinstance(fea
+00013670: 7475 7265 5f76 6563 746f 722c 2046 6561  ture_vector, Fea
+00013680: 7475 7265 5665 6374 6f72 293a 0a20 2020  tureVector):.   
+00013690: 2020 2020 2020 2020 2066 6561 7475 7265           feature
+000136a0: 5f76 6563 746f 7220 3d20 6665 6174 7572  _vector = featur
+000136b0: 655f 7665 6374 6f72 2e74 6f5f 6469 6374  e_vector.to_dict
+000136c0: 2829 0a0a 2020 2020 2020 2020 7072 6f6a  ()..        proj
+000136d0: 6563 7420 3d20 280a 2020 2020 2020 2020  ect = (.        
+000136e0: 2020 2020 7072 6f6a 6563 740a 2020 2020      project.    
+000136f0: 2020 2020 2020 2020 6f72 2066 6561 7475          or featu
+00013700: 7265 5f76 6563 746f 725b 226d 6574 6164  re_vector["metad
+00013710: 6174 6122 5d2e 6765 7428 2270 726f 6a65  ata"].get("proje
+00013720: 6374 222c 204e 6f6e 6529 0a20 2020 2020  ct", None).     
+00013730: 2020 2020 2020 206f 7220 636f 6e66 6967         or config
+00013740: 2e64 6566 6175 6c74 5f70 726f 6a65 6374  .default_project
+00013750: 0a20 2020 2020 2020 2029 0a20 2020 2020  .        ).     
+00013760: 2020 2070 6174 6820 3d20 6622 7072 6f6a     path = f"proj
+00013770: 6563 7473 2f7b 7072 6f6a 6563 747d 2f66  ects/{project}/f
+00013780: 6561 7475 7265 2d76 6563 746f 7273 220a  eature-vectors".
+00013790: 2020 2020 2020 2020 7061 7261 6d73 203d          params =
+000137a0: 207b 2276 6572 7369 6f6e 6564 223a 2076   {"versioned": v
+000137b0: 6572 7369 6f6e 6564 7d0a 0a20 2020 2020  ersioned}..     
+000137c0: 2020 206e 616d 6520 3d20 6665 6174 7572     name = featur
+000137d0: 655f 7665 6374 6f72 5b22 6d65 7461 6461  e_vector["metada
+000137e0: 7461 225d 5b22 6e61 6d65 225d 0a20 2020  ta"]["name"].   
+000137f0: 2020 2020 2065 7272 6f72 5f6d 6573 7361       error_messa
+00013800: 6765 203d 2066 2246 6169 6c65 6420 6372  ge = f"Failed cr
+00013810: 6561 7469 6e67 2066 6561 7475 7265 2d76  eating feature-v
+00013820: 6563 746f 7220 7b70 726f 6a65 6374 7d2f  ector {project}/
+00013830: 7b6e 616d 657d 220a 2020 2020 2020 2020  {name}".        
+00013840: 7265 7370 203d 2073 656c 662e 6170 695f  resp = self.api_
+00013850: 6361 6c6c 280a 2020 2020 2020 2020 2020  call(.          
+00013860: 2020 2250 4f53 5422 2c0a 2020 2020 2020    "POST",.      
+00013870: 2020 2020 2020 7061 7468 2c0a 2020 2020        path,.    
+00013880: 2020 2020 2020 2020 6572 726f 725f 6d65          error_me
+00013890: 7373 6167 652c 0a20 2020 2020 2020 2020  ssage,.         
+000138a0: 2020 2070 6172 616d 733d 7061 7261 6d73     params=params
+000138b0: 2c0a 2020 2020 2020 2020 2020 2020 626f  ,.            bo
+000138c0: 6479 3d64 6963 745f 746f 5f6a 736f 6e28  dy=dict_to_json(
+000138d0: 6665 6174 7572 655f 7665 6374 6f72 292c  feature_vector),
+000138e0: 0a20 2020 2020 2020 2029 0a20 2020 2020  .        ).     
+000138f0: 2020 2072 6574 7572 6e20 7265 7370 2e6a     return resp.j
+00013900: 736f 6e28 290a 0a20 2020 2064 6566 2067  son()..    def g
+00013910: 6574 5f66 6561 7475 7265 5f76 6563 746f  et_feature_vecto
+00013920: 7228 0a20 2020 2020 2020 2073 656c 662c  r(.        self,
+00013930: 206e 616d 653a 2073 7472 2c20 7072 6f6a   name: str, proj
+00013940: 6563 743a 2073 7472 203d 2022 222c 2074  ect: str = "", t
+00013950: 6167 3a20 7374 7220 3d20 4e6f 6e65 2c20  ag: str = None, 
+00013960: 7569 643a 2073 7472 203d 204e 6f6e 650a  uid: str = None.
+00013970: 2020 2020 2920 2d3e 2046 6561 7475 7265      ) -> Feature
+00013980: 5665 6374 6f72 3a0a 2020 2020 2020 2020  Vector:.        
+00013990: 2222 2252 6574 7572 6e20 6120 7370 6563  """Return a spec
+000139a0: 6966 6963 2066 6561 7475 7265 2d76 6563  ific feature-vec
+000139b0: 746f 7220 7265 6665 7265 6e63 6564 2062  tor referenced b
+000139c0: 7920 6974 7320 7461 6720 6f72 2075 6964  y its tag or uid
+000139d0: 2e20 4966 206e 6f6e 6520 6172 6520 7072  . If none are pr
+000139e0: 6f76 6964 6564 2c20 6060 6c61 7465 7374  ovided, ``latest
+000139f0: 6060 2074 6167 2077 696c 6c0a 2020 2020  `` tag will.    
+00013a00: 2020 2020 6265 2075 7365 642e 2222 220a      be used.""".
+00013a10: 0a20 2020 2020 2020 2070 726f 6a65 6374  .        project
+00013a20: 203d 2070 726f 6a65 6374 206f 7220 636f   = project or co
+00013a30: 6e66 6967 2e64 6566 6175 6c74 5f70 726f  nfig.default_pro
+00013a40: 6a65 6374 0a20 2020 2020 2020 2072 6566  ject.        ref
+00013a50: 6572 656e 6365 203d 2073 656c 662e 5f72  erence = self._r
+00013a60: 6573 6f6c 7665 5f72 6566 6572 656e 6365  esolve_reference
+00013a70: 2874 6167 2c20 7569 6429 0a20 2020 2020  (tag, uid).     
+00013a80: 2020 2070 6174 6820 3d20 6622 7072 6f6a     path = f"proj
+00013a90: 6563 7473 2f7b 7072 6f6a 6563 747d 2f66  ects/{project}/f
+00013aa0: 6561 7475 7265 2d76 6563 746f 7273 2f7b  eature-vectors/{
+00013ab0: 6e61 6d65 7d2f 7265 6665 7265 6e63 6573  name}/references
+00013ac0: 2f7b 7265 6665 7265 6e63 657d 220a 2020  /{reference}".  
+00013ad0: 2020 2020 2020 6572 726f 725f 6d65 7373        error_mess
+00013ae0: 6167 6520 3d20 6622 4661 696c 6564 2072  age = f"Failed r
+00013af0: 6574 7269 6576 696e 6720 6665 6174 7572  etrieving featur
+00013b00: 652d 7665 6374 6f72 207b 7072 6f6a 6563  e-vector {projec
+00013b10: 747d 2f7b 6e61 6d65 7d22 0a20 2020 2020  t}/{name}".     
+00013b20: 2020 2072 6573 7020 3d20 7365 6c66 2e61     resp = self.a
+00013b30: 7069 5f63 616c 6c28 2247 4554 222c 2070  pi_call("GET", p
+00013b40: 6174 682c 2065 7272 6f72 5f6d 6573 7361  ath, error_messa
+00013b50: 6765 290a 2020 2020 2020 2020 7265 7475  ge).        retu
+00013b60: 726e 2046 6561 7475 7265 5665 6374 6f72  rn FeatureVector
+00013b70: 2e66 726f 6d5f 6469 6374 2872 6573 702e  .from_dict(resp.
+00013b80: 6a73 6f6e 2829 290a 0a20 2020 2064 6566  json())..    def
+00013b90: 206c 6973 745f 6665 6174 7572 655f 7665   list_feature_ve
+00013ba0: 6374 6f72 7328 0a20 2020 2020 2020 2073  ctors(.        s
+00013bb0: 656c 662c 0a20 2020 2020 2020 2070 726f  elf,.        pro
+00013bc0: 6a65 6374 3a20 7374 7220 3d20 2222 2c0a  ject: str = "",.
+00013bd0: 2020 2020 2020 2020 6e61 6d65 3a20 7374          name: st
+00013be0: 7220 3d20 4e6f 6e65 2c0a 2020 2020 2020  r = None,.      
+00013bf0: 2020 7461 673a 2073 7472 203d 204e 6f6e    tag: str = Non
+00013c00: 652c 0a20 2020 2020 2020 2073 7461 7465  e,.        state
+00013c10: 3a20 7374 7220 3d20 4e6f 6e65 2c0a 2020  : str = None,.  
+00013c20: 2020 2020 2020 6c61 6265 6c73 3a20 4c69        labels: Li
+00013c30: 7374 5b73 7472 5d20 3d20 4e6f 6e65 2c0a  st[str] = None,.
+00013c40: 2020 2020 2020 2020 7061 7274 6974 696f          partitio
+00013c50: 6e5f 6279 3a20 556e 696f 6e5b 7363 6865  n_by: Union[sche
+00013c60: 6d61 732e 4665 6174 7572 6553 746f 7265  mas.FeatureStore
+00013c70: 5061 7274 6974 696f 6e42 7946 6965 6c64  PartitionByField
+00013c80: 2c20 7374 725d 203d 204e 6f6e 652c 0a20  , str] = None,. 
+00013c90: 2020 2020 2020 2072 6f77 735f 7065 725f         rows_per_
+00013ca0: 7061 7274 6974 696f 6e3a 2069 6e74 203d  partition: int =
+00013cb0: 2031 2c0a 2020 2020 2020 2020 7061 7274   1,.        part
+00013cc0: 6974 696f 6e5f 736f 7274 5f62 793a 2055  ition_sort_by: U
+00013cd0: 6e69 6f6e 5b73 6368 656d 6173 2e53 6f72  nion[schemas.Sor
+00013ce0: 7446 6965 6c64 2c20 7374 725d 203d 204e  tField, str] = N
+00013cf0: 6f6e 652c 0a20 2020 2020 2020 2070 6172  one,.        par
+00013d00: 7469 7469 6f6e 5f6f 7264 6572 3a20 556e  tition_order: Un
+00013d10: 696f 6e5b 7363 6865 6d61 732e 4f72 6465  ion[schemas.Orde
+00013d20: 7254 7970 652c 2073 7472 5d20 3d20 7363  rType, str] = sc
+00013d30: 6865 6d61 732e 4f72 6465 7254 7970 652e  hemas.OrderType.
+00013d40: 6465 7363 2c0a 2020 2020 2920 2d3e 204c  desc,.    ) -> L
+00013d50: 6973 745b 4665 6174 7572 6556 6563 746f  ist[FeatureVecto
+00013d60: 725d 3a0a 2020 2020 2020 2020 2222 2252  r]:.        """R
+00013d70: 6574 7269 6576 6520 6120 6c69 7374 206f  etrieve a list o
+00013d80: 6620 6665 6174 7572 652d 7665 6374 6f72  f feature-vector
+00013d90: 7320 6d61 7463 6869 6e67 2074 6865 2063  s matching the c
+00013da0: 7269 7465 7269 6120 7072 6f76 6964 6564  riteria provided
+00013db0: 2e0a 0a20 2020 2020 2020 203a 7061 7261  ...        :para
+00013dc0: 6d20 7072 6f6a 6563 743a 2050 726f 6a65  m project: Proje
+00013dd0: 6374 206e 616d 652e 0a20 2020 2020 2020  ct name..       
+00013de0: 203a 7061 7261 6d20 6e61 6d65 3a20 4e61   :param name: Na
+00013df0: 6d65 206f 6620 6665 6174 7572 652d 7665  me of feature-ve
+00013e00: 6374 6f72 2074 6f20 6d61 7463 682e 2054  ctor to match. T
+00013e10: 6869 7320 6973 2061 206c 696b 6520 7175  his is a like qu
+00013e20: 6572 792c 2061 6e64 2069 7320 6361 7365  ery, and is case
+00013e30: 2d69 6e73 656e 7369 7469 7665 2e0a 2020  -insensitive..  
+00013e40: 2020 2020 2020 3a70 6172 616d 2074 6167        :param tag
+00013e50: 3a20 4d61 7463 6820 6665 6174 7572 652d  : Match feature-
+00013e60: 7665 6374 6f72 7320 7769 7468 2073 7065  vectors with spe
+00013e70: 6369 6669 6320 7461 672e 0a20 2020 2020  cific tag..     
+00013e80: 2020 203a 7061 7261 6d20 7374 6174 653a     :param state:
+00013e90: 204d 6174 6368 2066 6561 7475 7265 2d76   Match feature-v
+00013ea0: 6563 746f 7273 2077 6974 6820 6120 7370  ectors with a sp
+00013eb0: 6563 6966 6963 2073 7461 7465 2e0a 2020  ecific state..  
+00013ec0: 2020 2020 2020 3a70 6172 616d 206c 6162        :param lab
+00013ed0: 656c 733a 204d 6174 6368 2066 6561 7475  els: Match featu
+00013ee0: 7265 2d76 6563 746f 7273 2077 6869 6368  re-vectors which
+00013ef0: 2068 6176 6520 7468 6573 6520 6c61 6265   have these labe
+00013f00: 6c73 2e0a 2020 2020 2020 2020 3a70 6172  ls..        :par
+00013f10: 616d 2070 6172 7469 7469 6f6e 5f62 793a  am partition_by:
+00013f20: 2046 6965 6c64 2074 6f20 6772 6f75 7020   Field to group 
+00013f30: 7265 7375 6c74 7320 6279 2e20 4f6e 6c79  results by. Only
+00013f40: 2061 6c6c 6f77 6564 2076 616c 7565 2069   allowed value i
+00013f50: 7320 606e 616d 6560 2e20 5768 656e 2060  s `name`. When `
+00013f60: 7061 7274 6974 696f 6e5f 6279 6020 6973  partition_by` is
+00013f70: 2073 7065 6369 6669 6564 2c0a 2020 2020   specified,.    
+00013f80: 2020 2020 2020 2020 7468 6520 6070 6172          the `par
+00013f90: 7469 7469 6f6e 5f73 6f72 745f 6279 6020  tition_sort_by` 
+00013fa0: 7061 7261 6d65 7465 7220 6d75 7374 2062  parameter must b
+00013fb0: 6520 7072 6f76 6964 6564 2061 7320 7765  e provided as we
+00013fc0: 6c6c 2e0a 2020 2020 2020 2020 3a70 6172  ll..        :par
+00013fd0: 616d 2072 6f77 735f 7065 725f 7061 7274  am rows_per_part
+00013fe0: 6974 696f 6e3a 2048 6f77 206d 616e 7920  ition: How many 
+00013ff0: 746f 7020 726f 7773 2028 7065 7220 736f  top rows (per so
+00014000: 7274 696e 6720 6465 6669 6e65 6420 6279  rting defined by
+00014010: 2060 7061 7274 6974 696f 6e5f 736f 7274   `partition_sort
+00014020: 5f62 7960 2061 6e64 2060 7061 7274 6974  _by` and `partit
+00014030: 696f 6e5f 6f72 6465 7260 290a 2020 2020  ion_order`).    
+00014040: 2020 2020 2020 2020 746f 2072 6574 7572          to retur
+00014050: 6e20 7065 7220 6772 6f75 702e 2044 6566  n per group. Def
+00014060: 6175 6c74 2076 616c 7565 2069 7320 312e  ault value is 1.
+00014070: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
+00014080: 7061 7274 6974 696f 6e5f 736f 7274 5f62  partition_sort_b
+00014090: 793a 2057 6861 7420 6669 656c 6420 746f  y: What field to
+000140a0: 2073 6f72 7420 7468 6520 7265 7375 6c74   sort the result
+000140b0: 7320 6279 2c20 7769 7468 696e 2065 6163  s by, within eac
+000140c0: 6820 7061 7274 6974 696f 6e20 6465 6669  h partition defi
+000140d0: 6e65 6420 6279 2060 7061 7274 6974 696f  ned by `partitio
+000140e0: 6e5f 6279 602e 0a20 2020 2020 2020 2020  n_by`..         
+000140f0: 2020 2043 7572 7265 6e74 6c79 2074 6865     Currently the
+00014100: 206f 6e6c 7920 616c 6c6f 7765 6420 7661   only allowed va
+00014110: 6c75 6573 2061 7265 2060 6372 6561 7465  lues are `create
+00014120: 6460 2061 6e64 2060 7570 6461 7465 6460  d` and `updated`
+00014130: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
+00014140: 2070 6172 7469 7469 6f6e 5f6f 7264 6572   partition_order
+00014150: 3a20 4f72 6465 7220 6f66 2073 6f72 7469  : Order of sorti
+00014160: 6e67 2077 6974 6869 6e20 7061 7274 6974  ng within partit
+00014170: 696f 6e73 202d 2060 6173 6360 206f 7220  ions - `asc` or 
+00014180: 6064 6573 6360 2e20 4465 6661 756c 7420  `desc`. Default 
+00014190: 6973 2060 6465 7363 602e 0a20 2020 2020  is `desc`..     
+000141a0: 2020 203a 7265 7475 726e 733a 204c 6973     :returns: Lis
+000141b0: 7420 6f66 206d 6174 6368 696e 6720 3a70  t of matching :p
+000141c0: 793a 636c 6173 733a 607e 6d6c 7275 6e2e  y:class:`~mlrun.
+000141d0: 6665 6174 7572 655f 7374 6f72 652e 4665  feature_store.Fe
+000141e0: 6174 7572 6556 6563 746f 7260 206f 626a  atureVector` obj
+000141f0: 6563 7473 2e0a 2020 2020 2020 2020 2222  ects..        ""
+00014200: 220a 0a20 2020 2020 2020 2070 726f 6a65  "..        proje
+00014210: 6374 203d 2070 726f 6a65 6374 206f 7220  ct = project or 
+00014220: 636f 6e66 6967 2e64 6566 6175 6c74 5f70  config.default_p
+00014230: 726f 6a65 6374 0a0a 2020 2020 2020 2020  roject..        
+00014240: 7061 7261 6d73 203d 207b 0a20 2020 2020  params = {.     
+00014250: 2020 2020 2020 2022 6e61 6d65 223a 206e         "name": n
+00014260: 616d 652c 0a20 2020 2020 2020 2020 2020  ame,.           
+00014270: 2022 7374 6174 6522 3a20 7374 6174 652c   "state": state,
+00014280: 0a20 2020 2020 2020 2020 2020 2022 7461  .            "ta
+00014290: 6722 3a20 7461 672c 0a20 2020 2020 2020  g": tag,.       
+000142a0: 2020 2020 2022 6c61 6265 6c22 3a20 6c61       "label": la
+000142b0: 6265 6c73 206f 7220 5b5d 2c0a 2020 2020  bels or [],.    
+000142c0: 2020 2020 7d0a 2020 2020 2020 2020 6966      }.        if
+000142d0: 2070 6172 7469 7469 6f6e 5f62 793a 0a20   partition_by:. 
+000142e0: 2020 2020 2020 2020 2020 2070 6172 616d             param
+000142f0: 732e 7570 6461 7465 280a 2020 2020 2020  s.update(.      
+00014300: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
+00014310: 6765 6e65 7261 7465 5f70 6172 7469 7469  generate_partiti
+00014320: 6f6e 5f62 795f 7061 7261 6d73 280a 2020  on_by_params(.  
+00014330: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014340: 2020 7363 6865 6d61 732e 4665 6174 7572    schemas.Featur
+00014350: 6553 746f 7265 5061 7274 6974 696f 6e42  eStorePartitionB
+00014360: 7946 6965 6c64 2c0a 2020 2020 2020 2020  yField,.        
+00014370: 2020 2020 2020 2020 2020 2020 7061 7274              part
+00014380: 6974 696f 6e5f 6279 2c0a 2020 2020 2020  ition_by,.      
+00014390: 2020 2020 2020 2020 2020 2020 2020 726f                ro
+000143a0: 7773 5f70 6572 5f70 6172 7469 7469 6f6e  ws_per_partition
+000143b0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+000143c0: 2020 2020 2020 7061 7274 6974 696f 6e5f        partition_
+000143d0: 736f 7274 5f62 792c 0a20 2020 2020 2020  sort_by,.       
+000143e0: 2020 2020 2020 2020 2020 2020 2070 6172               par
+000143f0: 7469 7469 6f6e 5f6f 7264 6572 2c0a 2020  tition_order,.  
+00014400: 2020 2020 2020 2020 2020 2020 2020 290a                ).
+00014410: 2020 2020 2020 2020 2020 2020 290a 0a20              ).. 
+00014420: 2020 2020 2020 2070 6174 6820 3d20 6622         path = f"
+00014430: 7072 6f6a 6563 7473 2f7b 7072 6f6a 6563  projects/{projec
+00014440: 747d 2f66 6561 7475 7265 2d76 6563 746f  t}/feature-vecto
+00014450: 7273 220a 0a20 2020 2020 2020 2065 7272  rs"..        err
+00014460: 6f72 5f6d 6573 7361 6765 203d 2028 0a20  or_message = (. 
+00014470: 2020 2020 2020 2020 2020 2066 2246 6169             f"Fai
+00014480: 6c65 6420 6c69 7374 696e 6720 6665 6174  led listing feat
+00014490: 7572 652d 7665 6374 6f72 732c 2070 726f  ure-vectors, pro
+000144a0: 6a65 6374 3a20 7b70 726f 6a65 6374 7d2c  ject: {project},
+000144b0: 2071 7565 7279 3a20 7b70 6172 616d 737d   query: {params}
+000144c0: 220a 2020 2020 2020 2020 290a 2020 2020  ".        ).    
+000144d0: 2020 2020 7265 7370 203d 2073 656c 662e      resp = self.
+000144e0: 6170 695f 6361 6c6c 2822 4745 5422 2c20  api_call("GET", 
+000144f0: 7061 7468 2c20 6572 726f 725f 6d65 7373  path, error_mess
+00014500: 6167 652c 2070 6172 616d 733d 7061 7261  age, params=para
+00014510: 6d73 290a 2020 2020 2020 2020 6665 6174  ms).        feat
+00014520: 7572 655f 7665 6374 6f72 7320 3d20 7265  ure_vectors = re
+00014530: 7370 2e6a 736f 6e28 295b 2266 6561 7475  sp.json()["featu
+00014540: 7265 5f76 6563 746f 7273 225d 0a20 2020  re_vectors"].   
+00014550: 2020 2020 2069 6620 6665 6174 7572 655f       if feature_
+00014560: 7665 6374 6f72 733a 0a20 2020 2020 2020  vectors:.       
+00014570: 2020 2020 2072 6574 7572 6e20 5b46 6561       return [Fea
+00014580: 7475 7265 5665 6374 6f72 2e66 726f 6d5f  tureVector.from_
+00014590: 6469 6374 286f 626a 2920 666f 7220 6f62  dict(obj) for ob
+000145a0: 6a20 696e 2066 6561 7475 7265 5f76 6563  j in feature_vec
+000145b0: 746f 7273 5d0a 0a20 2020 2064 6566 2073  tors]..    def s
+000145c0: 746f 7265 5f66 6561 7475 7265 5f76 6563  tore_feature_vec
+000145d0: 746f 7228 0a20 2020 2020 2020 2073 656c  tor(.        sel
+000145e0: 662c 0a20 2020 2020 2020 2066 6561 7475  f,.        featu
+000145f0: 7265 5f76 6563 746f 723a 2055 6e69 6f6e  re_vector: Union
+00014600: 5b64 6963 742c 2073 6368 656d 6173 2e46  [dict, schemas.F
+00014610: 6561 7475 7265 5665 6374 6f72 2c20 4665  eatureVector, Fe
+00014620: 6174 7572 6556 6563 746f 725d 2c0a 2020  atureVector],.  
+00014630: 2020 2020 2020 6e61 6d65 3d4e 6f6e 652c        name=None,
+00014640: 0a20 2020 2020 2020 2070 726f 6a65 6374  .        project
+00014650: 3d22 222c 0a20 2020 2020 2020 2074 6167  ="",.        tag
+00014660: 3d4e 6f6e 652c 0a20 2020 2020 2020 2075  =None,.        u
+00014670: 6964 3d4e 6f6e 652c 0a20 2020 2020 2020  id=None,.       
+00014680: 2076 6572 7369 6f6e 6564 3d54 7275 652c   versioned=True,
+00014690: 0a20 2020 2029 202d 3e20 6469 6374 3a0a  .    ) -> dict:.
+000146a0: 2020 2020 2020 2020 2222 2253 746f 7265          """Store
+000146b0: 2061 203a 7079 3a63 6c61 7373 3a60 7e6d   a :py:class:`~m
+000146c0: 6c72 756e 2e66 6561 7475 7265 5f73 746f  lrun.feature_sto
+000146d0: 7265 2e46 6561 7475 7265 5665 6374 6f72  re.FeatureVector
+000146e0: 6020 6f62 6a65 6374 2069 6e20 7468 6520  ` object in the 
+000146f0: 3a70 793a 6d6f 643a 606d 6c72 756e 6020  :py:mod:`mlrun` 
+00014700: 4442 2e20 5468 650a 2020 2020 2020 2020  DB. The.        
+00014710: 6665 6174 7572 652d 7665 6374 6f72 2063  feature-vector c
+00014720: 616e 2062 6520 6569 7468 6572 2061 206e  an be either a n
+00014730: 6577 206f 626a 6563 7420 6f72 2061 206d  ew object or a m
+00014740: 6f64 6966 6963 6174 696f 6e20 746f 2065  odification to e
+00014750: 7869 7374 696e 6720 6f62 6a65 6374 2072  xisting object r
+00014760: 6566 6572 656e 6365 6420 6279 2074 6865  eferenced by the
+00014770: 2070 6172 616d 730a 2020 2020 2020 2020   params.        
+00014780: 6f66 2074 6865 2066 756e 6374 696f 6e2e  of the function.
+00014790: 0a0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
+000147a0: 2066 6561 7475 7265 5f76 6563 746f 723a   feature_vector:
+000147b0: 2054 6865 203a 7079 3a63 6c61 7373 3a60   The :py:class:`
+000147c0: 7e6d 6c72 756e 2e66 6561 7475 7265 5f73  ~mlrun.feature_s
+000147d0: 746f 7265 2e46 6561 7475 7265 5665 6374  tore.FeatureVect
+000147e0: 6f72 6020 746f 2073 746f 7265 2e0a 2020  or` to store..  
+000147f0: 2020 2020 2020 3a70 6172 616d 206e 616d        :param nam
+00014800: 653a 2020 2020 4e61 6d65 206f 6620 6665  e:    Name of fe
+00014810: 6174 7572 6520 7665 6374 6f72 2e0a 2020  ature vector..  
+00014820: 2020 2020 2020 3a70 6172 616d 2070 726f        :param pro
+00014830: 6a65 6374 3a20 4e61 6d65 206f 6620 7072  ject: Name of pr
+00014840: 6f6a 6563 7420 7468 6973 2066 6561 7475  oject this featu
+00014850: 7265 2d76 6563 746f 7220 6265 6c6f 6e67  re-vector belong
+00014860: 7320 746f 2e0a 2020 2020 2020 2020 3a70  s to..        :p
+00014870: 6172 616d 2074 6167 3a20 5468 6520 6060  aram tag: The ``
+00014880: 7461 6760 6020 6f66 2074 6865 206f 626a  tag`` of the obj
+00014890: 6563 7420 746f 2072 6570 6c61 6365 2069  ect to replace i
+000148a0: 6e20 7468 6520 4442 2c20 666f 7220 6578  n the DB, for ex
+000148b0: 616d 706c 6520 6060 6c61 7465 7374 6060  ample ``latest``
+000148c0: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
+000148d0: 2075 6964 3a20 5468 6520 6060 7569 6460   uid: The ``uid`
+000148e0: 6020 6f66 2074 6865 206f 626a 6563 7420  ` of the object 
+000148f0: 746f 2072 6570 6c61 6365 2069 6e20 7468  to replace in th
+00014900: 6520 4442 2e20 4966 2075 7369 6e67 2074  e DB. If using t
+00014910: 6869 7320 7061 7261 6d65 7465 722c 2074  his parameter, t
+00014920: 6865 206d 6f64 6966 6965 6420 6f62 6a65  he modified obje
+00014930: 6374 0a20 2020 2020 2020 2020 2020 206d  ct.            m
+00014940: 7573 7420 6861 7665 2074 6865 2073 616d  ust have the sam
+00014950: 6520 6060 7569 6460 6020 6f66 2074 6865  e ``uid`` of the
+00014960: 2070 7265 7669 6f75 736c 792d 6578 6973   previously-exis
+00014970: 7469 6e67 206f 626a 6563 742e 2054 6869  ting object. Thi
+00014980: 7320 6361 6e6e 6f74 2062 6520 7573 6564  s cannot be used
+00014990: 2066 6f72 206e 6f6e 2d76 6572 7369 6f6e   for non-version
+000149a0: 6564 206f 626a 6563 7473 2e0a 2020 2020  ed objects..    
+000149b0: 2020 2020 3a70 6172 616d 2076 6572 7369      :param versi
+000149c0: 6f6e 6564 3a20 5768 6574 6865 7220 746f  oned: Whether to
+000149d0: 206d 6169 6e74 6169 6e20 7665 7273 696f   maintain versio
+000149e0: 6e73 2066 6f72 2074 6869 7320 6665 6174  ns for this feat
+000149f0: 7572 652d 7665 6374 6f72 2e20 416c 6c20  ure-vector. All 
+00014a00: 7665 7273 696f 6e73 206f 6620 6120 7665  versions of a ve
+00014a10: 7273 696f 6e65 6420 6f62 6a65 6374 0a20  rsioned object. 
+00014a20: 2020 2020 2020 2020 2020 2077 696c 6c20             will 
+00014a30: 6265 206b 6570 7420 696e 2074 6865 2044  be kept in the D
+00014a40: 4220 616e 6420 6361 6e20 6265 2072 6574  B and can be ret
+00014a50: 7269 6576 6564 2075 6e74 696c 2065 7870  rieved until exp
+00014a60: 6c69 6369 746c 7920 6465 6c65 7465 642e  licitly deleted.
+00014a70: 0a20 2020 2020 2020 203a 7265 7475 726e  .        :return
+00014a80: 733a 2054 6865 203a 7079 3a63 6c61 7373  s: The :py:class
+00014a90: 3a60 7e6d 6c72 756e 2e66 6561 7475 7265  :`~mlrun.feature
+00014aa0: 5f73 746f 7265 2e46 6561 7475 7265 5665  _store.FeatureVe
+00014ab0: 6374 6f72 6020 6f62 6a65 6374 2028 6173  ctor` object (as
+00014ac0: 2064 6963 7429 2e0a 2020 2020 2020 2020   dict)..        
+00014ad0: 2222 220a 0a20 2020 2020 2020 2072 6566  """..        ref
+00014ae0: 6572 656e 6365 203d 2073 656c 662e 5f72  erence = self._r
+00014af0: 6573 6f6c 7665 5f72 6566 6572 656e 6365  esolve_reference
+00014b00: 2874 6167 2c20 7569 6429 0a20 2020 2020  (tag, uid).     
+00014b10: 2020 2070 6172 616d 7320 3d20 7b22 7665     params = {"ve
+00014b20: 7273 696f 6e65 6422 3a20 7665 7273 696f  rsioned": versio
+00014b30: 6e65 647d 0a0a 2020 2020 2020 2020 6966  ned}..        if
+00014b40: 2069 7369 6e73 7461 6e63 6528 6665 6174   isinstance(feat
+00014b50: 7572 655f 7665 6374 6f72 2c20 7363 6865  ure_vector, sche
+00014b60: 6d61 732e 4665 6174 7572 6556 6563 746f  mas.FeatureVecto
+00014b70: 7229 3a0a 2020 2020 2020 2020 2020 2020  r):.            
+00014b80: 6665 6174 7572 655f 7665 6374 6f72 203d  feature_vector =
+00014b90: 2066 6561 7475 7265 5f76 6563 746f 722e   feature_vector.
+00014ba0: 6469 6374 2829 0a20 2020 2020 2020 2065  dict().        e
+00014bb0: 6c69 6620 6973 696e 7374 616e 6365 2866  lif isinstance(f
+00014bc0: 6561 7475 7265 5f76 6563 746f 722c 2046  eature_vector, F
+00014bd0: 6561 7475 7265 5665 6374 6f72 293a 0a20  eatureVector):. 
+00014be0: 2020 2020 2020 2020 2020 2066 6561 7475             featu
+00014bf0: 7265 5f76 6563 746f 7220 3d20 6665 6174  re_vector = feat
+00014c00: 7572 655f 7665 6374 6f72 2e74 6f5f 6469  ure_vector.to_di
+00014c10: 6374 2829 0a0a 2020 2020 2020 2020 6e61  ct()..        na
+00014c20: 6d65 203d 206e 616d 6520 6f72 2066 6561  me = name or fea
+00014c30: 7475 7265 5f76 6563 746f 725b 226d 6574  ture_vector["met
+00014c40: 6164 6174 6122 5d5b 226e 616d 6522 5d0a  adata"]["name"].
+00014c50: 2020 2020 2020 2020 7072 6f6a 6563 7420          project 
+00014c60: 3d20 280a 2020 2020 2020 2020 2020 2020  = (.            
+00014c70: 7072 6f6a 6563 740a 2020 2020 2020 2020  project.        
+00014c80: 2020 2020 6f72 2066 6561 7475 7265 5f76      or feature_v
+00014c90: 6563 746f 725b 226d 6574 6164 6174 6122  ector["metadata"
+00014ca0: 5d2e 6765 7428 2270 726f 6a65 6374 2229  ].get("project")
+00014cb0: 0a20 2020 2020 2020 2020 2020 206f 7220  .            or 
+00014cc0: 636f 6e66 6967 2e64 6566 6175 6c74 5f70  config.default_p
+00014cd0: 726f 6a65 6374 0a20 2020 2020 2020 2029  roject.        )
+00014ce0: 0a20 2020 2020 2020 2070 6174 6820 3d20  .        path = 
+00014cf0: 6622 7072 6f6a 6563 7473 2f7b 7072 6f6a  f"projects/{proj
+00014d00: 6563 747d 2f66 6561 7475 7265 2d76 6563  ect}/feature-vec
+00014d10: 746f 7273 2f7b 6e61 6d65 7d2f 7265 6665  tors/{name}/refe
+00014d20: 7265 6e63 6573 2f7b 7265 6665 7265 6e63  rences/{referenc
+00014d30: 657d 220a 2020 2020 2020 2020 6572 726f  e}".        erro
+00014d40: 725f 6d65 7373 6167 6520 3d20 6622 4661  r_message = f"Fa
+00014d50: 696c 6564 2073 746f 7269 6e67 2066 6561  iled storing fea
+00014d60: 7475 7265 2d76 6563 746f 7220 7b70 726f  ture-vector {pro
+00014d70: 6a65 6374 7d2f 7b6e 616d 657d 220a 2020  ject}/{name}".  
+00014d80: 2020 2020 2020 7265 7370 203d 2073 656c        resp = sel
+00014d90: 662e 6170 695f 6361 6c6c 280a 2020 2020  f.api_call(.    
+00014da0: 2020 2020 2020 2020 2250 5554 222c 2070          "PUT", p
+00014db0: 6174 682c 2065 7272 6f72 5f6d 6573 7361  ath, error_messa
+00014dc0: 6765 2c20 7061 7261 6d73 3d70 6172 616d  ge, params=param
+00014dd0: 732c 2062 6f64 793d 6469 6374 5f74 6f5f  s, body=dict_to_
+00014de0: 6a73 6f6e 2866 6561 7475 7265 5f76 6563  json(feature_vec
+00014df0: 746f 7229 0a20 2020 2020 2020 2029 0a20  tor).        ). 
+00014e00: 2020 2020 2020 2072 6574 7572 6e20 7265         return re
+00014e10: 7370 2e6a 736f 6e28 290a 0a20 2020 2064  sp.json()..    d
+00014e20: 6566 2070 6174 6368 5f66 6561 7475 7265  ef patch_feature
+00014e30: 5f76 6563 746f 7228 0a20 2020 2020 2020  _vector(.       
+00014e40: 2073 656c 662c 0a20 2020 2020 2020 206e   self,.        n
+00014e50: 616d 652c 0a20 2020 2020 2020 2066 6561  ame,.        fea
+00014e60: 7475 7265 5f76 6563 746f 725f 7570 6461  ture_vector_upda
+00014e70: 7465 3a20 6469 6374 2c0a 2020 2020 2020  te: dict,.      
+00014e80: 2020 7072 6f6a 6563 743d 2222 2c0a 2020    project="",.  
+00014e90: 2020 2020 2020 7461 673d 4e6f 6e65 2c0a        tag=None,.
+00014ea0: 2020 2020 2020 2020 7569 643d 4e6f 6e65          uid=None
+00014eb0: 2c0a 2020 2020 2020 2020 7061 7463 685f  ,.        patch_
+00014ec0: 6d6f 6465 3a20 556e 696f 6e5b 7374 722c  mode: Union[str,
+00014ed0: 2073 6368 656d 6173 2e50 6174 6368 4d6f   schemas.PatchMo
+00014ee0: 6465 5d20 3d20 7363 6865 6d61 732e 5061  de] = schemas.Pa
+00014ef0: 7463 684d 6f64 652e 7265 706c 6163 652c  tchMode.replace,
+00014f00: 0a20 2020 2029 3a0a 2020 2020 2020 2020  .    ):.        
+00014f10: 2222 224d 6f64 6966 7920 2870 6174 6368  """Modify (patch
+00014f20: 2920 616e 2065 7869 7374 696e 6720 3a70  ) an existing :p
+00014f30: 793a 636c 6173 733a 607e 6d6c 7275 6e2e  y:class:`~mlrun.
+00014f40: 6665 6174 7572 655f 7374 6f72 652e 4665  feature_store.Fe
+00014f50: 6174 7572 6556 6563 746f 7260 206f 626a  atureVector` obj
+00014f60: 6563 742e 0a20 2020 2020 2020 2054 6865  ect..        The
+00014f70: 206f 626a 6563 7420 6973 2069 6465 6e74   object is ident
+00014f80: 6966 6965 6420 6279 2069 7473 206e 616d  ified by its nam
+00014f90: 6520 2861 6e64 2070 726f 6a65 6374 2069  e (and project i
+00014fa0: 7420 6265 6c6f 6e67 7320 746f 292c 2061  t belongs to), a
+00014fb0: 7320 7765 6c6c 2061 7320 6f70 7469 6f6e  s well as option
+00014fc0: 616c 6c79 2061 2060 6074 6167 6060 206f  ally a ``tag`` o
+00014fd0: 7220 6974 730a 2020 2020 2020 2020 6060  r its.        ``
+00014fe0: 7569 6460 6020 2866 6f72 2076 6572 7369  uid`` (for versi
+00014ff0: 6f6e 6564 206f 626a 6563 7429 2e20 4966  oned object). If
+00015000: 2062 6f74 6820 6060 7461 6760 6020 616e   both ``tag`` an
+00015010: 6420 6060 7569 6460 6020 6172 6520 6f6d  d ``uid`` are om
+00015020: 6974 7465 6420 7468 656e 2074 6865 206f  itted then the o
+00015030: 626a 6563 7420 7769 7468 2074 6167 2060  bject with tag `
+00015040: 606c 6174 6573 7460 600a 2020 2020 2020  `latest``.      
+00015050: 2020 6973 206d 6f64 6966 6965 642e 0a0a    is modified...
+00015060: 2020 2020 2020 2020 3a70 6172 616d 206e          :param n
+00015070: 616d 653a 204e 616d 6520 6f66 2074 6865  ame: Name of the
+00015080: 206f 626a 6563 7420 746f 2070 6174 6368   object to patch
+00015090: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
+000150a0: 2066 6561 7475 7265 5f76 6563 746f 725f   feature_vector_
+000150b0: 7570 6461 7465 3a20 5468 6520 6d6f 6469  update: The modi
+000150c0: 6669 6361 7469 6f6e 7320 6e65 6564 6564  fications needed
+000150d0: 2069 6e20 7468 6520 6f62 6a65 6374 2e20   in the object. 
+000150e0: 5468 6973 2070 6172 616d 6574 6572 206f  This parameter o
+000150f0: 6e6c 7920 6861 7320 7468 6520 6368 616e  nly has the chan
+00015100: 6765 7320 696e 2069 742c 0a20 2020 2020  ges in it,.     
+00015110: 2020 2020 2020 206e 6f74 2061 2066 756c         not a ful
+00015120: 6c20 6f62 6a65 6374 2e0a 2020 2020 2020  l object..      
+00015130: 2020 3a70 6172 616d 2070 726f 6a65 6374    :param project
+00015140: 3a20 5072 6f6a 6563 7420 7768 6963 6820  : Project which 
+00015150: 636f 6e74 6169 6e73 2074 6865 206d 6f64  contains the mod
+00015160: 6966 6965 6420 6f62 6a65 6374 2e0a 2020  ified object..  
+00015170: 2020 2020 2020 3a70 6172 616d 2074 6167        :param tag
+00015180: 3a20 5468 6520 7461 6720 6f66 2074 6865  : The tag of the
+00015190: 206f 626a 6563 7420 746f 206d 6f64 6966   object to modif
+000151a0: 792e 0a20 2020 2020 2020 203a 7061 7261  y..        :para
+000151b0: 6d20 7569 643a 2075 6964 206f 6620 7468  m uid: uid of th
+000151c0: 6520 6f62 6a65 6374 2074 6f20 6d6f 6469  e object to modi
+000151d0: 6679 2e0a 2020 2020 2020 2020 3a70 6172  fy..        :par
+000151e0: 616d 2070 6174 6368 5f6d 6f64 653a 2054  am patch_mode: T
+000151f0: 6865 2073 7472 6174 6567 7920 666f 7220  he strategy for 
+00015200: 6d65 7267 696e 6720 7468 6520 6368 616e  merging the chan
+00015210: 6765 7320 7769 7468 2074 6865 2065 7869  ges with the exi
+00015220: 7374 696e 6720 6f62 6a65 6374 2e20 4361  sting object. Ca
+00015230: 6e20 6265 2065 6974 6865 7220 6060 7265  n be either ``re
+00015240: 706c 6163 6560 600a 2020 2020 2020 2020  place``.        
+00015250: 2020 2020 6f72 2060 6061 6464 6974 6976      or ``additiv
+00015260: 6560 602e 0a20 2020 2020 2020 2022 2222  e``..        """
+00015270: 0a20 2020 2020 2020 2072 6566 6572 656e  .        referen
+00015280: 6365 203d 2073 656c 662e 5f72 6573 6f6c  ce = self._resol
+00015290: 7665 5f72 6566 6572 656e 6365 2874 6167  ve_reference(tag
+000152a0: 2c20 7569 6429 0a20 2020 2020 2020 2070  , uid).        p
+000152b0: 726f 6a65 6374 203d 2070 726f 6a65 6374  roject = project
+000152c0: 206f 7220 636f 6e66 6967 2e64 6566 6175   or config.defau
+000152d0: 6c74 5f70 726f 6a65 6374 0a20 2020 2020  lt_project.     
+000152e0: 2020 2068 6561 6465 7273 203d 207b 7363     headers = {sc
+000152f0: 6865 6d61 732e 4865 6164 6572 4e61 6d65  hemas.HeaderName
+00015300: 732e 7061 7463 685f 6d6f 6465 3a20 7061  s.patch_mode: pa
+00015310: 7463 685f 6d6f 6465 7d0a 2020 2020 2020  tch_mode}.      
+00015320: 2020 7061 7468 203d 2066 2270 726f 6a65    path = f"proje
+00015330: 6374 732f 7b70 726f 6a65 6374 7d2f 6665  cts/{project}/fe
+00015340: 6174 7572 652d 7665 6374 6f72 732f 7b6e  ature-vectors/{n
+00015350: 616d 657d 2f72 6566 6572 656e 6365 732f  ame}/references/
+00015360: 7b72 6566 6572 656e 6365 7d22 0a20 2020  {reference}".   
+00015370: 2020 2020 2065 7272 6f72 5f6d 6573 7361       error_messa
+00015380: 6765 203d 2066 2246 6169 6c65 6420 7570  ge = f"Failed up
+00015390: 6461 7469 6e67 2066 6561 7475 7265 2d76  dating feature-v
+000153a0: 6563 746f 7220 7b70 726f 6a65 6374 7d2f  ector {project}/
+000153b0: 7b6e 616d 657d 220a 2020 2020 2020 2020  {name}".        
+000153c0: 7365 6c66 2e61 7069 5f63 616c 6c28 0a20  self.api_call(. 
+000153d0: 2020 2020 2020 2020 2020 2022 5041 5443             "PATC
+000153e0: 4822 2c0a 2020 2020 2020 2020 2020 2020  H",.            
+000153f0: 7061 7468 2c0a 2020 2020 2020 2020 2020  path,.          
+00015400: 2020 6572 726f 725f 6d65 7373 6167 652c    error_message,
+00015410: 0a20 2020 2020 2020 2020 2020 2062 6f64  .            bod
+00015420: 793d 6469 6374 5f74 6f5f 6a73 6f6e 2866  y=dict_to_json(f
+00015430: 6561 7475 7265 5f76 6563 746f 725f 7570  eature_vector_up
+00015440: 6461 7465 292c 0a20 2020 2020 2020 2020  date),.         
+00015450: 2020 2068 6561 6465 7273 3d68 6561 6465     headers=heade
+00015460: 7273 2c0a 2020 2020 2020 2020 290a 0a20  rs,.        ).. 
+00015470: 2020 2064 6566 2064 656c 6574 655f 6665     def delete_fe
+00015480: 6174 7572 655f 7665 6374 6f72 2873 656c  ature_vector(sel
+00015490: 662c 206e 616d 652c 2070 726f 6a65 6374  f, name, project
+000154a0: 3d22 222c 2074 6167 3d4e 6f6e 652c 2075  ="", tag=None, u
+000154b0: 6964 3d4e 6f6e 6529 3a0a 2020 2020 2020  id=None):.      
+000154c0: 2020 2222 2244 656c 6574 6520 6120 3a70    """Delete a :p
+000154d0: 793a 636c 6173 733a 607e 6d6c 7275 6e2e  y:class:`~mlrun.
+000154e0: 6665 6174 7572 655f 7374 6f72 652e 4665  feature_store.Fe
+000154f0: 6174 7572 6556 6563 746f 7260 206f 626a  atureVector` obj
+00015500: 6563 7420 6672 6f6d 2074 6865 2044 422e  ect from the DB.
+00015510: 0a20 2020 2020 2020 2049 6620 6060 7461  .        If ``ta
+00015520: 6760 6020 6f72 2060 6075 6964 6060 2061  g`` or ``uid`` a
+00015530: 7265 2073 7065 6369 6669 6564 2c20 7468  re specified, th
+00015540: 656e 206a 7573 7420 7468 6520 7665 7273  en just the vers
+00015550: 696f 6e20 7265 6665 7265 6e63 6564 2062  ion referenced b
+00015560: 7920 7468 656d 2077 696c 6c20 6265 2064  y them will be d
+00015570: 656c 6574 6564 2e20 5573 696e 6720 626f  eleted. Using bo
+00015580: 7468 0a20 2020 2020 2020 2069 7320 6e6f  th.        is no
+00015590: 7420 616c 6c6f 7765 642e 0a20 2020 2020  t allowed..     
+000155a0: 2020 2049 6620 6e6f 6e65 2061 7265 2073     If none are s
+000155b0: 7065 6369 6669 6564 2c20 7468 656e 2061  pecified, then a
+000155c0: 6c6c 2069 6e73 7461 6e63 6573 206f 6620  ll instances of 
+000155d0: 7468 6520 6f62 6a65 6374 2077 686f 7365  the object whose
+000155e0: 206e 616d 6520 6973 2060 606e 616d 6560   name is ``name`
+000155f0: 6020 7769 6c6c 2062 6520 6465 6c65 7465  ` will be delete
+00015600: 642e 0a20 2020 2020 2020 2022 2222 0a20  d..        """. 
+00015610: 2020 2020 2020 2070 726f 6a65 6374 203d         project =
+00015620: 2070 726f 6a65 6374 206f 7220 636f 6e66   project or conf
+00015630: 6967 2e64 6566 6175 6c74 5f70 726f 6a65  ig.default_proje
+00015640: 6374 0a20 2020 2020 2020 2070 6174 6820  ct.        path 
+00015650: 3d20 6622 7072 6f6a 6563 7473 2f7b 7072  = f"projects/{pr
+00015660: 6f6a 6563 747d 2f66 6561 7475 7265 2d76  oject}/feature-v
+00015670: 6563 746f 7273 2f7b 6e61 6d65 7d22 0a20  ectors/{name}". 
+00015680: 2020 2020 2020 2069 6620 7461 6720 6f72         if tag or
+00015690: 2075 6964 3a0a 2020 2020 2020 2020 2020   uid:.          
+000156a0: 2020 7265 6665 7265 6e63 6520 3d20 7365    reference = se
+000156b0: 6c66 2e5f 7265 736f 6c76 655f 7265 6665  lf._resolve_refe
+000156c0: 7265 6e63 6528 7461 672c 2075 6964 290a  rence(tag, uid).
+000156d0: 2020 2020 2020 2020 2020 2020 7061 7468              path
+000156e0: 203d 2070 6174 6820 2b20 6622 2f72 6566   = path + f"/ref
+000156f0: 6572 656e 6365 732f 7b72 6566 6572 656e  erences/{referen
+00015700: 6365 7d22 0a0a 2020 2020 2020 2020 6572  ce}"..        er
+00015710: 726f 725f 6d65 7373 6167 6520 3d20 6622  ror_message = f"
+00015720: 4661 696c 6564 2064 656c 6574 696e 6720  Failed deleting 
+00015730: 6665 6174 7572 652d 7665 6374 6f72 207b  feature-vector {
+00015740: 6e61 6d65 7d22 0a20 2020 2020 2020 2073  name}".        s
+00015750: 656c 662e 6170 695f 6361 6c6c 2822 4445  elf.api_call("DE
+00015760: 4c45 5445 222c 2070 6174 682c 2065 7272  LETE", path, err
+00015770: 6f72 5f6d 6573 7361 6765 290a 0a20 2020  or_message)..   
+00015780: 2064 6566 2074 6167 5f6f 626a 6563 7473   def tag_objects
+00015790: 280a 2020 2020 2020 2020 7365 6c66 2c0a  (.        self,.
+000157a0: 2020 2020 2020 2020 7072 6f6a 6563 743a          project:
+000157b0: 2073 7472 2c0a 2020 2020 2020 2020 7461   str,.        ta
+000157c0: 675f 6e61 6d65 3a20 7374 722c 0a20 2020  g_name: str,.   
+000157d0: 2020 2020 206f 626a 6563 7473 3a20 556e       objects: Un
+000157e0: 696f 6e5b 6d6c 7275 6e2e 6170 692e 7363  ion[mlrun.api.sc
+000157f0: 6865 6d61 732e 5461 674f 626a 6563 7473  hemas.TagObjects
+00015800: 2c20 6469 6374 5d2c 0a20 2020 2020 2020  , dict],.       
+00015810: 2072 6570 6c61 6365 3a20 626f 6f6c 203d   replace: bool =
+00015820: 2046 616c 7365 2c0a 2020 2020 293a 0a20   False,.    ):. 
+00015830: 2020 2020 2020 2022 2222 5461 6720 6120         """Tag a 
+00015840: 6c69 7374 206f 6620 6f62 6a65 6374 732e  list of objects.
+00015850: 0a0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
+00015860: 2070 726f 6a65 6374 3a20 5072 6f6a 6563   project: Projec
+00015870: 7420 7768 6963 6820 636f 6e74 6169 6e73  t which contains
+00015880: 2074 6865 206f 626a 6563 7473 2e0a 2020   the objects..  
+00015890: 2020 2020 2020 3a70 6172 616d 2074 6167        :param tag
+000158a0: 5f6e 616d 653a 2054 6865 2074 6167 2074  _name: The tag t
+000158b0: 6f20 7365 7420 6f6e 2074 6865 206f 626a  o set on the obj
+000158c0: 6563 7473 2e0a 2020 2020 2020 2020 3a70  ects..        :p
+000158d0: 6172 616d 206f 626a 6563 7473 3a20 5468  aram objects: Th
+000158e0: 6520 6f62 6a65 6374 7320 746f 2074 6167  e objects to tag
+000158f0: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
+00015900: 2072 6570 6c61 6365 3a20 5768 6574 6865   replace: Whethe
+00015910: 7220 746f 2072 6570 6c61 6365 2074 6865  r to replace the
+00015920: 2065 7869 7374 696e 6720 7461 6773 206f   existing tags o
+00015930: 6620 7468 6520 6f62 6a65 6374 7320 6f72  f the objects or
+00015940: 2074 6f20 6164 6420 7468 6520 6e65 7720   to add the new 
+00015950: 7461 6720 746f 2074 6865 6d2e 0a20 2020  tag to them..   
+00015960: 2020 2020 2022 2222 0a0a 2020 2020 2020       """..      
+00015970: 2020 7061 7468 203d 2066 2270 726f 6a65    path = f"proje
+00015980: 6374 732f 7b70 726f 6a65 6374 7d2f 7461  cts/{project}/ta
+00015990: 6773 2f7b 7461 675f 6e61 6d65 7d22 0a20  gs/{tag_name}". 
+000159a0: 2020 2020 2020 2065 7272 6f72 5f6d 6573         error_mes
+000159b0: 7361 6765 203d 2066 2246 6169 6c65 6420  sage = f"Failed 
+000159c0: 746f 2074 6167 207b 7461 675f 6e61 6d65  to tag {tag_name
+000159d0: 7d20 6f6e 206f 626a 6563 7473 207b 6f62  } on objects {ob
+000159e0: 6a65 6374 737d 220a 2020 2020 2020 2020  jects}".        
+000159f0: 6d65 7468 6f64 203d 2022 504f 5354 2220  method = "POST" 
+00015a00: 6966 2072 6570 6c61 6365 2065 6c73 6520  if replace else 
+00015a10: 2250 5554 220a 2020 2020 2020 2020 7365  "PUT".        se
+00015a20: 6c66 2e61 7069 5f63 616c 6c28 0a20 2020  lf.api_call(.   
+00015a30: 2020 2020 2020 2020 206d 6574 686f 642c           method,
+00015a40: 0a20 2020 2020 2020 2020 2020 2070 6174  .            pat
+00015a50: 682c 0a20 2020 2020 2020 2020 2020 2065  h,.            e
+00015a60: 7272 6f72 5f6d 6573 7361 6765 2c0a 2020  rror_message,.  
+00015a70: 2020 2020 2020 2020 2020 626f 6479 3d64            body=d
+00015a80: 6963 745f 746f 5f6a 736f 6e28 0a20 2020  ict_to_json(.   
+00015a90: 2020 2020 2020 2020 2020 2020 206f 626a               obj
+00015aa0: 6563 7473 2e64 6963 7428 290a 2020 2020  ects.dict().    
+00015ab0: 2020 2020 2020 2020 2020 2020 6966 2069              if i
+00015ac0: 7369 6e73 7461 6e63 6528 6f62 6a65 6374  sinstance(object
+00015ad0: 732c 206d 6c72 756e 2e61 7069 2e73 6368  s, mlrun.api.sch
+00015ae0: 656d 6173 2e54 6167 4f62 6a65 6374 7329  emas.TagObjects)
+00015af0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00015b00: 2065 6c73 6520 6f62 6a65 6374 730a 2020   else objects.  
+00015b10: 2020 2020 2020 2020 2020 292c 0a20 2020            ),.   
+00015b20: 2020 2020 2029 0a0a 2020 2020 6465 6620       )..    def 
+00015b30: 6465 6c65 7465 5f6f 626a 6563 7473 5f74  delete_objects_t
+00015b40: 6167 280a 2020 2020 2020 2020 7365 6c66  ag(.        self
+00015b50: 2c0a 2020 2020 2020 2020 7072 6f6a 6563  ,.        projec
+00015b60: 743a 2073 7472 2c0a 2020 2020 2020 2020  t: str,.        
+00015b70: 7461 675f 6e61 6d65 3a20 7374 722c 0a20  tag_name: str,. 
+00015b80: 2020 2020 2020 2074 6167 5f6f 626a 6563         tag_objec
+00015b90: 7473 3a20 556e 696f 6e5b 6d6c 7275 6e2e  ts: Union[mlrun.
+00015ba0: 6170 692e 7363 6865 6d61 732e 5461 674f  api.schemas.TagO
+00015bb0: 626a 6563 7473 2c20 6469 6374 5d2c 0a20  bjects, dict],. 
+00015bc0: 2020 2029 3a0a 2020 2020 2020 2020 2222     ):.        ""
+00015bd0: 2244 656c 6574 6520 6120 7461 6720 6672  "Delete a tag fr
+00015be0: 6f6d 2061 206c 6973 7420 6f66 206f 626a  om a list of obj
+00015bf0: 6563 7473 2e0a 0a20 2020 2020 2020 203a  ects...        :
+00015c00: 7061 7261 6d20 7072 6f6a 6563 743a 2050  param project: P
+00015c10: 726f 6a65 6374 2077 6869 6368 2063 6f6e  roject which con
+00015c20: 7461 696e 7320 7468 6520 6f62 6a65 6374  tains the object
+00015c30: 732e 0a20 2020 2020 2020 203a 7061 7261  s..        :para
+00015c40: 6d20 7461 675f 6e61 6d65 3a20 5468 6520  m tag_name: The 
+00015c50: 7461 6720 746f 2064 656c 6574 6520 6672  tag to delete fr
+00015c60: 6f6d 2074 6865 206f 626a 6563 7473 2e0a  om the objects..
+00015c70: 2020 2020 2020 2020 3a70 6172 616d 2074          :param t
+00015c80: 6167 5f6f 626a 6563 7473 3a20 5468 6520  ag_objects: The 
+00015c90: 6f62 6a65 6374 7320 746f 2064 656c 6574  objects to delet
+00015ca0: 6520 7468 6520 7461 6720 6672 6f6d 2e0a  e the tag from..
+00015cb0: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+00015cc0: 2020 2020 2070 6174 6820 3d20 6622 7072       path = f"pr
+00015cd0: 6f6a 6563 7473 2f7b 7072 6f6a 6563 747d  ojects/{project}
+00015ce0: 2f74 6167 732f 7b74 6167 5f6e 616d 657d  /tags/{tag_name}
+00015cf0: 220a 2020 2020 2020 2020 6572 726f 725f  ".        error_
+00015d00: 6d65 7373 6167 6520 3d20 6622 4661 696c  message = f"Fail
+00015d10: 6564 2064 656c 6574 696e 6720 7461 6720  ed deleting tag 
+00015d20: 6672 6f6d 207b 7461 675f 6e61 6d65 7d22  from {tag_name}"
+00015d30: 0a20 2020 2020 2020 2073 656c 662e 6170  .        self.ap
+00015d40: 695f 6361 6c6c 280a 2020 2020 2020 2020  i_call(.        
+00015d50: 2020 2020 2244 454c 4554 4522 2c0a 2020      "DELETE",.  
+00015d60: 2020 2020 2020 2020 2020 7061 7468 2c0a            path,.
+00015d70: 2020 2020 2020 2020 2020 2020 6572 726f              erro
+00015d80: 725f 6d65 7373 6167 652c 0a20 2020 2020  r_message,.     
+00015d90: 2020 2020 2020 2062 6f64 793d 6469 6374         body=dict
+00015da0: 5f74 6f5f 6a73 6f6e 280a 2020 2020 2020  _to_json(.      
+00015db0: 2020 2020 2020 2020 2020 7461 675f 6f62            tag_ob
+00015dc0: 6a65 6374 732e 6469 6374 2829 0a20 2020  jects.dict().   
+00015dd0: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+00015de0: 6973 696e 7374 616e 6365 2874 6167 5f6f  isinstance(tag_o
+00015df0: 626a 6563 7473 2c20 6d6c 7275 6e2e 6170  bjects, mlrun.ap
+00015e00: 692e 7363 6865 6d61 732e 5461 674f 626a  i.schemas.TagObj
+00015e10: 6563 7473 290a 2020 2020 2020 2020 2020  ects).          
+00015e20: 2020 2020 2020 656c 7365 2074 6167 5f6f        else tag_o
+00015e30: 626a 6563 7473 0a20 2020 2020 2020 2020  bjects.         
+00015e40: 2020 2029 2c0a 2020 2020 2020 2020 290a     ),.        ).
+00015e50: 0a20 2020 2064 6566 2074 6167 5f61 7274  .    def tag_art
+00015e60: 6966 6163 7473 280a 2020 2020 2020 2020  ifacts(.        
+00015e70: 7365 6c66 2c0a 2020 2020 2020 2020 6172  self,.        ar
+00015e80: 7469 6661 6374 733a 2055 6e69 6f6e 5b4c  tifacts: Union[L
+00015e90: 6973 745b 4172 7469 6661 6374 5d2c 204c  ist[Artifact], L
+00015ea0: 6973 745b 6469 6374 5d2c 2041 7274 6966  ist[dict], Artif
+00015eb0: 6163 742c 2064 6963 745d 2c0a 2020 2020  act, dict],.    
+00015ec0: 2020 2020 7072 6f6a 6563 743a 2073 7472      project: str
+00015ed0: 2c0a 2020 2020 2020 2020 7461 675f 6e61  ,.        tag_na
+00015ee0: 6d65 3a20 7374 722c 0a20 2020 2020 2020  me: str,.       
+00015ef0: 2072 6570 6c61 6365 3a20 626f 6f6c 203d   replace: bool =
+00015f00: 2046 616c 7365 2c0a 2020 2020 293a 0a20   False,.    ):. 
+00015f10: 2020 2020 2020 2022 2222 5461 6720 6120         """Tag a 
+00015f20: 6c69 7374 206f 6620 6172 7469 6661 6374  list of artifact
+00015f30: 732e 0a0a 2020 2020 2020 2020 3a70 6172  s...        :par
+00015f40: 616d 2061 7274 6966 6163 7473 3a20 5468  am artifacts: Th
+00015f50: 6520 6172 7469 6661 6374 7320 746f 2074  e artifacts to t
+00015f60: 6167 2e20 4361 6e20 6265 2061 206c 6973  ag. Can be a lis
+00015f70: 7420 6f66 203a 7079 3a63 6c61 7373 3a60  t of :py:class:`
+00015f80: 7e6d 6c72 756e 2e61 7274 6966 6163 7473  ~mlrun.artifacts
+00015f90: 2e41 7274 6966 6163 7460 206f 626a 6563  .Artifact` objec
+00015fa0: 7473 206f 720a 2020 2020 2020 2020 2020  ts or.          
+00015fb0: 2020 6469 6374 696f 6e61 7269 6573 2c20    dictionaries, 
+00015fc0: 6f72 2061 2073 696e 676c 6520 6f62 6a65  or a single obje
+00015fd0: 6374 2e0a 2020 2020 2020 2020 3a70 6172  ct..        :par
+00015fe0: 616d 2070 726f 6a65 6374 3a20 5072 6f6a  am project: Proj
+00015ff0: 6563 7420 7768 6963 6820 636f 6e74 6169  ect which contai
+00016000: 6e73 2074 6865 2061 7274 6966 6163 7473  ns the artifacts
+00016010: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
+00016020: 2074 6167 5f6e 616d 653a 2054 6865 2074   tag_name: The t
+00016030: 6167 2074 6f20 7365 7420 6f6e 2074 6865  ag to set on the
+00016040: 2061 7274 6966 6163 7473 2e0a 2020 2020   artifacts..    
+00016050: 2020 2020 3a70 6172 616d 2072 6570 6c61      :param repla
+00016060: 6365 3a20 4966 2054 7275 652c 2072 6570  ce: If True, rep
+00016070: 6c61 6365 2065 7869 7374 696e 6720 7461  lace existing ta
+00016080: 6773 2c20 6f74 6865 7277 6973 6520 6170  gs, otherwise ap
+00016090: 7065 6e64 2074 6f20 6578 6973 7469 6e67  pend to existing
+000160a0: 2074 6167 732e 0a20 2020 2020 2020 2022   tags..        "
+000160b0: 2222 0a20 2020 2020 2020 2074 6167 5f6f  "".        tag_o
+000160c0: 626a 6563 7473 203d 2073 656c 662e 5f72  bjects = self._r
+000160d0: 6573 6f6c 7665 5f61 7274 6966 6163 7473  esolve_artifacts
+000160e0: 5f74 6f5f 7461 675f 6f62 6a65 6374 7328  _to_tag_objects(
+000160f0: 6172 7469 6661 6374 7329 0a20 2020 2020  artifacts).     
+00016100: 2020 2073 656c 662e 7461 675f 6f62 6a65     self.tag_obje
+00016110: 6374 7328 7072 6f6a 6563 742c 2074 6167  cts(project, tag
+00016120: 5f6e 616d 652c 206f 626a 6563 7473 3d74  _name, objects=t
+00016130: 6167 5f6f 626a 6563 7473 2c20 7265 706c  ag_objects, repl
+00016140: 6163 653d 7265 706c 6163 6529 0a0a 2020  ace=replace)..  
+00016150: 2020 6465 6620 6465 6c65 7465 5f61 7274    def delete_art
+00016160: 6966 6163 7473 5f74 6167 7328 0a20 2020  ifacts_tags(.   
+00016170: 2020 2020 2073 656c 662c 0a20 2020 2020       self,.     
+00016180: 2020 2061 7274 6966 6163 7473 2c0a 2020     artifacts,.  
+00016190: 2020 2020 2020 7072 6f6a 6563 743a 2073        project: s
+000161a0: 7472 2c0a 2020 2020 2020 2020 7461 675f  tr,.        tag_
+000161b0: 6e61 6d65 3a20 7374 722c 0a20 2020 2029  name: str,.    )
+000161c0: 3a0a 2020 2020 2020 2020 2222 2244 656c  :.        """Del
+000161d0: 6574 6520 7461 6720 6672 6f6d 2061 206c  ete tag from a l
+000161e0: 6973 7420 6f66 2061 7274 6966 6163 7473  ist of artifacts
+000161f0: 2e0a 0a20 2020 2020 2020 203a 7061 7261  ...        :para
+00016200: 6d20 6172 7469 6661 6374 733a 2054 6865  m artifacts: The
+00016210: 2061 7274 6966 6163 7473 2074 6f20 6465   artifacts to de
+00016220: 6c65 7465 2074 6865 2074 6167 2066 726f  lete the tag fro
+00016230: 6d2e 2043 616e 2062 6520 6120 6c69 7374  m. Can be a list
+00016240: 206f 6620 3a70 793a 636c 6173 733a 607e   of :py:class:`~
+00016250: 6d6c 7275 6e2e 6172 7469 6661 6374 732e  mlrun.artifacts.
+00016260: 4172 7469 6661 6374 600a 2020 2020 2020  Artifact`.      
+00016270: 2020 2020 2020 6f62 6a65 6374 7320 6f72        objects or
+00016280: 2064 6963 7469 6f6e 6172 6965 732c 206f   dictionaries, o
+00016290: 7220 6120 7369 6e67 6c65 206f 626a 6563  r a single objec
+000162a0: 742e 0a20 2020 2020 2020 203a 7061 7261  t..        :para
+000162b0: 6d20 7072 6f6a 6563 743a 2050 726f 6a65  m project: Proje
+000162c0: 6374 2077 6869 6368 2063 6f6e 7461 696e  ct which contain
+000162d0: 7320 7468 6520 6172 7469 6661 6374 732e  s the artifacts.
+000162e0: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
+000162f0: 7461 675f 6e61 6d65 3a20 5468 6520 7461  tag_name: The ta
+00016300: 6720 746f 2073 6574 206f 6e20 7468 6520  g to set on the 
+00016310: 6172 7469 6661 6374 732e 0a20 2020 2020  artifacts..     
+00016320: 2020 2022 2222 0a20 2020 2020 2020 2074     """.        t
+00016330: 6167 5f6f 626a 6563 7473 203d 2073 656c  ag_objects = sel
+00016340: 662e 5f72 6573 6f6c 7665 5f61 7274 6966  f._resolve_artif
+00016350: 6163 7473 5f74 6f5f 7461 675f 6f62 6a65  acts_to_tag_obje
+00016360: 6374 7328 6172 7469 6661 6374 7329 0a20  cts(artifacts). 
+00016370: 2020 2020 2020 2073 656c 662e 6465 6c65         self.dele
+00016380: 7465 5f6f 626a 6563 7473 5f74 6167 2870  te_objects_tag(p
+00016390: 726f 6a65 6374 2c20 7461 675f 6e61 6d65  roject, tag_name
+000163a0: 2c20 7461 675f 6f62 6a65 6374 7329 0a0a  , tag_objects)..
+000163b0: 2020 2020 6465 6620 6c69 7374 5f70 726f      def list_pro
+000163c0: 6a65 6374 7328 0a20 2020 2020 2020 2073  jects(.        s
+000163d0: 656c 662c 0a20 2020 2020 2020 206f 776e  elf,.        own
+000163e0: 6572 3a20 7374 7220 3d20 4e6f 6e65 2c0a  er: str = None,.
+000163f0: 2020 2020 2020 2020 666f 726d 6174 5f3a          format_:
+00016400: 2055 6e69 6f6e 5b0a 2020 2020 2020 2020   Union[.        
+00016410: 2020 2020 7374 722c 206d 6c72 756e 2e61      str, mlrun.a
+00016420: 7069 2e73 6368 656d 6173 2e50 726f 6a65  pi.schemas.Proje
+00016430: 6374 7346 6f72 6d61 740a 2020 2020 2020  ctsFormat.      
+00016440: 2020 5d20 3d20 6d6c 7275 6e2e 6170 692e    ] = mlrun.api.
+00016450: 7363 6865 6d61 732e 5072 6f6a 6563 7473  schemas.Projects
+00016460: 466f 726d 6174 2e66 756c 6c2c 0a20 2020  Format.full,.   
+00016470: 2020 2020 206c 6162 656c 733a 204c 6973       labels: Lis
+00016480: 745b 7374 725d 203d 204e 6f6e 652c 0a20  t[str] = None,. 
+00016490: 2020 2020 2020 2073 7461 7465 3a20 556e         state: Un
+000164a0: 696f 6e5b 7374 722c 206d 6c72 756e 2e61  ion[str, mlrun.a
+000164b0: 7069 2e73 6368 656d 6173 2e50 726f 6a65  pi.schemas.Proje
+000164c0: 6374 5374 6174 655d 203d 204e 6f6e 652c  ctState] = None,
+000164d0: 0a20 2020 2029 202d 3e20 4c69 7374 5b55  .    ) -> List[U
+000164e0: 6e69 6f6e 5b6d 6c72 756e 2e70 726f 6a65  nion[mlrun.proje
+000164f0: 6374 732e 4d6c 7275 6e50 726f 6a65 6374  cts.MlrunProject
+00016500: 2c20 7374 725d 5d3a 0a20 2020 2020 2020  , str]]:.       
+00016510: 2022 2222 5265 7475 726e 2061 206c 6973   """Return a lis
+00016520: 7420 6f66 2074 6865 2065 7869 7374 696e  t of the existin
+00016530: 6720 7072 6f6a 6563 7473 2c20 706f 7465  g projects, pote
+00016540: 6e74 6961 6c6c 7920 6669 6c74 6572 6564  ntially filtered
+00016550: 2062 7920 7370 6563 6966 6963 2063 7269   by specific cri
+00016560: 7465 7269 612e 0a0a 2020 2020 2020 2020  teria...        
+00016570: 3a70 6172 616d 206f 776e 6572 3a20 4c69  :param owner: Li
+00016580: 7374 206f 6e6c 7920 7072 6f6a 6563 7473  st only projects
+00016590: 2062 656c 6f6e 6769 6e67 2074 6f20 7468   belonging to th
+000165a0: 6973 2073 7065 6369 6669 6320 6f77 6e65  is specific owne
+000165b0: 722e 0a20 2020 2020 2020 203a 7061 7261  r..        :para
+000165c0: 6d20 666f 726d 6174 5f3a 2046 6f72 6d61  m format_: Forma
+000165d0: 7420 6f66 2074 6865 2072 6573 756c 7473  t of the results
+000165e0: 2e20 506f 7373 6962 6c65 2076 616c 7565  . Possible value
+000165f0: 7320 6172 653a 0a0a 2020 2020 2020 2020  s are:..        
+00016600: 2020 2020 2d20 6060 6675 6c6c 6060 2028      - ``full`` (
+00016610: 6465 6661 756c 7420 7661 6c75 6529 202d  default value) -
+00016620: 2052 6574 7572 6e20 6675 6c6c 2070 726f   Return full pro
+00016630: 6a65 6374 206f 626a 6563 7473 2e0a 2020  ject objects..  
+00016640: 2020 2020 2020 2020 2020 2d20 6060 6e61            - ``na
+00016650: 6d65 5f6f 6e6c 7960 6020 2d20 5265 7475  me_only`` - Retu
+00016660: 726e 206a 7573 7420 7468 6520 6e61 6d65  rn just the name
+00016670: 7320 6f66 2074 6865 2070 726f 6a65 6374  s of the project
+00016680: 732e 0a0a 2020 2020 2020 2020 3a70 6172  s...        :par
+00016690: 616d 206c 6162 656c 733a 2046 696c 7465  am labels: Filte
+000166a0: 7220 6279 206c 6162 656c 7320 6174 7461  r by labels atta
+000166b0: 6368 6564 2074 6f20 7468 6520 7072 6f6a  ched to the proj
+000166c0: 6563 742e 0a20 2020 2020 2020 203a 7061  ect..        :pa
+000166d0: 7261 6d20 7374 6174 653a 2046 696c 7465  ram state: Filte
+000166e0: 7220 6279 2070 726f 6a65 6374 2773 2073  r by project's s
+000166f0: 7461 7465 2e20 4361 6e20 6265 2065 6974  tate. Can be eit
+00016700: 6865 7220 6060 6f6e 6c69 6e65 6060 206f  her ``online`` o
+00016710: 7220 6060 6172 6368 6976 6564 6060 2e0a  r ``archived``..
+00016720: 2020 2020 2020 2020 2222 220a 0a20 2020          """..   
+00016730: 2020 2020 2070 6172 616d 7320 3d20 7b0a       params = {.
+00016740: 2020 2020 2020 2020 2020 2020 226f 776e              "own
+00016750: 6572 223a 206f 776e 6572 2c0a 2020 2020  er": owner,.    
+00016760: 2020 2020 2020 2020 2273 7461 7465 223a          "state":
+00016770: 2073 7461 7465 2c0a 2020 2020 2020 2020   state,.        
+00016780: 2020 2020 2266 6f72 6d61 7422 3a20 666f      "format": fo
+00016790: 726d 6174 5f2c 0a20 2020 2020 2020 2020  rmat_,.         
+000167a0: 2020 2022 6c61 6265 6c22 3a20 6c61 6265     "label": labe
+000167b0: 6c73 206f 7220 5b5d 2c0a 2020 2020 2020  ls or [],.      
+000167c0: 2020 7d0a 0a20 2020 2020 2020 2065 7272    }..        err
+000167d0: 6f72 5f6d 6573 7361 6765 203d 2066 2246  or_message = f"F
+000167e0: 6169 6c65 6420 6c69 7374 696e 6720 7072  ailed listing pr
+000167f0: 6f6a 6563 7473 2c20 7175 6572 793a 207b  ojects, query: {
+00016800: 7061 7261 6d73 7d22 0a20 2020 2020 2020  params}".       
+00016810: 2072 6573 706f 6e73 6520 3d20 7365 6c66   response = self
+00016820: 2e61 7069 5f63 616c 6c28 2247 4554 222c  .api_call("GET",
+00016830: 2022 7072 6f6a 6563 7473 222c 2065 7272   "projects", err
+00016840: 6f72 5f6d 6573 7361 6765 2c20 7061 7261  or_message, para
+00016850: 6d73 3d70 6172 616d 7329 0a20 2020 2020  ms=params).     
+00016860: 2020 2069 6620 666f 726d 6174 5f20 3d3d     if format_ ==
+00016870: 206d 6c72 756e 2e61 7069 2e73 6368 656d   mlrun.api.schem
+00016880: 6173 2e50 726f 6a65 6374 7346 6f72 6d61  as.ProjectsForma
+00016890: 742e 6e61 6d65 5f6f 6e6c 793a 0a20 2020  t.name_only:.   
+000168a0: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+000168b0: 7265 7370 6f6e 7365 2e6a 736f 6e28 295b  response.json()[
+000168c0: 2270 726f 6a65 6374 7322 5d0a 2020 2020  "projects"].    
+000168d0: 2020 2020 656c 6966 2066 6f72 6d61 745f      elif format_
+000168e0: 203d 3d20 6d6c 7275 6e2e 6170 692e 7363   == mlrun.api.sc
+000168f0: 6865 6d61 732e 5072 6f6a 6563 7473 466f  hemas.ProjectsFo
+00016900: 726d 6174 2e66 756c 6c3a 0a20 2020 2020  rmat.full:.     
+00016910: 2020 2020 2020 2072 6574 7572 6e20 5b0a         return [.
+00016920: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016930: 6d6c 7275 6e2e 7072 6f6a 6563 7473 2e4d  mlrun.projects.M
+00016940: 6c72 756e 5072 6f6a 6563 742e 6672 6f6d  lrunProject.from
+00016950: 5f64 6963 7428 7072 6f6a 6563 745f 6469  _dict(project_di
+00016960: 6374 290a 2020 2020 2020 2020 2020 2020  ct).            
+00016970: 2020 2020 666f 7220 7072 6f6a 6563 745f      for project_
+00016980: 6469 6374 2069 6e20 7265 7370 6f6e 7365  dict in response
+00016990: 2e6a 736f 6e28 295b 2270 726f 6a65 6374  .json()["project
+000169a0: 7322 5d0a 2020 2020 2020 2020 2020 2020  s"].            
+000169b0: 5d0a 2020 2020 2020 2020 656c 7365 3a0a  ].        else:.
+000169c0: 2020 2020 2020 2020 2020 2020 7261 6973              rais
+000169d0: 6520 4e6f 7449 6d70 6c65 6d65 6e74 6564  e NotImplemented
+000169e0: 4572 726f 7228 0a20 2020 2020 2020 2020  Error(.         
+000169f0: 2020 2020 2020 2066 2250 726f 7669 6465         f"Provide
+00016a00: 6420 666f 726d 6174 2069 7320 6e6f 7420  d format is not 
+00016a10: 7375 7070 6f72 7465 642e 2066 6f72 6d61  supported. forma
+00016a20: 743d 7b66 6f72 6d61 745f 7d22 0a20 2020  t={format_}".   
+00016a30: 2020 2020 2020 2020 2029 0a0a 2020 2020           )..    
+00016a40: 6465 6620 6765 745f 7072 6f6a 6563 7428  def get_project(
+00016a50: 7365 6c66 2c20 6e61 6d65 3a20 7374 7229  self, name: str)
+00016a60: 202d 3e20 6d6c 7275 6e2e 7072 6f6a 6563   -> mlrun.projec
+00016a70: 7473 2e4d 6c72 756e 5072 6f6a 6563 743a  ts.MlrunProject:
+00016a80: 0a20 2020 2020 2020 2022 2222 4765 7420  .        """Get 
+00016a90: 6465 7461 696c 7320 666f 7220 6120 7370  details for a sp
+00016aa0: 6563 6966 6963 2070 726f 6a65 6374 2e22  ecific project."
+00016ab0: 2222 0a0a 2020 2020 2020 2020 6966 206e  ""..        if n
+00016ac0: 6f74 206e 616d 653a 0a20 2020 2020 2020  ot name:.       
+00016ad0: 2020 2020 2072 6169 7365 204d 4c52 756e       raise MLRun
+00016ae0: 496e 7661 6c69 6441 7267 756d 656e 7445  InvalidArgumentE
+00016af0: 7272 6f72 2822 4e61 6d65 206d 7573 7420  rror("Name must 
+00016b00: 6265 2070 726f 7669 6465 6422 290a 0a20  be provided").. 
+00016b10: 2020 2020 2020 2070 6174 6820 3d20 6622         path = f"
+00016b20: 7072 6f6a 6563 7473 2f7b 6e61 6d65 7d22  projects/{name}"
+00016b30: 0a20 2020 2020 2020 2065 7272 6f72 5f6d  .        error_m
+00016b40: 6573 7361 6765 203d 2066 2246 6169 6c65  essage = f"Faile
+00016b50: 6420 7265 7472 6965 7669 6e67 2070 726f  d retrieving pro
+00016b60: 6a65 6374 207b 6e61 6d65 7d22 0a20 2020  ject {name}".   
+00016b70: 2020 2020 2072 6573 706f 6e73 6520 3d20       response = 
+00016b80: 7365 6c66 2e61 7069 5f63 616c 6c28 2247  self.api_call("G
+00016b90: 4554 222c 2070 6174 682c 2065 7272 6f72  ET", path, error
+00016ba0: 5f6d 6573 7361 6765 290a 2020 2020 2020  _message).      
+00016bb0: 2020 7265 7475 726e 206d 6c72 756e 2e70    return mlrun.p
+00016bc0: 726f 6a65 6374 732e 4d6c 7275 6e50 726f  rojects.MlrunPro
+00016bd0: 6a65 6374 2e66 726f 6d5f 6469 6374 2872  ject.from_dict(r
+00016be0: 6573 706f 6e73 652e 6a73 6f6e 2829 290a  esponse.json()).
+00016bf0: 0a20 2020 2064 6566 2064 656c 6574 655f  .    def delete_
+00016c00: 7072 6f6a 6563 7428 0a20 2020 2020 2020  project(.       
+00016c10: 2073 656c 662c 0a20 2020 2020 2020 206e   self,.        n
+00016c20: 616d 653a 2073 7472 2c0a 2020 2020 2020  ame: str,.      
+00016c30: 2020 6465 6c65 7469 6f6e 5f73 7472 6174    deletion_strat
+00016c40: 6567 793a 2055 6e69 6f6e 5b0a 2020 2020  egy: Union[.    
+00016c50: 2020 2020 2020 2020 7374 722c 206d 6c72          str, mlr
+00016c60: 756e 2e61 7069 2e73 6368 656d 6173 2e44  un.api.schemas.D
+00016c70: 656c 6574 696f 6e53 7472 6174 6567 790a  eletionStrategy.
+00016c80: 2020 2020 2020 2020 5d20 3d20 6d6c 7275          ] = mlru
+00016c90: 6e2e 6170 692e 7363 6865 6d61 732e 4465  n.api.schemas.De
+00016ca0: 6c65 7469 6f6e 5374 7261 7465 6779 2e64  letionStrategy.d
+00016cb0: 6566 6175 6c74 2829 2c0a 2020 2020 293a  efault(),.    ):
+00016cc0: 0a20 2020 2020 2020 2022 2222 4465 6c65  .        """Dele
+00016cd0: 7465 2061 2070 726f 6a65 6374 2e0a 0a20  te a project... 
+00016ce0: 2020 2020 2020 203a 7061 7261 6d20 6e61         :param na
+00016cf0: 6d65 3a20 4e61 6d65 206f 6620 7468 6520  me: Name of the 
+00016d00: 7072 6f6a 6563 7420 746f 2064 656c 6574  project to delet
+00016d10: 652e 0a20 2020 2020 2020 203a 7061 7261  e..        :para
+00016d20: 6d20 6465 6c65 7469 6f6e 5f73 7472 6174  m deletion_strat
+00016d30: 6567 793a 2048 6f77 2074 6f20 7472 6561  egy: How to trea
+00016d40: 7420 6368 696c 6420 6f62 6a65 6374 7320  t child objects 
+00016d50: 6f66 2074 6865 2070 726f 6a65 6374 2e20  of the project. 
+00016d60: 506f 7373 6962 6c65 2076 616c 7565 7320  Possible values 
+00016d70: 6172 653a 0a0a 2020 2020 2020 2020 2020  are:..          
+00016d80: 2020 2d20 6060 7265 7374 7269 6374 6060    - ``restrict``
+00016d90: 2028 6465 6661 756c 7429 202d 2050 726f   (default) - Pro
+00016da0: 6a65 6374 206d 7573 7420 6e6f 7420 6861  ject must not ha
+00016db0: 7665 2061 6e79 2063 6869 6c64 206f 626a  ve any child obj
+00016dc0: 6563 7473 2077 6865 6e20 6465 6c65 7465  ects when delete
+00016dd0: 642e 2049 6620 7573 696e 6720 7468 6973  d. If using this
+00016de0: 206d 6f64 6520 7768 696c 650a 2020 2020   mode while.    
+00016df0: 2020 2020 2020 2020 2020 6368 696c 6420            child 
+00016e00: 6f62 6a65 6374 7320 6578 6973 742c 2074  objects exist, t
+00016e10: 6865 206f 7065 7261 7469 6f6e 2077 696c  he operation wil
+00016e20: 6c20 6661 696c 2e0a 2020 2020 2020 2020  l fail..        
+00016e30: 2020 2020 2d20 6060 6361 7363 6164 6560      - ``cascade`
+00016e40: 6020 2d20 4175 746f 6d61 7469 6361 6c6c  ` - Automaticall
+00016e50: 7920 6465 6c65 7465 2061 6c6c 2063 6869  y delete all chi
+00016e60: 6c64 206f 626a 6563 7473 2077 6865 6e20  ld objects when 
+00016e70: 6465 6c65 7469 6e67 2074 6865 2070 726f  deleting the pro
+00016e80: 6a65 6374 2e0a 2020 2020 2020 2020 2222  ject..        ""
+00016e90: 220a 0a20 2020 2020 2020 2070 6174 6820  "..        path 
+00016ea0: 3d20 6622 7072 6f6a 6563 7473 2f7b 6e61  = f"projects/{na
+00016eb0: 6d65 7d22 0a20 2020 2020 2020 2068 6561  me}".        hea
+00016ec0: 6465 7273 203d 207b 7363 6865 6d61 732e  ders = {schemas.
+00016ed0: 4865 6164 6572 4e61 6d65 732e 6465 6c65  HeaderNames.dele
+00016ee0: 7469 6f6e 5f73 7472 6174 6567 793a 2064  tion_strategy: d
+00016ef0: 656c 6574 696f 6e5f 7374 7261 7465 6779  eletion_strategy
+00016f00: 7d0a 2020 2020 2020 2020 6572 726f 725f  }.        error_
+00016f10: 6d65 7373 6167 6520 3d20 6622 4661 696c  message = f"Fail
+00016f20: 6564 2064 656c 6574 696e 6720 7072 6f6a  ed deleting proj
+00016f30: 6563 7420 7b6e 616d 657d 220a 2020 2020  ect {name}".    
+00016f40: 2020 2020 7265 7370 6f6e 7365 203d 2073      response = s
+00016f50: 656c 662e 6170 695f 6361 6c6c 2822 4445  elf.api_call("DE
+00016f60: 4c45 5445 222c 2070 6174 682c 2065 7272  LETE", path, err
+00016f70: 6f72 5f6d 6573 7361 6765 2c20 6865 6164  or_message, head
+00016f80: 6572 733d 6865 6164 6572 7329 0a20 2020  ers=headers).   
+00016f90: 2020 2020 2069 6620 7265 7370 6f6e 7365       if response
+00016fa0: 2e73 7461 7475 735f 636f 6465 203d 3d20  .status_code == 
+00016fb0: 6874 7470 2e48 5454 5053 7461 7475 732e  http.HTTPStatus.
+00016fc0: 4143 4345 5054 4544 3a0a 2020 2020 2020  ACCEPTED:.      
+00016fd0: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
+00016fe0: 662e 5f77 6169 745f 666f 725f 7072 6f6a  f._wait_for_proj
+00016ff0: 6563 745f 746f 5f62 655f 6465 6c65 7465  ect_to_be_delete
+00017000: 6428 6e61 6d65 290a 0a20 2020 2064 6566  d(name)..    def
+00017010: 2073 746f 7265 5f70 726f 6a65 6374 280a   store_project(.
+00017020: 2020 2020 2020 2020 7365 6c66 2c0a 2020          self,.  
+00017030: 2020 2020 2020 6e61 6d65 3a20 7374 722c        name: str,
+00017040: 0a20 2020 2020 2020 2070 726f 6a65 6374  .        project
+00017050: 3a20 556e 696f 6e5b 6469 6374 2c20 6d6c  : Union[dict, ml
+00017060: 7275 6e2e 7072 6f6a 6563 7473 2e4d 6c72  run.projects.Mlr
+00017070: 756e 5072 6f6a 6563 742c 206d 6c72 756e  unProject, mlrun
+00017080: 2e61 7069 2e73 6368 656d 6173 2e50 726f  .api.schemas.Pro
+00017090: 6a65 6374 5d2c 0a20 2020 2029 202d 3e20  ject],.    ) -> 
+000170a0: 6d6c 7275 6e2e 7072 6f6a 6563 7473 2e4d  mlrun.projects.M
+000170b0: 6c72 756e 5072 6f6a 6563 743a 0a20 2020  lrunProject:.   
+000170c0: 2020 2020 2022 2222 5374 6f72 6520 6120       """Store a 
+000170d0: 7072 6f6a 6563 7420 696e 2074 6865 2044  project in the D
+000170e0: 422e 2054 6869 7320 6f70 6572 6174 696f  B. This operatio
+000170f0: 6e20 7769 6c6c 206f 7665 7277 7269 7465  n will overwrite
+00017100: 2065 7869 7374 696e 6720 7072 6f6a 6563   existing projec
+00017110: 7420 6f66 2074 6865 2073 616d 6520 6e61  t of the same na
+00017120: 6d65 2069 6620 6578 6973 7473 2e22 2222  me if exists."""
+00017130: 0a0a 2020 2020 2020 2020 7061 7468 203d  ..        path =
+00017140: 2066 2270 726f 6a65 6374 732f 7b6e 616d   f"projects/{nam
+00017150: 657d 220a 2020 2020 2020 2020 6572 726f  e}".        erro
+00017160: 725f 6d65 7373 6167 6520 3d20 6622 4661  r_message = f"Fa
+00017170: 696c 6564 2073 746f 7269 6e67 2070 726f  iled storing pro
+00017180: 6a65 6374 207b 6e61 6d65 7d22 0a20 2020  ject {name}".   
+00017190: 2020 2020 2069 6620 6973 696e 7374 616e       if isinstan
+000171a0: 6365 2870 726f 6a65 6374 2c20 6d6c 7275  ce(project, mlru
+000171b0: 6e2e 6170 692e 7363 6865 6d61 732e 5072  n.api.schemas.Pr
+000171c0: 6f6a 6563 7429 3a0a 2020 2020 2020 2020  oject):.        
+000171d0: 2020 2020 7072 6f6a 6563 7420 3d20 7072      project = pr
+000171e0: 6f6a 6563 742e 6469 6374 2829 0a20 2020  oject.dict().   
+000171f0: 2020 2020 2065 6c69 6620 6973 696e 7374       elif isinst
+00017200: 616e 6365 2870 726f 6a65 6374 2c20 6d6c  ance(project, ml
+00017210: 7275 6e2e 7072 6f6a 6563 7473 2e4d 6c72  run.projects.Mlr
+00017220: 756e 5072 6f6a 6563 7429 3a0a 2020 2020  unProject):.    
+00017230: 2020 2020 2020 2020 7072 6f6a 6563 7420          project 
+00017240: 3d20 7072 6f6a 6563 742e 746f 5f64 6963  = project.to_dic
+00017250: 7428 290a 2020 2020 2020 2020 7265 7370  t().        resp
+00017260: 6f6e 7365 203d 2073 656c 662e 6170 695f  onse = self.api_
+00017270: 6361 6c6c 280a 2020 2020 2020 2020 2020  call(.          
+00017280: 2020 2250 5554 222c 0a20 2020 2020 2020    "PUT",.       
+00017290: 2020 2020 2070 6174 682c 0a20 2020 2020       path,.     
+000172a0: 2020 2020 2020 2065 7272 6f72 5f6d 6573         error_mes
+000172b0: 7361 6765 2c0a 2020 2020 2020 2020 2020  sage,.          
+000172c0: 2020 626f 6479 3d64 6963 745f 746f 5f6a    body=dict_to_j
+000172d0: 736f 6e28 7072 6f6a 6563 7429 2c0a 2020  son(project),.  
+000172e0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+000172f0: 6966 2072 6573 706f 6e73 652e 7374 6174  if response.stat
+00017300: 7573 5f63 6f64 6520 3d3d 2068 7474 702e  us_code == http.
+00017310: 4854 5450 5374 6174 7573 2e41 4343 4550  HTTPStatus.ACCEP
+00017320: 5445 443a 0a20 2020 2020 2020 2020 2020  TED:.           
+00017330: 2072 6574 7572 6e20 7365 6c66 2e5f 7761   return self._wa
+00017340: 6974 5f66 6f72 5f70 726f 6a65 6374 5f74  it_for_project_t
+00017350: 6f5f 7265 6163 685f 7465 726d 696e 616c  o_reach_terminal
+00017360: 5f73 7461 7465 286e 616d 6529 0a20 2020  _state(name).   
+00017370: 2020 2020 2072 6574 7572 6e20 6d6c 7275       return mlru
+00017380: 6e2e 7072 6f6a 6563 7473 2e4d 6c72 756e  n.projects.Mlrun
+00017390: 5072 6f6a 6563 742e 6672 6f6d 5f64 6963  Project.from_dic
+000173a0: 7428 7265 7370 6f6e 7365 2e6a 736f 6e28  t(response.json(
+000173b0: 2929 0a0a 2020 2020 6465 6620 7061 7463  ))..    def patc
+000173c0: 685f 7072 6f6a 6563 7428 0a20 2020 2020  h_project(.     
+000173d0: 2020 2073 656c 662c 0a20 2020 2020 2020     self,.       
+000173e0: 206e 616d 653a 2073 7472 2c0a 2020 2020   name: str,.    
+000173f0: 2020 2020 7072 6f6a 6563 743a 2064 6963      project: dic
+00017400: 742c 0a20 2020 2020 2020 2070 6174 6368  t,.        patch
+00017410: 5f6d 6f64 653a 2055 6e69 6f6e 5b73 7472  _mode: Union[str
+00017420: 2c20 7363 6865 6d61 732e 5061 7463 684d  , schemas.PatchM
+00017430: 6f64 655d 203d 2073 6368 656d 6173 2e50  ode] = schemas.P
+00017440: 6174 6368 4d6f 6465 2e72 6570 6c61 6365  atchMode.replace
+00017450: 2c0a 2020 2020 2920 2d3e 206d 6c72 756e  ,.    ) -> mlrun
+00017460: 2e70 726f 6a65 6374 732e 4d6c 7275 6e50  .projects.MlrunP
+00017470: 726f 6a65 6374 3a0a 2020 2020 2020 2020  roject:.        
+00017480: 2222 2250 6174 6368 2061 6e20 6578 6973  """Patch an exis
+00017490: 7469 6e67 2070 726f 6a65 6374 206f 626a  ting project obj
+000174a0: 6563 742e 0a0a 2020 2020 2020 2020 3a70  ect...        :p
+000174b0: 6172 616d 206e 616d 653a 204e 616d 6520  aram name: Name 
+000174c0: 6f66 2070 726f 6a65 6374 2074 6f20 7061  of project to pa
+000174d0: 7463 682e 0a20 2020 2020 2020 203a 7061  tch..        :pa
+000174e0: 7261 6d20 7072 6f6a 6563 743a 2054 6865  ram project: The
+000174f0: 2061 6374 7561 6c20 6368 616e 6765 7320   actual changes 
+00017500: 746f 2074 6865 2070 726f 6a65 6374 206f  to the project o
+00017510: 626a 6563 742e 0a20 2020 2020 2020 203a  bject..        :
+00017520: 7061 7261 6d20 7061 7463 685f 6d6f 6465  param patch_mode
+00017530: 3a20 5468 6520 7374 7261 7465 6779 2066  : The strategy f
+00017540: 6f72 206d 6572 6769 6e67 2074 6865 2063  or merging the c
+00017550: 6861 6e67 6573 2077 6974 6820 7468 6520  hanges with the 
+00017560: 6578 6973 7469 6e67 206f 626a 6563 742e  existing object.
+00017570: 2043 616e 2062 6520 6569 7468 6572 2060   Can be either `
+00017580: 6072 6570 6c61 6365 6060 0a20 2020 2020  `replace``.     
+00017590: 2020 2020 2020 206f 7220 6060 6164 6469         or ``addi
+000175a0: 7469 7665 6060 2e0a 2020 2020 2020 2020  tive``..        
+000175b0: 2222 220a 0a20 2020 2020 2020 2070 6174  """..        pat
+000175c0: 6820 3d20 6622 7072 6f6a 6563 7473 2f7b  h = f"projects/{
+000175d0: 6e61 6d65 7d22 0a20 2020 2020 2020 2068  name}".        h
+000175e0: 6561 6465 7273 203d 207b 7363 6865 6d61  eaders = {schema
+000175f0: 732e 4865 6164 6572 4e61 6d65 732e 7061  s.HeaderNames.pa
+00017600: 7463 685f 6d6f 6465 3a20 7061 7463 685f  tch_mode: patch_
+00017610: 6d6f 6465 7d0a 2020 2020 2020 2020 6572  mode}.        er
+00017620: 726f 725f 6d65 7373 6167 6520 3d20 6622  ror_message = f"
+00017630: 4661 696c 6564 2070 6174 6368 696e 6720  Failed patching 
+00017640: 7072 6f6a 6563 7420 7b6e 616d 657d 220a  project {name}".
+00017650: 2020 2020 2020 2020 7265 7370 6f6e 7365          response
+00017660: 203d 2073 656c 662e 6170 695f 6361 6c6c   = self.api_call
+00017670: 280a 2020 2020 2020 2020 2020 2020 2250  (.            "P
+00017680: 4154 4348 222c 2070 6174 682c 2065 7272  ATCH", path, err
+00017690: 6f72 5f6d 6573 7361 6765 2c20 626f 6479  or_message, body
+000176a0: 3d64 6963 745f 746f 5f6a 736f 6e28 7072  =dict_to_json(pr
+000176b0: 6f6a 6563 7429 2c20 6865 6164 6572 733d  oject), headers=
+000176c0: 6865 6164 6572 730a 2020 2020 2020 2020  headers.        
+000176d0: 290a 2020 2020 2020 2020 7265 7475 726e  ).        return
+000176e0: 206d 6c72 756e 2e70 726f 6a65 6374 732e   mlrun.projects.
+000176f0: 4d6c 7275 6e50 726f 6a65 6374 2e66 726f  MlrunProject.fro
+00017700: 6d5f 6469 6374 2872 6573 706f 6e73 652e  m_dict(response.
+00017710: 6a73 6f6e 2829 290a 0a20 2020 2064 6566  json())..    def
+00017720: 2063 7265 6174 655f 7072 6f6a 6563 7428   create_project(
+00017730: 0a20 2020 2020 2020 2073 656c 662c 0a20  .        self,. 
+00017740: 2020 2020 2020 2070 726f 6a65 6374 3a20         project: 
+00017750: 556e 696f 6e5b 6469 6374 2c20 6d6c 7275  Union[dict, mlru
+00017760: 6e2e 7072 6f6a 6563 7473 2e4d 6c72 756e  n.projects.Mlrun
+00017770: 5072 6f6a 6563 742c 206d 6c72 756e 2e61  Project, mlrun.a
+00017780: 7069 2e73 6368 656d 6173 2e50 726f 6a65  pi.schemas.Proje
+00017790: 6374 5d2c 0a20 2020 2029 202d 3e20 6d6c  ct],.    ) -> ml
+000177a0: 7275 6e2e 7072 6f6a 6563 7473 2e4d 6c72  run.projects.Mlr
+000177b0: 756e 5072 6f6a 6563 743a 0a20 2020 2020  unProject:.     
+000177c0: 2020 2022 2222 4372 6561 7465 2061 206e     """Create a n
+000177d0: 6577 2070 726f 6a65 6374 2e20 4120 7072  ew project. A pr
+000177e0: 6f6a 6563 7420 7769 7468 2074 6865 2073  oject with the s
+000177f0: 616d 6520 6e61 6d65 206d 7573 7420 6e6f  ame name must no
+00017800: 7420 6578 6973 7420 7072 696f 7220 746f  t exist prior to
+00017810: 2063 7265 6174 696f 6e2e 2222 220a 0a20   creation.""".. 
+00017820: 2020 2020 2020 2069 6620 6973 696e 7374         if isinst
+00017830: 616e 6365 2870 726f 6a65 6374 2c20 6d6c  ance(project, ml
+00017840: 7275 6e2e 6170 692e 7363 6865 6d61 732e  run.api.schemas.
+00017850: 5072 6f6a 6563 7429 3a0a 2020 2020 2020  Project):.      
+00017860: 2020 2020 2020 7072 6f6a 6563 7420 3d20        project = 
+00017870: 7072 6f6a 6563 742e 6469 6374 2829 0a20  project.dict(). 
+00017880: 2020 2020 2020 2065 6c69 6620 6973 696e         elif isin
+00017890: 7374 616e 6365 2870 726f 6a65 6374 2c20  stance(project, 
+000178a0: 6d6c 7275 6e2e 7072 6f6a 6563 7473 2e4d  mlrun.projects.M
+000178b0: 6c72 756e 5072 6f6a 6563 7429 3a0a 2020  lrunProject):.  
+000178c0: 2020 2020 2020 2020 2020 7072 6f6a 6563            projec
+000178d0: 7420 3d20 7072 6f6a 6563 742e 746f 5f64  t = project.to_d
+000178e0: 6963 7428 290a 2020 2020 2020 2020 7072  ict().        pr
+000178f0: 6f6a 6563 745f 6e61 6d65 203d 2070 726f  oject_name = pro
+00017900: 6a65 6374 5b22 6d65 7461 6461 7461 225d  ject["metadata"]
+00017910: 5b22 6e61 6d65 225d 0a20 2020 2020 2020  ["name"].       
+00017920: 2065 7272 6f72 5f6d 6573 7361 6765 203d   error_message =
+00017930: 2066 2246 6169 6c65 6420 6372 6561 7469   f"Failed creati
+00017940: 6e67 2070 726f 6a65 6374 207b 7072 6f6a  ng project {proj
+00017950: 6563 745f 6e61 6d65 7d22 0a20 2020 2020  ect_name}".     
+00017960: 2020 2072 6573 706f 6e73 6520 3d20 7365     response = se
+00017970: 6c66 2e61 7069 5f63 616c 6c28 0a20 2020  lf.api_call(.   
+00017980: 2020 2020 2020 2020 2022 504f 5354 222c           "POST",
+00017990: 0a20 2020 2020 2020 2020 2020 2022 7072  .            "pr
+000179a0: 6f6a 6563 7473 222c 0a20 2020 2020 2020  ojects",.       
+000179b0: 2020 2020 2065 7272 6f72 5f6d 6573 7361       error_messa
+000179c0: 6765 2c0a 2020 2020 2020 2020 2020 2020  ge,.            
+000179d0: 626f 6479 3d64 6963 745f 746f 5f6a 736f  body=dict_to_jso
+000179e0: 6e28 7072 6f6a 6563 7429 2c0a 2020 2020  n(project),.    
+000179f0: 2020 2020 290a 2020 2020 2020 2020 6966      ).        if
+00017a00: 2072 6573 706f 6e73 652e 7374 6174 7573   response.status
+00017a10: 5f63 6f64 6520 3d3d 2068 7474 702e 4854  _code == http.HT
+00017a20: 5450 5374 6174 7573 2e41 4343 4550 5445  TPStatus.ACCEPTE
+00017a30: 443a 0a20 2020 2020 2020 2020 2020 2072  D:.            r
+00017a40: 6574 7572 6e20 7365 6c66 2e5f 7761 6974  eturn self._wait
+00017a50: 5f66 6f72 5f70 726f 6a65 6374 5f74 6f5f  _for_project_to_
+00017a60: 7265 6163 685f 7465 726d 696e 616c 5f73  reach_terminal_s
+00017a70: 7461 7465 2870 726f 6a65 6374 5f6e 616d  tate(project_nam
+00017a80: 6529 0a20 2020 2020 2020 2072 6574 7572  e).        retur
+00017a90: 6e20 6d6c 7275 6e2e 7072 6f6a 6563 7473  n mlrun.projects
+00017aa0: 2e4d 6c72 756e 5072 6f6a 6563 742e 6672  .MlrunProject.fr
+00017ab0: 6f6d 5f64 6963 7428 7265 7370 6f6e 7365  om_dict(response
+00017ac0: 2e6a 736f 6e28 2929 0a0a 2020 2020 6465  .json())..    de
+00017ad0: 6620 5f77 6169 745f 666f 725f 7072 6f6a  f _wait_for_proj
+00017ae0: 6563 745f 746f 5f72 6561 6368 5f74 6572  ect_to_reach_ter
+00017af0: 6d69 6e61 6c5f 7374 6174 6528 0a20 2020  minal_state(.   
+00017b00: 2020 2020 2073 656c 662c 2070 726f 6a65       self, proje
+00017b10: 6374 5f6e 616d 653a 2073 7472 0a20 2020  ct_name: str.   
+00017b20: 2029 202d 3e20 6d6c 7275 6e2e 7072 6f6a   ) -> mlrun.proj
+00017b30: 6563 7473 2e4d 6c72 756e 5072 6f6a 6563  ects.MlrunProjec
+00017b40: 743a 0a20 2020 2020 2020 2064 6566 205f  t:.        def _
+00017b50: 7665 7269 6679 5f70 726f 6a65 6374 5f69  verify_project_i
+00017b60: 6e5f 7465 726d 696e 616c 5f73 7461 7465  n_terminal_state
+00017b70: 2829 3a0a 2020 2020 2020 2020 2020 2020  ():.            
+00017b80: 7072 6f6a 6563 7420 3d20 7365 6c66 2e67  project = self.g
+00017b90: 6574 5f70 726f 6a65 6374 2870 726f 6a65  et_project(proje
+00017ba0: 6374 5f6e 616d 6529 0a20 2020 2020 2020  ct_name).       
+00017bb0: 2020 2020 2069 6620 280a 2020 2020 2020       if (.      
+00017bc0: 2020 2020 2020 2020 2020 7072 6f6a 6563            projec
+00017bd0: 742e 7374 6174 7573 2e73 7461 7465 0a20  t.status.state. 
+00017be0: 2020 2020 2020 2020 2020 2020 2020 206e                 n
+00017bf0: 6f74 2069 6e20 6d6c 7275 6e2e 6170 692e  ot in mlrun.api.
+00017c00: 7363 6865 6d61 732e 5072 6f6a 6563 7453  schemas.ProjectS
+00017c10: 7461 7465 2e74 6572 6d69 6e61 6c5f 7374  tate.terminal_st
+00017c20: 6174 6573 2829 0a20 2020 2020 2020 2020  ates().         
+00017c30: 2020 2029 3a0a 2020 2020 2020 2020 2020     ):.          
+00017c40: 2020 2020 2020 7261 6973 6520 4578 6365        raise Exce
+00017c50: 7074 696f 6e28 0a20 2020 2020 2020 2020  ption(.         
+00017c60: 2020 2020 2020 2020 2020 2066 2250 726f             f"Pro
+00017c70: 6a65 6374 206e 6f74 2069 6e20 7465 726d  ject not in term
+00017c80: 696e 616c 2073 7461 7465 2e20 5374 6174  inal state. Stat
+00017c90: 653a 207b 7072 6f6a 6563 742e 7374 6174  e: {project.stat
+00017ca0: 7573 2e73 7461 7465 7d22 0a20 2020 2020  us.state}".     
+00017cb0: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
+00017cc0: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+00017cd0: 7072 6f6a 6563 740a 0a20 2020 2020 2020  project..       
+00017ce0: 2072 6574 7572 6e20 6d6c 7275 6e2e 7574   return mlrun.ut
+00017cf0: 696c 732e 6865 6c70 6572 732e 7265 7472  ils.helpers.retr
+00017d00: 795f 756e 7469 6c5f 7375 6363 6573 7366  y_until_successf
+00017d10: 756c 280a 2020 2020 2020 2020 2020 2020  ul(.            
+00017d20: 7365 6c66 2e5f 7761 6974 5f66 6f72 5f70  self._wait_for_p
+00017d30: 726f 6a65 6374 5f74 6572 6d69 6e61 6c5f  roject_terminal_
+00017d40: 7374 6174 655f 7265 7472 795f 696e 7465  state_retry_inte
+00017d50: 7276 616c 2c0a 2020 2020 2020 2020 2020  rval,.          
+00017d60: 2020 3132 302c 0a20 2020 2020 2020 2020    120,.         
+00017d70: 2020 206c 6f67 6765 722c 0a20 2020 2020     logger,.     
+00017d80: 2020 2020 2020 2046 616c 7365 2c0a 2020         False,.  
+00017d90: 2020 2020 2020 2020 2020 5f76 6572 6966            _verif
+00017da0: 795f 7072 6f6a 6563 745f 696e 5f74 6572  y_project_in_ter
+00017db0: 6d69 6e61 6c5f 7374 6174 652c 0a20 2020  minal_state,.   
+00017dc0: 2020 2020 2029 0a0a 2020 2020 6465 6620       )..    def 
+00017dd0: 5f77 6169 745f 666f 725f 6261 636b 6772  _wait_for_backgr
+00017de0: 6f75 6e64 5f74 6173 6b5f 746f 5f72 6561  ound_task_to_rea
+00017df0: 6368 5f74 6572 6d69 6e61 6c5f 7374 6174  ch_terminal_stat
+00017e00: 6528 0a20 2020 2020 2020 2073 656c 662c  e(.        self,
+00017e10: 206e 616d 653a 2073 7472 0a20 2020 2029   name: str.    )
+00017e20: 202d 3e20 7363 6865 6d61 732e 4261 636b   -> schemas.Back
+00017e30: 6772 6f75 6e64 5461 736b 3a0a 2020 2020  groundTask:.    
+00017e40: 2020 2020 6465 6620 5f76 6572 6966 795f      def _verify_
+00017e50: 6261 636b 6772 6f75 6e64 5f74 6173 6b5f  background_task_
+00017e60: 696e 5f74 6572 6d69 6e61 6c5f 7374 6174  in_terminal_stat
+00017e70: 6528 293a 0a20 2020 2020 2020 2020 2020  e():.           
+00017e80: 2062 6163 6b67 726f 756e 645f 7461 736b   background_task
+00017e90: 203d 2073 656c 662e 6765 745f 6261 636b   = self.get_back
+00017ea0: 6772 6f75 6e64 5f74 6173 6b28 6e61 6d65  ground_task(name
+00017eb0: 290a 2020 2020 2020 2020 2020 2020 7374  ).            st
+00017ec0: 6174 6520 3d20 6261 636b 6772 6f75 6e64  ate = background
+00017ed0: 5f74 6173 6b2e 7374 6174 7573 2e73 7461  _task.status.sta
+00017ee0: 7465 0a20 2020 2020 2020 2020 2020 2069  te.            i
+00017ef0: 6620 7374 6174 6520 6e6f 7420 696e 206d  f state not in m
+00017f00: 6c72 756e 2e61 7069 2e73 6368 656d 6173  lrun.api.schemas
+00017f10: 2e42 6163 6b67 726f 756e 6454 6173 6b53  .BackgroundTaskS
+00017f20: 7461 7465 2e74 6572 6d69 6e61 6c5f 7374  tate.terminal_st
+00017f30: 6174 6573 2829 3a0a 2020 2020 2020 2020  ates():.        
+00017f40: 2020 2020 2020 2020 7261 6973 6520 4578          raise Ex
+00017f50: 6365 7074 696f 6e28 0a20 2020 2020 2020  ception(.       
+00017f60: 2020 2020 2020 2020 2020 2020 2066 2242               f"B
+00017f70: 6163 6b67 726f 756e 6420 7461 736b 206e  ackground task n
+00017f80: 6f74 2069 6e20 7465 726d 696e 616c 2073  ot in terminal s
+00017f90: 7461 7465 2e20 6e61 6d65 3d7b 6e61 6d65  tate. name={name
+00017fa0: 7d2c 2073 7461 7465 3d7b 7374 6174 657d  }, state={state}
+00017fb0: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
+00017fc0: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
+00017fd0: 7265 7475 726e 2062 6163 6b67 726f 756e  return backgroun
+00017fe0: 645f 7461 736b 0a0a 2020 2020 2020 2020  d_task..        
+00017ff0: 7265 7475 726e 206d 6c72 756e 2e75 7469  return mlrun.uti
+00018000: 6c73 2e68 656c 7065 7273 2e72 6574 7279  ls.helpers.retry
+00018010: 5f75 6e74 696c 5f73 7563 6365 7373 6675  _until_successfu
+00018020: 6c28 0a20 2020 2020 2020 2020 2020 2073  l(.            s
+00018030: 656c 662e 5f77 6169 745f 666f 725f 6261  elf._wait_for_ba
+00018040: 636b 6772 6f75 6e64 5f74 6173 6b5f 7465  ckground_task_te
+00018050: 726d 696e 616c 5f73 7461 7465 5f72 6574  rminal_state_ret
+00018060: 7279 5f69 6e74 6572 7661 6c2c 0a20 2020  ry_interval,.   
+00018070: 2020 2020 2020 2020 2036 3020 2a20 3630           60 * 60
+00018080: 2c0a 2020 2020 2020 2020 2020 2020 6c6f  ,.            lo
+00018090: 6767 6572 2c0a 2020 2020 2020 2020 2020  gger,.          
+000180a0: 2020 4661 6c73 652c 0a20 2020 2020 2020    False,.       
+000180b0: 2020 2020 205f 7665 7269 6679 5f62 6163       _verify_bac
+000180c0: 6b67 726f 756e 645f 7461 736b 5f69 6e5f  kground_task_in_
+000180d0: 7465 726d 696e 616c 5f73 7461 7465 2c0a  terminal_state,.
+000180e0: 2020 2020 2020 2020 290a 0a20 2020 2064          )..    d
+000180f0: 6566 205f 7761 6974 5f66 6f72 5f70 726f  ef _wait_for_pro
+00018100: 6a65 6374 5f74 6f5f 6265 5f64 656c 6574  ject_to_be_delet
+00018110: 6564 2873 656c 662c 2070 726f 6a65 6374  ed(self, project
+00018120: 5f6e 616d 653a 2073 7472 293a 0a20 2020  _name: str):.   
+00018130: 2020 2020 2064 6566 205f 7665 7269 6679       def _verify
+00018140: 5f70 726f 6a65 6374 5f64 656c 6574 6564  _project_deleted
+00018150: 2829 3a0a 2020 2020 2020 2020 2020 2020  ():.            
+00018160: 7072 6f6a 6563 7473 203d 2073 656c 662e  projects = self.
+00018170: 6c69 7374 5f70 726f 6a65 6374 7328 0a20  list_projects(. 
+00018180: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+00018190: 6f72 6d61 745f 3d6d 6c72 756e 2e61 7069  ormat_=mlrun.api
+000181a0: 2e73 6368 656d 6173 2e50 726f 6a65 6374  .schemas.Project
+000181b0: 7346 6f72 6d61 742e 6e61 6d65 5f6f 6e6c  sFormat.name_onl
+000181c0: 790a 2020 2020 2020 2020 2020 2020 290a  y.            ).
+000181d0: 2020 2020 2020 2020 2020 2020 6966 2070              if p
+000181e0: 726f 6a65 6374 5f6e 616d 6520 696e 2070  roject_name in p
+000181f0: 726f 6a65 6374 733a 0a20 2020 2020 2020  rojects:.       
+00018200: 2020 2020 2020 2020 2072 6169 7365 2045           raise E
+00018210: 7863 6570 7469 6f6e 2822 5072 6f6a 6563  xception("Projec
+00018220: 7420 7374 696c 6c20 6578 6973 7473 2229  t still exists")
+00018230: 0a0a 2020 2020 2020 2020 7265 7475 726e  ..        return
+00018240: 206d 6c72 756e 2e75 7469 6c73 2e68 656c   mlrun.utils.hel
+00018250: 7065 7273 2e72 6574 7279 5f75 6e74 696c  pers.retry_until
+00018260: 5f73 7563 6365 7373 6675 6c28 0a20 2020  _successful(.   
+00018270: 2020 2020 2020 2020 2073 656c 662e 5f77           self._w
+00018280: 6169 745f 666f 725f 7072 6f6a 6563 745f  ait_for_project_
+00018290: 6465 6c65 7469 6f6e 5f69 6e74 6572 7661  deletion_interva
+000182a0: 6c2c 0a20 2020 2020 2020 2020 2020 2031  l,.            1
+000182b0: 3230 2c0a 2020 2020 2020 2020 2020 2020  20,.            
+000182c0: 6c6f 6767 6572 2c0a 2020 2020 2020 2020  logger,.        
+000182d0: 2020 2020 4661 6c73 652c 0a20 2020 2020      False,.     
+000182e0: 2020 2020 2020 205f 7665 7269 6679 5f70         _verify_p
+000182f0: 726f 6a65 6374 5f64 656c 6574 6564 2c0a  roject_deleted,.
+00018300: 2020 2020 2020 2020 290a 0a20 2020 2064          )..    d
+00018310: 6566 2063 7265 6174 655f 7072 6f6a 6563  ef create_projec
+00018320: 745f 7365 6372 6574 7328 0a20 2020 2020  t_secrets(.     
+00018330: 2020 2073 656c 662c 0a20 2020 2020 2020     self,.       
+00018340: 2070 726f 6a65 6374 3a20 7374 722c 0a20   project: str,. 
+00018350: 2020 2020 2020 2070 726f 7669 6465 723a         provider:
+00018360: 2055 6e69 6f6e 5b0a 2020 2020 2020 2020   Union[.        
+00018370: 2020 2020 7374 722c 2073 6368 656d 6173      str, schemas
+00018380: 2e53 6563 7265 7450 726f 7669 6465 724e  .SecretProviderN
+00018390: 616d 650a 2020 2020 2020 2020 5d20 3d20  ame.        ] = 
+000183a0: 7363 6865 6d61 732e 5365 6372 6574 5072  schemas.SecretPr
+000183b0: 6f76 6964 6572 4e61 6d65 2e6b 7562 6572  oviderName.kuber
+000183c0: 6e65 7465 732c 0a20 2020 2020 2020 2073  netes,.        s
+000183d0: 6563 7265 7473 3a20 6469 6374 203d 204e  ecrets: dict = N
+000183e0: 6f6e 652c 0a20 2020 2029 3a0a 2020 2020  one,.    ):.    
+000183f0: 2020 2020 2222 2243 7265 6174 6520 7072      """Create pr
+00018400: 6f6a 6563 742d 636f 6e74 6578 7420 7365  oject-context se
+00018410: 6372 6574 7320 7573 696e 6720 6569 7468  crets using eith
+00018420: 6572 2060 6076 6175 6c74 6060 206f 7220  er ``vault`` or 
+00018430: 6060 6b75 6265 726e 6574 6573 6060 2070  ``kubernetes`` p
+00018440: 726f 7669 6465 722e 0a20 2020 2020 2020  rovider..       
+00018450: 2057 6865 6e20 7573 696e 6720 7769 7468   When using with
+00018460: 2056 6175 6c74 2c20 7468 6973 2077 696c   Vault, this wil
+00018470: 6c20 6372 6561 7465 206e 6565 6465 6420  l create needed 
+00018480: 5661 756c 7420 7374 7275 6374 7572 6573  Vault structures
+00018490: 2066 6f72 2073 746f 7269 6e67 2073 6563   for storing sec
+000184a0: 7265 7473 2069 6e20 7072 6f6a 6563 742d  rets in project-
+000184b0: 636f 6e74 6578 742c 2061 6e64 0a20 2020  context, and.   
+000184c0: 2020 2020 2073 746f 7265 2061 2073 6574       store a set
+000184d0: 206f 6620 7365 6372 6574 2076 616c 7565   of secret value
+000184e0: 732e 2054 6865 206d 6574 686f 6420 6765  s. The method ge
+000184f0: 6e65 7261 7465 7320 4b75 6265 726e 6574  nerates Kubernet
+00018500: 6573 2073 6572 7669 6365 2d61 6363 6f75  es service-accou
+00018510: 6e74 2061 6e64 2074 6865 2056 6175 6c74  nt and the Vault
+00018520: 2061 7574 6865 6e74 6963 6174 696f 6e0a   authentication.
+00018530: 2020 2020 2020 2020 7374 7275 6374 7572          structur
+00018540: 6573 2074 6861 7420 6172 6520 7265 7175  es that are requ
+00018550: 6972 6564 2066 6f72 2066 756e 6374 696f  ired for functio
+00018560: 6e20 506f 6473 2074 6f20 6175 7468 656e  n Pods to authen
+00018570: 7469 6361 7465 2077 6974 6820 5661 756c  ticate with Vaul
+00018580: 7420 616e 6420 6265 2061 626c 6520 746f  t and be able to
+00018590: 2065 7874 7261 6374 2073 6563 7265 7420   extract secret 
+000185a0: 7661 6c75 6573 0a20 2020 2020 2020 2070  values.        p
+000185b0: 6173 7365 6420 6173 2070 6172 7420 6f66  assed as part of
+000185c0: 2074 6865 6972 2063 6f6e 7465 7874 2e0a   their context..
+000185d0: 0a20 2020 2020 2020 204e 6f74 653a 0a20  .        Note:. 
+000185e0: 2020 2020 2020 2020 2020 2020 2020 2054                 T
+000185f0: 6869 7320 6d65 7468 6f64 2075 7365 6420  his method used 
+00018600: 7769 7468 2056 6175 6c74 2069 7320 6375  with Vault is cu
+00018610: 7272 656e 746c 7920 696e 2074 6563 686e  rrently in techn
+00018620: 6963 616c 2070 7265 7669 6577 2c20 616e  ical preview, an
+00018630: 6420 7265 7175 6972 6573 2061 2048 6173  d requires a Has
+00018640: 6869 436f 7270 2056 6175 6c74 0a20 2020  hiCorp Vault.   
+00018650: 2020 2020 2020 2020 2020 2020 2069 6e66               inf
+00018660: 7261 7374 7275 6374 7572 6520 7072 6f70  rastructure prop
+00018670: 6572 6c79 2073 6574 2075 7020 616e 6420  erly set up and 
+00018680: 636f 6e6e 6563 7465 6420 746f 2074 6865  connected to the
+00018690: 204d 4c52 756e 2041 5049 2073 6572 7665   MLRun API serve
+000186a0: 722e 0a0a 2020 2020 2020 2020 5768 656e  r...        When
+000186b0: 2075 7365 6420 7769 7468 204b 7562 6572   used with Kuber
+000186c0: 6e65 7465 732c 2074 6869 7320 7769 6c6c  netes, this will
+000186d0: 206d 616b 6520 7375 7265 2074 6861 7420   make sure that 
+000186e0: 7468 6520 7072 6f6a 6563 742d 7370 6563  the project-spec
+000186f0: 6966 6963 206b 3873 2073 6563 7265 7420  ific k8s secret 
+00018700: 6973 2063 7265 6174 6564 2c20 616e 6420  is created, and 
+00018710: 7769 6c6c 0a20 2020 2020 2020 2070 6f70  will.        pop
+00018720: 756c 6174 6520 6974 2077 6974 6820 7468  ulate it with th
+00018730: 6520 7365 6372 6574 7320 7072 6f76 6964  e secrets provid
+00018740: 6564 2c20 7265 706c 6163 696e 6720 7468  ed, replacing th
+00018750: 6569 7220 7661 6c75 6573 2069 6620 7468  eir values if th
+00018760: 6579 2065 7869 7374 2e0a 0a20 2020 2020  ey exist...     
+00018770: 2020 203a 7061 7261 6d20 7072 6f6a 6563     :param projec
+00018780: 743a 2054 6865 2070 726f 6a65 6374 2063  t: The project c
+00018790: 6f6e 7465 7874 2066 6f72 2077 6869 6368  ontext for which
+000187a0: 2074 6f20 6765 6e65 7261 7465 2074 6865   to generate the
+000187b0: 2069 6e66 7261 2061 6e64 2073 746f 7265   infra and store
+000187c0: 2073 6563 7265 7473 2e0a 2020 2020 2020   secrets..      
+000187d0: 2020 3a70 6172 616d 2070 726f 7669 6465    :param provide
+000187e0: 723a 2054 6865 206e 616d 6520 6f66 2074  r: The name of t
+000187f0: 6865 2073 6563 7265 7473 2d70 726f 7669  he secrets-provi
+00018800: 6465 7220 746f 2077 6f72 6b20 7769 7468  der to work with
+00018810: 2e20 4163 6365 7074 7320 610a 2020 2020  . Accepts a.    
+00018820: 2020 2020 2020 2020 3a70 793a 636c 6173          :py:clas
+00018830: 733a 607e 6d6c 7275 6e2e 6170 692e 7363  s:`~mlrun.api.sc
+00018840: 6865 6d61 732e 7365 6372 6574 2e53 6563  hemas.secret.Sec
+00018850: 7265 7450 726f 7669 6465 724e 616d 6560  retProviderName`
+00018860: 2065 6e75 6d2e 0a20 2020 2020 2020 203a   enum..        :
+00018870: 7061 7261 6d20 7365 6372 6574 733a 2041  param secrets: A
+00018880: 2073 6574 206f 6620 7365 6372 6574 2076   set of secret v
+00018890: 616c 7565 7320 746f 2073 746f 7265 2e0a  alues to store..
+000188a0: 2020 2020 2020 2020 2020 2020 4578 616d              Exam
+000188b0: 706c 653a 3a0a 0a20 2020 2020 2020 2020  ple::..         
+000188c0: 2020 2020 2020 2073 6563 7265 7473 203d         secrets =
+000188d0: 207b 2770 6173 7377 6f72 6427 3a20 276d   {'password': 'm
+000188e0: 7950 6173 7377 3072 6427 2c20 2761 7773  yPassw0rd', 'aws
+000188f0: 5f6b 6579 273a 2027 3131 3132 3232 3333  _key': '11122233
+00018900: 3327 7d0a 2020 2020 2020 2020 2020 2020  3'}.            
+00018910: 2020 2020 6462 2e63 7265 6174 655f 7072      db.create_pr
+00018920: 6f6a 6563 745f 7365 6372 6574 7328 0a20  oject_secrets(. 
+00018930: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018940: 2020 2022 7072 6f6a 6563 7431 222c 0a20     "project1",. 
+00018950: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018960: 2020 2070 726f 7669 6465 723d 6d6c 7275     provider=mlru
+00018970: 6e2e 6170 692e 7363 6865 6d61 732e 5365  n.api.schemas.Se
+00018980: 6372 6574 5072 6f76 6964 6572 4e61 6d65  cretProviderName
+00018990: 2e6b 7562 6572 6e65 7465 732c 0a20 2020  .kubernetes,.   
+000189a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000189b0: 2073 6563 7265 7473 3d73 6563 7265 7473   secrets=secrets
+000189c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000189d0: 2029 0a20 2020 2020 2020 2022 2222 0a20   ).        """. 
+000189e0: 2020 2020 2020 2070 6174 6820 3d20 6622         path = f"
+000189f0: 7072 6f6a 6563 7473 2f7b 7072 6f6a 6563  projects/{projec
+00018a00: 747d 2f73 6563 7265 7473 220a 2020 2020  t}/secrets".    
+00018a10: 2020 2020 7365 6372 6574 735f 696e 7075      secrets_inpu
+00018a20: 7420 3d20 7363 6865 6d61 732e 5365 6372  t = schemas.Secr
+00018a30: 6574 7344 6174 6128 7365 6372 6574 733d  etsData(secrets=
+00018a40: 7365 6372 6574 732c 2070 726f 7669 6465  secrets, provide
+00018a50: 723d 7072 6f76 6964 6572 290a 2020 2020  r=provider).    
+00018a60: 2020 2020 626f 6479 203d 2073 6563 7265      body = secre
+00018a70: 7473 5f69 6e70 7574 2e64 6963 7428 290a  ts_input.dict().
+00018a80: 2020 2020 2020 2020 6572 726f 725f 6d65          error_me
+00018a90: 7373 6167 6520 3d20 6622 4661 696c 6564  ssage = f"Failed
+00018aa0: 2063 7265 6174 696e 6720 7365 6372 6574   creating secret
+00018ab0: 2070 726f 7669 6465 7220 7b70 726f 6a65   provider {proje
+00018ac0: 6374 7d2f 7b70 726f 7669 6465 727d 220a  ct}/{provider}".
+00018ad0: 2020 2020 2020 2020 7365 6c66 2e61 7069          self.api
+00018ae0: 5f63 616c 6c28 0a20 2020 2020 2020 2020  _call(.         
+00018af0: 2020 2022 504f 5354 222c 0a20 2020 2020     "POST",.     
+00018b00: 2020 2020 2020 2070 6174 682c 0a20 2020         path,.   
+00018b10: 2020 2020 2020 2020 2065 7272 6f72 5f6d           error_m
+00018b20: 6573 7361 6765 2c0a 2020 2020 2020 2020  essage,.        
+00018b30: 2020 2020 626f 6479 3d64 6963 745f 746f      body=dict_to
+00018b40: 5f6a 736f 6e28 626f 6479 292c 0a20 2020  _json(body),.   
+00018b50: 2020 2020 2029 0a0a 2020 2020 6465 6620       )..    def 
+00018b60: 6c69 7374 5f70 726f 6a65 6374 5f73 6563  list_project_sec
+00018b70: 7265 7473 280a 2020 2020 2020 2020 7365  rets(.        se
+00018b80: 6c66 2c0a 2020 2020 2020 2020 7072 6f6a  lf,.        proj
+00018b90: 6563 743a 2073 7472 2c0a 2020 2020 2020  ect: str,.      
+00018ba0: 2020 746f 6b65 6e3a 2073 7472 203d 204e    token: str = N
+00018bb0: 6f6e 652c 0a20 2020 2020 2020 2070 726f  one,.        pro
+00018bc0: 7669 6465 723a 2055 6e69 6f6e 5b0a 2020  vider: Union[.  
+00018bd0: 2020 2020 2020 2020 2020 7374 722c 2073            str, s
+00018be0: 6368 656d 6173 2e53 6563 7265 7450 726f  chemas.SecretPro
+00018bf0: 7669 6465 724e 616d 650a 2020 2020 2020  viderName.      
+00018c00: 2020 5d20 3d20 7363 6865 6d61 732e 5365    ] = schemas.Se
+00018c10: 6372 6574 5072 6f76 6964 6572 4e61 6d65  cretProviderName
+00018c20: 2e6b 7562 6572 6e65 7465 732c 0a20 2020  .kubernetes,.   
+00018c30: 2020 2020 2073 6563 7265 7473 3a20 4c69       secrets: Li
+00018c40: 7374 5b73 7472 5d20 3d20 4e6f 6e65 2c0a  st[str] = None,.
+00018c50: 2020 2020 2920 2d3e 2073 6368 656d 6173      ) -> schemas
+00018c60: 2e53 6563 7265 7473 4461 7461 3a0a 2020  .SecretsData:.  
+00018c70: 2020 2020 2020 2222 2252 6574 7269 6576        """Retriev
+00018c80: 6520 7072 6f6a 6563 742d 636f 6e74 6578  e project-contex
+00018c90: 7420 7365 6372 6574 7320 6672 6f6d 2056  t secrets from V
+00018ca0: 6175 6c74 2e0a 0a20 2020 2020 2020 204e  ault...        N
+00018cb0: 6f74 653a 0a20 2020 2020 2020 2020 2020  ote:.           
+00018cc0: 2020 2020 2054 6869 7320 6d65 7468 6f64       This method
+00018cd0: 2066 6f72 2056 6175 6c74 2066 756e 6374   for Vault funct
+00018ce0: 696f 6e61 6c69 7479 2069 7320 6375 7272  ionality is curr
+00018cf0: 656e 746c 7920 696e 2074 6563 686e 6963  ently in technic
+00018d00: 616c 2070 7265 7669 6577 2c20 616e 6420  al preview, and 
+00018d10: 7265 7175 6972 6573 2061 2048 6173 6869  requires a Hashi
+00018d20: 436f 7270 2056 6175 6c74 0a20 2020 2020  Corp Vault.     
+00018d30: 2020 2020 2020 2020 2020 2069 6e66 7261             infra
+00018d40: 7374 7275 6374 7572 6520 7072 6f70 6572  structure proper
+00018d50: 6c79 2073 6574 2075 7020 616e 6420 636f  ly set up and co
+00018d60: 6e6e 6563 7465 6420 746f 2074 6865 204d  nnected to the M
+00018d70: 4c52 756e 2041 5049 2073 6572 7665 722e  LRun API server.
+00018d80: 0a0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
+00018d90: 2070 726f 6a65 6374 3a20 5468 6520 7072   project: The pr
+00018da0: 6f6a 6563 7420 6e61 6d65 2e0a 2020 2020  oject name..    
+00018db0: 2020 2020 3a70 6172 616d 2074 6f6b 656e      :param token
+00018dc0: 3a20 5661 756c 7420 746f 6b65 6e20 746f  : Vault token to
+00018dd0: 2075 7365 2066 6f72 2072 6574 7269 6576   use for retriev
+00018de0: 696e 6720 7365 6372 6574 732e 0a20 2020  ing secrets..   
+00018df0: 2020 2020 2020 2020 204d 7573 7420 6265           Must be
+00018e00: 2061 2076 616c 6964 2056 6175 6c74 2074   a valid Vault t
+00018e10: 6f6b 656e 2c20 7769 7468 2070 6572 6d69  oken, with permi
+00018e20: 7373 696f 6e73 2074 6f20 7265 7472 6965  ssions to retrie
+00018e30: 7665 2073 6563 7265 7473 206f 6620 7468  ve secrets of th
+00018e40: 6520 7072 6f6a 6563 7420 696e 2071 7565  e project in que
+00018e50: 7374 696f 6e2e 0a20 2020 2020 2020 203a  stion..        :
+00018e60: 7061 7261 6d20 7072 6f76 6964 6572 3a20  param provider: 
+00018e70: 5468 6520 6e61 6d65 206f 6620 7468 6520  The name of the 
+00018e80: 7365 6372 6574 732d 7072 6f76 6964 6572  secrets-provider
+00018e90: 2074 6f20 776f 726b 2077 6974 682e 2043   to work with. C
+00018ea0: 7572 7265 6e74 6c79 206f 6e6c 7920 6060  urrently only ``
+00018eb0: 7661 756c 7460 6020 6973 2061 6363 6570  vault`` is accep
+00018ec0: 7465 642e 0a20 2020 2020 2020 203a 7061  ted..        :pa
+00018ed0: 7261 6d20 7365 6372 6574 733a 2041 206c  ram secrets: A l
+00018ee0: 6973 7420 6f66 2073 6563 7265 7420 6e61  ist of secret na
+00018ef0: 6d65 7320 746f 2072 6574 7269 6576 652e  mes to retrieve.
+00018f00: 2041 6e20 656d 7074 7920 6c69 7374 2060   An empty list `
+00018f10: 605b 5d60 6020 7769 6c6c 2072 6574 7269  `[]`` will retri
+00018f20: 6576 6520 616c 6c20 7365 6372 6574 7320  eve all secrets 
+00018f30: 6173 7369 676e 6564 0a20 2020 2020 2020  assigned.       
+00018f40: 2020 2020 2074 6f20 7468 6973 2073 7065       to this spe
+00018f50: 6369 6669 6320 7072 6f6a 6563 742e 2060  cific project. `
+00018f60: 606b 7562 6572 6e65 7465 7360 6020 7072  `kubernetes`` pr
+00018f70: 6f76 6964 6572 206f 6e6c 7920 7375 7070  ovider only supp
+00018f80: 6f72 7473 2061 6e20 656d 7074 7920 6c69  orts an empty li
+00018f90: 7374 2e0a 2020 2020 2020 2020 2222 220a  st..        """.
+00018fa0: 0a20 2020 2020 2020 2069 6620 7072 6f76  .        if prov
+00018fb0: 6964 6572 203d 3d20 7363 6865 6d61 732e  ider == schemas.
+00018fc0: 5365 6372 6574 5072 6f76 6964 6572 4e61  SecretProviderNa
+00018fd0: 6d65 2e76 6175 6c74 2e76 616c 7565 2061  me.vault.value a
+00018fe0: 6e64 206e 6f74 2074 6f6b 656e 3a0a 2020  nd not token:.  
+00018ff0: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+00019000: 4d4c 5275 6e49 6e76 616c 6964 4172 6775  MLRunInvalidArgu
+00019010: 6d65 6e74 4572 726f 7228 0a20 2020 2020  mentError(.     
+00019020: 2020 2020 2020 2020 2020 2022 4120 7661             "A va
+00019030: 756c 7420 746f 6b65 6e20 6d75 7374 2062  ult token must b
+00019040: 6520 7072 6f76 6964 6564 2077 6865 6e20  e provided when 
+00019050: 6163 6365 7373 696e 6720 7661 756c 7420  accessing vault 
+00019060: 7365 6372 6574 7322 0a20 2020 2020 2020  secrets".       
+00019070: 2020 2020 2029 0a0a 2020 2020 2020 2020       )..        
+00019080: 7061 7468 203d 2066 2270 726f 6a65 6374  path = f"project
+00019090: 732f 7b70 726f 6a65 6374 7d2f 7365 6372  s/{project}/secr
+000190a0: 6574 7322 0a20 2020 2020 2020 2070 6172  ets".        par
+000190b0: 616d 7320 3d20 7b22 7072 6f76 6964 6572  ams = {"provider
+000190c0: 223a 2070 726f 7669 6465 722c 2022 7365  ": provider, "se
+000190d0: 6372 6574 223a 2073 6563 7265 7473 7d0a  cret": secrets}.
+000190e0: 2020 2020 2020 2020 6865 6164 6572 7320          headers 
+000190f0: 3d20 7b73 6368 656d 6173 2e48 6561 6465  = {schemas.Heade
+00019100: 724e 616d 6573 2e73 6563 7265 745f 7374  rNames.secret_st
+00019110: 6f72 655f 746f 6b65 6e3a 2074 6f6b 656e  ore_token: token
+00019120: 7d0a 2020 2020 2020 2020 6572 726f 725f  }.        error_
+00019130: 6d65 7373 6167 6520 3d20 6622 4661 696c  message = f"Fail
+00019140: 6564 2072 6574 7269 6576 696e 6720 7365  ed retrieving se
+00019150: 6372 6574 7320 7b70 726f 6a65 6374 7d2f  crets {project}/
+00019160: 7b70 726f 7669 6465 727d 220a 2020 2020  {provider}".    
+00019170: 2020 2020 7265 7375 6c74 203d 2073 656c      result = sel
+00019180: 662e 6170 695f 6361 6c6c 280a 2020 2020  f.api_call(.    
+00019190: 2020 2020 2020 2020 2247 4554 222c 0a20          "GET",. 
+000191a0: 2020 2020 2020 2020 2020 2070 6174 682c             path,
+000191b0: 0a20 2020 2020 2020 2020 2020 2065 7272  .            err
+000191c0: 6f72 5f6d 6573 7361 6765 2c0a 2020 2020  or_message,.    
+000191d0: 2020 2020 2020 2020 7061 7261 6d73 3d70          params=p
+000191e0: 6172 616d 732c 0a20 2020 2020 2020 2020  arams,.         
+000191f0: 2020 2068 6561 6465 7273 3d68 6561 6465     headers=heade
+00019200: 7273 2c0a 2020 2020 2020 2020 290a 2020  rs,.        ).  
+00019210: 2020 2020 2020 7265 7475 726e 2073 6368        return sch
+00019220: 656d 6173 2e53 6563 7265 7473 4461 7461  emas.SecretsData
+00019230: 282a 2a72 6573 756c 742e 6a73 6f6e 2829  (**result.json()
+00019240: 290a 0a20 2020 2064 6566 206c 6973 745f  )..    def list_
+00019250: 7072 6f6a 6563 745f 7365 6372 6574 5f6b  project_secret_k
+00019260: 6579 7328 0a20 2020 2020 2020 2073 656c  eys(.        sel
+00019270: 662c 0a20 2020 2020 2020 2070 726f 6a65  f,.        proje
+00019280: 6374 3a20 7374 722c 0a20 2020 2020 2020  ct: str,.       
+00019290: 2070 726f 7669 6465 723a 2055 6e69 6f6e   provider: Union
+000192a0: 5b0a 2020 2020 2020 2020 2020 2020 7374  [.            st
+000192b0: 722c 2073 6368 656d 6173 2e53 6563 7265  r, schemas.Secre
+000192c0: 7450 726f 7669 6465 724e 616d 650a 2020  tProviderName.  
+000192d0: 2020 2020 2020 5d20 3d20 7363 6865 6d61        ] = schema
+000192e0: 732e 5365 6372 6574 5072 6f76 6964 6572  s.SecretProvider
+000192f0: 4e61 6d65 2e6b 7562 6572 6e65 7465 732c  Name.kubernetes,
+00019300: 0a20 2020 2020 2020 2074 6f6b 656e 3a20  .        token: 
+00019310: 7374 7220 3d20 4e6f 6e65 2c0a 2020 2020  str = None,.    
+00019320: 2920 2d3e 2073 6368 656d 6173 2e53 6563  ) -> schemas.Sec
+00019330: 7265 744b 6579 7344 6174 613a 0a20 2020  retKeysData:.   
+00019340: 2020 2020 2022 2222 5265 7472 6965 7665       """Retrieve
+00019350: 2070 726f 6a65 6374 2d63 6f6e 7465 7874   project-context
+00019360: 2073 6563 7265 7420 6b65 7973 2066 726f   secret keys fro
+00019370: 6d20 5661 756c 7420 6f72 204b 7562 6572  m Vault or Kuber
+00019380: 6e65 7465 732e 0a0a 2020 2020 2020 2020  netes...        
+00019390: 4e6f 7465 3a0a 2020 2020 2020 2020 2020  Note:.          
+000193a0: 2020 2020 2020 5468 6973 206d 6574 686f        This metho
+000193b0: 6420 666f 7220 5661 756c 7420 6675 6e63  d for Vault func
+000193c0: 7469 6f6e 616c 6974 7920 6973 2063 7572  tionality is cur
+000193d0: 7265 6e74 6c79 2069 6e20 7465 6368 6e69  rently in techni
+000193e0: 6361 6c20 7072 6576 6965 772c 2061 6e64  cal preview, and
+000193f0: 2072 6571 7569 7265 7320 6120 4861 7368   requires a Hash
+00019400: 6943 6f72 7020 5661 756c 740a 2020 2020  iCorp Vault.    
+00019410: 2020 2020 2020 2020 2020 2020 696e 6672              infr
+00019420: 6173 7472 7563 7475 7265 2070 726f 7065  astructure prope
+00019430: 726c 7920 7365 7420 7570 2061 6e64 2063  rly set up and c
+00019440: 6f6e 6e65 6374 6564 2074 6f20 7468 6520  onnected to the 
+00019450: 4d4c 5275 6e20 4150 4920 7365 7276 6572  MLRun API server
+00019460: 2e0a 0a20 2020 2020 2020 203a 7061 7261  ...        :para
+00019470: 6d20 7072 6f6a 6563 743a 2054 6865 2070  m project: The p
+00019480: 726f 6a65 6374 206e 616d 652e 0a20 2020  roject name..   
+00019490: 2020 2020 203a 7061 7261 6d20 7072 6f76       :param prov
+000194a0: 6964 6572 3a20 5468 6520 6e61 6d65 206f  ider: The name o
+000194b0: 6620 7468 6520 7365 6372 6574 732d 7072  f the secrets-pr
+000194c0: 6f76 6964 6572 2074 6f20 776f 726b 2077  ovider to work w
+000194d0: 6974 682e 2041 6363 6570 7473 2061 0a20  ith. Accepts a. 
+000194e0: 2020 2020 2020 2020 2020 203a 7079 3a63             :py:c
+000194f0: 6c61 7373 3a60 7e6d 6c72 756e 2e61 7069  lass:`~mlrun.api
+00019500: 2e73 6368 656d 6173 2e73 6563 7265 742e  .schemas.secret.
+00019510: 5365 6372 6574 5072 6f76 6964 6572 4e61  SecretProviderNa
+00019520: 6d65 6020 656e 756d 2e0a 2020 2020 2020  me` enum..      
+00019530: 2020 3a70 6172 616d 2074 6f6b 656e 3a20    :param token: 
+00019540: 5661 756c 7420 746f 6b65 6e20 746f 2075  Vault token to u
+00019550: 7365 2066 6f72 2072 6574 7269 6576 696e  se for retrievin
+00019560: 6720 7365 6372 6574 732e 204f 6e6c 7920  g secrets. Only 
+00019570: 696e 2075 7365 2069 6620 6060 7072 6f76  in use if ``prov
+00019580: 6964 6572 6060 2069 7320 6060 7661 756c  ider`` is ``vaul
+00019590: 7460 602e 0a20 2020 2020 2020 2020 2020  t``..           
+000195a0: 204d 7573 7420 6265 2061 2076 616c 6964   Must be a valid
+000195b0: 2056 6175 6c74 2074 6f6b 656e 2c20 7769   Vault token, wi
+000195c0: 7468 2070 6572 6d69 7373 696f 6e73 2074  th permissions t
+000195d0: 6f20 7265 7472 6965 7665 2073 6563 7265  o retrieve secre
+000195e0: 7473 206f 6620 7468 6520 7072 6f6a 6563  ts of the projec
+000195f0: 7420 696e 2071 7565 7374 696f 6e2e 0a20  t in question.. 
+00019600: 2020 2020 2020 2022 2222 0a0a 2020 2020         """..    
+00019610: 2020 2020 6966 2070 726f 7669 6465 7220      if provider 
+00019620: 3d3d 2073 6368 656d 6173 2e53 6563 7265  == schemas.Secre
+00019630: 7450 726f 7669 6465 724e 616d 652e 7661  tProviderName.va
+00019640: 756c 742e 7661 6c75 6520 616e 6420 6e6f  ult.value and no
+00019650: 7420 746f 6b65 6e3a 0a20 2020 2020 2020  t token:.       
+00019660: 2020 2020 2072 6169 7365 204d 4c52 756e       raise MLRun
+00019670: 496e 7661 6c69 6441 7267 756d 656e 7445  InvalidArgumentE
+00019680: 7272 6f72 280a 2020 2020 2020 2020 2020  rror(.          
+00019690: 2020 2020 2020 2241 2076 6175 6c74 2074        "A vault t
+000196a0: 6f6b 656e 206d 7573 7420 6265 2070 726f  oken must be pro
+000196b0: 7669 6465 6420 7768 656e 2061 6363 6573  vided when acces
+000196c0: 7369 6e67 2076 6175 6c74 2073 6563 7265  sing vault secre
+000196d0: 7473 220a 2020 2020 2020 2020 2020 2020  ts".            
+000196e0: 290a 0a20 2020 2020 2020 2070 6174 6820  )..        path 
+000196f0: 3d20 6622 7072 6f6a 6563 7473 2f7b 7072  = f"projects/{pr
+00019700: 6f6a 6563 747d 2f73 6563 7265 742d 6b65  oject}/secret-ke
+00019710: 7973 220a 2020 2020 2020 2020 7061 7261  ys".        para
+00019720: 6d73 203d 207b 2270 726f 7669 6465 7222  ms = {"provider"
+00019730: 3a20 7072 6f76 6964 6572 7d0a 2020 2020  : provider}.    
+00019740: 2020 2020 6865 6164 6572 7320 3d20 280a      headers = (.
+00019750: 2020 2020 2020 2020 2020 2020 7b73 6368              {sch
+00019760: 656d 6173 2e48 6561 6465 724e 616d 6573  emas.HeaderNames
+00019770: 2e73 6563 7265 745f 7374 6f72 655f 746f  .secret_store_to
+00019780: 6b65 6e3a 2074 6f6b 656e 7d0a 2020 2020  ken: token}.    
+00019790: 2020 2020 2020 2020 6966 2070 726f 7669          if provi
+000197a0: 6465 7220 3d3d 2073 6368 656d 6173 2e53  der == schemas.S
+000197b0: 6563 7265 7450 726f 7669 6465 724e 616d  ecretProviderNam
+000197c0: 652e 7661 756c 742e 7661 6c75 650a 2020  e.vault.value.  
+000197d0: 2020 2020 2020 2020 2020 656c 7365 204e            else N
+000197e0: 6f6e 650a 2020 2020 2020 2020 290a 2020  one.        ).  
+000197f0: 2020 2020 2020 6572 726f 725f 6d65 7373        error_mess
+00019800: 6167 6520 3d20 6622 4661 696c 6564 2072  age = f"Failed r
+00019810: 6574 7269 6576 696e 6720 7365 6372 6574  etrieving secret
+00019820: 206b 6579 7320 7b70 726f 6a65 6374 7d2f   keys {project}/
+00019830: 7b70 726f 7669 6465 727d 220a 2020 2020  {provider}".    
+00019840: 2020 2020 7265 7375 6c74 203d 2073 656c      result = sel
+00019850: 662e 6170 695f 6361 6c6c 280a 2020 2020  f.api_call(.    
+00019860: 2020 2020 2020 2020 2247 4554 222c 0a20          "GET",. 
+00019870: 2020 2020 2020 2020 2020 2070 6174 682c             path,
+00019880: 0a20 2020 2020 2020 2020 2020 2065 7272  .            err
+00019890: 6f72 5f6d 6573 7361 6765 2c0a 2020 2020  or_message,.    
+000198a0: 2020 2020 2020 2020 7061 7261 6d73 3d70          params=p
+000198b0: 6172 616d 732c 0a20 2020 2020 2020 2020  arams,.         
+000198c0: 2020 2068 6561 6465 7273 3d68 6561 6465     headers=heade
+000198d0: 7273 2c0a 2020 2020 2020 2020 290a 2020  rs,.        ).  
+000198e0: 2020 2020 2020 7265 7475 726e 2073 6368        return sch
+000198f0: 656d 6173 2e53 6563 7265 744b 6579 7344  emas.SecretKeysD
+00019900: 6174 6128 2a2a 7265 7375 6c74 2e6a 736f  ata(**result.jso
+00019910: 6e28 2929 0a0a 2020 2020 6465 6620 6465  n())..    def de
+00019920: 6c65 7465 5f70 726f 6a65 6374 5f73 6563  lete_project_sec
+00019930: 7265 7473 280a 2020 2020 2020 2020 7365  rets(.        se
+00019940: 6c66 2c0a 2020 2020 2020 2020 7072 6f6a  lf,.        proj
+00019950: 6563 743a 2073 7472 2c0a 2020 2020 2020  ect: str,.      
+00019960: 2020 7072 6f76 6964 6572 3a20 556e 696f    provider: Unio
+00019970: 6e5b 0a20 2020 2020 2020 2020 2020 2073  n[.            s
+00019980: 7472 2c20 7363 6865 6d61 732e 5365 6372  tr, schemas.Secr
+00019990: 6574 5072 6f76 6964 6572 4e61 6d65 0a20  etProviderName. 
+000199a0: 2020 2020 2020 205d 203d 2073 6368 656d         ] = schem
+000199b0: 6173 2e53 6563 7265 7450 726f 7669 6465  as.SecretProvide
+000199c0: 724e 616d 652e 6b75 6265 726e 6574 6573  rName.kubernetes
+000199d0: 2c0a 2020 2020 2020 2020 7365 6372 6574  ,.        secret
+000199e0: 733a 204c 6973 745b 7374 725d 203d 204e  s: List[str] = N
+000199f0: 6f6e 652c 0a20 2020 2029 3a0a 2020 2020  one,.    ):.    
+00019a00: 2020 2020 2222 2244 656c 6574 6520 7072      """Delete pr
+00019a10: 6f6a 6563 742d 636f 6e74 6578 7420 7365  oject-context se
+00019a20: 6372 6574 7320 6672 6f6d 204b 7562 6572  crets from Kuber
+00019a30: 6e65 7465 732e 0a0a 2020 2020 2020 2020  netes...        
+00019a40: 3a70 6172 616d 2070 726f 6a65 6374 3a20  :param project: 
+00019a50: 5468 6520 7072 6f6a 6563 7420 6e61 6d65  The project name
+00019a60: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
+00019a70: 2070 726f 7669 6465 723a 2054 6865 206e   provider: The n
+00019a80: 616d 6520 6f66 2074 6865 2073 6563 7265  ame of the secre
+00019a90: 7473 2d70 726f 7669 6465 7220 746f 2077  ts-provider to w
+00019aa0: 6f72 6b20 7769 7468 2e20 4375 7272 656e  ork with. Curren
+00019ab0: 746c 7920 6f6e 6c79 2060 606b 7562 6572  tly only ``kuber
+00019ac0: 6e65 7465 7360 6020 6973 2073 7570 706f  netes`` is suppo
+00019ad0: 7274 6564 2e0a 2020 2020 2020 2020 3a70  rted..        :p
+00019ae0: 6172 616d 2073 6563 7265 7473 3a20 4120  aram secrets: A 
+00019af0: 6c69 7374 206f 6620 7365 6372 6574 206e  list of secret n
+00019b00: 616d 6573 2074 6f20 6465 6c65 7465 2e20  ames to delete. 
+00019b10: 416e 2065 6d70 7479 206c 6973 7420 7769  An empty list wi
+00019b20: 6c6c 2064 656c 6574 6520 616c 6c20 7365  ll delete all se
+00019b30: 6372 6574 7320 6173 7369 676e 6564 0a20  crets assigned. 
+00019b40: 2020 2020 2020 2020 2020 2074 6f20 7468             to th
+00019b50: 6973 2073 7065 6369 6669 6320 7072 6f6a  is specific proj
+00019b60: 6563 742e 0a20 2020 2020 2020 2022 2222  ect..        """
+00019b70: 0a0a 2020 2020 2020 2020 7061 7468 203d  ..        path =
+00019b80: 2066 2270 726f 6a65 6374 732f 7b70 726f   f"projects/{pro
+00019b90: 6a65 6374 7d2f 7365 6372 6574 7322 0a20  ject}/secrets". 
+00019ba0: 2020 2020 2020 2070 6172 616d 7320 3d20         params = 
+00019bb0: 7b22 7072 6f76 6964 6572 223a 2070 726f  {"provider": pro
+00019bc0: 7669 6465 722c 2022 7365 6372 6574 223a  vider, "secret":
+00019bd0: 2073 6563 7265 7473 7d0a 2020 2020 2020   secrets}.      
+00019be0: 2020 6572 726f 725f 6d65 7373 6167 6520    error_message 
+00019bf0: 3d20 6622 4661 696c 6564 2064 656c 6574  = f"Failed delet
+00019c00: 696e 6720 7365 6372 6574 7320 7b70 726f  ing secrets {pro
+00019c10: 6a65 6374 7d2f 7b70 726f 7669 6465 727d  ject}/{provider}
+00019c20: 220a 2020 2020 2020 2020 7365 6c66 2e61  ".        self.a
+00019c30: 7069 5f63 616c 6c28 0a20 2020 2020 2020  pi_call(.       
+00019c40: 2020 2020 2022 4445 4c45 5445 222c 0a20       "DELETE",. 
+00019c50: 2020 2020 2020 2020 2020 2070 6174 682c             path,
+00019c60: 0a20 2020 2020 2020 2020 2020 2065 7272  .            err
+00019c70: 6f72 5f6d 6573 7361 6765 2c0a 2020 2020  or_message,.    
+00019c80: 2020 2020 2020 2020 7061 7261 6d73 3d70          params=p
+00019c90: 6172 616d 732c 0a20 2020 2020 2020 2029  arams,.        )
+00019ca0: 0a0a 2020 2020 6465 6620 6372 6561 7465  ..    def create
+00019cb0: 5f75 7365 725f 7365 6372 6574 7328 0a20  _user_secrets(. 
+00019cc0: 2020 2020 2020 2073 656c 662c 0a20 2020         self,.   
+00019cd0: 2020 2020 2075 7365 723a 2073 7472 2c0a       user: str,.
+00019ce0: 2020 2020 2020 2020 7072 6f76 6964 6572          provider
+00019cf0: 3a20 556e 696f 6e5b 0a20 2020 2020 2020  : Union[.       
+00019d00: 2020 2020 2073 7472 2c20 7363 6865 6d61       str, schema
+00019d10: 732e 5365 6372 6574 5072 6f76 6964 6572  s.SecretProvider
+00019d20: 4e61 6d65 0a20 2020 2020 2020 205d 203d  Name.        ] =
+00019d30: 2073 6368 656d 6173 2e53 6563 7265 7450   schemas.SecretP
+00019d40: 726f 7669 6465 724e 616d 652e 7661 756c  roviderName.vaul
+00019d50: 742c 0a20 2020 2020 2020 2073 6563 7265  t,.        secre
+00019d60: 7473 3a20 6469 6374 203d 204e 6f6e 652c  ts: dict = None,
+00019d70: 0a20 2020 2029 3a0a 2020 2020 2020 2020  .    ):.        
+00019d80: 2222 2243 7265 6174 6520 7573 6572 2d63  """Create user-c
+00019d90: 6f6e 7465 7874 2073 6563 7265 7420 696e  ontext secret in
+00019da0: 2056 6175 6c74 2e20 506c 6561 7365 2072   Vault. Please r
+00019db0: 6566 6572 2074 6f20 3a70 793a 6675 6e63  efer to :py:func
+00019dc0: 3a60 6372 6561 7465 5f70 726f 6a65 6374  :`create_project
+00019dd0: 5f73 6563 7265 7473 6020 666f 7220 6d6f  _secrets` for mo
+00019de0: 7265 2064 6574 6169 6c73 0a20 2020 2020  re details.     
+00019df0: 2020 2061 6e64 2073 7461 7475 7320 6f66     and status of
+00019e00: 2074 6869 7320 6675 6e63 7469 6f6e 616c   this functional
+00019e10: 6974 792e 0a0a 2020 2020 2020 2020 4e6f  ity...        No
+00019e20: 7465 3a0a 2020 2020 2020 2020 2020 2020  te:.            
+00019e30: 2020 2020 5468 6973 206d 6574 686f 6420      This method 
+00019e40: 6973 2063 7572 7265 6e74 6c79 2069 6e20  is currently in 
+00019e50: 7465 6368 6e69 6361 6c20 7072 6576 6965  technical previe
+00019e60: 772c 2061 6e64 2072 6571 7569 7265 7320  w, and requires 
+00019e70: 6120 4861 7368 6943 6f72 7020 5661 756c  a HashiCorp Vaul
+00019e80: 7420 696e 6672 6173 7472 7563 7475 7265  t infrastructure
+00019e90: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00019ea0: 2070 726f 7065 726c 7920 7365 7420 7570   properly set up
+00019eb0: 2061 6e64 2063 6f6e 6e65 6374 6564 2074   and connected t
+00019ec0: 6f20 7468 6520 4d4c 5275 6e20 4150 4920  o the MLRun API 
+00019ed0: 7365 7276 6572 2e0a 0a20 2020 2020 2020  server...       
+00019ee0: 203a 7061 7261 6d20 7573 6572 3a20 5468   :param user: Th
+00019ef0: 6520 7573 6572 2063 6f6e 7465 7874 2066  e user context f
+00019f00: 6f72 2077 6869 6368 2074 6f20 6765 6e65  or which to gene
+00019f10: 7261 7465 2074 6865 2069 6e66 7261 2061  rate the infra a
+00019f20: 6e64 2073 746f 7265 2073 6563 7265 7473  nd store secrets
+00019f30: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
+00019f40: 2070 726f 7669 6465 723a 2054 6865 206e   provider: The n
+00019f50: 616d 6520 6f66 2074 6865 2073 6563 7265  ame of the secre
+00019f60: 7473 2d70 726f 7669 6465 7220 746f 2077  ts-provider to w
+00019f70: 6f72 6b20 7769 7468 2e20 4375 7272 656e  ork with. Curren
+00019f80: 746c 7920 6f6e 6c79 2060 6076 6175 6c74  tly only ``vault
+00019f90: 6060 2069 7320 7375 7070 6f72 7465 642e  `` is supported.
+00019fa0: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
+00019fb0: 7365 6372 6574 733a 2041 2073 6574 206f  secrets: A set o
+00019fc0: 6620 7365 6372 6574 2076 616c 7565 7320  f secret values 
+00019fd0: 746f 2073 746f 7265 2077 6974 6869 6e20  to store within 
+00019fe0: 7468 6520 5661 756c 742e 0a20 2020 2020  the Vault..     
+00019ff0: 2020 2022 2222 0a20 2020 2020 2020 2070     """.        p
+0001a000: 6174 6820 3d20 2275 7365 722d 7365 6372  ath = "user-secr
+0001a010: 6574 7322 0a20 2020 2020 2020 2073 6563  ets".        sec
+0001a020: 7265 7473 5f63 7265 6174 696f 6e5f 7265  rets_creation_re
+0001a030: 7175 6573 7420 3d20 7363 6865 6d61 732e  quest = schemas.
+0001a040: 5573 6572 5365 6372 6574 4372 6561 7469  UserSecretCreati
+0001a050: 6f6e 5265 7175 6573 7428 0a20 2020 2020  onRequest(.     
+0001a060: 2020 2020 2020 2075 7365 723d 7573 6572         user=user
+0001a070: 2c0a 2020 2020 2020 2020 2020 2020 7072  ,.            pr
+0001a080: 6f76 6964 6572 3d70 726f 7669 6465 722c  ovider=provider,
+0001a090: 0a20 2020 2020 2020 2020 2020 2073 6563  .            sec
+0001a0a0: 7265 7473 3d73 6563 7265 7473 2c0a 2020  rets=secrets,.  
+0001a0b0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+0001a0c0: 626f 6479 203d 2073 6563 7265 7473 5f63  body = secrets_c
+0001a0d0: 7265 6174 696f 6e5f 7265 7175 6573 742e  reation_request.
+0001a0e0: 6469 6374 2829 0a20 2020 2020 2020 2065  dict().        e
+0001a0f0: 7272 6f72 5f6d 6573 7361 6765 203d 2066  rror_message = f
+0001a100: 2246 6169 6c65 6420 6372 6561 7469 6e67  "Failed creating
+0001a110: 2075 7365 7220 7365 6372 6574 7320 2d20   user secrets - 
+0001a120: 7b75 7365 727d 220a 2020 2020 2020 2020  {user}".        
+0001a130: 7365 6c66 2e61 7069 5f63 616c 6c28 0a20  self.api_call(. 
+0001a140: 2020 2020 2020 2020 2020 2022 504f 5354             "POST
+0001a150: 222c 0a20 2020 2020 2020 2020 2020 2070  ",.            p
+0001a160: 6174 682c 0a20 2020 2020 2020 2020 2020  ath,.           
+0001a170: 2065 7272 6f72 5f6d 6573 7361 6765 2c0a   error_message,.
+0001a180: 2020 2020 2020 2020 2020 2020 626f 6479              body
+0001a190: 3d64 6963 745f 746f 5f6a 736f 6e28 626f  =dict_to_json(bo
+0001a1a0: 6479 292c 0a20 2020 2020 2020 2029 0a0a  dy),.        )..
+0001a1b0: 2020 2020 4073 7461 7469 636d 6574 686f      @staticmetho
+0001a1c0: 640a 2020 2020 6465 6620 5f76 616c 6964  d.    def _valid
+0001a1d0: 6174 655f 7665 7273 696f 6e5f 636f 6d70  ate_version_comp
+0001a1e0: 6174 6962 696c 6974 7928 7365 7276 6572  atibility(server
+0001a1f0: 5f76 6572 7369 6f6e 2c20 636c 6965 6e74  _version, client
+0001a200: 5f76 6572 7369 6f6e 2920 2d3e 2062 6f6f  _version) -> boo
+0001a210: 6c3a 0a20 2020 2020 2020 2074 7279 3a0a  l:.        try:.
+0001a220: 2020 2020 2020 2020 2020 2020 7061 7273              pars
+0001a230: 6564 5f73 6572 7665 725f 7665 7273 696f  ed_server_versio
+0001a240: 6e20 3d20 7365 6d76 6572 2e56 6572 7369  n = semver.Versi
+0001a250: 6f6e 496e 666f 2e70 6172 7365 2873 6572  onInfo.parse(ser
+0001a260: 7665 725f 7665 7273 696f 6e29 0a20 2020  ver_version).   
+0001a270: 2020 2020 2020 2020 2070 6172 7365 645f           parsed_
+0001a280: 636c 6965 6e74 5f76 6572 7369 6f6e 203d  client_version =
+0001a290: 2073 656d 7665 722e 5665 7273 696f 6e49   semver.VersionI
+0001a2a0: 6e66 6f2e 7061 7273 6528 636c 6965 6e74  nfo.parse(client
+0001a2b0: 5f76 6572 7369 6f6e 290a 2020 2020 2020  _version).      
+0001a2c0: 2020 6578 6365 7074 2056 616c 7565 4572    except ValueEr
+0001a2d0: 726f 723a 0a20 2020 2020 2020 2020 2020  ror:.           
+0001a2e0: 2023 2054 6869 7320 7769 6c6c 206d 6f73   # This will mos
+0001a2f0: 746c 7920 6861 7070 656e 2069 6e20 6465  tly happen in de
+0001a300: 7620 7363 656e 6172 696f 7320 7768 656e  v scenarios when
+0001a310: 2074 6865 2076 6572 7369 6f6e 2069 7320   the version is 
+0001a320: 756e 7374 6162 6c65 2061 6e64 2073 7563  unstable and suc
+0001a330: 6820 2d20 7468 6572 6566 6f72 6520 7765  h - therefore we
+0001a340: 2772 6520 6967 6e6f 7269 6e67 0a20 2020  're ignoring.   
+0001a350: 2020 2020 2020 2020 206c 6f67 6765 722e           logger.
+0001a360: 7761 726e 696e 6728 0a20 2020 2020 2020  warning(.       
+0001a370: 2020 2020 2020 2020 2022 556e 6162 6c65           "Unable
+0001a380: 2074 6f20 7061 7273 6520 7365 7276 6572   to parse server
+0001a390: 206f 7220 636c 6965 6e74 2076 6572 7369   or client versi
+0001a3a0: 6f6e 2e20 4173 7375 6d69 6e67 2063 6f6d  on. Assuming com
+0001a3b0: 7061 7469 626c 6522 2c0a 2020 2020 2020  patible",.      
+0001a3c0: 2020 2020 2020 2020 2020 7365 7276 6572            server
+0001a3d0: 5f76 6572 7369 6f6e 3d73 6572 7665 725f  _version=server_
+0001a3e0: 7665 7273 696f 6e2c 0a20 2020 2020 2020  version,.       
+0001a3f0: 2020 2020 2020 2020 2063 6c69 656e 745f           client_
+0001a400: 7665 7273 696f 6e3d 636c 6965 6e74 5f76  version=client_v
+0001a410: 6572 7369 6f6e 2c0a 2020 2020 2020 2020  ersion,.        
+0001a420: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
+0001a430: 2020 7265 7475 726e 2054 7275 650a 2020    return True.  
+0001a440: 2020 2020 2020 6966 2028 7061 7273 6564        if (parsed
+0001a450: 5f73 6572 7665 725f 7665 7273 696f 6e2e  _server_version.
+0001a460: 6d61 6a6f 7220 3d3d 2030 2061 6e64 2070  major == 0 and p
+0001a470: 6172 7365 645f 7365 7276 6572 5f76 6572  arsed_server_ver
+0001a480: 7369 6f6e 2e6d 696e 6f72 203d 3d20 3029  sion.minor == 0)
+0001a490: 206f 7220 280a 2020 2020 2020 2020 2020   or (.          
+0001a4a0: 2020 7061 7273 6564 5f63 6c69 656e 745f    parsed_client_
+0001a4b0: 7665 7273 696f 6e2e 6d61 6a6f 7220 3d3d  version.major ==
+0001a4c0: 2030 2061 6e64 2070 6172 7365 645f 636c   0 and parsed_cl
+0001a4d0: 6965 6e74 5f76 6572 7369 6f6e 2e6d 696e  ient_version.min
+0001a4e0: 6f72 203d 3d20 300a 2020 2020 2020 2020  or == 0.        
+0001a4f0: 293a 0a20 2020 2020 2020 2020 2020 206c  ):.            l
+0001a500: 6f67 6765 722e 7761 726e 696e 6728 0a20  ogger.warning(. 
+0001a510: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+0001a520: 5365 7276 6572 206f 7220 636c 6965 6e74  Server or client
+0001a530: 2076 6572 7369 6f6e 2069 7320 756e 7374   version is unst
+0001a540: 6162 6c65 2e20 4173 7375 6d69 6e67 2063  able. Assuming c
+0001a550: 6f6d 7061 7469 626c 6522 2c0a 2020 2020  ompatible",.    
+0001a560: 2020 2020 2020 2020 2020 2020 7365 7276              serv
+0001a570: 6572 5f76 6572 7369 6f6e 3d73 6572 7665  er_version=serve
+0001a580: 725f 7665 7273 696f 6e2c 0a20 2020 2020  r_version,.     
+0001a590: 2020 2020 2020 2020 2020 2063 6c69 656e             clien
+0001a5a0: 745f 7665 7273 696f 6e3d 636c 6965 6e74  t_version=client
+0001a5b0: 5f76 6572 7369 6f6e 2c0a 2020 2020 2020  _version,.      
+0001a5c0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+0001a5d0: 2020 2020 7265 7475 726e 2054 7275 650a      return True.
+0001a5e0: 2020 2020 2020 2020 6966 2070 6172 7365          if parse
+0001a5f0: 645f 7365 7276 6572 5f76 6572 7369 6f6e  d_server_version
+0001a600: 2e6d 616a 6f72 2021 3d20 7061 7273 6564  .major != parsed
+0001a610: 5f63 6c69 656e 745f 7665 7273 696f 6e2e  _client_version.
+0001a620: 6d61 6a6f 723a 0a20 2020 2020 2020 2020  major:.         
+0001a630: 2020 206c 6f67 6765 722e 7761 726e 696e     logger.warnin
+0001a640: 6728 0a20 2020 2020 2020 2020 2020 2020  g(.             
+0001a650: 2020 2022 5365 7276 6572 2061 6e64 2063     "Server and c
+0001a660: 6c69 656e 7420 7665 7273 696f 6e73 2061  lient versions a
+0001a670: 7265 2069 6e63 6f6d 7061 7469 626c 6522  re incompatible"
+0001a680: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0001a690: 2020 7061 7273 6564 5f73 6572 7665 725f    parsed_server_
+0001a6a0: 7665 7273 696f 6e3d 7061 7273 6564 5f73  version=parsed_s
+0001a6b0: 6572 7665 725f 7665 7273 696f 6e2c 0a20  erver_version,. 
+0001a6c0: 2020 2020 2020 2020 2020 2020 2020 2070                 p
+0001a6d0: 6172 7365 645f 636c 6965 6e74 5f76 6572  arsed_client_ver
+0001a6e0: 7369 6f6e 3d70 6172 7365 645f 636c 6965  sion=parsed_clie
+0001a6f0: 6e74 5f76 6572 7369 6f6e 2c0a 2020 2020  nt_version,.    
+0001a700: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+0001a710: 2020 2020 2020 7265 7475 726e 2046 616c        return Fal
+0001a720: 7365 0a20 2020 2020 2020 2069 6620 7061  se.        if pa
+0001a730: 7273 6564 5f73 6572 7665 725f 7665 7273  rsed_server_vers
+0001a740: 696f 6e2e 6d69 6e6f 7220 3e20 7061 7273  ion.minor > pars
+0001a750: 6564 5f63 6c69 656e 745f 7665 7273 696f  ed_client_versio
+0001a760: 6e2e 6d69 6e6f 7220 2b20 323a 0a20 2020  n.minor + 2:.   
+0001a770: 2020 2020 2020 2020 206c 6f67 6765 722e           logger.
+0001a780: 696e 666f 280a 2020 2020 2020 2020 2020  info(.          
+0001a790: 2020 2020 2020 2242 6163 6b77 6172 6473        "Backwards
+0001a7a0: 2063 6f6d 7061 7469 6269 6c69 7479 206d   compatibility m
+0001a7b0: 6967 6874 206e 6f74 2061 7070 6c79 2062  ight not apply b
+0001a7c0: 6574 7765 656e 2074 6865 2073 6572 7665  etween the serve
+0001a7d0: 7220 616e 6420 636c 6965 6e74 2076 6572  r and client ver
+0001a7e0: 7369 6f6e 222c 0a20 2020 2020 2020 2020  sion",.         
+0001a7f0: 2020 2020 2020 2070 6172 7365 645f 7365         parsed_se
+0001a800: 7276 6572 5f76 6572 7369 6f6e 3d70 6172  rver_version=par
+0001a810: 7365 645f 7365 7276 6572 5f76 6572 7369  sed_server_versi
+0001a820: 6f6e 2c0a 2020 2020 2020 2020 2020 2020  on,.            
+0001a830: 2020 2020 7061 7273 6564 5f63 6c69 656e      parsed_clien
+0001a840: 745f 7665 7273 696f 6e3d 7061 7273 6564  t_version=parsed
+0001a850: 5f63 6c69 656e 745f 7665 7273 696f 6e2c  _client_version,
+0001a860: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
+0001a870: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+0001a880: 6e20 4661 6c73 650a 2020 2020 2020 2020  n False.        
+0001a890: 6966 2070 6172 7365 645f 636c 6965 6e74  if parsed_client
+0001a8a0: 5f76 6572 7369 6f6e 2e6d 696e 6f72 203e  _version.minor >
+0001a8b0: 2070 6172 7365 645f 7365 7276 6572 5f76   parsed_server_v
+0001a8c0: 6572 7369 6f6e 2e6d 696e 6f72 3a0a 2020  ersion.minor:.  
+0001a8d0: 2020 2020 2020 2020 2020 6c6f 6767 6572            logger
+0001a8e0: 2e77 6172 6e69 6e67 280a 2020 2020 2020  .warning(.      
+0001a8f0: 2020 2020 2020 2020 2020 2243 6c69 656e            "Clien
+0001a900: 7420 7665 7273 696f 6e20 7769 7468 2068  t version with h
+0001a910: 6967 6865 7220 7665 7273 696f 6e20 7468  igher version th
+0001a920: 616e 2073 6572 7665 7220 7665 7273 696f  an server versio
+0001a930: 6e20 6973 6e27 7420 7375 7070 6f72 7465  n isn't supporte
+0001a940: 642c 220a 2020 2020 2020 2020 2020 2020  d,".            
+0001a950: 2020 2020 2220 616c 6967 6e20 796f 7572      " align your
+0001a960: 2063 6c69 656e 7420 746f 2074 6865 2073   client to the s
+0001a970: 6572 7665 7220 7665 7273 696f 6e22 2c0a  erver version",.
+0001a980: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001a990: 7061 7273 6564 5f73 6572 7665 725f 7665  parsed_server_ve
+0001a9a0: 7273 696f 6e3d 7061 7273 6564 5f73 6572  rsion=parsed_ser
+0001a9b0: 7665 725f 7665 7273 696f 6e2c 0a20 2020  ver_version,.   
+0001a9c0: 2020 2020 2020 2020 2020 2020 2070 6172               par
+0001a9d0: 7365 645f 636c 6965 6e74 5f76 6572 7369  sed_client_versi
+0001a9e0: 6f6e 3d70 6172 7365 645f 636c 6965 6e74  on=parsed_client
+0001a9f0: 5f76 6572 7369 6f6e 2c0a 2020 2020 2020  _version,.      
+0001aa00: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+0001aa10: 2020 2020 7265 7475 726e 2046 616c 7365      return False
+0001aa20: 0a20 2020 2020 2020 2069 6620 7061 7273  .        if pars
+0001aa30: 6564 5f73 6572 7665 725f 7665 7273 696f  ed_server_versio
+0001aa40: 6e2e 6d69 6e6f 7220 213d 2070 6172 7365  n.minor != parse
+0001aa50: 645f 636c 6965 6e74 5f76 6572 7369 6f6e  d_client_version
+0001aa60: 2e6d 696e 6f72 3a0a 2020 2020 2020 2020  .minor:.        
+0001aa70: 2020 2020 6c6f 6767 6572 2e69 6e66 6f28      logger.info(
+0001aa80: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001aa90: 2022 5365 7276 6572 2061 6e64 2063 6c69   "Server and cli
+0001aaa0: 656e 7420 7665 7273 696f 6e73 2061 7265  ent versions are
+0001aab0: 206e 6f74 2074 6865 2073 616d 6520 6275   not the same bu
+0001aac0: 7420 636f 6d70 6174 6962 6c65 222c 0a20  t compatible",. 
+0001aad0: 2020 2020 2020 2020 2020 2020 2020 2070                 p
+0001aae0: 6172 7365 645f 7365 7276 6572 5f76 6572  arsed_server_ver
+0001aaf0: 7369 6f6e 3d70 6172 7365 645f 7365 7276  sion=parsed_serv
+0001ab00: 6572 5f76 6572 7369 6f6e 2c0a 2020 2020  er_version,.    
+0001ab10: 2020 2020 2020 2020 2020 2020 7061 7273              pars
+0001ab20: 6564 5f63 6c69 656e 745f 7665 7273 696f  ed_client_versio
+0001ab30: 6e3d 7061 7273 6564 5f63 6c69 656e 745f  n=parsed_client_
+0001ab40: 7665 7273 696f 6e2c 0a20 2020 2020 2020  version,.       
+0001ab50: 2020 2020 2029 0a20 2020 2020 2020 2072       ).        r
+0001ab60: 6574 7572 6e20 5472 7565 0a0a 2020 2020  eturn True..    
+0001ab70: 6465 6620 6372 6561 7465 5f6d 6f64 656c  def create_model
+0001ab80: 5f65 6e64 706f 696e 7428 0a20 2020 2020  _endpoint(.     
+0001ab90: 2020 2073 656c 662c 0a20 2020 2020 2020     self,.       
+0001aba0: 2070 726f 6a65 6374 3a20 7374 722c 0a20   project: str,. 
+0001abb0: 2020 2020 2020 2065 6e64 706f 696e 745f         endpoint_
+0001abc0: 6964 3a20 7374 722c 0a20 2020 2020 2020  id: str,.       
+0001abd0: 206d 6f64 656c 5f65 6e64 706f 696e 743a   model_endpoint:
+0001abe0: 2055 6e69 6f6e 5b0a 2020 2020 2020 2020   Union[.        
+0001abf0: 2020 2020 6d6c 7275 6e2e 6d6f 6465 6c5f      mlrun.model_
+0001ac00: 6d6f 6e69 746f 7269 6e67 2e6d 6f64 656c  monitoring.model
+0001ac10: 5f65 6e64 706f 696e 742e 4d6f 6465 6c45  _endpoint.ModelE
+0001ac20: 6e64 706f 696e 742c 2064 6963 740a 2020  ndpoint, dict.  
+0001ac30: 2020 2020 2020 5d2c 0a20 2020 2029 3a0a        ],.    ):.
+0001ac40: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+0001ac50: 2020 2020 4372 6561 7465 7320 6120 4442      Creates a DB
+0001ac60: 2072 6563 6f72 6420 7769 7468 2074 6865   record with the
+0001ac70: 2067 6976 656e 206d 6f64 656c 5f65 6e64   given model_end
+0001ac80: 706f 696e 7420 7265 636f 7264 2e0a 0a20  point record... 
+0001ac90: 2020 2020 2020 203a 7061 7261 6d20 7072         :param pr
+0001aca0: 6f6a 6563 743a 2054 6865 206e 616d 6520  oject: The name 
+0001acb0: 6f66 2074 6865 2070 726f 6a65 6374 2e0a  of the project..
+0001acc0: 2020 2020 2020 2020 3a70 6172 616d 2065          :param e
+0001acd0: 6e64 706f 696e 745f 6964 3a20 5468 6520  ndpoint_id: The 
+0001ace0: 6964 206f 6620 7468 6520 656e 6470 6f69  id of the endpoi
+0001acf0: 6e74 2e0a 2020 2020 2020 2020 3a70 6172  nt..        :par
+0001ad00: 616d 206d 6f64 656c 5f65 6e64 706f 696e  am model_endpoin
+0001ad10: 743a 2041 6e20 6f62 6a65 6374 2072 6570  t: An object rep
+0001ad20: 7265 7365 6e74 696e 6720 7468 6520 6d6f  resenting the mo
+0001ad30: 6465 6c20 656e 6470 6f69 6e74 2e0a 2020  del endpoint..  
+0001ad40: 2020 2020 2020 2222 220a 0a20 2020 2020        """..     
+0001ad50: 2020 2069 6620 6973 696e 7374 616e 6365     if isinstance
+0001ad60: 280a 2020 2020 2020 2020 2020 2020 6d6f  (.            mo
+0001ad70: 6465 6c5f 656e 6470 6f69 6e74 2c20 6d6c  del_endpoint, ml
+0001ad80: 7275 6e2e 6d6f 6465 6c5f 6d6f 6e69 746f  run.model_monito
+0001ad90: 7269 6e67 2e6d 6f64 656c 5f65 6e64 706f  ring.model_endpo
+0001ada0: 696e 742e 4d6f 6465 6c45 6e64 706f 696e  int.ModelEndpoin
+0001adb0: 740a 2020 2020 2020 2020 293a 0a20 2020  t.        ):.   
+0001adc0: 2020 2020 2020 2020 206d 6f64 656c 5f65           model_e
+0001add0: 6e64 706f 696e 7420 3d20 6d6f 6465 6c5f  ndpoint = model_
+0001ade0: 656e 6470 6f69 6e74 2e74 6f5f 6469 6374  endpoint.to_dict
+0001adf0: 2829 0a0a 2020 2020 2020 2020 7061 7468  ()..        path
+0001ae00: 203d 2066 2270 726f 6a65 6374 732f 7b70   = f"projects/{p
+0001ae10: 726f 6a65 6374 7d2f 6d6f 6465 6c2d 656e  roject}/model-en
+0001ae20: 6470 6f69 6e74 732f 7b65 6e64 706f 696e  dpoints/{endpoin
+0001ae30: 745f 6964 7d22 0a20 2020 2020 2020 2073  t_id}".        s
+0001ae40: 656c 662e 6170 695f 6361 6c6c 280a 2020  elf.api_call(.  
+0001ae50: 2020 2020 2020 2020 2020 6d65 7468 6f64            method
+0001ae60: 3d22 504f 5354 222c 0a20 2020 2020 2020  ="POST",.       
+0001ae70: 2020 2020 2070 6174 683d 7061 7468 2c0a       path=path,.
+0001ae80: 2020 2020 2020 2020 2020 2020 626f 6479              body
+0001ae90: 3d64 6963 745f 746f 5f6a 736f 6e28 6d6f  =dict_to_json(mo
+0001aea0: 6465 6c5f 656e 6470 6f69 6e74 292c 0a20  del_endpoint),. 
+0001aeb0: 2020 2020 2020 2029 0a0a 2020 2020 6465         )..    de
+0001aec0: 6620 6465 6c65 7465 5f6d 6f64 656c 5f65  f delete_model_e
+0001aed0: 6e64 706f 696e 7428 0a20 2020 2020 2020  ndpoint(.       
+0001aee0: 2073 656c 662c 0a20 2020 2020 2020 2070   self,.        p
+0001aef0: 726f 6a65 6374 3a20 7374 722c 0a20 2020  roject: str,.   
+0001af00: 2020 2020 2065 6e64 706f 696e 745f 6964       endpoint_id
+0001af10: 3a20 7374 722c 0a20 2020 2029 3a0a 2020  : str,.    ):.  
+0001af20: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+0001af30: 2020 4465 6c65 7465 7320 7468 6520 4442    Deletes the DB
+0001af40: 2072 6563 6f72 6420 6f66 2061 2067 6976   record of a giv
+0001af50: 656e 206d 6f64 656c 2065 6e64 706f 696e  en model endpoin
+0001af60: 742c 2070 726f 6a65 6374 2061 6e64 2065  t, project and e
+0001af70: 6e64 706f 696e 745f 6964 2061 7265 2075  ndpoint_id are u
+0001af80: 7365 6420 666f 7220 6c6f 6f6b 7570 0a0a  sed for lookup..
+0001af90: 2020 2020 2020 2020 3a70 6172 616d 2070          :param p
+0001afa0: 726f 6a65 6374 3a20 5468 6520 6e61 6d65  roject: The name
+0001afb0: 206f 6620 7468 6520 7072 6f6a 6563 740a   of the project.
+0001afc0: 2020 2020 2020 2020 3a70 6172 616d 2065          :param e
+0001afd0: 6e64 706f 696e 745f 6964 3a20 5468 6520  ndpoint_id: The 
+0001afe0: 6964 206f 6620 7468 6520 656e 6470 6f69  id of the endpoi
+0001aff0: 6e74 0a20 2020 2020 2020 2022 2222 0a0a  nt.        """..
+0001b000: 2020 2020 2020 2020 7061 7468 203d 2066          path = f
+0001b010: 2270 726f 6a65 6374 732f 7b70 726f 6a65  "projects/{proje
+0001b020: 6374 7d2f 6d6f 6465 6c2d 656e 6470 6f69  ct}/model-endpoi
+0001b030: 6e74 732f 7b65 6e64 706f 696e 745f 6964  nts/{endpoint_id
+0001b040: 7d22 0a20 2020 2020 2020 2073 656c 662e  }".        self.
+0001b050: 6170 695f 6361 6c6c 280a 2020 2020 2020  api_call(.      
+0001b060: 2020 2020 2020 6d65 7468 6f64 3d22 4445        method="DE
+0001b070: 4c45 5445 222c 0a20 2020 2020 2020 2020  LETE",.         
+0001b080: 2020 2070 6174 683d 7061 7468 2c0a 2020     path=path,.  
+0001b090: 2020 2020 2020 290a 0a20 2020 2064 6566        )..    def
+0001b0a0: 206c 6973 745f 6d6f 6465 6c5f 656e 6470   list_model_endp
+0001b0b0: 6f69 6e74 7328 0a20 2020 2020 2020 2073  oints(.        s
+0001b0c0: 656c 662c 0a20 2020 2020 2020 2070 726f  elf,.        pro
+0001b0d0: 6a65 6374 3a20 7374 722c 0a20 2020 2020  ject: str,.     
+0001b0e0: 2020 206d 6f64 656c 3a20 4f70 7469 6f6e     model: Option
+0001b0f0: 616c 5b73 7472 5d20 3d20 4e6f 6e65 2c0a  al[str] = None,.
+0001b100: 2020 2020 2020 2020 6675 6e63 7469 6f6e          function
+0001b110: 3a20 4f70 7469 6f6e 616c 5b73 7472 5d20  : Optional[str] 
+0001b120: 3d20 4e6f 6e65 2c0a 2020 2020 2020 2020  = None,.        
+0001b130: 6c61 6265 6c73 3a20 4c69 7374 5b73 7472  labels: List[str
+0001b140: 5d20 3d20 4e6f 6e65 2c0a 2020 2020 2020  ] = None,.      
+0001b150: 2020 7374 6172 743a 2073 7472 203d 2022    start: str = "
+0001b160: 6e6f 772d 3168 222c 0a20 2020 2020 2020  now-1h",.       
+0001b170: 2065 6e64 3a20 7374 7220 3d20 226e 6f77   end: str = "now
+0001b180: 222c 0a20 2020 2020 2020 206d 6574 7269  ",.        metri
+0001b190: 6373 3a20 4f70 7469 6f6e 616c 5b4c 6973  cs: Optional[Lis
+0001b1a0: 745b 7374 725d 5d20 3d20 4e6f 6e65 2c0a  t[str]] = None,.
+0001b1b0: 2020 2020 2020 2020 746f 705f 6c65 7665          top_leve
+0001b1c0: 6c3a 2062 6f6f 6c20 3d20 4661 6c73 652c  l: bool = False,
+0001b1d0: 0a20 2020 2020 2020 2075 6964 733a 204f  .        uids: O
+0001b1e0: 7074 696f 6e61 6c5b 4c69 7374 5b73 7472  ptional[List[str
+0001b1f0: 5d5d 203d 204e 6f6e 652c 0a20 2020 2029  ]] = None,.    )
+0001b200: 202d 3e20 4c69 7374 5b6d 6c72 756e 2e6d   -> List[mlrun.m
+0001b210: 6f64 656c 5f6d 6f6e 6974 6f72 696e 672e  odel_monitoring.
+0001b220: 6d6f 6465 6c5f 656e 6470 6f69 6e74 2e4d  model_endpoint.M
+0001b230: 6f64 656c 456e 6470 6f69 6e74 5d3a 0a20  odelEndpoint]:. 
+0001b240: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+0001b250: 2020 2052 6574 7572 6e73 2061 206c 6973     Returns a lis
+0001b260: 7420 6f66 204d 6f64 656c 456e 6470 6f69  t of ModelEndpoi
+0001b270: 6e74 5374 6174 6520 6f62 6a65 6374 732e  ntState objects.
+0001b280: 2045 6163 6820 6f62 6a65 6374 2072 6570   Each object rep
+0001b290: 7265 7365 6e74 7320 7468 6520 6375 7272  resents the curr
+0001b2a0: 656e 7420 7374 6174 6520 6f66 2061 206d  ent state of a m
+0001b2b0: 6f64 656c 2065 6e64 706f 696e 742e 0a20  odel endpoint.. 
+0001b2c0: 2020 2020 2020 2054 6869 7320 6675 6e63         This func
+0001b2d0: 7469 6f6e 7320 7375 7070 6f72 7473 2066  tions supports f
+0001b2e0: 696c 7465 7269 6e67 2062 7920 7468 6520  iltering by the 
+0001b2f0: 666f 6c6c 6f77 696e 6720 7061 7261 6d65  following parame
+0001b300: 7465 7273 3a0a 2020 2020 2020 2020 3129  ters:.        1)
+0001b310: 206d 6f64 656c 0a20 2020 2020 2020 2032   model.        2
+0001b320: 2920 6675 6e63 7469 6f6e 0a20 2020 2020  ) function.     
+0001b330: 2020 2033 2920 6c61 6265 6c73 0a20 2020     3) labels.   
+0001b340: 2020 2020 2042 7920 6465 6661 756c 742c       By default,
+0001b350: 2077 6865 6e20 6e6f 2066 696c 7465 7273   when no filters
+0001b360: 2061 7265 2061 7070 6c69 6564 2c20 616c   are applied, al
+0001b370: 6c20 6176 6169 6c61 626c 6520 656e 6470  l available endp
+0001b380: 6f69 6e74 7320 666f 7220 7468 6520 6769  oints for the gi
+0001b390: 7665 6e20 7072 6f6a 6563 7420 7769 6c6c  ven project will
+0001b3a0: 2062 6520 6c69 7374 6564 2e0a 0a20 2020   be listed...   
+0001b3b0: 2020 2020 2049 6e20 6164 6469 7469 6f6e       In addition
+0001b3c0: 2c20 7468 6973 2066 756e 6374 696f 6e73  , this functions
+0001b3d0: 2070 726f 7669 6465 7320 6120 6661 6361   provides a faca
+0001b3e0: 6465 2066 6f72 206c 6973 7469 6e67 2065  de for listing e
+0001b3f0: 6e64 706f 696e 7420 7265 6c61 7465 6420  ndpoint related 
+0001b400: 6d65 7472 6963 732e 2054 6869 7320 6661  metrics. This fa
+0001b410: 6361 6465 2069 7320 7469 6d65 2d62 6173  cade is time-bas
+0001b420: 6564 0a20 2020 2020 2020 2061 6e64 2064  ed.        and d
+0001b430: 6570 656e 6473 206f 6e20 7468 6520 2773  epends on the 's
+0001b440: 7461 7274 2720 616e 6420 2765 6e64 2720  tart' and 'end' 
+0001b450: 7061 7261 6d65 7465 7273 2e20 4279 2064  parameters. By d
+0001b460: 6566 6175 6c74 2c20 7768 656e 2074 6865  efault, when the
+0001b470: 206d 6574 7269 6373 2070 6172 616d 6574   metrics paramet
+0001b480: 6572 2069 7320 4e6f 6e65 2c20 6e6f 206d  er is None, no m
+0001b490: 6574 7269 6373 2061 7265 0a20 2020 2020  etrics are.     
+0001b4a0: 2020 2061 6464 6564 2074 6f20 7468 6520     added to the 
+0001b4b0: 6f75 7470 7574 206f 6620 7468 6973 2066  output of this f
+0001b4c0: 756e 6374 696f 6e2e 0a0a 2020 2020 2020  unction...      
+0001b4d0: 2020 3a70 6172 616d 2070 726f 6a65 6374    :param project
+0001b4e0: 3a20 5468 6520 6e61 6d65 206f 6620 7468  : The name of th
+0001b4f0: 6520 7072 6f6a 6563 740a 2020 2020 2020  e project.      
+0001b500: 2020 3a70 6172 616d 206d 6f64 656c 3a20    :param model: 
+0001b510: 5468 6520 6e61 6d65 206f 6620 7468 6520  The name of the 
+0001b520: 6d6f 6465 6c20 746f 2066 696c 7465 7220  model to filter 
+0001b530: 6279 0a20 2020 2020 2020 203a 7061 7261  by.        :para
+0001b540: 6d20 6675 6e63 7469 6f6e 3a20 5468 6520  m function: The 
+0001b550: 6e61 6d65 206f 6620 7468 6520 6675 6e63  name of the func
+0001b560: 7469 6f6e 2074 6f20 6669 6c74 6572 2062  tion to filter b
+0001b570: 790a 2020 2020 2020 2020 3a70 6172 616d  y.        :param
+0001b580: 206c 6162 656c 733a 2041 206c 6973 7420   labels: A list 
+0001b590: 6f66 206c 6162 656c 7320 746f 2066 696c  of labels to fil
+0001b5a0: 7465 7220 6279 2e20 4c61 6265 6c20 6669  ter by. Label fi
+0001b5b0: 6c74 6572 7320 776f 726b 2062 7920 6569  lters work by ei
+0001b5c0: 7468 6572 2066 696c 7465 7269 6e67 2061  ther filtering a
+0001b5d0: 2073 7065 6369 6669 6320 7661 6c75 6520   specific value 
+0001b5e0: 6f66 2061 0a20 2020 2020 2020 2020 6c61  of a.         la
+0001b5f0: 6265 6c20 2869 2e65 2e20 6c69 7374 2822  bel (i.e. list("
+0001b600: 6b65 793d 7661 6c75 6522 2929 206f 7220  key=value")) or 
+0001b610: 6279 206c 6f6f 6b69 6e67 2066 6f72 2074  by looking for t
+0001b620: 6865 2065 7869 7374 656e 6365 206f 6620  he existence of 
+0001b630: 6120 6769 7665 6e20 6b65 7920 2869 2e65  a given key (i.e
+0001b640: 2e20 226b 6579 2229 0a20 2020 2020 2020  . "key").       
+0001b650: 203a 7061 7261 6d20 6d65 7472 6963 733a   :param metrics:
+0001b660: 2041 206c 6973 7420 6f66 206d 6574 7269   A list of metri
+0001b670: 6373 2074 6f20 7265 7475 726e 2066 6f72  cs to return for
+0001b680: 2065 6163 6820 656e 6470 6f69 6e74 2c20   each endpoint, 
+0001b690: 7265 6164 206d 6f72 6520 696e 2027 5469  read more in 'Ti
+0001b6a0: 6d65 4d65 7472 6963 270a 2020 2020 2020  meMetric'.      
+0001b6b0: 2020 3a70 6172 616d 2073 7461 7274 3a20    :param start: 
+0001b6c0: 5468 6520 7374 6172 7420 7469 6d65 206f  The start time o
+0001b6d0: 6620 7468 6520 6d65 7472 6963 732e 2043  f the metrics. C
+0001b6e0: 616e 2062 6520 7265 7072 6573 656e 7465  an be represente
+0001b6f0: 6420 6279 2061 2073 7472 696e 6720 636f  d by a string co
+0001b700: 6e74 6169 6e69 6e67 2061 6e20 5246 4320  ntaining an RFC 
+0001b710: 3333 3339 0a20 2020 2020 2020 2020 2020  3339.           
+0001b720: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b730: 2020 2020 2020 7469 6d65 2c20 6120 556e        time, a Un
+0001b740: 6978 2074 696d 6573 7461 6d70 2069 6e20  ix timestamp in 
+0001b750: 6d69 6c6c 6973 6563 6f6e 6473 2c20 6120  milliseconds, a 
+0001b760: 7265 6c61 7469 7665 2074 696d 6520 2860  relative time (`
+0001b770: 276e 6f77 2760 206f 720a 2020 2020 2020  'now'` or.      
+0001b780: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b790: 2020 2020 2020 2020 2020 2060 276e 6f77             `'now
+0001b7a0: 2d5b 302d 395d 2b5b 6d68 645d 2760 2c20  -[0-9]+[mhd]'`, 
+0001b7b0: 7768 6572 6520 606d 6020 3d20 6d69 6e75  where `m` = minu
+0001b7c0: 7465 732c 2060 6860 203d 2068 6f75 7273  tes, `h` = hours
+0001b7d0: 2c20 616e 6420 6027 6427 6020 3d0a 2020  , and `'d'` =.  
+0001b7e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b7f0: 2020 2020 2020 2020 2020 2020 2020 2064                 d
+0001b800: 6179 7329 2c20 6f72 2030 2066 6f72 2074  ays), or 0 for t
+0001b810: 6865 2065 6172 6c69 6573 7420 7469 6d65  he earliest time
+0001b820: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
+0001b830: 2065 6e64 3a20 5468 6520 656e 6420 7469   end: The end ti
+0001b840: 6d65 206f 6620 7468 6520 6d65 7472 6963  me of the metric
+0001b850: 732e 2043 616e 2062 6520 7265 7072 6573  s. Can be repres
+0001b860: 656e 7465 6420 6279 2061 2073 7472 696e  ented by a strin
+0001b870: 6720 636f 6e74 6169 6e69 6e67 2061 6e20  g containing an 
+0001b880: 5246 4320 3333 3339 0a20 2020 2020 2020  RFC 3339.       
+0001b890: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b8a0: 2020 2020 2020 2020 2020 7469 6d65 2c20            time, 
+0001b8b0: 6120 556e 6978 2074 696d 6573 7461 6d70  a Unix timestamp
+0001b8c0: 2069 6e20 6d69 6c6c 6973 6563 6f6e 6473   in milliseconds
+0001b8d0: 2c20 6120 7265 6c61 7469 7665 2074 696d  , a relative tim
+0001b8e0: 6520 2860 276e 6f77 2760 206f 720a 2020  e (`'now'` or.  
+0001b8f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b900: 2020 2020 2020 2020 2020 2020 2020 2060                 `
+0001b910: 276e 6f77 2d5b 302d 395d 2b5b 6d68 645d  'now-[0-9]+[mhd]
+0001b920: 2760 2c20 7768 6572 6520 606d 6020 3d20  '`, where `m` = 
+0001b930: 6d69 6e75 7465 732c 2060 6860 203d 2068  minutes, `h` = h
+0001b940: 6f75 7273 2c20 616e 6420 6027 6427 6020  ours, and `'d'` 
+0001b950: 3d0a 2020 2020 2020 2020 2020 2020 2020  =.              
+0001b960: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b970: 2020 2064 6179 7329 2c20 6f72 2030 2066     days), or 0 f
+0001b980: 6f72 2074 6865 2065 6172 6c69 6573 7420  or the earliest 
+0001b990: 7469 6d65 2e0a 2020 2020 2020 2020 3a70  time..        :p
+0001b9a0: 6172 616d 2074 6f70 5f6c 6576 656c 3a20  aram top_level: 
+0001b9b0: 6966 2074 7275 6520 7769 6c6c 2072 6574  if true will ret
+0001b9c0: 7572 6e20 6f6e 6c79 2072 6f75 7465 7273  urn only routers
+0001b9d0: 2061 6e64 2065 6e64 706f 696e 7420 7468   and endpoint th
+0001b9e0: 6174 2061 7265 204e 4f54 2063 6869 6c64  at are NOT child
+0001b9f0: 7265 6e20 6f66 2061 6e79 2072 6f75 7465  ren of any route
+0001ba00: 720a 2020 2020 2020 2020 3a70 6172 616d  r.        :param
+0001ba10: 2075 6964 733a 2069 6620 7061 7373 6564   uids: if passed
+0001ba20: 2077 696c 6c20 7265 7475 726e 2060 4d6f   will return `Mo
+0001ba30: 6465 6c45 6e64 706f 696e 744c 6973 7460  delEndpointList`
+0001ba40: 206f 6620 656e 6470 6f69 6e74 7320 7769   of endpoints wi
+0001ba50: 7468 2075 6964 2069 6e20 7569 6473 0a20  th uid in uids. 
+0001ba60: 2020 2020 2020 2022 2222 0a0a 2020 2020         """..    
+0001ba70: 2020 2020 7061 7468 203d 2066 2270 726f      path = f"pro
+0001ba80: 6a65 6374 732f 7b70 726f 6a65 6374 7d2f  jects/{project}/
+0001ba90: 6d6f 6465 6c2d 656e 6470 6f69 6e74 7322  model-endpoints"
+0001baa0: 0a0a 2020 2020 2020 2020 6966 206c 6162  ..        if lab
+0001bab0: 656c 7320 616e 6420 6973 696e 7374 616e  els and isinstan
+0001bac0: 6365 286c 6162 656c 732c 2064 6963 7429  ce(labels, dict)
+0001bad0: 3a0a 2020 2020 2020 2020 2020 2020 6c61  :.            la
+0001bae0: 6265 6c73 203d 205b 6622 7b6b 6579 7d3d  bels = [f"{key}=
+0001baf0: 7b76 616c 7565 7d22 2066 6f72 206b 6579  {value}" for key
+0001bb00: 2c20 7661 6c75 6520 696e 206c 6162 656c  , value in label
+0001bb10: 732e 6974 656d 7328 295d 0a0a 2020 2020  s.items()]..    
+0001bb20: 2020 2020 7265 7370 6f6e 7365 203d 2073      response = s
+0001bb30: 656c 662e 6170 695f 6361 6c6c 280a 2020  elf.api_call(.  
+0001bb40: 2020 2020 2020 2020 2020 6d65 7468 6f64            method
+0001bb50: 3d22 4745 5422 2c0a 2020 2020 2020 2020  ="GET",.        
+0001bb60: 2020 2020 7061 7468 3d70 6174 682c 0a20      path=path,. 
+0001bb70: 2020 2020 2020 2020 2020 2070 6172 616d             param
+0001bb80: 733d 7b0a 2020 2020 2020 2020 2020 2020  s={.            
+0001bb90: 2020 2020 226d 6f64 656c 223a 206d 6f64      "model": mod
+0001bba0: 656c 2c0a 2020 2020 2020 2020 2020 2020  el,.            
+0001bbb0: 2020 2020 2266 756e 6374 696f 6e22 3a20      "function": 
+0001bbc0: 6675 6e63 7469 6f6e 2c0a 2020 2020 2020  function,.      
+0001bbd0: 2020 2020 2020 2020 2020 226c 6162 656c            "label
+0001bbe0: 223a 206c 6162 656c 7320 6f72 205b 5d2c  ": labels or [],
+0001bbf0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001bc00: 2022 7374 6172 7422 3a20 7374 6172 742c   "start": start,
+0001bc10: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001bc20: 2022 656e 6422 3a20 656e 642c 0a20 2020   "end": end,.   
+0001bc30: 2020 2020 2020 2020 2020 2020 2022 6d65               "me
+0001bc40: 7472 6963 223a 206d 6574 7269 6373 206f  tric": metrics o
+0001bc50: 7220 5b5d 2c0a 2020 2020 2020 2020 2020  r [],.          
+0001bc60: 2020 2020 2020 2274 6f70 2d6c 6576 656c        "top-level
+0001bc70: 223a 2074 6f70 5f6c 6576 656c 2c0a 2020  ": top_level,.  
+0001bc80: 2020 2020 2020 2020 2020 2020 2020 2275                "u
+0001bc90: 6964 223a 2075 6964 732c 0a20 2020 2020  id": uids,.     
+0001bca0: 2020 2020 2020 207d 2c0a 2020 2020 2020         },.      
+0001bcb0: 2020 290a 0a20 2020 2020 2020 2023 2047    )..        # G
+0001bcc0: 656e 6572 6174 6520 6120 6c69 7374 206f  enerate a list o
+0001bcd0: 6620 6120 6d6f 6465 6c20 656e 6470 6f69  f a model endpoi
+0001bce0: 6e74 2064 6963 7469 6f6e 6172 6965 730a  nt dictionaries.
+0001bcf0: 2020 2020 2020 2020 6d6f 6465 6c5f 656e          model_en
+0001bd00: 6470 6f69 6e74 7320 3d20 7265 7370 6f6e  dpoints = respon
+0001bd10: 7365 2e6a 736f 6e28 295b 2265 6e64 706f  se.json()["endpo
+0001bd20: 696e 7473 225d 0a20 2020 2020 2020 2069  ints"].        i
+0001bd30: 6620 6d6f 6465 6c5f 656e 6470 6f69 6e74  f model_endpoint
+0001bd40: 733a 0a20 2020 2020 2020 2020 2020 2072  s:.            r
+0001bd50: 6574 7572 6e20 5b0a 2020 2020 2020 2020  eturn [.        
+0001bd60: 2020 2020 2020 2020 6d6c 7275 6e2e 6d6f          mlrun.mo
+0001bd70: 6465 6c5f 6d6f 6e69 746f 7269 6e67 2e6d  del_monitoring.m
+0001bd80: 6f64 656c 5f65 6e64 706f 696e 742e 4d6f  odel_endpoint.Mo
+0001bd90: 6465 6c45 6e64 706f 696e 742e 6672 6f6d  delEndpoint.from
+0001bda0: 5f64 6963 7428 6f62 6a29 0a20 2020 2020  _dict(obj).     
+0001bdb0: 2020 2020 2020 2020 2020 2066 6f72 206f             for o
+0001bdc0: 626a 2069 6e20 6d6f 6465 6c5f 656e 6470  bj in model_endp
+0001bdd0: 6f69 6e74 730a 2020 2020 2020 2020 2020  oints.          
+0001bde0: 2020 5d0a 2020 2020 2020 2020 7265 7475    ].        retu
+0001bdf0: 726e 205b 5d0a 0a20 2020 2064 6566 2067  rn []..    def g
+0001be00: 6574 5f6d 6f64 656c 5f65 6e64 706f 696e  et_model_endpoin
+0001be10: 7428 0a20 2020 2020 2020 2073 656c 662c  t(.        self,
+0001be20: 0a20 2020 2020 2020 2070 726f 6a65 6374  .        project
+0001be30: 3a20 7374 722c 0a20 2020 2020 2020 2065  : str,.        e
+0001be40: 6e64 706f 696e 745f 6964 3a20 7374 722c  ndpoint_id: str,
+0001be50: 0a20 2020 2020 2020 2073 7461 7274 3a20  .        start: 
+0001be60: 4f70 7469 6f6e 616c 5b73 7472 5d20 3d20  Optional[str] = 
+0001be70: 4e6f 6e65 2c0a 2020 2020 2020 2020 656e  None,.        en
+0001be80: 643a 204f 7074 696f 6e61 6c5b 7374 725d  d: Optional[str]
+0001be90: 203d 204e 6f6e 652c 0a20 2020 2020 2020   = None,.       
+0001bea0: 206d 6574 7269 6373 3a20 4f70 7469 6f6e   metrics: Option
+0001beb0: 616c 5b4c 6973 745b 7374 725d 5d20 3d20  al[List[str]] = 
+0001bec0: 4e6f 6e65 2c0a 2020 2020 2020 2020 6665  None,.        fe
+0001bed0: 6174 7572 655f 616e 616c 7973 6973 3a20  ature_analysis: 
+0001bee0: 626f 6f6c 203d 2046 616c 7365 2c0a 2020  bool = False,.  
+0001bef0: 2020 2920 2d3e 206d 6c72 756e 2e6d 6f64    ) -> mlrun.mod
+0001bf00: 656c 5f6d 6f6e 6974 6f72 696e 672e 6d6f  el_monitoring.mo
+0001bf10: 6465 6c5f 656e 6470 6f69 6e74 2e4d 6f64  del_endpoint.Mod
+0001bf20: 656c 456e 6470 6f69 6e74 3a0a 2020 2020  elEndpoint:.    
+0001bf30: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+0001bf40: 5265 7475 726e 7320 6120 7369 6e67 6c65  Returns a single
+0001bf50: 2060 4d6f 6465 6c45 6e64 706f 696e 7460   `ModelEndpoint`
+0001bf60: 206f 626a 6563 7420 7769 7468 2061 6464   object with add
+0001bf70: 6974 696f 6e61 6c20 6d65 7472 6963 7320  itional metrics 
+0001bf80: 616e 6420 6665 6174 7572 6520 7265 6c61  and feature rela
+0001bf90: 7465 6420 6461 7461 2e0a 0a20 2020 2020  ted data...     
+0001bfa0: 2020 203a 7061 7261 6d20 7072 6f6a 6563     :param projec
+0001bfb0: 743a 2020 2020 2020 2020 2020 2020 2020  t:              
+0001bfc0: 2020 2020 2020 5468 6520 6e61 6d65 206f        The name o
+0001bfd0: 6620 7468 6520 7072 6f6a 6563 740a 2020  f the project.  
+0001bfe0: 2020 2020 2020 3a70 6172 616d 2065 6e64        :param end
+0001bff0: 706f 696e 745f 6964 3a20 2020 2020 2020  point_id:       
+0001c000: 2020 2020 2020 2020 2054 6865 2075 6e69           The uni
+0001c010: 7175 6520 6964 206f 6620 7468 6520 6d6f  que id of the mo
+0001c020: 6465 6c20 656e 6470 6f69 6e74 2e0a 2020  del endpoint..  
+0001c030: 2020 2020 2020 3a70 6172 616d 2073 7461        :param sta
+0001c040: 7274 3a20 2020 2020 2020 2020 2020 2020  rt:             
+0001c050: 2020 2020 2020 2020 2054 6865 2073 7461           The sta
+0001c060: 7274 2074 696d 6520 6f66 2074 6865 206d  rt time of the m
+0001c070: 6574 7269 6373 2e20 4361 6e20 6265 2072  etrics. Can be r
+0001c080: 6570 7265 7365 6e74 6564 2062 7920 6120  epresented by a 
+0001c090: 7374 7269 6e67 2063 6f6e 7461 696e 696e  string containin
+0001c0a0: 6720 616e 0a20 2020 2020 2020 2020 2020  g an.           
+0001c0b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0001c0c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c0d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c0e0: 2020 2020 2020 2020 2020 3020 666f 7220            0 for 
-0001c0f0: 7468 6520 6561 726c 6965 7374 2074 696d  the earliest tim
-0001c100: 652e 0a20 2020 2020 2020 203a 7061 7261  e..        :para
-0001c110: 6d20 656e 643a 2020 2020 2020 2020 2020  m end:          
-0001c120: 2020 2020 2020 2020 2020 2020 2020 5468                Th
-0001c130: 6520 656e 6420 7469 6d65 206f 6620 7468  e end time of th
-0001c140: 6520 6d65 7472 6963 732e 2043 616e 2062  e metrics. Can b
-0001c150: 6520 7265 7072 6573 656e 7465 6420 6279  e represented by
-0001c160: 2061 2073 7472 696e 6720 636f 6e74 6169   a string contai
-0001c170: 6e69 6e67 2061 6e0a 2020 2020 2020 2020  ning an.        
-0001c180: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c190: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c1a0: 2020 2052 4643 2033 3333 3920 7469 6d65     RFC 3339 time
-0001c1b0: 2c20 6120 556e 6978 2074 696d 6573 7461  , a Unix timesta
-0001c1c0: 6d70 2069 6e20 6d69 6c6c 6973 6563 6f6e  mp in millisecon
-0001c1d0: 6473 2c20 6120 7265 6c61 7469 7665 2074  ds, a relative t
-0001c1e0: 696d 6520 2860 276e 6f77 2760 206f 720a  ime (`'now'` or.
+0001c0d0: 5246 4320 3333 3339 2074 696d 652c 2061  RFC 3339 time, a
+0001c0e0: 2055 6e69 7820 7469 6d65 7374 616d 7020   Unix timestamp 
+0001c0f0: 696e 206d 696c 6c69 7365 636f 6e64 732c  in milliseconds,
+0001c100: 2061 2072 656c 6174 6976 6520 7469 6d65   a relative time
+0001c110: 2028 6027 6e6f 7727 6020 6f72 0a20 2020   (`'now'` or.   
+0001c120: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c130: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c140: 2020 2020 2020 2020 6027 6e6f 772d 5b30          `'now-[0
+0001c150: 2d39 5d2b 5b6d 6864 5d27 602c 2077 6865  -9]+[mhd]'`, whe
+0001c160: 7265 2060 6d60 203d 206d 696e 7574 6573  re `m` = minutes
+0001c170: 2c20 6068 6020 3d20 686f 7572 732c 2061  , `h` = hours, a
+0001c180: 6e64 2060 2764 2760 203d 2064 6179 7329  nd `'d'` = days)
+0001c190: 2c20 6f72 0a20 2020 2020 2020 2020 2020  , or.           
+0001c1a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c1b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c1c0: 3020 666f 7220 7468 6520 6561 726c 6965  0 for the earlie
+0001c1d0: 7374 2074 696d 652e 0a20 2020 2020 2020  st time..       
+0001c1e0: 203a 7061 7261 6d20 656e 643a 2020 2020   :param end:    
 0001c1f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c200: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c210: 2020 2020 2020 2020 2020 2060 276e 6f77             `'now
-0001c220: 2d5b 302d 395d 2b5b 6d68 645d 2760 2c20  -[0-9]+[mhd]'`, 
-0001c230: 7768 6572 6520 606d 6020 3d20 6d69 6e75  where `m` = minu
-0001c240: 7465 732c 2060 6860 203d 2068 6f75 7273  tes, `h` = hours
-0001c250: 2c20 616e 6420 6027 6427 6020 3d20 6461  , and `'d'` = da
-0001c260: 7973 292c 206f 720a 2020 2020 2020 2020  ys), or.        
-0001c270: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c280: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c290: 2020 2030 2066 6f72 2074 6865 2065 6172     0 for the ear
-0001c2a0: 6c69 6573 7420 7469 6d65 2e0a 2020 2020  liest time..    
-0001c2b0: 2020 2020 3a70 6172 616d 206d 6574 7269      :param metri
-0001c2c0: 6373 3a20 2020 2020 2020 2020 2020 2020  cs:             
-0001c2d0: 2020 2020 2020 2041 206c 6973 7420 6f66         A list of
-0001c2e0: 206d 6574 7269 6373 2074 6f20 7265 7475   metrics to retu
-0001c2f0: 726e 2066 6f72 2074 6865 206d 6f64 656c  rn for the model
-0001c300: 2065 6e64 706f 696e 742e 2054 6865 7265   endpoint. There
-0001c310: 2061 7265 2070 7265 2d64 6566 696e 6564   are pre-defined
-0001c320: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001c330: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c340: 2020 2020 2020 2020 2020 2020 6d65 7472              metr
-0001c350: 6963 7320 666f 7220 6d6f 6465 6c20 656e  ics for model en
-0001c360: 6470 6f69 6e74 7320 7375 6368 2061 7320  dpoints such as 
-0001c370: 7072 6564 6963 7469 6f6e 735f 7065 725f  predictions_per_
-0001c380: 7365 636f 6e64 2061 6e64 0a20 2020 2020  second and.     
-0001c390: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c3a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c3b0: 2020 2020 2020 6c61 7465 6e63 795f 6176        latency_av
-0001c3c0: 675f 356d 2062 7574 2061 6c73 6f20 6375  g_5m but also cu
-0001c3d0: 7374 6f6d 206d 6574 7269 6373 2064 6566  stom metrics def
-0001c3e0: 696e 6564 2062 7920 7468 6520 7573 6572  ined by the user
-0001c3f0: 2e20 506c 6561 7365 206e 6f74 6520 7468  . Please note th
-0001c400: 6174 0a20 2020 2020 2020 2020 2020 2020  at.             
+0001c200: 2020 2020 5468 6520 656e 6420 7469 6d65      The end time
+0001c210: 206f 6620 7468 6520 6d65 7472 6963 732e   of the metrics.
+0001c220: 2043 616e 2062 6520 7265 7072 6573 656e   Can be represen
+0001c230: 7465 6420 6279 2061 2073 7472 696e 6720  ted by a string 
+0001c240: 636f 6e74 6169 6e69 6e67 2061 6e0a 2020  containing an.  
+0001c250: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c260: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c270: 2020 2020 2020 2020 2052 4643 2033 3333           RFC 333
+0001c280: 3920 7469 6d65 2c20 6120 556e 6978 2074  9 time, a Unix t
+0001c290: 696d 6573 7461 6d70 2069 6e20 6d69 6c6c  imestamp in mill
+0001c2a0: 6973 6563 6f6e 6473 2c20 6120 7265 6c61  iseconds, a rela
+0001c2b0: 7469 7665 2074 696d 6520 2860 276e 6f77  tive time (`'now
+0001c2c0: 2760 206f 720a 2020 2020 2020 2020 2020  '` or.          
+0001c2d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c2e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c2f0: 2060 276e 6f77 2d5b 302d 395d 2b5b 6d68   `'now-[0-9]+[mh
+0001c300: 645d 2760 2c20 7768 6572 6520 606d 6020  d]'`, where `m` 
+0001c310: 3d20 6d69 6e75 7465 732c 2060 6860 203d  = minutes, `h` =
+0001c320: 2068 6f75 7273 2c20 616e 6420 6027 6427   hours, and `'d'
+0001c330: 6020 3d20 6461 7973 292c 206f 720a 2020  ` = days), or.  
+0001c340: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c350: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c360: 2020 2020 2020 2020 2030 2066 6f72 2074           0 for t
+0001c370: 6865 2065 6172 6c69 6573 7420 7469 6d65  he earliest time
+0001c380: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
+0001c390: 206d 6574 7269 6373 3a20 2020 2020 2020   metrics:       
+0001c3a0: 2020 2020 2020 2020 2020 2020 2041 206c               A l
+0001c3b0: 6973 7420 6f66 206d 6574 7269 6373 2074  ist of metrics t
+0001c3c0: 6f20 7265 7475 726e 2066 6f72 2074 6865  o return for the
+0001c3d0: 206d 6f64 656c 2065 6e64 706f 696e 742e   model endpoint.
+0001c3e0: 2054 6865 7265 2061 7265 2070 7265 2d64   There are pre-d
+0001c3f0: 6566 696e 6564 0a20 2020 2020 2020 2020  efined.         
+0001c400: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0001c410: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c420: 2020 2020 2020 2020 2020 2020 2020 7468                th
-0001c430: 6573 6520 6d65 7472 6963 7320 6172 6520  ese metrics are 
-0001c440: 7374 6f72 6564 2069 6e20 7468 6520 7469  stored in the ti
-0001c450: 6d65 2073 6572 6965 7320 4442 2061 6e64  me series DB and
-0001c460: 2074 6865 2072 6573 756c 7473 2077 696c   the results wil
-0001c470: 6c20 6265 0a20 2020 2020 2020 2020 2020  l be.           
-0001c480: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c490: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c4a0: 6170 7065 6172 6564 2075 6e64 6572 206d  appeared under m
-0001c4b0: 6f64 656c 5f65 6e64 706f 696e 742e 7370  odel_endpoint.sp
-0001c4c0: 6563 2e6d 6574 7269 6373 2e0a 2020 2020  ec.metrics..    
-0001c4d0: 2020 2020 3a70 6172 616d 2066 6561 7475      :param featu
-0001c4e0: 7265 5f61 6e61 6c79 7369 733a 2020 2020  re_analysis:    
-0001c4f0: 2020 2020 2020 2057 6865 6e20 5472 7565         When True
-0001c500: 2c20 7468 6520 6261 7365 2066 6561 7475  , the base featu
-0001c510: 7265 2073 7461 7469 7374 6963 7320 616e  re statistics an
-0001c520: 6420 6375 7272 656e 7420 6665 6174 7572  d current featur
-0001c530: 6520 7374 6174 6973 7469 6373 2077 696c  e statistics wil
-0001c540: 6c0a 2020 2020 2020 2020 2020 2020 2020  l.              
+0001c420: 2020 6d65 7472 6963 7320 666f 7220 6d6f    metrics for mo
+0001c430: 6465 6c20 656e 6470 6f69 6e74 7320 7375  del endpoints su
+0001c440: 6368 2061 7320 7072 6564 6963 7469 6f6e  ch as prediction
+0001c450: 735f 7065 725f 7365 636f 6e64 2061 6e64  s_per_second and
+0001c460: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001c470: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c480: 2020 2020 2020 2020 2020 2020 6c61 7465              late
+0001c490: 6e63 795f 6176 675f 356d 2062 7574 2061  ncy_avg_5m but a
+0001c4a0: 6c73 6f20 6375 7374 6f6d 206d 6574 7269  lso custom metri
+0001c4b0: 6373 2064 6566 696e 6564 2062 7920 7468  cs defined by th
+0001c4c0: 6520 7573 6572 2e20 506c 6561 7365 206e  e user. Please n
+0001c4d0: 6f74 6520 7468 6174 0a20 2020 2020 2020  ote that.       
+0001c4e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c4f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c500: 2020 2020 7468 6573 6520 6d65 7472 6963      these metric
+0001c510: 7320 6172 6520 7374 6f72 6564 2069 6e20  s are stored in 
+0001c520: 7468 6520 7469 6d65 2073 6572 6965 7320  the time series 
+0001c530: 4442 2061 6e64 2074 6865 2072 6573 756c  DB and the resul
+0001c540: 7473 2077 696c 6c20 6265 0a20 2020 2020  ts will be.     
 0001c550: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c560: 2020 2020 2020 2020 2020 2020 2062 6520               be 
-0001c570: 6164 6465 6420 746f 2074 6865 206f 7574  added to the out
-0001c580: 7075 7420 6f66 2074 6865 2072 6573 756c  put of the resul
-0001c590: 7469 6e67 206f 626a 6563 742e 0a0a 2020  ting object...  
-0001c5a0: 2020 2020 2020 3a72 6574 7572 6e3a 2041        :return: A
-0001c5b0: 2060 4d6f 6465 6c45 6e64 706f 696e 7460   `ModelEndpoint`
-0001c5c0: 206f 626a 6563 742e 0a20 2020 2020 2020   object..       
-0001c5d0: 2022 2222 0a0a 2020 2020 2020 2020 7061   """..        pa
-0001c5e0: 7468 203d 2066 2270 726f 6a65 6374 732f  th = f"projects/
-0001c5f0: 7b70 726f 6a65 6374 7d2f 6d6f 6465 6c2d  {project}/model-
-0001c600: 656e 6470 6f69 6e74 732f 7b65 6e64 706f  endpoints/{endpo
-0001c610: 696e 745f 6964 7d22 0a20 2020 2020 2020  int_id}".       
-0001c620: 2072 6573 706f 6e73 6520 3d20 7365 6c66   response = self
-0001c630: 2e61 7069 5f63 616c 6c28 0a20 2020 2020  .api_call(.     
-0001c640: 2020 2020 2020 206d 6574 686f 643d 2247         method="G
-0001c650: 4554 222c 0a20 2020 2020 2020 2020 2020  ET",.           
-0001c660: 2070 6174 683d 7061 7468 2c0a 2020 2020   path=path,.    
-0001c670: 2020 2020 2020 2020 7061 7261 6d73 3d7b          params={
-0001c680: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001c690: 2022 7374 6172 7422 3a20 7374 6172 742c   "start": start,
-0001c6a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001c6b0: 2022 656e 6422 3a20 656e 642c 0a20 2020   "end": end,.   
-0001c6c0: 2020 2020 2020 2020 2020 2020 2022 6d65               "me
-0001c6d0: 7472 6963 223a 206d 6574 7269 6373 206f  tric": metrics o
-0001c6e0: 7220 5b5d 2c0a 2020 2020 2020 2020 2020  r [],.          
-0001c6f0: 2020 2020 2020 2266 6561 7475 7265 5f61        "feature_a
-0001c700: 6e61 6c79 7369 7322 3a20 6665 6174 7572  nalysis": featur
-0001c710: 655f 616e 616c 7973 6973 2c0a 2020 2020  e_analysis,.    
-0001c720: 2020 2020 2020 2020 7d2c 0a20 2020 2020          },.     
-0001c730: 2020 2029 0a0a 2020 2020 2020 2020 7265     )..        re
-0001c740: 7475 726e 206d 6c72 756e 2e6d 6f64 656c  turn mlrun.model
-0001c750: 5f6d 6f6e 6974 6f72 696e 672e 6d6f 6465  _monitoring.mode
-0001c760: 6c5f 656e 6470 6f69 6e74 2e4d 6f64 656c  l_endpoint.Model
-0001c770: 456e 6470 6f69 6e74 2e66 726f 6d5f 6469  Endpoint.from_di
-0001c780: 6374 280a 2020 2020 2020 2020 2020 2020  ct(.            
-0001c790: 7265 7370 6f6e 7365 2e6a 736f 6e28 290a  response.json().
-0001c7a0: 2020 2020 2020 2020 290a 0a20 2020 2064          )..    d
-0001c7b0: 6566 2070 6174 6368 5f6d 6f64 656c 5f65  ef patch_model_e
-0001c7c0: 6e64 706f 696e 7428 0a20 2020 2020 2020  ndpoint(.       
-0001c7d0: 2073 656c 662c 0a20 2020 2020 2020 2070   self,.        p
-0001c7e0: 726f 6a65 6374 3a20 7374 722c 0a20 2020  roject: str,.   
-0001c7f0: 2020 2020 2065 6e64 706f 696e 745f 6964       endpoint_id
-0001c800: 3a20 7374 722c 0a20 2020 2020 2020 2061  : str,.        a
-0001c810: 7474 7269 6275 7465 733a 2064 6963 742c  ttributes: dict,
-0001c820: 0a20 2020 2029 3a0a 2020 2020 2020 2020  .    ):.        
-0001c830: 2222 220a 2020 2020 2020 2020 5570 6461  """.        Upda
-0001c840: 7465 7320 6d6f 6465 6c20 656e 6470 6f69  tes model endpoi
-0001c850: 6e74 2077 6974 6820 7072 6f76 6964 6564  nt with provided
-0001c860: 2061 7474 7269 6275 7465 732e 0a0a 2020   attributes...  
-0001c870: 2020 2020 2020 3a70 6172 616d 2070 726f        :param pro
-0001c880: 6a65 6374 3a20 5468 6520 6e61 6d65 206f  ject: The name o
-0001c890: 6620 7468 6520 7072 6f6a 6563 742e 0a20  f the project.. 
-0001c8a0: 2020 2020 2020 203a 7061 7261 6d20 656e         :param en
-0001c8b0: 6470 6f69 6e74 5f69 643a 2054 6865 2069  dpoint_id: The i
-0001c8c0: 6420 6f66 2074 6865 2065 6e64 706f 696e  d of the endpoin
-0001c8d0: 742e 0a20 2020 2020 2020 203a 7061 7261  t..        :para
-0001c8e0: 6d20 6174 7472 6962 7574 6573 3a20 4469  m attributes: Di
-0001c8f0: 6374 696f 6e61 7279 206f 6620 6174 7472  ctionary of attr
-0001c900: 6962 7574 6573 2074 6861 7420 7769 6c6c  ibutes that will
-0001c910: 2062 6520 7573 6564 2066 6f72 2075 7064   be used for upd
-0001c920: 6174 6520 7468 6520 6d6f 6465 6c20 656e  ate the model en
-0001c930: 6470 6f69 6e74 2e20 5468 6520 6b65 7973  dpoint. The keys
-0001c940: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001c950: 2020 2020 2020 2020 2020 2020 6f66 2074              of t
-0001c960: 6869 7320 6469 6374 696f 6e61 7279 2073  his dictionary s
-0001c970: 686f 756c 6420 6578 6973 7420 696e 2074  hould exist in t
-0001c980: 6865 2074 6172 6765 7420 7461 626c 652e  he target table.
-0001c990: 204e 6f74 6520 7468 6174 2074 6865 2076   Note that the v
-0001c9a0: 616c 7565 7320 7368 6f75 6c64 2062 650a  alues should be.
-0001c9b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c9c0: 2020 2020 2020 2020 2020 2066 726f 6d20             from 
-0001c9d0: 7479 7065 2073 7472 696e 6720 6f72 2066  type string or f
-0001c9e0: 726f 6d20 6120 7661 6c69 6420 6e75 6d65  rom a valid nume
-0001c9f0: 7269 6361 6c20 7479 7065 2073 7563 6820  rical type such 
-0001ca00: 6173 2069 6e74 206f 7220 666c 6f61 742e  as int or float.
-0001ca10: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001ca20: 2020 2020 2020 2020 2020 2020 204d 6f72               Mor
-0001ca30: 6520 6465 7461 696c 7320 6162 6f75 7420  e details about 
-0001ca40: 7468 6520 6d6f 6465 6c20 656e 6470 6f69  the model endpoi
-0001ca50: 6e74 2061 7661 696c 6162 6c65 2061 7474  nt available att
-0001ca60: 7269 6275 7465 7320 6361 6e20 6265 2066  ributes can be f
-0001ca70: 6f75 6e64 2075 6e64 6572 0a20 2020 2020  ound under.     
-0001ca80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001ca90: 2020 2020 2020 3a70 793a 636c 6173 733a        :py:class:
-0001caa0: 607e 6d6c 7275 6e2e 6170 692e 7363 6865  `~mlrun.api.sche
-0001cab0: 6d61 732e 4d6f 6465 6c45 6e64 706f 696e  mas.ModelEndpoin
-0001cac0: 7460 2e0a 0a20 2020 2020 2020 2020 2020  t`...           
-0001cad0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001cae0: 4578 616d 706c 653a 3a0a 0a20 2020 2020  Example::..     
+0001c560: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c570: 2020 2020 2020 6170 7065 6172 6564 2075        appeared u
+0001c580: 6e64 6572 206d 6f64 656c 5f65 6e64 706f  nder model_endpo
+0001c590: 696e 742e 7370 6563 2e6d 6574 7269 6373  int.spec.metrics
+0001c5a0: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
+0001c5b0: 2066 6561 7475 7265 5f61 6e61 6c79 7369   feature_analysi
+0001c5c0: 733a 2020 2020 2020 2020 2020 2057 6865  s:           Whe
+0001c5d0: 6e20 5472 7565 2c20 7468 6520 6261 7365  n True, the base
+0001c5e0: 2066 6561 7475 7265 2073 7461 7469 7374   feature statist
+0001c5f0: 6963 7320 616e 6420 6375 7272 656e 7420  ics and current 
+0001c600: 6665 6174 7572 6520 7374 6174 6973 7469  feature statisti
+0001c610: 6373 2077 696c 6c0a 2020 2020 2020 2020  cs will.        
+0001c620: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c630: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c640: 2020 2062 6520 6164 6465 6420 746f 2074     be added to t
+0001c650: 6865 206f 7574 7075 7420 6f66 2074 6865  he output of the
+0001c660: 2072 6573 756c 7469 6e67 206f 626a 6563   resulting objec
+0001c670: 742e 0a0a 2020 2020 2020 2020 3a72 6574  t...        :ret
+0001c680: 7572 6e3a 2041 2060 4d6f 6465 6c45 6e64  urn: A `ModelEnd
+0001c690: 706f 696e 7460 206f 626a 6563 742e 0a20  point` object.. 
+0001c6a0: 2020 2020 2020 2022 2222 0a0a 2020 2020         """..    
+0001c6b0: 2020 2020 7061 7468 203d 2066 2270 726f      path = f"pro
+0001c6c0: 6a65 6374 732f 7b70 726f 6a65 6374 7d2f  jects/{project}/
+0001c6d0: 6d6f 6465 6c2d 656e 6470 6f69 6e74 732f  model-endpoints/
+0001c6e0: 7b65 6e64 706f 696e 745f 6964 7d22 0a20  {endpoint_id}". 
+0001c6f0: 2020 2020 2020 2072 6573 706f 6e73 6520         response 
+0001c700: 3d20 7365 6c66 2e61 7069 5f63 616c 6c28  = self.api_call(
+0001c710: 0a20 2020 2020 2020 2020 2020 206d 6574  .            met
+0001c720: 686f 643d 2247 4554 222c 0a20 2020 2020  hod="GET",.     
+0001c730: 2020 2020 2020 2070 6174 683d 7061 7468         path=path
+0001c740: 2c0a 2020 2020 2020 2020 2020 2020 7061  ,.            pa
+0001c750: 7261 6d73 3d7b 0a20 2020 2020 2020 2020  rams={.         
+0001c760: 2020 2020 2020 2022 7374 6172 7422 3a20         "start": 
+0001c770: 7374 6172 742c 0a20 2020 2020 2020 2020  start,.         
+0001c780: 2020 2020 2020 2022 656e 6422 3a20 656e         "end": en
+0001c790: 642c 0a20 2020 2020 2020 2020 2020 2020  d,.             
+0001c7a0: 2020 2022 6d65 7472 6963 223a 206d 6574     "metric": met
+0001c7b0: 7269 6373 206f 7220 5b5d 2c0a 2020 2020  rics or [],.    
+0001c7c0: 2020 2020 2020 2020 2020 2020 2266 6561              "fea
+0001c7d0: 7475 7265 5f61 6e61 6c79 7369 7322 3a20  ture_analysis": 
+0001c7e0: 6665 6174 7572 655f 616e 616c 7973 6973  feature_analysis
+0001c7f0: 2c0a 2020 2020 2020 2020 2020 2020 7d2c  ,.            },
+0001c800: 0a20 2020 2020 2020 2029 0a0a 2020 2020  .        )..    
+0001c810: 2020 2020 7265 7475 726e 206d 6c72 756e      return mlrun
+0001c820: 2e6d 6f64 656c 5f6d 6f6e 6974 6f72 696e  .model_monitorin
+0001c830: 672e 6d6f 6465 6c5f 656e 6470 6f69 6e74  g.model_endpoint
+0001c840: 2e4d 6f64 656c 456e 6470 6f69 6e74 2e66  .ModelEndpoint.f
+0001c850: 726f 6d5f 6469 6374 280a 2020 2020 2020  rom_dict(.      
+0001c860: 2020 2020 2020 7265 7370 6f6e 7365 2e6a        response.j
+0001c870: 736f 6e28 290a 2020 2020 2020 2020 290a  son().        ).
+0001c880: 0a20 2020 2064 6566 2070 6174 6368 5f6d  .    def patch_m
+0001c890: 6f64 656c 5f65 6e64 706f 696e 7428 0a20  odel_endpoint(. 
+0001c8a0: 2020 2020 2020 2073 656c 662c 0a20 2020         self,.   
+0001c8b0: 2020 2020 2070 726f 6a65 6374 3a20 7374       project: st
+0001c8c0: 722c 0a20 2020 2020 2020 2065 6e64 706f  r,.        endpo
+0001c8d0: 696e 745f 6964 3a20 7374 722c 0a20 2020  int_id: str,.   
+0001c8e0: 2020 2020 2061 7474 7269 6275 7465 733a       attributes:
+0001c8f0: 2064 6963 742c 0a20 2020 2029 3a0a 2020   dict,.    ):.  
+0001c900: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+0001c910: 2020 5570 6461 7465 7320 6d6f 6465 6c20    Updates model 
+0001c920: 656e 6470 6f69 6e74 2077 6974 6820 7072  endpoint with pr
+0001c930: 6f76 6964 6564 2061 7474 7269 6275 7465  ovided attribute
+0001c940: 732e 0a0a 2020 2020 2020 2020 3a70 6172  s...        :par
+0001c950: 616d 2070 726f 6a65 6374 3a20 5468 6520  am project: The 
+0001c960: 6e61 6d65 206f 6620 7468 6520 7072 6f6a  name of the proj
+0001c970: 6563 742e 0a20 2020 2020 2020 203a 7061  ect..        :pa
+0001c980: 7261 6d20 656e 6470 6f69 6e74 5f69 643a  ram endpoint_id:
+0001c990: 2054 6865 2069 6420 6f66 2074 6865 2065   The id of the e
+0001c9a0: 6e64 706f 696e 742e 0a20 2020 2020 2020  ndpoint..       
+0001c9b0: 203a 7061 7261 6d20 6174 7472 6962 7574   :param attribut
+0001c9c0: 6573 3a20 4469 6374 696f 6e61 7279 206f  es: Dictionary o
+0001c9d0: 6620 6174 7472 6962 7574 6573 2074 6861  f attributes tha
+0001c9e0: 7420 7769 6c6c 2062 6520 7573 6564 2066  t will be used f
+0001c9f0: 6f72 2075 7064 6174 6520 7468 6520 6d6f  or update the mo
+0001ca00: 6465 6c20 656e 6470 6f69 6e74 2e20 5468  del endpoint. Th
+0001ca10: 6520 6b65 7973 0a20 2020 2020 2020 2020  e keys.         
+0001ca20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ca30: 2020 6f66 2074 6869 7320 6469 6374 696f    of this dictio
+0001ca40: 6e61 7279 2073 686f 756c 6420 6578 6973  nary should exis
+0001ca50: 7420 696e 2074 6865 2074 6172 6765 7420  t in the target 
+0001ca60: 7461 626c 652e 204e 6f74 6520 7468 6174  table. Note that
+0001ca70: 2074 6865 2076 616c 7565 7320 7368 6f75   the values shou
+0001ca80: 6c64 2062 650a 2020 2020 2020 2020 2020  ld be.          
+0001ca90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001caa0: 2066 726f 6d20 7479 7065 2073 7472 696e   from type strin
+0001cab0: 6720 6f72 2066 726f 6d20 6120 7661 6c69  g or from a vali
+0001cac0: 6420 6e75 6d65 7269 6361 6c20 7479 7065  d numerical type
+0001cad0: 2073 7563 6820 6173 2069 6e74 206f 7220   such as int or 
+0001cae0: 666c 6f61 742e 0a20 2020 2020 2020 2020  float..         
 0001caf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001cb00: 2020 2020 2020 2020 2020 2023 2047 656e             # Gen
-0001cb10: 6572 6174 6520 6375 7272 656e 7420 7374  erate current st
-0001cb20: 6174 7320 666f 7220 7477 6f20 6665 6174  ats for two feat
-0001cb30: 7572 6573 0a20 2020 2020 2020 2020 2020  ures.           
-0001cb40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001cb50: 2020 2020 2063 7572 7265 6e74 5f73 7461       current_sta
-0001cb60: 7473 203d 207b 2774 7664 5f73 756d 273a  ts = {'tvd_sum':
-0001cb70: 2032 2e32 2c0a 2020 2020 2020 2020 2020   2.2,.          
-0001cb80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001cb90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001cba0: 2020 2020 2020 2027 7476 645f 6d65 616e         'tvd_mean
-0001cbb0: 273a 2030 2e35 2c0a 2020 2020 2020 2020  ': 0.5,.        
-0001cbc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001cb00: 2020 204d 6f72 6520 6465 7461 696c 7320     More details 
+0001cb10: 6162 6f75 7420 7468 6520 6d6f 6465 6c20  about the model 
+0001cb20: 656e 6470 6f69 6e74 2061 7661 696c 6162  endpoint availab
+0001cb30: 6c65 2061 7474 7269 6275 7465 7320 6361  le attributes ca
+0001cb40: 6e20 6265 2066 6f75 6e64 2075 6e64 6572  n be found under
+0001cb50: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001cb60: 2020 2020 2020 2020 2020 2020 3a70 793a              :py:
+0001cb70: 636c 6173 733a 607e 6d6c 7275 6e2e 6170  class:`~mlrun.ap
+0001cb80: 692e 7363 6865 6d61 732e 4d6f 6465 6c45  i.schemas.ModelE
+0001cb90: 6e64 706f 696e 7460 2e0a 0a20 2020 2020  ndpoint`...     
+0001cba0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001cbb0: 2020 2020 2020 4578 616d 706c 653a 3a0a        Example::.
+0001cbc0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
 0001cbd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001cbe0: 2020 2020 2020 2020 2027 6865 6c6c 696e           'hellin
-0001cbf0: 6765 725f 7375 6d27 3a20 332e 362c 0a20  ger_sum': 3.6,. 
-0001cc00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001cbe0: 2023 2047 656e 6572 6174 6520 6375 7272   # Generate curr
+0001cbf0: 656e 7420 7374 6174 7320 666f 7220 7477  ent stats for tw
+0001cc00: 6f20 6665 6174 7572 6573 0a20 2020 2020  o features.     
 0001cc10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001cc20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001cc30: 2768 656c 6c69 6e67 6572 5f6d 6561 6e27  'hellinger_mean'
-0001cc40: 3a20 302e 392c 0a20 2020 2020 2020 2020  : 0.9,.         
+0001cc20: 2020 2020 2020 2020 2020 2063 7572 7265             curre
+0001cc30: 6e74 5f73 7461 7473 203d 207b 2774 7664  nt_stats = {'tvd
+0001cc40: 5f73 756d 273a 2032 2e32 2c0a 2020 2020  _sum': 2.2,.    
 0001cc50: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0001cc60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001cc70: 2020 2020 2020 2020 276b 6c64 5f73 756d          'kld_sum
-0001cc80: 273a 2032 342e 322c 0a20 2020 2020 2020  ': 24.2,.       
+0001cc70: 2020 2020 2020 2020 2020 2020 2027 7476               'tv
+0001cc80: 645f 6d65 616e 273a 2030 2e35 2c0a 2020  d_mean': 0.5,.  
 0001cc90: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0001cca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001ccb0: 2020 2020 2020 2020 2020 276b 6c64 5f6d            'kld_m
-0001ccc0: 6561 6e27 3a20 362e 302c 0a20 2020 2020  ean': 6.0,.     
-0001ccd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ccb0: 2020 2020 2020 2020 2020 2020 2020 2027                 '
+0001ccc0: 6865 6c6c 696e 6765 725f 7375 6d27 3a20  hellinger_sum': 
+0001ccd0: 332e 362c 0a20 2020 2020 2020 2020 2020  3.6,.           
 0001cce0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001ccf0: 2020 2020 2020 2020 2020 2020 2766 3127              'f1'
-0001cd00: 3a20 7b27 7476 6427 3a20 302e 352c 2027  : {'tvd': 0.5, '
-0001cd10: 6865 6c6c 696e 6765 7227 3a20 312e 302c  hellinger': 1.0,
-0001cd20: 2027 6b6c 6427 3a20 362e 347d 2c0a 2020   'kld': 6.4},.  
+0001ccf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001cd00: 2020 2020 2020 2768 656c 6c69 6e67 6572        'hellinger
+0001cd10: 5f6d 6561 6e27 3a20 302e 392c 0a20 2020  _mean': 0.9,.   
+0001cd20: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0001cd30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001cd40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001cd50: 2020 2020 2020 2020 2020 2020 2020 2027                 '
-0001cd60: 6632 273a 207b 2774 7664 273a 2030 2e35  f2': {'tvd': 0.5
-0001cd70: 2c20 2768 656c 6c69 6e67 6572 273a 2031  , 'hellinger': 1
-0001cd80: 2e30 2c20 276b 6c64 273a 2036 2e35 7d7d  .0, 'kld': 6.5}}
-0001cd90: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0001cda0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001cdb0: 2020 2320 4372 6561 7465 2061 7474 7269    # Create attri
-0001cdc0: 6275 7465 7320 6469 6374 696f 6e61 7279  butes dictionary
-0001cdd0: 2061 6363 6f72 6469 6e67 2074 6f20 7468   according to th
-0001cde0: 6520 7265 7175 6972 6564 2066 6f72 6d61  e required forma
-0001cdf0: 740a 2020 2020 2020 2020 2020 2020 2020  t.              
-0001ce00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001ce10: 2020 6174 7472 6962 7574 6573 203d 207b    attributes = {
-0001ce20: 6063 7572 7265 6e74 5f73 7461 7473 603a  `current_stats`:
-0001ce30: 206a 736f 6e2e 6475 6d70 7328 6375 7272   json.dumps(curr
-0001ce40: 656e 745f 7374 6174 7329 2c0a 2020 2020  ent_stats),.    
-0001ce50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001ce60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001ce70: 2020 2020 2020 2020 2020 6064 7269 6674            `drift
-0001ce80: 5f73 7461 7475 7360 3a20 2244 5249 4654  _status`: "DRIFT
-0001ce90: 5f44 4554 4543 5445 4422 7d0a 0a20 2020  _DETECTED"}..   
-0001cea0: 2020 2020 2022 2222 0a0a 2020 2020 2020       """..      
-0001ceb0: 2020 6174 7472 6962 7574 6573 203d 207b    attributes = {
-0001cec0: 2261 7474 7269 6275 7465 7322 3a20 5f61  "attributes": _a
-0001ced0: 735f 6a73 6f6e 2861 7474 7269 6275 7465  s_json(attribute
-0001cee0: 7329 7d0a 2020 2020 2020 2020 7061 7468  s)}.        path
-0001cef0: 203d 2066 2270 726f 6a65 6374 732f 7b70   = f"projects/{p
-0001cf00: 726f 6a65 6374 7d2f 6d6f 6465 6c2d 656e  roject}/model-en
-0001cf10: 6470 6f69 6e74 732f 7b65 6e64 706f 696e  dpoints/{endpoin
-0001cf20: 745f 6964 7d22 0a20 2020 2020 2020 2073  t_id}".        s
-0001cf30: 656c 662e 6170 695f 6361 6c6c 280a 2020  elf.api_call(.  
-0001cf40: 2020 2020 2020 2020 2020 6d65 7468 6f64            method
-0001cf50: 3d22 5041 5443 4822 2c0a 2020 2020 2020  ="PATCH",.      
-0001cf60: 2020 2020 2020 7061 7468 3d70 6174 682c        path=path,
-0001cf70: 0a20 2020 2020 2020 2020 2020 2070 6172  .            par
-0001cf80: 616d 733d 6174 7472 6962 7574 6573 2c0a  ams=attributes,.
-0001cf90: 2020 2020 2020 2020 290a 0a20 2020 2064          )..    d
-0001cfa0: 6566 2063 7265 6174 655f 6d61 726b 6574  ef create_market
-0001cfb0: 706c 6163 655f 736f 7572 6365 280a 2020  place_source(.  
-0001cfc0: 2020 2020 2020 7365 6c66 2c20 736f 7572        self, sour
-0001cfd0: 6365 3a20 556e 696f 6e5b 6469 6374 2c20  ce: Union[dict, 
-0001cfe0: 7363 6865 6d61 732e 496e 6465 7865 644d  schemas.IndexedM
-0001cff0: 6172 6b65 7470 6c61 6365 536f 7572 6365  arketplaceSource
-0001d000: 5d0a 2020 2020 293a 0a20 2020 2020 2020  ].    ):.       
-0001d010: 2022 2222 0a20 2020 2020 2020 2041 6464   """.        Add
-0001d020: 2061 206e 6577 206d 6172 6b65 7470 6c61   a new marketpla
-0001d030: 6365 2073 6f75 7263 652e 0a0a 2020 2020  ce source...    
-0001d040: 2020 2020 4d4c 5275 6e20 6d61 696e 7461      MLRun mainta
-0001d050: 696e 7320 616e 206f 7264 6572 6564 206c  ins an ordered l
-0001d060: 6973 7420 6f66 206d 6172 6b65 7470 6c61  ist of marketpla
-0001d070: 6365 2073 6f75 7263 6573 2028 e280 9c73  ce sources (...s
-0001d080: 6f75 7263 6573 e280 9d29 2045 6163 6820  ources...) Each 
-0001d090: 736f 7572 6365 2068 6173 0a20 2020 2020  source has.     
-0001d0a0: 2020 2069 7473 2064 6574 6169 6c73 2072     its details r
-0001d0b0: 6567 6973 7465 7265 6420 616e 6420 6974  egistered and it
-0001d0c0: 7320 6f72 6465 7220 7769 7468 696e 2074  s order within t
-0001d0d0: 6865 206c 6973 742e 2057 6865 6e20 6372  he list. When cr
-0001d0e0: 6561 7469 6e67 2061 206e 6577 2073 6f75  eating a new sou
-0001d0f0: 7263 652c 2074 6865 2073 7065 6369 616c  rce, the special
-0001d100: 206f 7264 6572 2060 602d 3160 600a 2020   order ``-1``.  
-0001d110: 2020 2020 2020 6361 6e20 6265 2075 7365        can be use
-0001d120: 6420 746f 206d 6172 6b20 7468 6973 2073  d to mark this s
-0001d130: 6f75 7263 6520 6173 206c 6173 7420 696e  ource as last in
-0001d140: 2074 6865 206c 6973 742e 2048 6f77 6576   the list. Howev
-0001d150: 6572 2c20 6f6e 6365 2074 6865 2073 6f75  er, once the sou
-0001d160: 7263 6520 6973 2069 6e20 7468 6520 4d4c  rce is in the ML
-0001d170: 5275 6e20 6c69 7374 2c0a 2020 2020 2020  Run list,.      
-0001d180: 2020 6974 7320 6f72 6465 7220 7769 6c6c    its order will
-0001d190: 2061 6c77 6179 7320 6265 2060 603e 3060   always be ``>0`
-0001d1a0: 602e 0a0a 2020 2020 2020 2020 5468 6520  `...        The 
-0001d1b0: 676c 6f62 616c 206d 6172 6b65 7470 6c61  global marketpla
-0001d1c0: 6365 2073 6f75 7263 6520 616c 7761 7973  ce source always
-0001d1d0: 2065 7869 7374 7320 696e 2074 6865 206c   exists in the l
-0001d1e0: 6973 742c 2061 6e64 2069 7320 616c 7761  ist, and is alwa
-0001d1f0: 7973 2074 6865 206c 6173 7420 736f 7572  ys the last sour
-0001d200: 6365 0a20 2020 2020 2020 2028 6060 6f72  ce.        (``or
-0001d210: 6465 7220 3d20 2d31 6060 292e 2049 7420  der = -1``). It 
-0001d220: 6361 6e6e 6f74 2062 6520 6d6f 6469 6669  cannot be modifi
-0001d230: 6564 206e 6f72 2063 616e 2069 7420 6265  ed nor can it be
-0001d240: 206d 6f76 6564 2074 6f20 616e 6f74 6865   moved to anothe
-0001d250: 7220 6f72 6465 7220 696e 2074 6865 206c  r order in the l
-0001d260: 6973 742e 0a0a 2020 2020 2020 2020 5468  ist...        Th
-0001d270: 6520 736f 7572 6365 206f 626a 6563 7420  e source object 
-0001d280: 6d61 7920 636f 6e74 6169 6e20 6372 6564  may contain cred
-0001d290: 656e 7469 616c 7320 7768 6963 6820 6172  entials which ar
-0001d2a0: 6520 6e65 6564 6564 2074 6f20 6163 6365  e needed to acce
-0001d2b0: 7373 2074 6865 2064 6174 6173 746f 7265  ss the datastore
-0001d2c0: 2077 6865 7265 2074 6865 2073 6f75 7263   where the sourc
-0001d2d0: 6520 6973 2073 746f 7265 642e 0a20 2020  e is stored..   
-0001d2e0: 2020 2020 2054 6865 7365 2063 7265 6465       These crede
-0001d2f0: 6e74 6961 6c73 2061 7265 206e 6f74 206b  ntials are not k
-0001d300: 6570 7420 696e 2074 6865 204d 4c52 756e  ept in the MLRun
-0001d310: 2044 422c 2062 7574 2061 7265 2073 746f   DB, but are sto
-0001d320: 7265 6420 696e 7369 6465 2061 206b 7562  red inside a kub
-0001d330: 6572 6e65 7465 7320 7365 6372 6574 206f  ernetes secret o
-0001d340: 626a 6563 7420 6d61 696e 7461 696e 6564  bject maintained
-0001d350: 2062 790a 2020 2020 2020 2020 4d4c 5275   by.        MLRu
-0001d360: 6e2e 2054 6865 7920 6172 6520 6e6f 7420  n. They are not 
-0001d370: 7265 7475 726e 6564 2074 6872 6f75 6768  returned through
-0001d380: 2061 6e79 2041 5049 2066 726f 6d20 4d4c   any API from ML
-0001d390: 5275 6e2e 0a0a 2020 2020 2020 2020 4578  Run...        Ex
-0001d3a0: 616d 706c 653a 3a0a 0a20 2020 2020 2020  ample::..       
-0001d3b0: 2020 2020 2069 6d70 6f72 7420 6d6c 7275       import mlru
-0001d3c0: 6e2e 6170 692e 7363 6865 6d61 730a 0a20  n.api.schemas.. 
-0001d3d0: 2020 2020 2020 2020 2020 2023 2041 6464             # Add
-0001d3e0: 2061 2070 7269 7661 7465 2073 6f75 7263   a private sourc
-0001d3f0: 6520 6173 2074 6865 206c 6173 7420 6f6e  e as the last on
-0001d400: 6520 2877 696c 6c20 6265 2023 3120 696e  e (will be #1 in
-0001d410: 2074 6865 206c 6973 7429 0a20 2020 2020   the list).     
-0001d420: 2020 2020 2020 2070 7269 7661 7465 5f73         private_s
-0001d430: 6f75 7263 6520 3d20 6d6c 7275 6e2e 6170  ource = mlrun.ap
-0001d440: 692e 7363 6865 6d61 732e 496e 6465 7865  i.schemas.Indexe
-0001d450: 644d 6172 6b65 7470 6c61 6365 536f 7572  dMarketplaceSour
-0001d460: 6365 280a 2020 2020 2020 2020 2020 2020  ce(.            
-0001d470: 2020 2020 6f72 6465 723d 2d31 2c0a 2020      order=-1,.  
-0001d480: 2020 2020 2020 2020 2020 2020 2020 736f                so
-0001d490: 7572 6365 3d6d 6c72 756e 2e61 7069 2e73  urce=mlrun.api.s
-0001d4a0: 6368 656d 6173 2e4d 6172 6b65 7470 6c61  chemas.Marketpla
-0001d4b0: 6365 536f 7572 6365 280a 2020 2020 2020  ceSource(.      
-0001d4c0: 2020 2020 2020 2020 2020 2020 2020 6d65                me
-0001d4d0: 7461 6461 7461 3d6d 6c72 756e 2e61 7069  tadata=mlrun.api
-0001d4e0: 2e73 6368 656d 6173 2e4d 6172 6b65 7470  .schemas.Marketp
-0001d4f0: 6c61 6365 4f62 6a65 6374 4d65 7461 6461  laceObjectMetada
-0001d500: 7461 286e 616d 653d 2270 7269 7622 2c20  ta(name="priv", 
-0001d510: 6465 7363 7269 7074 696f 6e3d 2261 2070  description="a p
-0001d520: 7269 7661 7465 2073 6f75 7263 6522 292c  rivate source"),
-0001d530: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001d540: 2020 2020 2073 7065 633d 6d6c 7275 6e2e       spec=mlrun.
-0001d550: 6170 692e 7363 6865 6d61 732e 4d61 726b  api.schemas.Mark
-0001d560: 6574 706c 6163 6553 6f75 7263 6553 7065  etplaceSourceSpe
-0001d570: 6328 7061 7468 3d22 2f6c 6f63 616c 2f70  c(path="/local/p
-0001d580: 6174 682f 746f 2f73 6f75 7263 6522 2c20  ath/to/source", 
-0001d590: 6368 616e 6e65 6c3d 2264 6576 656c 6f70  channel="develop
-0001d5a0: 6d65 6e74 2229 0a20 2020 2020 2020 2020  ment").         
-0001d5b0: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-0001d5c0: 2020 2020 2029 0a20 2020 2020 2020 2020       ).         
-0001d5d0: 2020 2064 622e 6372 6561 7465 5f6d 6172     db.create_mar
-0001d5e0: 6b65 7470 6c61 6365 5f73 6f75 7263 6528  ketplace_source(
-0001d5f0: 7072 6976 6174 655f 736f 7572 6365 290a  private_source).
-0001d600: 0a20 2020 2020 2020 2020 2020 2023 2041  .            # A
-0001d610: 6464 2061 6e6f 7468 6572 2073 6f75 7263  dd another sourc
-0001d620: 6520 6173 2031 7374 2069 6e20 7468 6520  e as 1st in the 
-0001d630: 6c69 7374 202d 2077 696c 6c20 7075 7368  list - will push
-0001d640: 2070 7265 7669 6f75 7320 6f6e 6520 746f   previous one to
-0001d650: 2062 6520 2332 0a20 2020 2020 2020 2020   be #2.         
-0001d660: 2020 2061 6e6f 7468 6572 5f73 6f75 7263     another_sourc
-0001d670: 6520 3d20 6d6c 7275 6e2e 6170 692e 7363  e = mlrun.api.sc
-0001d680: 6865 6d61 732e 496e 6465 7865 644d 6172  hemas.IndexedMar
-0001d690: 6b65 7470 6c61 6365 536f 7572 6365 280a  ketplaceSource(.
-0001d6a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d6b0: 6f72 6465 723d 312c 0a20 2020 2020 2020  order=1,.       
-0001d6c0: 2020 2020 2020 2020 2073 6f75 7263 653d           source=
-0001d6d0: 6d6c 7275 6e2e 6170 692e 7363 6865 6d61  mlrun.api.schema
-0001d6e0: 732e 4d61 726b 6574 706c 6163 6553 6f75  s.MarketplaceSou
-0001d6f0: 7263 6528 0a20 2020 2020 2020 2020 2020  rce(.           
-0001d700: 2020 2020 2020 2020 206d 6574 6164 6174           metadat
-0001d710: 613d 6d6c 7275 6e2e 6170 692e 7363 6865  a=mlrun.api.sche
-0001d720: 6d61 732e 4d61 726b 6574 706c 6163 654f  mas.MarketplaceO
-0001d730: 626a 6563 744d 6574 6164 6174 6128 6e61  bjectMetadata(na
-0001d740: 6d65 3d22 7072 6976 2d32 222c 2064 6573  me="priv-2", des
-0001d750: 6372 6970 7469 6f6e 3d22 616e 6f74 6865  cription="anothe
-0001d760: 7220 736f 7572 6365 2229 2c0a 2020 2020  r source"),.    
-0001d770: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d780: 7370 6563 3d6d 6c72 756e 2e61 7069 2e73  spec=mlrun.api.s
-0001d790: 6368 656d 6173 2e4d 6172 6b65 7470 6c61  chemas.Marketpla
-0001d7a0: 6365 536f 7572 6365 5370 6563 280a 2020  ceSourceSpec(.  
-0001d7b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d7c0: 2020 2020 2020 7061 7468 3d22 2f6c 6f63        path="/loc
-0001d7d0: 616c 2f70 6174 682f 746f 2f73 6f75 7263  al/path/to/sourc
-0001d7e0: 652f 3222 2c0a 2020 2020 2020 2020 2020  e/2",.          
-0001d7f0: 2020 2020 2020 2020 2020 2020 2020 6368                ch
-0001d800: 616e 6e65 6c3d 2264 6576 656c 6f70 6d65  annel="developme
-0001d810: 6e74 222c 0a20 2020 2020 2020 2020 2020  nt",.           
-0001d820: 2020 2020 2020 2020 2020 2020 2063 7265               cre
-0001d830: 6465 6e74 6961 6c73 3d7b 2e2e 2e7d 0a20  dentials={...}. 
-0001d840: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d850: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
-0001d860: 2020 2020 2029 0a20 2020 2020 2020 2020       ).         
-0001d870: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
-0001d880: 2064 622e 6372 6561 7465 5f6d 6172 6b65   db.create_marke
-0001d890: 7470 6c61 6365 5f73 6f75 7263 6528 616e  tplace_source(an
-0001d8a0: 6f74 6865 725f 736f 7572 6365 290a 0a20  other_source).. 
-0001d8b0: 2020 2020 2020 203a 7061 7261 6d20 736f         :param so
-0001d8c0: 7572 6365 3a20 5468 6520 736f 7572 6365  urce: The source
-0001d8d0: 2061 6e64 2069 7473 206f 7264 6572 2c20   and its order, 
-0001d8e0: 6f66 2074 7970 650a 2020 2020 2020 2020  of type.        
-0001d8f0: 2020 2020 3a70 793a 636c 6173 733a 607e      :py:class:`~
-0001d900: 6d6c 7275 6e2e 6170 692e 7363 6865 6d61  mlrun.api.schema
-0001d910: 732e 6d61 726b 6574 706c 6163 652e 496e  s.marketplace.In
-0001d920: 6465 7865 644d 6172 6b65 7470 6c61 6365  dexedMarketplace
-0001d930: 536f 7572 6365 602c 206f 7220 696e 2064  Source`, or in d
-0001d940: 6963 7469 6f6e 6172 7920 666f 726d 2e0a  ictionary form..
-0001d950: 2020 2020 2020 2020 3a72 6574 7572 6e73          :returns
-0001d960: 3a20 5468 6520 736f 7572 6365 206f 626a  : The source obj
-0001d970: 6563 7420 6173 2069 6e73 6572 7465 6420  ect as inserted 
-0001d980: 696e 746f 2074 6865 2064 6174 6162 6173  into the databas
-0001d990: 652c 2077 6974 6820 6372 6564 656e 7469  e, with credenti
-0001d9a0: 616c 7320 7374 7269 7070 6564 2e0a 2020  als stripped..  
-0001d9b0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-0001d9c0: 2020 7061 7468 203d 2022 6d61 726b 6574    path = "market
-0001d9d0: 706c 6163 652f 736f 7572 6365 7322 0a20  place/sources". 
-0001d9e0: 2020 2020 2020 2069 6620 6973 696e 7374         if isinst
-0001d9f0: 616e 6365 2873 6f75 7263 652c 2073 6368  ance(source, sch
-0001da00: 656d 6173 2e49 6e64 6578 6564 4d61 726b  emas.IndexedMark
-0001da10: 6574 706c 6163 6553 6f75 7263 6529 3a0a  etplaceSource):.
-0001da20: 2020 2020 2020 2020 2020 2020 736f 7572              sour
-0001da30: 6365 203d 2073 6f75 7263 652e 6469 6374  ce = source.dict
-0001da40: 2829 0a20 2020 2020 2020 2072 6573 706f  ().        respo
-0001da50: 6e73 6520 3d20 7365 6c66 2e61 7069 5f63  nse = self.api_c
-0001da60: 616c 6c28 6d65 7468 6f64 3d22 504f 5354  all(method="POST
-0001da70: 222c 2070 6174 683d 7061 7468 2c20 6a73  ", path=path, js
-0001da80: 6f6e 3d73 6f75 7263 6529 0a20 2020 2020  on=source).     
-0001da90: 2020 2072 6574 7572 6e20 7363 6865 6d61     return schema
-0001daa0: 732e 496e 6465 7865 644d 6172 6b65 7470  s.IndexedMarketp
-0001dab0: 6c61 6365 536f 7572 6365 282a 2a72 6573  laceSource(**res
-0001dac0: 706f 6e73 652e 6a73 6f6e 2829 290a 0a20  ponse.json()).. 
-0001dad0: 2020 2064 6566 2073 746f 7265 5f6d 6172     def store_mar
-0001dae0: 6b65 7470 6c61 6365 5f73 6f75 7263 6528  ketplace_source(
-0001daf0: 0a20 2020 2020 2020 2073 656c 662c 2073  .        self, s
-0001db00: 6f75 7263 655f 6e61 6d65 3a20 7374 722c  ource_name: str,
-0001db10: 2073 6f75 7263 653a 2055 6e69 6f6e 5b64   source: Union[d
-0001db20: 6963 742c 2073 6368 656d 6173 2e49 6e64  ict, schemas.Ind
-0001db30: 6578 6564 4d61 726b 6574 706c 6163 6553  exedMarketplaceS
-0001db40: 6f75 7263 655d 0a20 2020 2029 3a0a 2020  ource].    ):.  
-0001db50: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-0001db60: 2020 4372 6561 7465 206f 7220 7265 706c    Create or repl
-0001db70: 6163 6520 6120 6d61 726b 6574 706c 6163  ace a marketplac
-0001db80: 6520 736f 7572 6365 2e0a 2020 2020 2020  e source..      
-0001db90: 2020 466f 7220 616e 2065 7861 6d70 6c65    For an example
-0001dba0: 206f 6620 7468 6520 736f 7572 6365 2066   of the source f
-0001dbb0: 6f72 6d61 7420 616e 6420 6578 706c 616e  ormat and explan
-0001dbc0: 6174 696f 6e20 6f66 2074 6865 2073 6f75  ation of the sou
-0001dbd0: 7263 6520 6f72 6465 7220 6c6f 6769 632c  rce order logic,
-0001dbe0: 0a20 2020 2020 2020 2070 6c65 6173 6520  .        please 
-0001dbf0: 7365 6520 3a70 793a 6675 6e63 3a60 7e63  see :py:func:`~c
-0001dc00: 7265 6174 655f 6d61 726b 6574 706c 6163  reate_marketplac
-0001dc10: 655f 736f 7572 6365 602e 2054 6869 7320  e_source`. This 
-0001dc20: 6d65 7468 6f64 2063 616e 2062 6520 7573  method can be us
-0001dc30: 6564 2074 6f20 6d6f 6469 6679 2074 6865  ed to modify the
-0001dc40: 2073 6f75 7263 6520 6974 7365 6c66 206f   source itself o
-0001dc50: 7220 6974 730a 2020 2020 2020 2020 6f72  r its.        or
-0001dc60: 6465 7220 696e 2074 6865 206c 6973 7420  der in the list 
-0001dc70: 6f66 2073 6f75 7263 6573 2e0a 0a20 2020  of sources...   
-0001dc80: 2020 2020 203a 7061 7261 6d20 736f 7572       :param sour
-0001dc90: 6365 5f6e 616d 653a 204e 616d 6520 6f66  ce_name: Name of
-0001dca0: 2074 6865 2073 6f75 7263 6520 6f62 6a65   the source obje
-0001dcb0: 6374 2074 6f20 6d6f 6469 6679 2f63 7265  ct to modify/cre
-0001dcc0: 6174 652e 2049 7420 6d75 7374 206d 6174  ate. It must mat
-0001dcd0: 6368 2074 6865 2060 6073 6f75 7263 652e  ch the ``source.
-0001dce0: 6d65 7461 6461 7461 2e6e 616d 6560 600a  metadata.name``.
-0001dcf0: 2020 2020 2020 2020 2020 2020 7061 7261              para
-0001dd00: 6d65 7465 7220 696e 2074 6865 2073 6f75  meter in the sou
-0001dd10: 7263 6520 6974 7365 6c66 2e0a 2020 2020  rce itself..    
-0001dd20: 2020 2020 3a70 6172 616d 2073 6f75 7263      :param sourc
-0001dd30: 653a 2053 6f75 7263 6520 6f62 6a65 6374  e: Source object
-0001dd40: 2074 6f20 7374 6f72 6520 696e 2074 6865   to store in the
-0001dd50: 2064 6174 6162 6173 652e 0a20 2020 2020   database..     
-0001dd60: 2020 203a 7265 7475 726e 733a 2054 6865     :returns: The
-0001dd70: 2073 6f75 7263 6520 6f62 6a65 6374 2061   source object a
-0001dd80: 7320 7374 6f72 6564 2069 6e20 7468 6520  s stored in the 
-0001dd90: 4442 2e0a 2020 2020 2020 2020 2222 220a  DB..        """.
-0001dda0: 2020 2020 2020 2020 7061 7468 203d 2066          path = f
-0001ddb0: 226d 6172 6b65 7470 6c61 6365 2f73 6f75  "marketplace/sou
-0001ddc0: 7263 6573 2f7b 736f 7572 6365 5f6e 616d  rces/{source_nam
-0001ddd0: 657d 220a 2020 2020 2020 2020 6966 2069  e}".        if i
-0001dde0: 7369 6e73 7461 6e63 6528 736f 7572 6365  sinstance(source
-0001ddf0: 2c20 7363 6865 6d61 732e 496e 6465 7865  , schemas.Indexe
-0001de00: 644d 6172 6b65 7470 6c61 6365 536f 7572  dMarketplaceSour
-0001de10: 6365 293a 0a20 2020 2020 2020 2020 2020  ce):.           
-0001de20: 2073 6f75 7263 6520 3d20 736f 7572 6365   source = source
-0001de30: 2e64 6963 7428 290a 0a20 2020 2020 2020  .dict()..       
-0001de40: 2072 6573 706f 6e73 6520 3d20 7365 6c66   response = self
-0001de50: 2e61 7069 5f63 616c 6c28 6d65 7468 6f64  .api_call(method
-0001de60: 3d22 5055 5422 2c20 7061 7468 3d70 6174  ="PUT", path=pat
-0001de70: 682c 206a 736f 6e3d 736f 7572 6365 290a  h, json=source).
-0001de80: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-0001de90: 6368 656d 6173 2e49 6e64 6578 6564 4d61  chemas.IndexedMa
-0001dea0: 726b 6574 706c 6163 6553 6f75 7263 6528  rketplaceSource(
-0001deb0: 2a2a 7265 7370 6f6e 7365 2e6a 736f 6e28  **response.json(
-0001dec0: 2929 0a0a 2020 2020 6465 6620 6c69 7374  ))..    def list
-0001ded0: 5f6d 6172 6b65 7470 6c61 6365 5f73 6f75  _marketplace_sou
-0001dee0: 7263 6573 2873 656c 6629 3a0a 2020 2020  rces(self):.    
-0001def0: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-0001df00: 4c69 7374 206d 6172 6b65 7470 6c61 6365  List marketplace
-0001df10: 2073 6f75 7263 6573 2069 6e20 7468 6520   sources in the 
-0001df20: 4d4c 5275 6e20 4442 2e0a 2020 2020 2020  MLRun DB..      
-0001df30: 2020 2222 220a 2020 2020 2020 2020 7061    """.        pa
-0001df40: 7468 203d 2022 6d61 726b 6574 706c 6163  th = "marketplac
-0001df50: 652f 736f 7572 6365 7322 0a20 2020 2020  e/sources".     
-0001df60: 2020 2072 6573 706f 6e73 6520 3d20 7365     response = se
-0001df70: 6c66 2e61 7069 5f63 616c 6c28 6d65 7468  lf.api_call(meth
-0001df80: 6f64 3d22 4745 5422 2c20 7061 7468 3d70  od="GET", path=p
-0001df90: 6174 6829 2e6a 736f 6e28 290a 2020 2020  ath).json().    
-0001dfa0: 2020 2020 7265 7375 6c74 7320 3d20 5b5d      results = []
-0001dfb0: 0a20 2020 2020 2020 2066 6f72 2069 7465  .        for ite
-0001dfc0: 6d20 696e 2072 6573 706f 6e73 653a 0a20  m in response:. 
-0001dfd0: 2020 2020 2020 2020 2020 2072 6573 756c             resul
-0001dfe0: 7473 2e61 7070 656e 6428 7363 6865 6d61  ts.append(schema
-0001dff0: 732e 496e 6465 7865 644d 6172 6b65 7470  s.IndexedMarketp
-0001e000: 6c61 6365 536f 7572 6365 282a 2a69 7465  laceSource(**ite
-0001e010: 6d29 290a 2020 2020 2020 2020 7265 7475  m)).        retu
-0001e020: 726e 2072 6573 756c 7473 0a0a 2020 2020  rn results..    
-0001e030: 6465 6620 6765 745f 6d61 726b 6574 706c  def get_marketpl
-0001e040: 6163 655f 736f 7572 6365 2873 656c 662c  ace_source(self,
-0001e050: 2073 6f75 7263 655f 6e61 6d65 3a20 7374   source_name: st
-0001e060: 7229 3a0a 2020 2020 2020 2020 2222 220a  r):.        """.
-0001e070: 2020 2020 2020 2020 5265 7472 6965 7665          Retrieve
-0001e080: 2061 206d 6172 6b65 7470 6c61 6365 2073   a marketplace s
-0001e090: 6f75 7263 6520 6672 6f6d 2074 6865 2044  ource from the D
-0001e0a0: 422e 0a0a 2020 2020 2020 2020 3a70 6172  B...        :par
-0001e0b0: 616d 2073 6f75 7263 655f 6e61 6d65 3a20  am source_name: 
-0001e0c0: 4e61 6d65 206f 6620 7468 6520 6d61 726b  Name of the mark
-0001e0d0: 6574 706c 6163 6520 736f 7572 6365 2074  etplace source t
-0001e0e0: 6f20 7265 7472 6965 7665 2e0a 2020 2020  o retrieve..    
-0001e0f0: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-0001e100: 7061 7468 203d 2066 226d 6172 6b65 7470  path = f"marketp
-0001e110: 6c61 6365 2f73 6f75 7263 6573 2f7b 736f  lace/sources/{so
-0001e120: 7572 6365 5f6e 616d 657d 220a 2020 2020  urce_name}".    
-0001e130: 2020 2020 7265 7370 6f6e 7365 203d 2073      response = s
-0001e140: 656c 662e 6170 695f 6361 6c6c 286d 6574  elf.api_call(met
-0001e150: 686f 643d 2247 4554 222c 2070 6174 683d  hod="GET", path=
-0001e160: 7061 7468 290a 2020 2020 2020 2020 7265  path).        re
-0001e170: 7475 726e 2073 6368 656d 6173 2e49 6e64  turn schemas.Ind
-0001e180: 6578 6564 4d61 726b 6574 706c 6163 6553  exedMarketplaceS
-0001e190: 6f75 7263 6528 2a2a 7265 7370 6f6e 7365  ource(**response
-0001e1a0: 2e6a 736f 6e28 2929 0a0a 2020 2020 6465  .json())..    de
-0001e1b0: 6620 6465 6c65 7465 5f6d 6172 6b65 7470  f delete_marketp
-0001e1c0: 6c61 6365 5f73 6f75 7263 6528 7365 6c66  lace_source(self
-0001e1d0: 2c20 736f 7572 6365 5f6e 616d 653a 2073  , source_name: s
-0001e1e0: 7472 293a 0a20 2020 2020 2020 2022 2222  tr):.        """
-0001e1f0: 0a20 2020 2020 2020 2044 656c 6574 6520  .        Delete 
-0001e200: 6120 6d61 726b 6574 706c 6163 6520 736f  a marketplace so
-0001e210: 7572 6365 2066 726f 6d20 7468 6520 4442  urce from the DB
-0001e220: 2e0a 2020 2020 2020 2020 5468 6520 736f  ..        The so
-0001e230: 7572 6365 2077 696c 6c20 6265 2064 656c  urce will be del
-0001e240: 6574 6564 2066 726f 6d20 7468 6520 6c69  eted from the li
-0001e250: 7374 2c20 616e 6420 616e 7920 666f 6c6c  st, and any foll
-0001e260: 6f77 696e 6720 736f 7572 6365 7320 7769  owing sources wi
-0001e270: 6c6c 2062 6520 7072 6f6d 6f74 6564 202d  ll be promoted -
-0001e280: 2066 6f72 2065 7861 6d70 6c65 2c20 6966   for example, if
-0001e290: 2074 6865 0a20 2020 2020 2020 2031 7374   the.        1st
-0001e2a0: 2073 6f75 7263 6520 6973 2064 656c 6574   source is delet
-0001e2b0: 6564 2c20 7468 6520 326e 6420 736f 7572  ed, the 2nd sour
-0001e2c0: 6365 2077 696c 6c20 6265 636f 6d65 2023  ce will become #
-0001e2d0: 3120 696e 2074 6865 206c 6973 742e 0a20  1 in the list.. 
-0001e2e0: 2020 2020 2020 2054 6865 2067 6c6f 6261         The globa
-0001e2f0: 6c20 6d61 726b 6574 706c 6163 6520 736f  l marketplace so
-0001e300: 7572 6365 2063 616e 6e6f 7420 6265 2064  urce cannot be d
-0001e310: 656c 6574 6564 2e0a 0a20 2020 2020 2020  eleted...       
-0001e320: 203a 7061 7261 6d20 736f 7572 6365 5f6e   :param source_n
-0001e330: 616d 653a 204e 616d 6520 6f66 2074 6865  ame: Name of the
-0001e340: 206d 6172 6b65 7470 6c61 6365 2073 6f75   marketplace sou
-0001e350: 7263 6520 746f 2064 656c 6574 652e 0a20  rce to delete.. 
-0001e360: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-0001e370: 2020 2070 6174 6820 3d20 6622 6d61 726b     path = f"mark
-0001e380: 6574 706c 6163 652f 736f 7572 6365 732f  etplace/sources/
-0001e390: 7b73 6f75 7263 655f 6e61 6d65 7d22 0a20  {source_name}". 
-0001e3a0: 2020 2020 2020 2073 656c 662e 6170 695f         self.api_
-0001e3b0: 6361 6c6c 286d 6574 686f 643d 2244 454c  call(method="DEL
-0001e3c0: 4554 4522 2c20 7061 7468 3d70 6174 6829  ETE", path=path)
-0001e3d0: 0a0a 2020 2020 6465 6620 6765 745f 6d61  ..    def get_ma
-0001e3e0: 726b 6574 706c 6163 655f 6361 7461 6c6f  rketplace_catalo
-0001e3f0: 6728 0a20 2020 2020 2020 2073 656c 662c  g(.        self,
-0001e400: 0a20 2020 2020 2020 2073 6f75 7263 655f  .        source_
-0001e410: 6e61 6d65 3a20 7374 722c 0a20 2020 2020  name: str,.     
-0001e420: 2020 2063 6861 6e6e 656c 3a20 7374 7220     channel: str 
-0001e430: 3d20 4e6f 6e65 2c0a 2020 2020 2020 2020  = None,.        
-0001e440: 7665 7273 696f 6e3a 2073 7472 203d 204e  version: str = N
-0001e450: 6f6e 652c 0a20 2020 2020 2020 2074 6167  one,.        tag
-0001e460: 3a20 7374 7220 3d20 4e6f 6e65 2c0a 2020  : str = None,.  
-0001e470: 2020 2020 2020 666f 7263 655f 7265 6672        force_refr
-0001e480: 6573 683a 2062 6f6f 6c20 3d20 4661 6c73  esh: bool = Fals
-0001e490: 652c 0a20 2020 2029 3a0a 2020 2020 2020  e,.    ):.      
-0001e4a0: 2020 2222 220a 2020 2020 2020 2020 5265    """.        Re
-0001e4b0: 7472 6965 7665 2074 6865 2069 7465 6d20  trieve the item 
-0001e4c0: 6361 7461 6c6f 6720 666f 7220 6120 7370  catalog for a sp
-0001e4d0: 6563 6966 6965 6420 6d61 726b 6574 706c  ecified marketpl
-0001e4e0: 6163 6520 736f 7572 6365 2e0a 2020 2020  ace source..    
-0001e4f0: 2020 2020 5468 6520 6c69 7374 206f 6620      The list of 
-0001e500: 6974 656d 7320 6361 6e20 6265 2066 696c  items can be fil
-0001e510: 7465 7265 6420 6163 636f 7264 696e 6720  tered according 
-0001e520: 746f 2076 6172 696f 7573 2066 696c 7465  to various filte
-0001e530: 7273 2c20 7573 696e 6720 6974 656d 2773  rs, using item's
-0001e540: 206d 6574 6164 6174 6120 746f 2066 696c   metadata to fil
-0001e550: 7465 722e 0a0a 2020 2020 2020 2020 3a70  ter...        :p
-0001e560: 6172 616d 2073 6f75 7263 655f 6e61 6d65  aram source_name
-0001e570: 3a20 4e61 6d65 206f 6620 7468 6520 736f  : Name of the so
-0001e580: 7572 6365 2e0a 2020 2020 2020 2020 3a70  urce..        :p
-0001e590: 6172 616d 2063 6861 6e6e 656c 3a20 4669  aram channel: Fi
-0001e5a0: 6c74 6572 2069 7465 6d73 2061 6363 6f72  lter items accor
-0001e5b0: 6469 6e67 2074 6f20 7468 6569 7220 6368  ding to their ch
-0001e5c0: 616e 6e65 6c2e 2046 6f72 2065 7861 6d70  annel. For examp
-0001e5d0: 6c65 2060 6064 6576 656c 6f70 6d65 6e74  le ``development
-0001e5e0: 6060 2e0a 2020 2020 2020 2020 3a70 6172  ``..        :par
-0001e5f0: 616d 2076 6572 7369 6f6e 3a20 4669 6c74  am version: Filt
-0001e600: 6572 2069 7465 6d73 2061 6363 6f72 6469  er items accordi
-0001e610: 6e67 2074 6f20 7468 6569 7220 7665 7273  ng to their vers
-0001e620: 696f 6e2e 0a20 2020 2020 2020 203a 7061  ion..        :pa
-0001e630: 7261 6d20 7461 673a 2046 696c 7465 7220  ram tag: Filter 
-0001e640: 6974 656d 7320 6261 7365 6420 6f6e 2074  items based on t
-0001e650: 6167 2e0a 2020 2020 2020 2020 3a70 6172  ag..        :par
-0001e660: 616d 2066 6f72 6365 5f72 6566 7265 7368  am force_refresh
-0001e670: 3a20 4d61 6b65 2074 6865 2073 6572 7665  : Make the serve
-0001e680: 7220 6665 7463 6820 7468 6520 6361 7461  r fetch the cata
-0001e690: 6c6f 6720 6672 6f6d 2074 6865 2061 6374  log from the act
-0001e6a0: 7561 6c20 6d61 726b 6574 706c 6163 6520  ual marketplace 
-0001e6b0: 736f 7572 6365 2c0a 2020 2020 2020 2020  source,.        
-0001e6c0: 2020 2020 7261 7468 6572 2074 6861 6e20      rather than 
-0001e6d0: 7265 6c79 206f 6e20 6361 6368 6564 2069  rely on cached i
-0001e6e0: 6e66 6f72 6d61 7469 6f6e 2077 6869 6368  nformation which
-0001e6f0: 206d 6179 2065 7869 7374 2066 726f 6d20   may exist from 
-0001e700: 7072 6576 696f 7573 2067 6574 2072 6571  previous get req
-0001e710: 7565 7374 732e 2046 6f72 2065 7861 6d70  uests. For examp
-0001e720: 6c65 2c0a 2020 2020 2020 2020 2020 2020  le,.            
-0001e730: 6966 2074 6865 2073 6f75 7263 6520 7761  if the source wa
-0001e740: 7320 7265 2d62 7569 6c74 2c0a 2020 2020  s re-built,.    
-0001e750: 2020 2020 2020 2020 7468 6973 2077 696c          this wil
-0001e760: 6c20 6d61 6b65 2074 6865 2073 6572 7665  l make the serve
-0001e770: 7220 6765 7420 7468 6520 7570 6461 7465  r get the update
-0001e780: 6420 696e 666f 726d 6174 696f 6e2e 2044  d information. D
-0001e790: 6566 6175 6c74 2069 7320 6060 4661 6c73  efault is ``Fals
-0001e7a0: 6560 602e 0a20 2020 2020 2020 203a 7265  e``..        :re
-0001e7b0: 7475 726e 733a 203a 7079 3a63 6c61 7373  turns: :py:class
-0001e7c0: 3a60 7e6d 6c72 756e 2e61 7069 2e73 6368  :`~mlrun.api.sch
-0001e7d0: 656d 6173 2e6d 6172 6b65 7470 6c61 6365  emas.marketplace
-0001e7e0: 2e4d 6172 6b65 7470 6c61 6365 4361 7461  .MarketplaceCata
-0001e7f0: 6c6f 6760 206f 626a 6563 742c 2077 6869  log` object, whi
-0001e800: 6368 2069 7320 6573 7365 6e74 6961 6c6c  ch is essentiall
-0001e810: 7920 6120 6c69 7374 0a20 2020 2020 2020  y a list.       
-0001e820: 2020 2020 206f 6620 3a70 793a 636c 6173       of :py:clas
-0001e830: 733a 607e 6d6c 7275 6e2e 6170 692e 7363  s:`~mlrun.api.sc
-0001e840: 6865 6d61 732e 6d61 726b 6574 706c 6163  hemas.marketplac
-0001e850: 652e 4d61 726b 6574 706c 6163 6549 7465  e.MarketplaceIte
-0001e860: 6d60 2065 6e74 7269 6573 2e0a 2020 2020  m` entries..    
-0001e870: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-0001e880: 7061 7468 203d 2028 6622 6d61 726b 6574  path = (f"market
-0001e890: 706c 6163 652f 736f 7572 6365 732f 7b73  place/sources/{s
-0001e8a0: 6f75 7263 655f 6e61 6d65 7d2f 6974 656d  ource_name}/item
-0001e8b0: 7322 2c29 0a20 2020 2020 2020 2070 6172  s",).        par
-0001e8c0: 616d 7320 3d20 7b0a 2020 2020 2020 2020  ams = {.        
-0001e8d0: 2020 2020 2263 6861 6e6e 656c 223a 2063      "channel": c
-0001e8e0: 6861 6e6e 656c 2c0a 2020 2020 2020 2020  hannel,.        
-0001e8f0: 2020 2020 2276 6572 7369 6f6e 223a 2076      "version": v
-0001e900: 6572 7369 6f6e 2c0a 2020 2020 2020 2020  ersion,.        
-0001e910: 2020 2020 2274 6167 223a 2074 6167 2c0a      "tag": tag,.
-0001e920: 2020 2020 2020 2020 2020 2020 2266 6f72              "for
-0001e930: 6365 2d72 6566 7265 7368 223a 2066 6f72  ce-refresh": for
-0001e940: 6365 5f72 6566 7265 7368 2c0a 2020 2020  ce_refresh,.    
-0001e950: 2020 2020 7d0a 2020 2020 2020 2020 7265      }.        re
-0001e960: 7370 6f6e 7365 203d 2073 656c 662e 6170  sponse = self.ap
-0001e970: 695f 6361 6c6c 286d 6574 686f 643d 2247  i_call(method="G
-0001e980: 4554 222c 2070 6174 683d 7061 7468 2c20  ET", path=path, 
-0001e990: 7061 7261 6d73 3d70 6172 616d 7329 0a20  params=params). 
-0001e9a0: 2020 2020 2020 2072 6574 7572 6e20 7363         return sc
-0001e9b0: 6865 6d61 732e 4d61 726b 6574 706c 6163  hemas.Marketplac
-0001e9c0: 6543 6174 616c 6f67 282a 2a72 6573 706f  eCatalog(**respo
-0001e9d0: 6e73 652e 6a73 6f6e 2829 290a 0a20 2020  nse.json())..   
-0001e9e0: 2064 6566 2067 6574 5f6d 6172 6b65 7470   def get_marketp
-0001e9f0: 6c61 6365 5f69 7465 6d28 0a20 2020 2020  lace_item(.     
-0001ea00: 2020 2073 656c 662c 0a20 2020 2020 2020     self,.       
-0001ea10: 2073 6f75 7263 655f 6e61 6d65 3a20 7374   source_name: st
-0001ea20: 722c 0a20 2020 2020 2020 2069 7465 6d5f  r,.        item_
-0001ea30: 6e61 6d65 3a20 7374 722c 0a20 2020 2020  name: str,.     
-0001ea40: 2020 2063 6861 6e6e 656c 3a20 7374 7220     channel: str 
-0001ea50: 3d20 2264 6576 656c 6f70 6d65 6e74 222c  = "development",
-0001ea60: 0a20 2020 2020 2020 2076 6572 7369 6f6e  .        version
-0001ea70: 3a20 7374 7220 3d20 4e6f 6e65 2c0a 2020  : str = None,.  
-0001ea80: 2020 2020 2020 7461 673a 2073 7472 203d        tag: str =
-0001ea90: 2022 6c61 7465 7374 222c 0a20 2020 2020   "latest",.     
-0001eaa0: 2020 2066 6f72 6365 5f72 6566 7265 7368     force_refresh
-0001eab0: 3a20 626f 6f6c 203d 2046 616c 7365 2c0a  : bool = False,.
-0001eac0: 2020 2020 293a 0a20 2020 2020 2020 2022      ):.        "
-0001ead0: 2222 0a20 2020 2020 2020 2052 6574 7269  "".        Retri
-0001eae0: 6576 6520 6120 7370 6563 6966 6963 206d  eve a specific m
-0001eaf0: 6172 6b65 7470 6c61 6365 2069 7465 6d2e  arketplace item.
-0001eb00: 0a0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
-0001eb10: 2073 6f75 7263 655f 6e61 6d65 3a20 4e61   source_name: Na
-0001eb20: 6d65 206f 6620 736f 7572 6365 2e0a 2020  me of source..  
-0001eb30: 2020 2020 2020 3a70 6172 616d 2069 7465        :param ite
-0001eb40: 6d5f 6e61 6d65 3a20 4e61 6d65 206f 6620  m_name: Name of 
-0001eb50: 7468 6520 6974 656d 2074 6f20 7265 7472  the item to retr
-0001eb60: 6965 7665 2c20 6173 2069 7420 6170 7065  ieve, as it appe
-0001eb70: 6172 7320 696e 2074 6865 2063 6174 616c  ars in the catal
-0001eb80: 6f67 2e0a 2020 2020 2020 2020 3a70 6172  og..        :par
-0001eb90: 616d 2063 6861 6e6e 656c 3a20 4765 7420  am channel: Get 
-0001eba0: 7468 6520 6974 656d 2066 726f 6d20 7468  the item from th
-0001ebb0: 6520 7370 6563 6966 6965 6420 6368 616e  e specified chan
-0001ebc0: 6e65 6c2e 2044 6566 6175 6c74 2069 7320  nel. Default is 
-0001ebd0: 6060 6465 7665 6c6f 706d 656e 7460 602e  ``development``.
-0001ebe0: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
-0001ebf0: 7665 7273 696f 6e3a 2047 6574 2061 2073  version: Get a s
-0001ec00: 7065 6369 6669 6320 7665 7273 696f 6e20  pecific version 
-0001ec10: 6f66 2074 6865 2069 7465 6d2e 2044 6566  of the item. Def
-0001ec20: 6175 6c74 2069 7320 6060 4e6f 6e65 6060  ault is ``None``
-0001ec30: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
-0001ec40: 2074 6167 3a20 4765 7420 6120 7370 6563   tag: Get a spec
-0001ec50: 6966 6963 2076 6572 7369 6f6e 206f 6620  ific version of 
-0001ec60: 7468 6520 6974 656d 2069 6465 6e74 6966  the item identif
-0001ec70: 6965 6420 6279 2074 6167 2e20 4465 6661  ied by tag. Defa
-0001ec80: 756c 7420 6973 2060 606c 6174 6573 7460  ult is ``latest`
-0001ec90: 602e 0a20 2020 2020 2020 203a 7061 7261  `..        :para
-0001eca0: 6d20 666f 7263 655f 7265 6672 6573 683a  m force_refresh:
-0001ecb0: 204d 616b 6520 7468 6520 7365 7276 6572   Make the server
-0001ecc0: 2066 6574 6368 2074 6865 2069 6e66 6f72   fetch the infor
-0001ecd0: 6d61 7469 6f6e 2066 726f 6d20 7468 6520  mation from the 
-0001ece0: 6163 7475 616c 206d 6172 6b65 7470 6c61  actual marketpla
-0001ecf0: 6365 0a20 2020 2020 2020 2020 2020 2073  ce.            s
-0001ed00: 6f75 7263 652c 2072 6174 6865 7220 7468  ource, rather th
-0001ed10: 616e 0a20 2020 2020 2020 2020 2020 2072  an.            r
-0001ed20: 656c 7920 6f6e 2063 6163 6865 6420 696e  ely on cached in
-0001ed30: 666f 726d 6174 696f 6e2e 2044 6566 6175  formation. Defau
-0001ed40: 6c74 2069 7320 6060 4661 6c73 6560 602e  lt is ``False``.
-0001ed50: 0a20 2020 2020 2020 203a 7265 7475 726e  .        :return
-0001ed60: 733a 203a 7079 3a63 6c61 7373 3a60 7e6d  s: :py:class:`~m
-0001ed70: 6c72 756e 2e61 7069 2e73 6368 656d 6173  lrun.api.schemas
-0001ed80: 2e6d 6172 6b65 7470 6c61 6365 2e4d 6172  .marketplace.Mar
-0001ed90: 6b65 7470 6c61 6365 4974 656d 602e 0a20  ketplaceItem`.. 
-0001eda0: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-0001edb0: 2020 2070 6174 6820 3d20 2866 226d 6172     path = (f"mar
-0001edc0: 6b65 7470 6c61 6365 2f73 6f75 7263 6573  ketplace/sources
-0001edd0: 2f7b 736f 7572 6365 5f6e 616d 657d 2f69  /{source_name}/i
-0001ede0: 7465 6d73 2f7b 6974 656d 5f6e 616d 657d  tems/{item_name}
-0001edf0: 222c 290a 2020 2020 2020 2020 7061 7261  ",).        para
-0001ee00: 6d73 203d 207b 0a20 2020 2020 2020 2020  ms = {.         
-0001ee10: 2020 2022 6368 616e 6e65 6c22 3a20 6368     "channel": ch
-0001ee20: 616e 6e65 6c2c 0a20 2020 2020 2020 2020  annel,.         
-0001ee30: 2020 2022 7665 7273 696f 6e22 3a20 7665     "version": ve
-0001ee40: 7273 696f 6e2c 0a20 2020 2020 2020 2020  rsion,.         
-0001ee50: 2020 2022 7461 6722 3a20 7461 672c 0a20     "tag": tag,. 
-0001ee60: 2020 2020 2020 2020 2020 2022 666f 7263             "forc
-0001ee70: 652d 7265 6672 6573 6822 3a20 666f 7263  e-refresh": forc
-0001ee80: 655f 7265 6672 6573 682c 0a20 2020 2020  e_refresh,.     
-0001ee90: 2020 207d 0a20 2020 2020 2020 2072 6573     }.        res
-0001eea0: 706f 6e73 6520 3d20 7365 6c66 2e61 7069  ponse = self.api
-0001eeb0: 5f63 616c 6c28 6d65 7468 6f64 3d22 4745  _call(method="GE
-0001eec0: 5422 2c20 7061 7468 3d70 6174 682c 2070  T", path=path, p
-0001eed0: 6172 616d 733d 7061 7261 6d73 290a 2020  arams=params).  
-0001eee0: 2020 2020 2020 7265 7475 726e 2073 6368        return sch
-0001eef0: 656d 6173 2e4d 6172 6b65 7470 6c61 6365  emas.Marketplace
-0001ef00: 4974 656d 282a 2a72 6573 706f 6e73 652e  Item(**response.
-0001ef10: 6a73 6f6e 2829 290a 0a20 2020 2064 6566  json())..    def
-0001ef20: 2076 6572 6966 795f 6175 7468 6f72 697a   verify_authoriz
-0001ef30: 6174 696f 6e28 0a20 2020 2020 2020 2073  ation(.        s
-0001ef40: 656c 662c 2061 7574 686f 7269 7a61 7469  elf, authorizati
-0001ef50: 6f6e 5f76 6572 6966 6963 6174 696f 6e5f  on_verification_
-0001ef60: 696e 7075 743a 2073 6368 656d 6173 2e41  input: schemas.A
-0001ef70: 7574 686f 7269 7a61 7469 6f6e 5665 7269  uthorizationVeri
-0001ef80: 6669 6361 7469 6f6e 496e 7075 740a 2020  ficationInput.  
-0001ef90: 2020 293a 0a20 2020 2020 2020 2022 2222    ):.        """
-0001efa0: 5665 7269 6669 6573 2061 7574 686f 7269  Verifies authori
-0001efb0: 7a61 7469 6f6e 2066 6f72 2074 6865 2070  zation for the p
-0001efc0: 726f 7669 6465 6420 6163 7469 6f6e 206f  rovided action o
-0001efd0: 6e20 7468 6520 7072 6f76 6964 6564 2072  n the provided r
-0001efe0: 6573 6f75 7263 652e 0a0a 2020 2020 2020  esource...      
-0001eff0: 2020 3a70 6172 616d 2061 7574 686f 7269    :param authori
-0001f000: 7a61 7469 6f6e 5f76 6572 6966 6963 6174  zation_verificat
-0001f010: 696f 6e5f 696e 7075 743a 2049 6e73 7461  ion_input: Insta
-0001f020: 6e63 6520 6f66 0a20 2020 2020 2020 2020  nce of.         
-0001f030: 2020 203a 7079 3a63 6c61 7373 3a60 7e6d     :py:class:`~m
-0001f040: 6c72 756e 2e61 7069 2e73 6368 656d 6173  lrun.api.schemas
-0001f050: 2e41 7574 686f 7269 7a61 7469 6f6e 5665  .AuthorizationVe
-0001f060: 7269 6669 6361 7469 6f6e 496e 7075 7460  rificationInput`
-0001f070: 2074 6861 7420 696e 636c 7564 6573 2061   that includes a
-0001f080: 6c6c 2074 6865 206e 6565 6465 6420 7061  ll the needed pa
-0001f090: 7261 6d65 7465 7273 2066 6f72 0a20 2020  rameters for.   
-0001f0a0: 2020 2020 2020 2020 2074 6865 2061 7574           the aut
-0001f0b0: 6820 7665 7269 6669 6361 7469 6f6e 0a20  h verification. 
-0001f0c0: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-0001f0d0: 2020 2065 7272 6f72 5f6d 6573 7361 6765     error_message
-0001f0e0: 203d 2022 4175 7468 6f72 697a 6174 696f   = "Authorizatio
-0001f0f0: 6e20 6368 6563 6b20 6661 696c 6564 220a  n check failed".
-0001f100: 2020 2020 2020 2020 7365 6c66 2e61 7069          self.api
-0001f110: 5f63 616c 6c28 0a20 2020 2020 2020 2020  _call(.         
-0001f120: 2020 2022 504f 5354 222c 0a20 2020 2020     "POST",.     
-0001f130: 2020 2020 2020 2022 6175 7468 6f72 697a         "authoriz
-0001f140: 6174 696f 6e2f 7665 7269 6669 6361 7469  ation/verificati
-0001f150: 6f6e 7322 2c0a 2020 2020 2020 2020 2020  ons",.          
-0001f160: 2020 6572 726f 725f 6d65 7373 6167 652c    error_message,
-0001f170: 0a20 2020 2020 2020 2020 2020 2062 6f64  .            bod
-0001f180: 793d 6469 6374 5f74 6f5f 6a73 6f6e 2861  y=dict_to_json(a
-0001f190: 7574 686f 7269 7a61 7469 6f6e 5f76 6572  uthorization_ver
-0001f1a0: 6966 6963 6174 696f 6e5f 696e 7075 742e  ification_input.
-0001f1b0: 6469 6374 2829 292c 0a20 2020 2020 2020  dict()),.       
-0001f1c0: 2029 0a0a 2020 2020 6465 6620 7472 6967   )..    def trig
-0001f1d0: 6765 725f 6d69 6772 6174 696f 6e73 2873  ger_migrations(s
-0001f1e0: 656c 6629 202d 3e20 4f70 7469 6f6e 616c  elf) -> Optional
-0001f1f0: 5b73 6368 656d 6173 2e42 6163 6b67 726f  [schemas.Backgro
-0001f200: 756e 6454 6173 6b5d 3a0a 2020 2020 2020  undTask]:.      
-0001f210: 2020 2222 2254 7269 6767 6572 206d 6967    """Trigger mig
-0001f220: 7261 7469 6f6e 7320 2877 696c 6c20 646f  rations (will do
-0001f230: 206e 6f74 6869 6e67 2069 6620 6e6f 206d   nothing if no m
-0001f240: 6967 7261 7469 6f6e 7320 6172 6520 6e65  igrations are ne
-0001f250: 6564 6564 2920 616e 6420 7761 6974 2066  eded) and wait f
-0001f260: 6f72 2074 6865 6d20 746f 2066 696e 6973  or them to finis
-0001f270: 6820 6966 2061 6374 7561 6c6c 790a 2020  h if actually.  
-0001f280: 2020 2020 2020 7472 6967 6765 7265 640a        triggered.
-0001f290: 2020 2020 2020 2020 3a72 6574 7572 6e73          :returns
-0001f2a0: 3a20 3a70 793a 636c 6173 733a 607e 6d6c  : :py:class:`~ml
-0001f2b0: 7275 6e2e 6170 692e 7363 6865 6d61 732e  run.api.schemas.
-0001f2c0: 4261 636b 6772 6f75 6e64 5461 736b 602e  BackgroundTask`.
-0001f2d0: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-0001f2e0: 2020 2020 2072 6573 706f 6e73 6520 3d20       response = 
-0001f2f0: 7365 6c66 2e61 7069 5f63 616c 6c28 0a20  self.api_call(. 
-0001f300: 2020 2020 2020 2020 2020 2022 504f 5354             "POST
-0001f310: 222c 0a20 2020 2020 2020 2020 2020 2022  ",.            "
-0001f320: 6f70 6572 6174 696f 6e73 2f6d 6967 7261  operations/migra
-0001f330: 7469 6f6e 7322 2c0a 2020 2020 2020 2020  tions",.        
-0001f340: 2020 2020 2246 6169 6c65 6420 7472 6967      "Failed trig
-0001f350: 6765 7269 6e67 206d 6967 7261 7469 6f6e  gering migration
-0001f360: 7322 2c0a 2020 2020 2020 2020 290a 2020  s",.        ).  
-0001f370: 2020 2020 2020 6966 2072 6573 706f 6e73        if respons
-0001f380: 652e 7374 6174 7573 5f63 6f64 6520 3d3d  e.status_code ==
-0001f390: 2068 7474 702e 4854 5450 5374 6174 7573   http.HTTPStatus
-0001f3a0: 2e41 4343 4550 5445 443a 0a20 2020 2020  .ACCEPTED:.     
-0001f3b0: 2020 2020 2020 2062 6163 6b67 726f 756e         backgroun
-0001f3c0: 645f 7461 736b 203d 2073 6368 656d 6173  d_task = schemas
-0001f3d0: 2e42 6163 6b67 726f 756e 6454 6173 6b28  .BackgroundTask(
-0001f3e0: 2a2a 7265 7370 6f6e 7365 2e6a 736f 6e28  **response.json(
-0001f3f0: 2929 0a20 2020 2020 2020 2020 2020 2072  )).            r
-0001f400: 6574 7572 6e20 7365 6c66 2e5f 7761 6974  eturn self._wait
-0001f410: 5f66 6f72 5f62 6163 6b67 726f 756e 645f  _for_background_
-0001f420: 7461 736b 5f74 6f5f 7265 6163 685f 7465  task_to_reach_te
-0001f430: 726d 696e 616c 5f73 7461 7465 280a 2020  rminal_state(.  
-0001f440: 2020 2020 2020 2020 2020 2020 2020 6261                ba
-0001f450: 636b 6772 6f75 6e64 5f74 6173 6b2e 6d65  ckground_task.me
-0001f460: 7461 6461 7461 2e6e 616d 650a 2020 2020  tadata.name.    
-0001f470: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-0001f480: 2020 7265 7475 726e 204e 6f6e 650a 0a0a    return None...
-0001f490: 6465 6620 5f61 735f 6a73 6f6e 286f 626a  def _as_json(obj
-0001f4a0: 293a 0a20 2020 2066 6e20 3d20 6765 7461  ):.    fn = geta
-0001f4b0: 7474 7228 6f62 6a2c 2022 746f 5f6a 736f  ttr(obj, "to_jso
-0001f4c0: 6e22 2c20 4e6f 6e65 290a 2020 2020 6966  n", None).    if
-0001f4d0: 2066 6e3a 0a20 2020 2020 2020 2072 6574   fn:.        ret
-0001f4e0: 7572 6e20 666e 2829 0a20 2020 2072 6574  urn fn().    ret
-0001f4f0: 7572 6e20 6469 6374 5f74 6f5f 6a73 6f6e  urn dict_to_json
-0001f500: 286f 626a 290a                           (obj).
+0001cd40: 2020 2020 2020 2020 2020 2020 2020 276b                'k
+0001cd50: 6c64 5f73 756d 273a 2032 342e 322c 0a20  ld_sum': 24.2,. 
+0001cd60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001cd70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001cd80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001cd90: 276b 6c64 5f6d 6561 6e27 3a20 362e 302c  'kld_mean': 6.0,
+0001cda0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001cdb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001cdc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001cdd0: 2020 2766 3127 3a20 7b27 7476 6427 3a20    'f1': {'tvd': 
+0001cde0: 302e 352c 2027 6865 6c6c 696e 6765 7227  0.5, 'hellinger'
+0001cdf0: 3a20 312e 302c 2027 6b6c 6427 3a20 362e  : 1.0, 'kld': 6.
+0001ce00: 347d 2c0a 2020 2020 2020 2020 2020 2020  4},.            
+0001ce10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ce20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ce30: 2020 2020 2027 6632 273a 207b 2774 7664       'f2': {'tvd
+0001ce40: 273a 2030 2e35 2c20 2768 656c 6c69 6e67  ': 0.5, 'helling
+0001ce50: 6572 273a 2031 2e30 2c20 276b 6c64 273a  er': 1.0, 'kld':
+0001ce60: 2036 2e35 7d7d 0a0a 2020 2020 2020 2020   6.5}}..        
+0001ce70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ce80: 2020 2020 2020 2020 2320 4372 6561 7465          # Create
+0001ce90: 2061 7474 7269 6275 7465 7320 6469 6374   attributes dict
+0001cea0: 696f 6e61 7279 2061 6363 6f72 6469 6e67  ionary according
+0001ceb0: 2074 6f20 7468 6520 7265 7175 6972 6564   to the required
+0001cec0: 2066 6f72 6d61 740a 2020 2020 2020 2020   format.        
+0001ced0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001cee0: 2020 2020 2020 2020 6174 7472 6962 7574          attribut
+0001cef0: 6573 203d 207b 6063 7572 7265 6e74 5f73  es = {`current_s
+0001cf00: 7461 7473 603a 206a 736f 6e2e 6475 6d70  tats`: json.dump
+0001cf10: 7328 6375 7272 656e 745f 7374 6174 7329  s(current_stats)
+0001cf20: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0001cf30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001cf40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001cf50: 6064 7269 6674 5f73 7461 7475 7360 3a20  `drift_status`: 
+0001cf60: 2244 5249 4654 5f44 4554 4543 5445 4422  "DRIFT_DETECTED"
+0001cf70: 7d0a 0a20 2020 2020 2020 2022 2222 0a0a  }..        """..
+0001cf80: 2020 2020 2020 2020 6174 7472 6962 7574          attribut
+0001cf90: 6573 203d 207b 2261 7474 7269 6275 7465  es = {"attribute
+0001cfa0: 7322 3a20 5f61 735f 6a73 6f6e 2861 7474  s": _as_json(att
+0001cfb0: 7269 6275 7465 7329 7d0a 2020 2020 2020  ributes)}.      
+0001cfc0: 2020 7061 7468 203d 2066 2270 726f 6a65    path = f"proje
+0001cfd0: 6374 732f 7b70 726f 6a65 6374 7d2f 6d6f  cts/{project}/mo
+0001cfe0: 6465 6c2d 656e 6470 6f69 6e74 732f 7b65  del-endpoints/{e
+0001cff0: 6e64 706f 696e 745f 6964 7d22 0a20 2020  ndpoint_id}".   
+0001d000: 2020 2020 2073 656c 662e 6170 695f 6361       self.api_ca
+0001d010: 6c6c 280a 2020 2020 2020 2020 2020 2020  ll(.            
+0001d020: 6d65 7468 6f64 3d22 5041 5443 4822 2c0a  method="PATCH",.
+0001d030: 2020 2020 2020 2020 2020 2020 7061 7468              path
+0001d040: 3d70 6174 682c 0a20 2020 2020 2020 2020  =path,.         
+0001d050: 2020 2070 6172 616d 733d 6174 7472 6962     params=attrib
+0001d060: 7574 6573 2c0a 2020 2020 2020 2020 290a  utes,.        ).
+0001d070: 0a20 2020 2064 6566 2063 7265 6174 655f  .    def create_
+0001d080: 6d61 726b 6574 706c 6163 655f 736f 7572  marketplace_sour
+0001d090: 6365 280a 2020 2020 2020 2020 7365 6c66  ce(.        self
+0001d0a0: 2c20 736f 7572 6365 3a20 556e 696f 6e5b  , source: Union[
+0001d0b0: 6469 6374 2c20 7363 6865 6d61 732e 496e  dict, schemas.In
+0001d0c0: 6465 7865 644d 6172 6b65 7470 6c61 6365  dexedMarketplace
+0001d0d0: 536f 7572 6365 5d0a 2020 2020 293a 0a20  Source].    ):. 
+0001d0e0: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+0001d0f0: 2020 2041 6464 2061 206e 6577 206d 6172     Add a new mar
+0001d100: 6b65 7470 6c61 6365 2073 6f75 7263 652e  ketplace source.
+0001d110: 0a0a 2020 2020 2020 2020 4d4c 5275 6e20  ..        MLRun 
+0001d120: 6d61 696e 7461 696e 7320 616e 206f 7264  maintains an ord
+0001d130: 6572 6564 206c 6973 7420 6f66 206d 6172  ered list of mar
+0001d140: 6b65 7470 6c61 6365 2073 6f75 7263 6573  ketplace sources
+0001d150: 2028 e280 9c73 6f75 7263 6573 e280 9d29   (...sources...)
+0001d160: 2045 6163 6820 736f 7572 6365 2068 6173   Each source has
+0001d170: 0a20 2020 2020 2020 2069 7473 2064 6574  .        its det
+0001d180: 6169 6c73 2072 6567 6973 7465 7265 6420  ails registered 
+0001d190: 616e 6420 6974 7320 6f72 6465 7220 7769  and its order wi
+0001d1a0: 7468 696e 2074 6865 206c 6973 742e 2057  thin the list. W
+0001d1b0: 6865 6e20 6372 6561 7469 6e67 2061 206e  hen creating a n
+0001d1c0: 6577 2073 6f75 7263 652c 2074 6865 2073  ew source, the s
+0001d1d0: 7065 6369 616c 206f 7264 6572 2060 602d  pecial order ``-
+0001d1e0: 3160 600a 2020 2020 2020 2020 6361 6e20  1``.        can 
+0001d1f0: 6265 2075 7365 6420 746f 206d 6172 6b20  be used to mark 
+0001d200: 7468 6973 2073 6f75 7263 6520 6173 206c  this source as l
+0001d210: 6173 7420 696e 2074 6865 206c 6973 742e  ast in the list.
+0001d220: 2048 6f77 6576 6572 2c20 6f6e 6365 2074   However, once t
+0001d230: 6865 2073 6f75 7263 6520 6973 2069 6e20  he source is in 
+0001d240: 7468 6520 4d4c 5275 6e20 6c69 7374 2c0a  the MLRun list,.
+0001d250: 2020 2020 2020 2020 6974 7320 6f72 6465          its orde
+0001d260: 7220 7769 6c6c 2061 6c77 6179 7320 6265  r will always be
+0001d270: 2060 603e 3060 602e 0a0a 2020 2020 2020   ``>0``...      
+0001d280: 2020 5468 6520 676c 6f62 616c 206d 6172    The global mar
+0001d290: 6b65 7470 6c61 6365 2073 6f75 7263 6520  ketplace source 
+0001d2a0: 616c 7761 7973 2065 7869 7374 7320 696e  always exists in
+0001d2b0: 2074 6865 206c 6973 742c 2061 6e64 2069   the list, and i
+0001d2c0: 7320 616c 7761 7973 2074 6865 206c 6173  s always the las
+0001d2d0: 7420 736f 7572 6365 0a20 2020 2020 2020  t source.       
+0001d2e0: 2028 6060 6f72 6465 7220 3d20 2d31 6060   (``order = -1``
+0001d2f0: 292e 2049 7420 6361 6e6e 6f74 2062 6520  ). It cannot be 
+0001d300: 6d6f 6469 6669 6564 206e 6f72 2063 616e  modified nor can
+0001d310: 2069 7420 6265 206d 6f76 6564 2074 6f20   it be moved to 
+0001d320: 616e 6f74 6865 7220 6f72 6465 7220 696e  another order in
+0001d330: 2074 6865 206c 6973 742e 0a0a 2020 2020   the list...    
+0001d340: 2020 2020 5468 6520 736f 7572 6365 206f      The source o
+0001d350: 626a 6563 7420 6d61 7920 636f 6e74 6169  bject may contai
+0001d360: 6e20 6372 6564 656e 7469 616c 7320 7768  n credentials wh
+0001d370: 6963 6820 6172 6520 6e65 6564 6564 2074  ich are needed t
+0001d380: 6f20 6163 6365 7373 2074 6865 2064 6174  o access the dat
+0001d390: 6173 746f 7265 2077 6865 7265 2074 6865  astore where the
+0001d3a0: 2073 6f75 7263 6520 6973 2073 746f 7265   source is store
+0001d3b0: 642e 0a20 2020 2020 2020 2054 6865 7365  d..        These
+0001d3c0: 2063 7265 6465 6e74 6961 6c73 2061 7265   credentials are
+0001d3d0: 206e 6f74 206b 6570 7420 696e 2074 6865   not kept in the
+0001d3e0: 204d 4c52 756e 2044 422c 2062 7574 2061   MLRun DB, but a
+0001d3f0: 7265 2073 746f 7265 6420 696e 7369 6465  re stored inside
+0001d400: 2061 206b 7562 6572 6e65 7465 7320 7365   a kubernetes se
+0001d410: 6372 6574 206f 626a 6563 7420 6d61 696e  cret object main
+0001d420: 7461 696e 6564 2062 790a 2020 2020 2020  tained by.      
+0001d430: 2020 4d4c 5275 6e2e 2054 6865 7920 6172    MLRun. They ar
+0001d440: 6520 6e6f 7420 7265 7475 726e 6564 2074  e not returned t
+0001d450: 6872 6f75 6768 2061 6e79 2041 5049 2066  hrough any API f
+0001d460: 726f 6d20 4d4c 5275 6e2e 0a0a 2020 2020  rom MLRun...    
+0001d470: 2020 2020 4578 616d 706c 653a 3a0a 0a20      Example::.. 
+0001d480: 2020 2020 2020 2020 2020 2069 6d70 6f72             impor
+0001d490: 7420 6d6c 7275 6e2e 6170 692e 7363 6865  t mlrun.api.sche
+0001d4a0: 6d61 730a 0a20 2020 2020 2020 2020 2020  mas..           
+0001d4b0: 2023 2041 6464 2061 2070 7269 7661 7465   # Add a private
+0001d4c0: 2073 6f75 7263 6520 6173 2074 6865 206c   source as the l
+0001d4d0: 6173 7420 6f6e 6520 2877 696c 6c20 6265  ast one (will be
+0001d4e0: 2023 3120 696e 2074 6865 206c 6973 7429   #1 in the list)
+0001d4f0: 0a20 2020 2020 2020 2020 2020 2070 7269  .            pri
+0001d500: 7661 7465 5f73 6f75 7263 6520 3d20 6d6c  vate_source = ml
+0001d510: 7275 6e2e 6170 692e 7363 6865 6d61 732e  run.api.schemas.
+0001d520: 496e 6465 7865 644d 6172 6b65 7470 6c61  IndexedMarketpla
+0001d530: 6365 536f 7572 6365 280a 2020 2020 2020  ceSource(.      
+0001d540: 2020 2020 2020 2020 2020 6f72 6465 723d            order=
+0001d550: 2d31 2c0a 2020 2020 2020 2020 2020 2020  -1,.            
+0001d560: 2020 2020 736f 7572 6365 3d6d 6c72 756e      source=mlrun
+0001d570: 2e61 7069 2e73 6368 656d 6173 2e4d 6172  .api.schemas.Mar
+0001d580: 6b65 7470 6c61 6365 536f 7572 6365 280a  ketplaceSource(.
+0001d590: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d5a0: 2020 2020 6d65 7461 6461 7461 3d6d 6c72      metadata=mlr
+0001d5b0: 756e 2e61 7069 2e73 6368 656d 6173 2e4d  un.api.schemas.M
+0001d5c0: 6172 6b65 7470 6c61 6365 4f62 6a65 6374  arketplaceObject
+0001d5d0: 4d65 7461 6461 7461 286e 616d 653d 2270  Metadata(name="p
+0001d5e0: 7269 7622 2c20 6465 7363 7269 7074 696f  riv", descriptio
+0001d5f0: 6e3d 2261 2070 7269 7661 7465 2073 6f75  n="a private sou
+0001d600: 7263 6522 292c 0a20 2020 2020 2020 2020  rce"),.         
+0001d610: 2020 2020 2020 2020 2020 2073 7065 633d             spec=
+0001d620: 6d6c 7275 6e2e 6170 692e 7363 6865 6d61  mlrun.api.schema
+0001d630: 732e 4d61 726b 6574 706c 6163 6553 6f75  s.MarketplaceSou
+0001d640: 7263 6553 7065 6328 7061 7468 3d22 2f6c  rceSpec(path="/l
+0001d650: 6f63 616c 2f70 6174 682f 746f 2f73 6f75  ocal/path/to/sou
+0001d660: 7263 6522 2c20 6368 616e 6e65 6c3d 2264  rce", channel="d
+0001d670: 6576 656c 6f70 6d65 6e74 2229 0a20 2020  evelopment").   
+0001d680: 2020 2020 2020 2020 2020 2020 2029 0a20               ). 
+0001d690: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
+0001d6a0: 2020 2020 2020 2020 2064 622e 6372 6561           db.crea
+0001d6b0: 7465 5f6d 6172 6b65 7470 6c61 6365 5f73  te_marketplace_s
+0001d6c0: 6f75 7263 6528 7072 6976 6174 655f 736f  ource(private_so
+0001d6d0: 7572 6365 290a 0a20 2020 2020 2020 2020  urce)..         
+0001d6e0: 2020 2023 2041 6464 2061 6e6f 7468 6572     # Add another
+0001d6f0: 2073 6f75 7263 6520 6173 2031 7374 2069   source as 1st i
+0001d700: 6e20 7468 6520 6c69 7374 202d 2077 696c  n the list - wil
+0001d710: 6c20 7075 7368 2070 7265 7669 6f75 7320  l push previous 
+0001d720: 6f6e 6520 746f 2062 6520 2332 0a20 2020  one to be #2.   
+0001d730: 2020 2020 2020 2020 2061 6e6f 7468 6572           another
+0001d740: 5f73 6f75 7263 6520 3d20 6d6c 7275 6e2e  _source = mlrun.
+0001d750: 6170 692e 7363 6865 6d61 732e 496e 6465  api.schemas.Inde
+0001d760: 7865 644d 6172 6b65 7470 6c61 6365 536f  xedMarketplaceSo
+0001d770: 7572 6365 280a 2020 2020 2020 2020 2020  urce(.          
+0001d780: 2020 2020 2020 6f72 6465 723d 312c 0a20        order=1,. 
+0001d790: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+0001d7a0: 6f75 7263 653d 6d6c 7275 6e2e 6170 692e  ource=mlrun.api.
+0001d7b0: 7363 6865 6d61 732e 4d61 726b 6574 706c  schemas.Marketpl
+0001d7c0: 6163 6553 6f75 7263 6528 0a20 2020 2020  aceSource(.     
+0001d7d0: 2020 2020 2020 2020 2020 2020 2020 206d                 m
+0001d7e0: 6574 6164 6174 613d 6d6c 7275 6e2e 6170  etadata=mlrun.ap
+0001d7f0: 692e 7363 6865 6d61 732e 4d61 726b 6574  i.schemas.Market
+0001d800: 706c 6163 654f 626a 6563 744d 6574 6164  placeObjectMetad
+0001d810: 6174 6128 6e61 6d65 3d22 7072 6976 2d32  ata(name="priv-2
+0001d820: 222c 2064 6573 6372 6970 7469 6f6e 3d22  ", description="
+0001d830: 616e 6f74 6865 7220 736f 7572 6365 2229  another source")
+0001d840: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0001d850: 2020 2020 2020 7370 6563 3d6d 6c72 756e        spec=mlrun
+0001d860: 2e61 7069 2e73 6368 656d 6173 2e4d 6172  .api.schemas.Mar
+0001d870: 6b65 7470 6c61 6365 536f 7572 6365 5370  ketplaceSourceSp
+0001d880: 6563 280a 2020 2020 2020 2020 2020 2020  ec(.            
+0001d890: 2020 2020 2020 2020 2020 2020 7061 7468              path
+0001d8a0: 3d22 2f6c 6f63 616c 2f70 6174 682f 746f  ="/local/path/to
+0001d8b0: 2f73 6f75 7263 652f 3222 2c0a 2020 2020  /source/2",.    
+0001d8c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d8d0: 2020 2020 6368 616e 6e65 6c3d 2264 6576      channel="dev
+0001d8e0: 656c 6f70 6d65 6e74 222c 0a20 2020 2020  elopment",.     
+0001d8f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d900: 2020 2063 7265 6465 6e74 6961 6c73 3d7b     credentials={
+0001d910: 2e2e 2e7d 0a20 2020 2020 2020 2020 2020  ...}.           
+0001d920: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
+0001d930: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
+0001d940: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
+0001d950: 2020 2020 2020 2064 622e 6372 6561 7465         db.create
+0001d960: 5f6d 6172 6b65 7470 6c61 6365 5f73 6f75  _marketplace_sou
+0001d970: 7263 6528 616e 6f74 6865 725f 736f 7572  rce(another_sour
+0001d980: 6365 290a 0a20 2020 2020 2020 203a 7061  ce)..        :pa
+0001d990: 7261 6d20 736f 7572 6365 3a20 5468 6520  ram source: The 
+0001d9a0: 736f 7572 6365 2061 6e64 2069 7473 206f  source and its o
+0001d9b0: 7264 6572 2c20 6f66 2074 7970 650a 2020  rder, of type.  
+0001d9c0: 2020 2020 2020 2020 2020 3a70 793a 636c            :py:cl
+0001d9d0: 6173 733a 607e 6d6c 7275 6e2e 6170 692e  ass:`~mlrun.api.
+0001d9e0: 7363 6865 6d61 732e 6d61 726b 6574 706c  schemas.marketpl
+0001d9f0: 6163 652e 496e 6465 7865 644d 6172 6b65  ace.IndexedMarke
+0001da00: 7470 6c61 6365 536f 7572 6365 602c 206f  tplaceSource`, o
+0001da10: 7220 696e 2064 6963 7469 6f6e 6172 7920  r in dictionary 
+0001da20: 666f 726d 2e0a 2020 2020 2020 2020 3a72  form..        :r
+0001da30: 6574 7572 6e73 3a20 5468 6520 736f 7572  eturns: The sour
+0001da40: 6365 206f 626a 6563 7420 6173 2069 6e73  ce object as ins
+0001da50: 6572 7465 6420 696e 746f 2074 6865 2064  erted into the d
+0001da60: 6174 6162 6173 652c 2077 6974 6820 6372  atabase, with cr
+0001da70: 6564 656e 7469 616c 7320 7374 7269 7070  edentials stripp
+0001da80: 6564 2e0a 2020 2020 2020 2020 2222 220a  ed..        """.
+0001da90: 2020 2020 2020 2020 7061 7468 203d 2022          path = "
+0001daa0: 6d61 726b 6574 706c 6163 652f 736f 7572  marketplace/sour
+0001dab0: 6365 7322 0a20 2020 2020 2020 2069 6620  ces".        if 
+0001dac0: 6973 696e 7374 616e 6365 2873 6f75 7263  isinstance(sourc
+0001dad0: 652c 2073 6368 656d 6173 2e49 6e64 6578  e, schemas.Index
+0001dae0: 6564 4d61 726b 6574 706c 6163 6553 6f75  edMarketplaceSou
+0001daf0: 7263 6529 3a0a 2020 2020 2020 2020 2020  rce):.          
+0001db00: 2020 736f 7572 6365 203d 2073 6f75 7263    source = sourc
+0001db10: 652e 6469 6374 2829 0a20 2020 2020 2020  e.dict().       
+0001db20: 2072 6573 706f 6e73 6520 3d20 7365 6c66   response = self
+0001db30: 2e61 7069 5f63 616c 6c28 6d65 7468 6f64  .api_call(method
+0001db40: 3d22 504f 5354 222c 2070 6174 683d 7061  ="POST", path=pa
+0001db50: 7468 2c20 6a73 6f6e 3d73 6f75 7263 6529  th, json=source)
+0001db60: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+0001db70: 7363 6865 6d61 732e 496e 6465 7865 644d  schemas.IndexedM
+0001db80: 6172 6b65 7470 6c61 6365 536f 7572 6365  arketplaceSource
+0001db90: 282a 2a72 6573 706f 6e73 652e 6a73 6f6e  (**response.json
+0001dba0: 2829 290a 0a20 2020 2064 6566 2073 746f  ())..    def sto
+0001dbb0: 7265 5f6d 6172 6b65 7470 6c61 6365 5f73  re_marketplace_s
+0001dbc0: 6f75 7263 6528 0a20 2020 2020 2020 2073  ource(.        s
+0001dbd0: 656c 662c 2073 6f75 7263 655f 6e61 6d65  elf, source_name
+0001dbe0: 3a20 7374 722c 2073 6f75 7263 653a 2055  : str, source: U
+0001dbf0: 6e69 6f6e 5b64 6963 742c 2073 6368 656d  nion[dict, schem
+0001dc00: 6173 2e49 6e64 6578 6564 4d61 726b 6574  as.IndexedMarket
+0001dc10: 706c 6163 6553 6f75 7263 655d 0a20 2020  placeSource].   
+0001dc20: 2029 3a0a 2020 2020 2020 2020 2222 220a   ):.        """.
+0001dc30: 2020 2020 2020 2020 4372 6561 7465 206f          Create o
+0001dc40: 7220 7265 706c 6163 6520 6120 6d61 726b  r replace a mark
+0001dc50: 6574 706c 6163 6520 736f 7572 6365 2e0a  etplace source..
+0001dc60: 2020 2020 2020 2020 466f 7220 616e 2065          For an e
+0001dc70: 7861 6d70 6c65 206f 6620 7468 6520 736f  xample of the so
+0001dc80: 7572 6365 2066 6f72 6d61 7420 616e 6420  urce format and 
+0001dc90: 6578 706c 616e 6174 696f 6e20 6f66 2074  explanation of t
+0001dca0: 6865 2073 6f75 7263 6520 6f72 6465 7220  he source order 
+0001dcb0: 6c6f 6769 632c 0a20 2020 2020 2020 2070  logic,.        p
+0001dcc0: 6c65 6173 6520 7365 6520 3a70 793a 6675  lease see :py:fu
+0001dcd0: 6e63 3a60 7e63 7265 6174 655f 6d61 726b  nc:`~create_mark
+0001dce0: 6574 706c 6163 655f 736f 7572 6365 602e  etplace_source`.
+0001dcf0: 2054 6869 7320 6d65 7468 6f64 2063 616e   This method can
+0001dd00: 2062 6520 7573 6564 2074 6f20 6d6f 6469   be used to modi
+0001dd10: 6679 2074 6865 2073 6f75 7263 6520 6974  fy the source it
+0001dd20: 7365 6c66 206f 7220 6974 730a 2020 2020  self or its.    
+0001dd30: 2020 2020 6f72 6465 7220 696e 2074 6865      order in the
+0001dd40: 206c 6973 7420 6f66 2073 6f75 7263 6573   list of sources
+0001dd50: 2e0a 0a20 2020 2020 2020 203a 7061 7261  ...        :para
+0001dd60: 6d20 736f 7572 6365 5f6e 616d 653a 204e  m source_name: N
+0001dd70: 616d 6520 6f66 2074 6865 2073 6f75 7263  ame of the sourc
+0001dd80: 6520 6f62 6a65 6374 2074 6f20 6d6f 6469  e object to modi
+0001dd90: 6679 2f63 7265 6174 652e 2049 7420 6d75  fy/create. It mu
+0001dda0: 7374 206d 6174 6368 2074 6865 2060 6073  st match the ``s
+0001ddb0: 6f75 7263 652e 6d65 7461 6461 7461 2e6e  ource.metadata.n
+0001ddc0: 616d 6560 600a 2020 2020 2020 2020 2020  ame``.          
+0001ddd0: 2020 7061 7261 6d65 7465 7220 696e 2074    parameter in t
+0001dde0: 6865 2073 6f75 7263 6520 6974 7365 6c66  he source itself
+0001ddf0: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
+0001de00: 2073 6f75 7263 653a 2053 6f75 7263 6520   source: Source 
+0001de10: 6f62 6a65 6374 2074 6f20 7374 6f72 6520  object to store 
+0001de20: 696e 2074 6865 2064 6174 6162 6173 652e  in the database.
+0001de30: 0a20 2020 2020 2020 203a 7265 7475 726e  .        :return
+0001de40: 733a 2054 6865 2073 6f75 7263 6520 6f62  s: The source ob
+0001de50: 6a65 6374 2061 7320 7374 6f72 6564 2069  ject as stored i
+0001de60: 6e20 7468 6520 4442 2e0a 2020 2020 2020  n the DB..      
+0001de70: 2020 2222 220a 2020 2020 2020 2020 7061    """.        pa
+0001de80: 7468 203d 2066 226d 6172 6b65 7470 6c61  th = f"marketpla
+0001de90: 6365 2f73 6f75 7263 6573 2f7b 736f 7572  ce/sources/{sour
+0001dea0: 6365 5f6e 616d 657d 220a 2020 2020 2020  ce_name}".      
+0001deb0: 2020 6966 2069 7369 6e73 7461 6e63 6528    if isinstance(
+0001dec0: 736f 7572 6365 2c20 7363 6865 6d61 732e  source, schemas.
+0001ded0: 496e 6465 7865 644d 6172 6b65 7470 6c61  IndexedMarketpla
+0001dee0: 6365 536f 7572 6365 293a 0a20 2020 2020  ceSource):.     
+0001def0: 2020 2020 2020 2073 6f75 7263 6520 3d20         source = 
+0001df00: 736f 7572 6365 2e64 6963 7428 290a 0a20  source.dict().. 
+0001df10: 2020 2020 2020 2072 6573 706f 6e73 6520         response 
+0001df20: 3d20 7365 6c66 2e61 7069 5f63 616c 6c28  = self.api_call(
+0001df30: 6d65 7468 6f64 3d22 5055 5422 2c20 7061  method="PUT", pa
+0001df40: 7468 3d70 6174 682c 206a 736f 6e3d 736f  th=path, json=so
+0001df50: 7572 6365 290a 2020 2020 2020 2020 7265  urce).        re
+0001df60: 7475 726e 2073 6368 656d 6173 2e49 6e64  turn schemas.Ind
+0001df70: 6578 6564 4d61 726b 6574 706c 6163 6553  exedMarketplaceS
+0001df80: 6f75 7263 6528 2a2a 7265 7370 6f6e 7365  ource(**response
+0001df90: 2e6a 736f 6e28 2929 0a0a 2020 2020 6465  .json())..    de
+0001dfa0: 6620 6c69 7374 5f6d 6172 6b65 7470 6c61  f list_marketpla
+0001dfb0: 6365 5f73 6f75 7263 6573 2873 656c 6629  ce_sources(self)
+0001dfc0: 3a0a 2020 2020 2020 2020 2222 220a 2020  :.        """.  
+0001dfd0: 2020 2020 2020 4c69 7374 206d 6172 6b65        List marke
+0001dfe0: 7470 6c61 6365 2073 6f75 7263 6573 2069  tplace sources i
+0001dff0: 6e20 7468 6520 4d4c 5275 6e20 4442 2e0a  n the MLRun DB..
+0001e000: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+0001e010: 2020 2020 7061 7468 203d 2022 6d61 726b      path = "mark
+0001e020: 6574 706c 6163 652f 736f 7572 6365 7322  etplace/sources"
+0001e030: 0a20 2020 2020 2020 2072 6573 706f 6e73  .        respons
+0001e040: 6520 3d20 7365 6c66 2e61 7069 5f63 616c  e = self.api_cal
+0001e050: 6c28 6d65 7468 6f64 3d22 4745 5422 2c20  l(method="GET", 
+0001e060: 7061 7468 3d70 6174 6829 2e6a 736f 6e28  path=path).json(
+0001e070: 290a 2020 2020 2020 2020 7265 7375 6c74  ).        result
+0001e080: 7320 3d20 5b5d 0a20 2020 2020 2020 2066  s = [].        f
+0001e090: 6f72 2069 7465 6d20 696e 2072 6573 706f  or item in respo
+0001e0a0: 6e73 653a 0a20 2020 2020 2020 2020 2020  nse:.           
+0001e0b0: 2072 6573 756c 7473 2e61 7070 656e 6428   results.append(
+0001e0c0: 7363 6865 6d61 732e 496e 6465 7865 644d  schemas.IndexedM
+0001e0d0: 6172 6b65 7470 6c61 6365 536f 7572 6365  arketplaceSource
+0001e0e0: 282a 2a69 7465 6d29 290a 2020 2020 2020  (**item)).      
+0001e0f0: 2020 7265 7475 726e 2072 6573 756c 7473    return results
+0001e100: 0a0a 2020 2020 6465 6620 6765 745f 6d61  ..    def get_ma
+0001e110: 726b 6574 706c 6163 655f 736f 7572 6365  rketplace_source
+0001e120: 2873 656c 662c 2073 6f75 7263 655f 6e61  (self, source_na
+0001e130: 6d65 3a20 7374 7229 3a0a 2020 2020 2020  me: str):.      
+0001e140: 2020 2222 220a 2020 2020 2020 2020 5265    """.        Re
+0001e150: 7472 6965 7665 2061 206d 6172 6b65 7470  trieve a marketp
+0001e160: 6c61 6365 2073 6f75 7263 6520 6672 6f6d  lace source from
+0001e170: 2074 6865 2044 422e 0a0a 2020 2020 2020   the DB...      
+0001e180: 2020 3a70 6172 616d 2073 6f75 7263 655f    :param source_
+0001e190: 6e61 6d65 3a20 4e61 6d65 206f 6620 7468  name: Name of th
+0001e1a0: 6520 6d61 726b 6574 706c 6163 6520 736f  e marketplace so
+0001e1b0: 7572 6365 2074 6f20 7265 7472 6965 7665  urce to retrieve
+0001e1c0: 2e0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
+0001e1d0: 2020 2020 2020 7061 7468 203d 2066 226d        path = f"m
+0001e1e0: 6172 6b65 7470 6c61 6365 2f73 6f75 7263  arketplace/sourc
+0001e1f0: 6573 2f7b 736f 7572 6365 5f6e 616d 657d  es/{source_name}
+0001e200: 220a 2020 2020 2020 2020 7265 7370 6f6e  ".        respon
+0001e210: 7365 203d 2073 656c 662e 6170 695f 6361  se = self.api_ca
+0001e220: 6c6c 286d 6574 686f 643d 2247 4554 222c  ll(method="GET",
+0001e230: 2070 6174 683d 7061 7468 290a 2020 2020   path=path).    
+0001e240: 2020 2020 7265 7475 726e 2073 6368 656d      return schem
+0001e250: 6173 2e49 6e64 6578 6564 4d61 726b 6574  as.IndexedMarket
+0001e260: 706c 6163 6553 6f75 7263 6528 2a2a 7265  placeSource(**re
+0001e270: 7370 6f6e 7365 2e6a 736f 6e28 2929 0a0a  sponse.json())..
+0001e280: 2020 2020 6465 6620 6465 6c65 7465 5f6d      def delete_m
+0001e290: 6172 6b65 7470 6c61 6365 5f73 6f75 7263  arketplace_sourc
+0001e2a0: 6528 7365 6c66 2c20 736f 7572 6365 5f6e  e(self, source_n
+0001e2b0: 616d 653a 2073 7472 293a 0a20 2020 2020  ame: str):.     
+0001e2c0: 2020 2022 2222 0a20 2020 2020 2020 2044     """.        D
+0001e2d0: 656c 6574 6520 6120 6d61 726b 6574 706c  elete a marketpl
+0001e2e0: 6163 6520 736f 7572 6365 2066 726f 6d20  ace source from 
+0001e2f0: 7468 6520 4442 2e0a 2020 2020 2020 2020  the DB..        
+0001e300: 5468 6520 736f 7572 6365 2077 696c 6c20  The source will 
+0001e310: 6265 2064 656c 6574 6564 2066 726f 6d20  be deleted from 
+0001e320: 7468 6520 6c69 7374 2c20 616e 6420 616e  the list, and an
+0001e330: 7920 666f 6c6c 6f77 696e 6720 736f 7572  y following sour
+0001e340: 6365 7320 7769 6c6c 2062 6520 7072 6f6d  ces will be prom
+0001e350: 6f74 6564 202d 2066 6f72 2065 7861 6d70  oted - for examp
+0001e360: 6c65 2c20 6966 2074 6865 0a20 2020 2020  le, if the.     
+0001e370: 2020 2031 7374 2073 6f75 7263 6520 6973     1st source is
+0001e380: 2064 656c 6574 6564 2c20 7468 6520 326e   deleted, the 2n
+0001e390: 6420 736f 7572 6365 2077 696c 6c20 6265  d source will be
+0001e3a0: 636f 6d65 2023 3120 696e 2074 6865 206c  come #1 in the l
+0001e3b0: 6973 742e 0a20 2020 2020 2020 2054 6865  ist..        The
+0001e3c0: 2067 6c6f 6261 6c20 6d61 726b 6574 706c   global marketpl
+0001e3d0: 6163 6520 736f 7572 6365 2063 616e 6e6f  ace source canno
+0001e3e0: 7420 6265 2064 656c 6574 6564 2e0a 0a20  t be deleted... 
+0001e3f0: 2020 2020 2020 203a 7061 7261 6d20 736f         :param so
+0001e400: 7572 6365 5f6e 616d 653a 204e 616d 6520  urce_name: Name 
+0001e410: 6f66 2074 6865 206d 6172 6b65 7470 6c61  of the marketpla
+0001e420: 6365 2073 6f75 7263 6520 746f 2064 656c  ce source to del
+0001e430: 6574 652e 0a20 2020 2020 2020 2022 2222  ete..        """
+0001e440: 0a20 2020 2020 2020 2070 6174 6820 3d20  .        path = 
+0001e450: 6622 6d61 726b 6574 706c 6163 652f 736f  f"marketplace/so
+0001e460: 7572 6365 732f 7b73 6f75 7263 655f 6e61  urces/{source_na
+0001e470: 6d65 7d22 0a20 2020 2020 2020 2073 656c  me}".        sel
+0001e480: 662e 6170 695f 6361 6c6c 286d 6574 686f  f.api_call(metho
+0001e490: 643d 2244 454c 4554 4522 2c20 7061 7468  d="DELETE", path
+0001e4a0: 3d70 6174 6829 0a0a 2020 2020 6465 6620  =path)..    def 
+0001e4b0: 6765 745f 6d61 726b 6574 706c 6163 655f  get_marketplace_
+0001e4c0: 6361 7461 6c6f 6728 0a20 2020 2020 2020  catalog(.       
+0001e4d0: 2073 656c 662c 0a20 2020 2020 2020 2073   self,.        s
+0001e4e0: 6f75 7263 655f 6e61 6d65 3a20 7374 722c  ource_name: str,
+0001e4f0: 0a20 2020 2020 2020 2076 6572 7369 6f6e  .        version
+0001e500: 3a20 7374 7220 3d20 4e6f 6e65 2c0a 2020  : str = None,.  
+0001e510: 2020 2020 2020 7461 673a 2073 7472 203d        tag: str =
+0001e520: 204e 6f6e 652c 0a20 2020 2020 2020 2066   None,.        f
+0001e530: 6f72 6365 5f72 6566 7265 7368 3a20 626f  orce_refresh: bo
+0001e540: 6f6c 203d 2046 616c 7365 2c0a 2020 2020  ol = False,.    
+0001e550: 293a 0a20 2020 2020 2020 2022 2222 0a20  ):.        """. 
+0001e560: 2020 2020 2020 2052 6574 7269 6576 6520         Retrieve 
+0001e570: 7468 6520 6974 656d 2063 6174 616c 6f67  the item catalog
+0001e580: 2066 6f72 2061 2073 7065 6369 6669 6564   for a specified
+0001e590: 206d 6172 6b65 7470 6c61 6365 2073 6f75   marketplace sou
+0001e5a0: 7263 652e 0a20 2020 2020 2020 2054 6865  rce..        The
+0001e5b0: 206c 6973 7420 6f66 2069 7465 6d73 2063   list of items c
+0001e5c0: 616e 2062 6520 6669 6c74 6572 6564 2061  an be filtered a
+0001e5d0: 6363 6f72 6469 6e67 2074 6f20 7661 7269  ccording to vari
+0001e5e0: 6f75 7320 6669 6c74 6572 732c 2075 7369  ous filters, usi
+0001e5f0: 6e67 2069 7465 6d27 7320 6d65 7461 6461  ng item's metada
+0001e600: 7461 2074 6f20 6669 6c74 6572 2e0a 0a20  ta to filter... 
+0001e610: 2020 2020 2020 203a 7061 7261 6d20 736f         :param so
+0001e620: 7572 6365 5f6e 616d 653a 204e 616d 6520  urce_name: Name 
+0001e630: 6f66 2074 6865 2073 6f75 7263 652e 0a20  of the source.. 
+0001e640: 2020 2020 2020 203a 7061 7261 6d20 7665         :param ve
+0001e650: 7273 696f 6e3a 2046 696c 7465 7220 6974  rsion: Filter it
+0001e660: 656d 7320 6163 636f 7264 696e 6720 746f  ems according to
+0001e670: 2074 6865 6972 2076 6572 7369 6f6e 2e0a   their version..
+0001e680: 2020 2020 2020 2020 3a70 6172 616d 2074          :param t
+0001e690: 6167 3a20 4669 6c74 6572 2069 7465 6d73  ag: Filter items
+0001e6a0: 2062 6173 6564 206f 6e20 7461 672e 0a20   based on tag.. 
+0001e6b0: 2020 2020 2020 203a 7061 7261 6d20 666f         :param fo
+0001e6c0: 7263 655f 7265 6672 6573 683a 204d 616b  rce_refresh: Mak
+0001e6d0: 6520 7468 6520 7365 7276 6572 2066 6574  e the server fet
+0001e6e0: 6368 2074 6865 2063 6174 616c 6f67 2066  ch the catalog f
+0001e6f0: 726f 6d20 7468 6520 6163 7475 616c 206d  rom the actual m
+0001e700: 6172 6b65 7470 6c61 6365 2073 6f75 7263  arketplace sourc
+0001e710: 652c 0a20 2020 2020 2020 2020 2020 2072  e,.            r
+0001e720: 6174 6865 7220 7468 616e 2072 656c 7920  ather than rely 
+0001e730: 6f6e 2063 6163 6865 6420 696e 666f 726d  on cached inform
+0001e740: 6174 696f 6e20 7768 6963 6820 6d61 7920  ation which may 
+0001e750: 6578 6973 7420 6672 6f6d 2070 7265 7669  exist from previ
+0001e760: 6f75 7320 6765 7420 7265 7175 6573 7473  ous get requests
+0001e770: 2e20 466f 7220 6578 616d 706c 652c 0a20  . For example,. 
+0001e780: 2020 2020 2020 2020 2020 2069 6620 7468             if th
+0001e790: 6520 736f 7572 6365 2077 6173 2072 652d  e source was re-
+0001e7a0: 6275 696c 742c 0a20 2020 2020 2020 2020  built,.         
+0001e7b0: 2020 2074 6869 7320 7769 6c6c 206d 616b     this will mak
+0001e7c0: 6520 7468 6520 7365 7276 6572 2067 6574  e the server get
+0001e7d0: 2074 6865 2075 7064 6174 6564 2069 6e66   the updated inf
+0001e7e0: 6f72 6d61 7469 6f6e 2e20 4465 6661 756c  ormation. Defaul
+0001e7f0: 7420 6973 2060 6046 616c 7365 6060 2e0a  t is ``False``..
+0001e800: 2020 2020 2020 2020 3a72 6574 7572 6e73          :returns
+0001e810: 3a20 3a70 793a 636c 6173 733a 607e 6d6c  : :py:class:`~ml
+0001e820: 7275 6e2e 6170 692e 7363 6865 6d61 732e  run.api.schemas.
+0001e830: 6d61 726b 6574 706c 6163 652e 4d61 726b  marketplace.Mark
+0001e840: 6574 706c 6163 6543 6174 616c 6f67 6020  etplaceCatalog` 
+0001e850: 6f62 6a65 6374 2c20 7768 6963 6820 6973  object, which is
+0001e860: 2065 7373 656e 7469 616c 6c79 2061 206c   essentially a l
+0001e870: 6973 740a 2020 2020 2020 2020 2020 2020  ist.            
+0001e880: 6f66 203a 7079 3a63 6c61 7373 3a60 7e6d  of :py:class:`~m
+0001e890: 6c72 756e 2e61 7069 2e73 6368 656d 6173  lrun.api.schemas
+0001e8a0: 2e6d 6172 6b65 7470 6c61 6365 2e4d 6172  .marketplace.Mar
+0001e8b0: 6b65 7470 6c61 6365 4974 656d 6020 656e  ketplaceItem` en
+0001e8c0: 7472 6965 732e 0a20 2020 2020 2020 2022  tries..        "
+0001e8d0: 2222 0a20 2020 2020 2020 2070 6174 6820  "".        path 
+0001e8e0: 3d20 2866 226d 6172 6b65 7470 6c61 6365  = (f"marketplace
+0001e8f0: 2f73 6f75 7263 6573 2f7b 736f 7572 6365  /sources/{source
+0001e900: 5f6e 616d 657d 2f69 7465 6d73 222c 290a  _name}/items",).
+0001e910: 2020 2020 2020 2020 7061 7261 6d73 203d          params =
+0001e920: 207b 0a20 2020 2020 2020 2020 2020 2022   {.            "
+0001e930: 7665 7273 696f 6e22 3a20 7665 7273 696f  version": versio
+0001e940: 6e2c 0a20 2020 2020 2020 2020 2020 2022  n,.            "
+0001e950: 7461 6722 3a20 7461 672c 0a20 2020 2020  tag": tag,.     
+0001e960: 2020 2020 2020 2022 666f 7263 652d 7265         "force-re
+0001e970: 6672 6573 6822 3a20 666f 7263 655f 7265  fresh": force_re
+0001e980: 6672 6573 682c 0a20 2020 2020 2020 207d  fresh,.        }
+0001e990: 0a20 2020 2020 2020 2072 6573 706f 6e73  .        respons
+0001e9a0: 6520 3d20 7365 6c66 2e61 7069 5f63 616c  e = self.api_cal
+0001e9b0: 6c28 6d65 7468 6f64 3d22 4745 5422 2c20  l(method="GET", 
+0001e9c0: 7061 7468 3d70 6174 682c 2070 6172 616d  path=path, param
+0001e9d0: 733d 7061 7261 6d73 290a 2020 2020 2020  s=params).      
+0001e9e0: 2020 7265 7475 726e 2073 6368 656d 6173    return schemas
+0001e9f0: 2e4d 6172 6b65 7470 6c61 6365 4361 7461  .MarketplaceCata
+0001ea00: 6c6f 6728 2a2a 7265 7370 6f6e 7365 2e6a  log(**response.j
+0001ea10: 736f 6e28 2929 0a0a 2020 2020 6465 6620  son())..    def 
+0001ea20: 6765 745f 6d61 726b 6574 706c 6163 655f  get_marketplace_
+0001ea30: 6974 656d 280a 2020 2020 2020 2020 7365  item(.        se
+0001ea40: 6c66 2c0a 2020 2020 2020 2020 736f 7572  lf,.        sour
+0001ea50: 6365 5f6e 616d 653a 2073 7472 2c0a 2020  ce_name: str,.  
+0001ea60: 2020 2020 2020 6974 656d 5f6e 616d 653a        item_name:
+0001ea70: 2073 7472 2c0a 2020 2020 2020 2020 7665   str,.        ve
+0001ea80: 7273 696f 6e3a 2073 7472 203d 204e 6f6e  rsion: str = Non
+0001ea90: 652c 0a20 2020 2020 2020 2074 6167 3a20  e,.        tag: 
+0001eaa0: 7374 7220 3d20 226c 6174 6573 7422 2c0a  str = "latest",.
+0001eab0: 2020 2020 2020 2020 666f 7263 655f 7265          force_re
+0001eac0: 6672 6573 683a 2062 6f6f 6c20 3d20 4661  fresh: bool = Fa
+0001ead0: 6c73 652c 0a20 2020 2029 3a0a 2020 2020  lse,.    ):.    
+0001eae0: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+0001eaf0: 5265 7472 6965 7665 2061 2073 7065 6369  Retrieve a speci
+0001eb00: 6669 6320 6d61 726b 6574 706c 6163 6520  fic marketplace 
+0001eb10: 6974 656d 2e0a 0a20 2020 2020 2020 203a  item...        :
+0001eb20: 7061 7261 6d20 736f 7572 6365 5f6e 616d  param source_nam
+0001eb30: 653a 204e 616d 6520 6f66 2073 6f75 7263  e: Name of sourc
+0001eb40: 652e 0a20 2020 2020 2020 203a 7061 7261  e..        :para
+0001eb50: 6d20 6974 656d 5f6e 616d 653a 204e 616d  m item_name: Nam
+0001eb60: 6520 6f66 2074 6865 2069 7465 6d20 746f  e of the item to
+0001eb70: 2072 6574 7269 6576 652c 2061 7320 6974   retrieve, as it
+0001eb80: 2061 7070 6561 7273 2069 6e20 7468 6520   appears in the 
+0001eb90: 6361 7461 6c6f 672e 0a20 2020 2020 2020  catalog..       
+0001eba0: 203a 7061 7261 6d20 7665 7273 696f 6e3a   :param version:
+0001ebb0: 2047 6574 2061 2073 7065 6369 6669 6320   Get a specific 
+0001ebc0: 7665 7273 696f 6e20 6f66 2074 6865 2069  version of the i
+0001ebd0: 7465 6d2e 2044 6566 6175 6c74 2069 7320  tem. Default is 
+0001ebe0: 6060 4e6f 6e65 6060 2e0a 2020 2020 2020  ``None``..      
+0001ebf0: 2020 3a70 6172 616d 2074 6167 3a20 4765    :param tag: Ge
+0001ec00: 7420 6120 7370 6563 6966 6963 2076 6572  t a specific ver
+0001ec10: 7369 6f6e 206f 6620 7468 6520 6974 656d  sion of the item
+0001ec20: 2069 6465 6e74 6966 6965 6420 6279 2074   identified by t
+0001ec30: 6167 2e20 4465 6661 756c 7420 6973 2060  ag. Default is `
+0001ec40: 606c 6174 6573 7460 602e 0a20 2020 2020  `latest``..     
+0001ec50: 2020 203a 7061 7261 6d20 666f 7263 655f     :param force_
+0001ec60: 7265 6672 6573 683a 204d 616b 6520 7468  refresh: Make th
+0001ec70: 6520 7365 7276 6572 2066 6574 6368 2074  e server fetch t
+0001ec80: 6865 2069 6e66 6f72 6d61 7469 6f6e 2066  he information f
+0001ec90: 726f 6d20 7468 6520 6163 7475 616c 206d  rom the actual m
+0001eca0: 6172 6b65 7470 6c61 6365 0a20 2020 2020  arketplace.     
+0001ecb0: 2020 2020 2020 2073 6f75 7263 652c 2072         source, r
+0001ecc0: 6174 6865 7220 7468 616e 0a20 2020 2020  ather than.     
+0001ecd0: 2020 2020 2020 2072 656c 7920 6f6e 2063         rely on c
+0001ece0: 6163 6865 6420 696e 666f 726d 6174 696f  ached informatio
+0001ecf0: 6e2e 2044 6566 6175 6c74 2069 7320 6060  n. Default is ``
+0001ed00: 4661 6c73 6560 602e 0a20 2020 2020 2020  False``..       
+0001ed10: 203a 7265 7475 726e 733a 203a 7079 3a63   :returns: :py:c
+0001ed20: 6c61 7373 3a60 7e6d 6c72 756e 2e61 7069  lass:`~mlrun.api
+0001ed30: 2e73 6368 656d 6173 2e6d 6172 6b65 7470  .schemas.marketp
+0001ed40: 6c61 6365 2e4d 6172 6b65 7470 6c61 6365  lace.Marketplace
+0001ed50: 4974 656d 602e 0a20 2020 2020 2020 2022  Item`..        "
+0001ed60: 2222 0a20 2020 2020 2020 2070 6174 6820  "".        path 
+0001ed70: 3d20 2866 226d 6172 6b65 7470 6c61 6365  = (f"marketplace
+0001ed80: 2f73 6f75 7263 6573 2f7b 736f 7572 6365  /sources/{source
+0001ed90: 5f6e 616d 657d 2f69 7465 6d73 2f7b 6974  _name}/items/{it
+0001eda0: 656d 5f6e 616d 657d 222c 290a 2020 2020  em_name}",).    
+0001edb0: 2020 2020 7061 7261 6d73 203d 207b 0a20      params = {. 
+0001edc0: 2020 2020 2020 2020 2020 2022 7665 7273             "vers
+0001edd0: 696f 6e22 3a20 7665 7273 696f 6e2c 0a20  ion": version,. 
+0001ede0: 2020 2020 2020 2020 2020 2022 7461 6722             "tag"
+0001edf0: 3a20 7461 672c 0a20 2020 2020 2020 2020  : tag,.         
+0001ee00: 2020 2022 666f 7263 652d 7265 6672 6573     "force-refres
+0001ee10: 6822 3a20 666f 7263 655f 7265 6672 6573  h": force_refres
+0001ee20: 682c 0a20 2020 2020 2020 207d 0a20 2020  h,.        }.   
+0001ee30: 2020 2020 2072 6573 706f 6e73 6520 3d20       response = 
+0001ee40: 7365 6c66 2e61 7069 5f63 616c 6c28 6d65  self.api_call(me
+0001ee50: 7468 6f64 3d22 4745 5422 2c20 7061 7468  thod="GET", path
+0001ee60: 3d70 6174 682c 2070 6172 616d 733d 7061  =path, params=pa
+0001ee70: 7261 6d73 290a 2020 2020 2020 2020 7265  rams).        re
+0001ee80: 7475 726e 2073 6368 656d 6173 2e4d 6172  turn schemas.Mar
+0001ee90: 6b65 7470 6c61 6365 4974 656d 282a 2a72  ketplaceItem(**r
+0001eea0: 6573 706f 6e73 652e 6a73 6f6e 2829 290a  esponse.json()).
+0001eeb0: 0a20 2020 2064 6566 2067 6574 5f6d 6172  .    def get_mar
+0001eec0: 6b65 7470 6c61 6365 5f61 7373 6574 280a  ketplace_asset(.
+0001eed0: 2020 2020 2020 2020 7365 6c66 2c0a 2020          self,.  
+0001eee0: 2020 2020 2020 736f 7572 6365 5f6e 616d        source_nam
+0001eef0: 653a 2073 7472 2c0a 2020 2020 2020 2020  e: str,.        
+0001ef00: 6974 656d 5f6e 616d 653a 2073 7472 2c0a  item_name: str,.
+0001ef10: 2020 2020 2020 2020 6173 7365 745f 6e61          asset_na
+0001ef20: 6d65 3a20 7374 722c 0a20 2020 2020 2020  me: str,.       
+0001ef30: 2076 6572 7369 6f6e 3a20 7374 7220 3d20   version: str = 
+0001ef40: 4e6f 6e65 2c0a 2020 2020 2020 2020 7461  None,.        ta
+0001ef50: 673a 2073 7472 203d 2022 6c61 7465 7374  g: str = "latest
+0001ef60: 222c 0a20 2020 2029 3a0a 2020 2020 2020  ",.    ):.      
+0001ef70: 2020 2222 220a 2020 2020 2020 2020 4765    """.        Ge
+0001ef80: 7420 6d61 726b 6574 706c 6163 6520 6173  t marketplace as
+0001ef90: 7365 7420 6672 6f6d 2069 7465 6d2e 0a0a  set from item...
+0001efa0: 2020 2020 2020 2020 3a70 6172 616d 2073          :param s
+0001efb0: 6f75 7263 655f 6e61 6d65 3a20 4e61 6d65  ource_name: Name
+0001efc0: 206f 6620 736f 7572 6365 2e0a 2020 2020   of source..    
+0001efd0: 2020 2020 3a70 6172 616d 2069 7465 6d5f      :param item_
+0001efe0: 6e61 6d65 3a20 2020 4e61 6d65 206f 6620  name:   Name of 
+0001eff0: 7468 6520 6974 656d 2077 6869 6368 2068  the item which h
+0001f000: 6f6c 6473 2074 6865 2061 7373 6574 2e0a  olds the asset..
+0001f010: 2020 2020 2020 2020 3a70 6172 616d 2061          :param a
+0001f020: 7373 6574 5f6e 616d 653a 2020 4e61 6d65  sset_name:  Name
+0001f030: 206f 6620 7468 6520 6173 7365 7420 746f   of the asset to
+0001f040: 2072 6574 7269 6576 652e 0a20 2020 2020   retrieve..     
+0001f050: 2020 203a 7061 7261 6d20 7665 7273 696f     :param versio
+0001f060: 6e3a 2047 6574 2061 2073 7065 6369 6669  n: Get a specifi
+0001f070: 6320 7665 7273 696f 6e20 6f66 2074 6865  c version of the
+0001f080: 2069 7465 6d2e 2044 6566 6175 6c74 2069   item. Default i
+0001f090: 7320 6060 4e6f 6e65 6060 2e0a 2020 2020  s ``None``..    
+0001f0a0: 2020 2020 3a70 6172 616d 2074 6167 3a20      :param tag: 
+0001f0b0: 4765 7420 6120 7370 6563 6966 6963 2076  Get a specific v
+0001f0c0: 6572 7369 6f6e 206f 6620 7468 6520 6974  ersion of the it
+0001f0d0: 656d 2069 6465 6e74 6966 6965 6420 6279  em identified by
+0001f0e0: 2074 6167 2e20 4465 6661 756c 7420 6973   tag. Default is
+0001f0f0: 2060 606c 6174 6573 7460 602e 0a0a 2020   ``latest``...  
+0001f100: 2020 2020 2020 3a72 6574 7572 6e3a 2068        :return: h
+0001f110: 7474 7020 7265 7370 6f6e 7365 2077 6974  ttp response wit
+0001f120: 6820 7468 6520 6173 7365 7420 696e 2074  h the asset in t
+0001f130: 6865 2063 6f6e 7465 6e74 2061 7474 7269  he content attri
+0001f140: 6275 7465 0a20 2020 2020 2020 2022 2222  bute.        """
+0001f150: 0a20 2020 2020 2020 2070 6174 6820 3d20  .        path = 
+0001f160: 280a 2020 2020 2020 2020 2020 2020 6622  (.            f"
+0001f170: 6d61 726b 6574 706c 6163 652f 736f 7572  marketplace/sour
+0001f180: 6365 732f 7b73 6f75 7263 655f 6e61 6d65  ces/{source_name
+0001f190: 7d2f 6974 656d 732f 7b69 7465 6d5f 6e61  }/items/{item_na
+0001f1a0: 6d65 7d2f 6173 7365 7473 2f7b 6173 7365  me}/assets/{asse
+0001f1b0: 745f 6e61 6d65 7d22 2c0a 2020 2020 2020  t_name}",.      
+0001f1c0: 2020 290a 2020 2020 2020 2020 7061 7261    ).        para
+0001f1d0: 6d73 203d 207b 0a20 2020 2020 2020 2020  ms = {.         
+0001f1e0: 2020 2022 7665 7273 696f 6e22 3a20 7665     "version": ve
+0001f1f0: 7273 696f 6e2c 0a20 2020 2020 2020 2020  rsion,.         
+0001f200: 2020 2022 7461 6722 3a20 7461 672c 0a20     "tag": tag,. 
+0001f210: 2020 2020 2020 207d 0a20 2020 2020 2020         }.       
+0001f220: 2072 6573 706f 6e73 6520 3d20 7365 6c66   response = self
+0001f230: 2e61 7069 5f63 616c 6c28 6d65 7468 6f64  .api_call(method
+0001f240: 3d22 4745 5422 2c20 7061 7468 3d70 6174  ="GET", path=pat
+0001f250: 682c 2070 6172 616d 733d 7061 7261 6d73  h, params=params
+0001f260: 290a 2020 2020 2020 2020 7265 7475 726e  ).        return
+0001f270: 2072 6573 706f 6e73 650a 0a20 2020 2064   response..    d
+0001f280: 6566 2076 6572 6966 795f 6175 7468 6f72  ef verify_author
+0001f290: 697a 6174 696f 6e28 0a20 2020 2020 2020  ization(.       
+0001f2a0: 2073 656c 662c 2061 7574 686f 7269 7a61   self, authoriza
+0001f2b0: 7469 6f6e 5f76 6572 6966 6963 6174 696f  tion_verificatio
+0001f2c0: 6e5f 696e 7075 743a 2073 6368 656d 6173  n_input: schemas
+0001f2d0: 2e41 7574 686f 7269 7a61 7469 6f6e 5665  .AuthorizationVe
+0001f2e0: 7269 6669 6361 7469 6f6e 496e 7075 740a  rificationInput.
+0001f2f0: 2020 2020 293a 0a20 2020 2020 2020 2022      ):.        "
+0001f300: 2222 5665 7269 6669 6573 2061 7574 686f  ""Verifies autho
+0001f310: 7269 7a61 7469 6f6e 2066 6f72 2074 6865  rization for the
+0001f320: 2070 726f 7669 6465 6420 6163 7469 6f6e   provided action
+0001f330: 206f 6e20 7468 6520 7072 6f76 6964 6564   on the provided
+0001f340: 2072 6573 6f75 7263 652e 0a0a 2020 2020   resource...    
+0001f350: 2020 2020 3a70 6172 616d 2061 7574 686f      :param autho
+0001f360: 7269 7a61 7469 6f6e 5f76 6572 6966 6963  rization_verific
+0001f370: 6174 696f 6e5f 696e 7075 743a 2049 6e73  ation_input: Ins
+0001f380: 7461 6e63 6520 6f66 0a20 2020 2020 2020  tance of.       
+0001f390: 2020 2020 203a 7079 3a63 6c61 7373 3a60       :py:class:`
+0001f3a0: 7e6d 6c72 756e 2e61 7069 2e73 6368 656d  ~mlrun.api.schem
+0001f3b0: 6173 2e41 7574 686f 7269 7a61 7469 6f6e  as.Authorization
+0001f3c0: 5665 7269 6669 6361 7469 6f6e 496e 7075  VerificationInpu
+0001f3d0: 7460 2074 6861 7420 696e 636c 7564 6573  t` that includes
+0001f3e0: 2061 6c6c 2074 6865 206e 6565 6465 6420   all the needed 
+0001f3f0: 7061 7261 6d65 7465 7273 2066 6f72 0a20  parameters for. 
+0001f400: 2020 2020 2020 2020 2020 2074 6865 2061             the a
+0001f410: 7574 6820 7665 7269 6669 6361 7469 6f6e  uth verification
+0001f420: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+0001f430: 2020 2020 2065 7272 6f72 5f6d 6573 7361       error_messa
+0001f440: 6765 203d 2022 4175 7468 6f72 697a 6174  ge = "Authorizat
+0001f450: 696f 6e20 6368 6563 6b20 6661 696c 6564  ion check failed
+0001f460: 220a 2020 2020 2020 2020 7365 6c66 2e61  ".        self.a
+0001f470: 7069 5f63 616c 6c28 0a20 2020 2020 2020  pi_call(.       
+0001f480: 2020 2020 2022 504f 5354 222c 0a20 2020       "POST",.   
+0001f490: 2020 2020 2020 2020 2022 6175 7468 6f72           "author
+0001f4a0: 697a 6174 696f 6e2f 7665 7269 6669 6361  ization/verifica
+0001f4b0: 7469 6f6e 7322 2c0a 2020 2020 2020 2020  tions",.        
+0001f4c0: 2020 2020 6572 726f 725f 6d65 7373 6167      error_messag
+0001f4d0: 652c 0a20 2020 2020 2020 2020 2020 2062  e,.            b
+0001f4e0: 6f64 793d 6469 6374 5f74 6f5f 6a73 6f6e  ody=dict_to_json
+0001f4f0: 2861 7574 686f 7269 7a61 7469 6f6e 5f76  (authorization_v
+0001f500: 6572 6966 6963 6174 696f 6e5f 696e 7075  erification_inpu
+0001f510: 742e 6469 6374 2829 292c 0a20 2020 2020  t.dict()),.     
+0001f520: 2020 2029 0a0a 2020 2020 6465 6620 7472     )..    def tr
+0001f530: 6967 6765 725f 6d69 6772 6174 696f 6e73  igger_migrations
+0001f540: 2873 656c 6629 202d 3e20 4f70 7469 6f6e  (self) -> Option
+0001f550: 616c 5b73 6368 656d 6173 2e42 6163 6b67  al[schemas.Backg
+0001f560: 726f 756e 6454 6173 6b5d 3a0a 2020 2020  roundTask]:.    
+0001f570: 2020 2020 2222 2254 7269 6767 6572 206d      """Trigger m
+0001f580: 6967 7261 7469 6f6e 7320 2877 696c 6c20  igrations (will 
+0001f590: 646f 206e 6f74 6869 6e67 2069 6620 6e6f  do nothing if no
+0001f5a0: 206d 6967 7261 7469 6f6e 7320 6172 6520   migrations are 
+0001f5b0: 6e65 6564 6564 2920 616e 6420 7761 6974  needed) and wait
+0001f5c0: 2066 6f72 2074 6865 6d20 746f 2066 696e   for them to fin
+0001f5d0: 6973 6820 6966 2061 6374 7561 6c6c 790a  ish if actually.
+0001f5e0: 2020 2020 2020 2020 7472 6967 6765 7265          triggere
+0001f5f0: 640a 2020 2020 2020 2020 3a72 6574 7572  d.        :retur
+0001f600: 6e73 3a20 3a70 793a 636c 6173 733a 607e  ns: :py:class:`~
+0001f610: 6d6c 7275 6e2e 6170 692e 7363 6865 6d61  mlrun.api.schema
+0001f620: 732e 4261 636b 6772 6f75 6e64 5461 736b  s.BackgroundTask
+0001f630: 602e 0a20 2020 2020 2020 2022 2222 0a20  `..        """. 
+0001f640: 2020 2020 2020 2072 6573 706f 6e73 6520         response 
+0001f650: 3d20 7365 6c66 2e61 7069 5f63 616c 6c28  = self.api_call(
+0001f660: 0a20 2020 2020 2020 2020 2020 2022 504f  .            "PO
+0001f670: 5354 222c 0a20 2020 2020 2020 2020 2020  ST",.           
+0001f680: 2022 6f70 6572 6174 696f 6e73 2f6d 6967   "operations/mig
+0001f690: 7261 7469 6f6e 7322 2c0a 2020 2020 2020  rations",.      
+0001f6a0: 2020 2020 2020 2246 6169 6c65 6420 7472        "Failed tr
+0001f6b0: 6967 6765 7269 6e67 206d 6967 7261 7469  iggering migrati
+0001f6c0: 6f6e 7322 2c0a 2020 2020 2020 2020 290a  ons",.        ).
+0001f6d0: 2020 2020 2020 2020 6966 2072 6573 706f          if respo
+0001f6e0: 6e73 652e 7374 6174 7573 5f63 6f64 6520  nse.status_code 
+0001f6f0: 3d3d 2068 7474 702e 4854 5450 5374 6174  == http.HTTPStat
+0001f700: 7573 2e41 4343 4550 5445 443a 0a20 2020  us.ACCEPTED:.   
+0001f710: 2020 2020 2020 2020 2062 6163 6b67 726f           backgro
+0001f720: 756e 645f 7461 736b 203d 2073 6368 656d  und_task = schem
+0001f730: 6173 2e42 6163 6b67 726f 756e 6454 6173  as.BackgroundTas
+0001f740: 6b28 2a2a 7265 7370 6f6e 7365 2e6a 736f  k(**response.jso
+0001f750: 6e28 2929 0a20 2020 2020 2020 2020 2020  n()).           
+0001f760: 2072 6574 7572 6e20 7365 6c66 2e5f 7761   return self._wa
+0001f770: 6974 5f66 6f72 5f62 6163 6b67 726f 756e  it_for_backgroun
+0001f780: 645f 7461 736b 5f74 6f5f 7265 6163 685f  d_task_to_reach_
+0001f790: 7465 726d 696e 616c 5f73 7461 7465 280a  terminal_state(.
+0001f7a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001f7b0: 6261 636b 6772 6f75 6e64 5f74 6173 6b2e  background_task.
+0001f7c0: 6d65 7461 6461 7461 2e6e 616d 650a 2020  metadata.name.  
+0001f7d0: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
+0001f7e0: 2020 2020 7265 7475 726e 204e 6f6e 650a      return None.
+0001f7f0: 0a0a 6465 6620 5f61 735f 6a73 6f6e 286f  ..def _as_json(o
+0001f800: 626a 293a 0a20 2020 2066 6e20 3d20 6765  bj):.    fn = ge
+0001f810: 7461 7474 7228 6f62 6a2c 2022 746f 5f6a  tattr(obj, "to_j
+0001f820: 736f 6e22 2c20 4e6f 6e65 290a 2020 2020  son", None).    
+0001f830: 6966 2066 6e3a 0a20 2020 2020 2020 2072  if fn:.        r
+0001f840: 6574 7572 6e20 666e 2829 0a20 2020 2072  eturn fn().    r
+0001f850: 6574 7572 6e20 6469 6374 5f74 6f5f 6a73  eturn dict_to_js
+0001f860: 6f6e 286f 626a 290a                      on(obj).
```

## mlrun/db/sqldb.py

```diff
@@ -124,14 +124,15 @@
         last_update_time_from: datetime.datetime = None,
         last_update_time_to: datetime.datetime = None,
         partition_by: Union[schemas.RunPartitionByField, str] = None,
         rows_per_partition: int = 1,
         partition_sort_by: Union[schemas.SortField, str] = None,
         partition_order: Union[schemas.OrderType, str] = schemas.OrderType.desc,
         max_partitions: int = 0,
+        with_notifications: bool = False,
     ):
         import mlrun.api.crud
 
         return self._transform_db_error(
             mlrun.api.crud.Runs().list_runs,
             self.session,
             name,
@@ -147,14 +148,15 @@
             last_update_time_from,
             last_update_time_to,
             partition_by,
             rows_per_partition,
             partition_sort_by,
             partition_order,
             max_partitions,
+            with_notifications,
         )
 
     def del_run(self, uid, project=None, iter=None):
         import mlrun.api.crud
 
         return self._transform_db_error(
             mlrun.api.crud.Runs().delete_run,
@@ -390,36 +392,67 @@
         return self._transform_db_error(self.db.list_schedules, self.session)
 
     def store_project(
         self,
         name: str,
         project: mlrun.api.schemas.Project,
     ) -> mlrun.api.schemas.Project:
-        raise NotImplementedError()
+        import mlrun.api.crud
+
+        if isinstance(project, dict):
+            project = mlrun.api.schemas.Project(**project)
+
+        return self._transform_db_error(
+            mlrun.api.crud.Projects().store_project,
+            self.session,
+            name=name,
+            project=project,
+        )
 
     def patch_project(
         self,
         name: str,
         project: dict,
         patch_mode: mlrun.api.schemas.PatchMode = mlrun.api.schemas.PatchMode.replace,
     ) -> mlrun.api.schemas.Project:
-        raise NotImplementedError()
+        import mlrun.api.crud
+
+        return self._transform_db_error(
+            mlrun.api.crud.Projects().patch_project,
+            self.session,
+            name=name,
+            project=project,
+            patch_mode=patch_mode,
+        )
 
     def create_project(
         self,
         project: mlrun.api.schemas.Project,
     ) -> mlrun.api.schemas.Project:
-        raise NotImplementedError()
+        import mlrun.api.crud
+
+        return self._transform_db_error(
+            mlrun.api.crud.Projects().create_project,
+            self.session,
+            project=project,
+        )
 
     def delete_project(
         self,
         name: str,
         deletion_strategy: mlrun.api.schemas.DeletionStrategy = mlrun.api.schemas.DeletionStrategy.default(),
     ):
-        raise NotImplementedError()
+        import mlrun.api.crud
+
+        return self._transform_db_error(
+            mlrun.api.crud.Projects().delete_project,
+            self.session,
+            name=name,
+            deletion_strategy=deletion_strategy,
+        )
 
     def get_project(
         self, name: str = None, project_id: int = None
     ) -> mlrun.api.schemas.Project:
         import mlrun.api.crud
 
         return self._transform_db_error(
@@ -431,15 +464,24 @@
     def list_projects(
         self,
         owner: str = None,
         format_: mlrun.api.schemas.ProjectsFormat = mlrun.api.schemas.ProjectsFormat.full,
         labels: List[str] = None,
         state: mlrun.api.schemas.ProjectState = None,
     ) -> mlrun.api.schemas.ProjectsOutput:
-        raise NotImplementedError()
+        import mlrun.api.crud
+
+        return self._transform_db_error(
+            mlrun.api.crud.Projects().list_projects,
+            self.session,
+            owner=owner,
+            format_=format_,
+            labels=labels,
+            state=state,
+        )
 
     @staticmethod
     def _transform_db_error(func, *args, **kwargs):
         try:
             return func(*args, **kwargs)
         except DBError as exc:
             raise RunDBError(exc.args)
@@ -835,26 +877,24 @@
 
     def delete_marketplace_source(self, source_name: str):
         raise NotImplementedError()
 
     def get_marketplace_catalog(
         self,
         source_name: str,
-        channel: str = None,
         version: str = None,
         tag: str = None,
         force_refresh: bool = False,
     ):
         raise NotImplementedError()
 
     def get_marketplace_item(
         self,
         source_name: str,
         item_name: str,
-        channel: str = "development",
         version: str = None,
         tag: str = "latest",
         force_refresh: bool = False,
     ):
         raise NotImplementedError()
 
     def verify_authorization(
```

## mlrun/feature_store/api.py

```diff
@@ -8,18 +8,20 @@
 #
 # Unless required by applicable law or agreed to in writing, software
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 import copy
+import importlib.util
+import pathlib
+import sys
 import warnings
 from datetime import datetime
-from typing import List, Optional, Union
-from urllib.parse import urlparse
+from typing import Any, Dict, List, Optional, Union
 
 import pandas as pd
 
 import mlrun
 import mlrun.errors
 
 from ..data_types import InferOptions, get_infer_interface
@@ -323,14 +325,29 @@
         logger.warn(
             f"the following dataframe columns have been renamed due to unsupported characters: {rename_mapping}"
         )
         df = df.rename(rename_mapping, axis=1)
     return df
 
 
+def _get_namespace(run_config: RunConfig) -> Dict[str, Any]:
+    # if running locally, we need to import the file dynamically to get its namespace
+    if run_config and run_config.local and run_config.function:
+        filename = run_config.function.spec.filename
+        if filename:
+            module_name = pathlib.Path(filename).name.rsplit(".", maxsplit=1)[0]
+            spec = importlib.util.spec_from_file_location(module_name, filename)
+            module = importlib.util.module_from_spec(spec)
+            sys.modules[module_name] = module
+            spec.loader.exec_module(module)
+            return vars(__import__(module_name))
+    else:
+        return get_caller_globals()
+
+
 def ingest(
     featureset: Union[FeatureSet, str] = None,
     source=None,
     targets: List[DataTargetBase] = None,
     namespace=None,
     return_df: bool = True,
     infer_options: InferOptions = InferOptions.default(),
@@ -497,15 +514,16 @@
         )
         return_df = False
 
     if featureset.spec.passthrough:
         featureset.spec.source = source
         featureset.spec.validate_no_processing_for_passthrough()
 
-    namespace = namespace or get_caller_globals()
+    if not namespace:
+        namespace = _get_namespace(run_config)
 
     targets_to_ingest = targets or featureset.spec.targets or get_default_targets()
     targets_to_ingest = copy.deepcopy(targets_to_ingest)
 
     validate_target_paths_for_engine(targets_to_ingest, featureset.spec.engine, source)
 
     if overwrite is None:
@@ -842,15 +860,19 @@
             if mlrun_context:
                 session_name = f"{mlrun_context.name}-{mlrun_context.uid}"
             else:
                 session_name = (
                     f"{featureset.metadata.project}-{featureset.metadata.name}"
                 )
 
-            spark = pyspark.sql.SparkSession.builder.appName(session_name).getOrCreate()
+            spark = (
+                pyspark.sql.SparkSession.builder.appName(session_name)
+                .config("spark.sql.session.timeZone", "UTC")
+                .getOrCreate()
+            )
             created_spark_context = True
 
         timestamp_key = featureset.spec.timestamp_key
 
         if isinstance(source, pd.DataFrame):
             df = spark.createDataFrame(source)
         elif isinstance(source, pyspark.sql.DataFrame):
@@ -873,22 +895,14 @@
 
         for target in targets_to_ingest or []:
             if type(target) is DataTargetBase:
                 target = get_target_driver(target, featureset)
             target.set_resource(featureset)
             if featureset.spec.passthrough and target.is_offline:
                 continue
-            if target.path and urlparse(target.path).scheme == "":
-                if mlrun_context:
-                    mlrun_context.logger.error(
-                        "Paths for spark ingest must contain schema, i.e v3io, s3, az"
-                    )
-                raise mlrun.errors.MLRunInvalidArgumentError(
-                    "Paths for spark ingest must contain schema, i.e v3io, s3, az"
-                )
             spark_options = target.get_spark_options(
                 key_columns, timestamp_key, overwrite
             )
             logger.info(
                 f"writing to target {target.name}, spark options {spark_options}"
             )
```

## mlrun/feature_store/common.py

```diff
@@ -214,15 +214,15 @@
             # config for using empty/default code
             config = RunConfig()
 
             # config for using .py/.ipynb file with image and extra package requirements
             config = RunConfig("mycode.py", image="mlrun/mlrun", requirements=["spacy"])
 
             # config for using function object
-            function = mlrun.import_function("hub://some_function")
+            function = mlrun.import_function("hub://some-function")
             config = RunConfig(function)
 
         :param function:    this can be function uri or function object or path to function code (.py/.ipynb)
                             or a :py:class:`~mlrun.runtimes.function_reference.FunctionReference`
                             the function define the code, dependencies, and resources
         :param local:       use True to simulate local job run or mock service
         :param image:       function container image
```

## mlrun/feature_store/steps.py

```diff
@@ -8,14 +8,15 @@
 #
 # Unless required by applicable law or agreed to in writing, software
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 #
+import math
 import re
 import uuid
 import warnings
 from collections import OrderedDict
 from typing import Any, Dict, List, Union
 
 import numpy as np
@@ -51,15 +52,15 @@
     def do(self, event):
         """
         This method defines the do method of this class according to the first event type.
         """
         engine = get_engine(event)
         self.do = self._engine_to_do_method.get(engine, None)
         if self.do is None:
-            raise mlrun.errors.InvalidArgummentError(
+            raise mlrun.errors.MLRunInvalidArgumentError(
                 f"Unrecognized engine: {engine}. Available engines are: pandas, spark and storey"
             )
 
         return self.do(event)
 
     def _do_pandas(self, event):
         raise NotImplementedError
@@ -132,15 +133,15 @@
 
 
 class MapValues(StepToDict, MLRunStep):
     """Map column values to new values"""
 
     def __init__(
         self,
-        mapping: Dict[str, Dict[str, Any]],
+        mapping: Dict[str, Dict[Union[str, int, bool], Any]],
         with_original_features: bool = False,
         suffix: str = "mapped",
         **kwargs,
     ):
         """Map column values to new values
 
         example::
@@ -222,42 +223,138 @@
         if self.with_original_features:
             df = pd.concat([event, df], axis=1)
         return df
 
     def _do_spark(self, event):
         from itertools import chain
 
-        from pyspark.sql.functions import col, create_map, lit, when
+        from pyspark.sql.functions import col, create_map, isnan, isnull, lit, when
+        from pyspark.sql.types import DecimalType, DoubleType, FloatType
+        from pyspark.sql.utils import AnalysisException
 
+        df = event
+        source_column_names = df.columns
         for column, column_map in self.mapping.items():
             new_column_name = self._get_feature_name(column)
-            if "ranges" not in column_map:
+            if not self.get_ranges_key() in column_map:
+                if column not in source_column_names:
+                    continue
                 mapping_expr = create_map([lit(x) for x in chain(*column_map.items())])
-                event = event.withColumn(
-                    new_column_name, mapping_expr.getItem(col(column))
-                )
+                try:
+                    df = df.withColumn(
+                        new_column_name,
+                        when(
+                            col(column).isin(list(column_map.keys())),
+                            mapping_expr.getItem(col(column)),
+                        ).otherwise(col(column)),
+                    )
+                #  if failed to use otherwise it is probably because the new column has different type
+                #  then the original column.
+                #  we will try to replace the values without using 'otherwise'.
+                except AnalysisException:
+                    df = df.withColumn(
+                        new_column_name, mapping_expr.getItem(col(column))
+                    )
+                    col_type = df.schema[column].dataType
+                    new_col_type = df.schema[new_column_name].dataType
+                    #  in order to avoid exception at isna on non-decimal/float columns -
+                    #  we need to check their types before filtering.
+                    if isinstance(col_type, (FloatType, DoubleType, DecimalType)):
+                        column_filter = (~isnull(col(column))) & (~isnan(col(column)))
+                    else:
+                        column_filter = ~isnull(col(column))
+                    if isinstance(new_col_type, (FloatType, DoubleType, DecimalType)):
+                        new_column_filter = isnull(col(new_column_name)) | isnan(
+                            col(new_column_name)
+                        )
+                    else:
+                        #  we need to check that every value replaced if we changed column type - except None or NaN.
+                        new_column_filter = isnull(col(new_column_name))
+                    mapping_to_null = [
+                        k
+                        for k, v in column_map.items()
+                        if v is None
+                        or (
+                            isinstance(v, (float, np.float64, np.float32, np.float16))
+                            and math.isnan(v)
+                        )
+                    ]
+                    turned_to_none_values = df.filter(
+                        column_filter & new_column_filter
+                    ).filter(~col(column).isin(mapping_to_null))
+
+                    if len(turned_to_none_values.head(1)) > 0:
+                        raise mlrun.errors.MLRunInvalidArgumentError(
+                            f"MapValues - mapping that changes column type must change all values accordingly,"
+                            f" which is not the case for column '{column}'"
+                        )
             else:
                 for val, val_range in column_map["ranges"].items():
                     min_val = val_range[0] if val_range[0] != "-inf" else -np.inf
                     max_val = val_range[1] if val_range[1] != "inf" else np.inf
                     otherwise = ""
-                    if new_column_name in event.columns:
-                        otherwise = event[new_column_name]
-                    event = event.withColumn(
+                    if new_column_name in df.columns:
+                        otherwise = df[new_column_name]
+                    df = df.withColumn(
                         new_column_name,
                         when(
-                            (event[column] < max_val) & (event[column] >= min_val),
+                            (df[column] < max_val) & (df[column] >= min_val),
                             lit(val),
                         ).otherwise(otherwise),
                     )
 
         if not self.with_original_features:
-            event = event.select(*self.mapping.keys())
+            df = df.select(*self.mapping.keys())
 
-        return event
+        return df
+
+    @classmethod
+    def validate_args(cls, feature_set, **kwargs):
+        mapping = kwargs.get("mapping", [])
+        for column, column_map in mapping.items():
+            if not cls.get_ranges_key() in column_map:
+                types = set(
+                    type(val)
+                    for val in column_map.values()
+                    if type(val) is not None
+                    and not (
+                        isinstance(val, (float, np.float64, np.float32, np.float16))
+                        and math.isnan(val)
+                    )
+                )
+            else:
+                if len(column_map) > 1:
+                    raise mlrun.errors.MLRunInvalidArgumentError(
+                        f"MapValues - mapping values of the same column can not combine ranges and "
+                        f"single replacement, which is the case for column '{column}'"
+                    )
+                ranges_dict = column_map[cls.get_ranges_key()]
+                types = set()
+                for ranges_mapping_values in ranges_dict.values():
+                    range_types = set(
+                        type(val)
+                        for val in ranges_mapping_values
+                        if type(val) is not None
+                        and val != "-inf"
+                        and val != "inf"
+                        and not (
+                            isinstance(val, (float, np.float64, np.float32, np.float16))
+                            and math.isnan(val)
+                        )
+                    )
+                    types = types.union(range_types)
+            if len(types) > 1:
+                raise mlrun.errors.MLRunInvalidArgumentError(
+                    f"MapValues - mapping values of the same column must be in the"
+                    f" same type, which was not the case for Column '{column}'"
+                )
+
+    @staticmethod
+    def get_ranges_key():
+        return "ranges"
 
 
 class Imputer(StepToDict, MLRunStep):
     def __init__(
         self,
         method: str = "avg",
         default_value=None,
```

## mlrun/projects/operations.py

```diff
@@ -68,14 +68,15 @@
     local: bool = None,
     verbose: bool = None,
     selector: str = None,
     project_object=None,
     auto_build: bool = None,
     schedule: Union[str, mlrun.api.schemas.ScheduleCronTrigger] = None,
     artifact_path: str = None,
+    notifications: List[mlrun.model.Notification] = None,
     returns: Optional[List[Union[str, Dict[str, str]]]] = None,
 ) -> Union[mlrun.model.RunObject, kfp.dsl.ContainerOp]:
     """Run a local or remote task as part of a local/kubeflow pipeline
 
     run_function() allow you to execute a function locally, on a remote cluster, or as part of an automated workflow
     function can be specified as an object or by name (str), when the function is specified by name it is looked up
     in the current project eliminating the need to redefine/edit functions.
@@ -87,24 +88,24 @@
     some behavior may differ between regular runs and deferred KFP runs.
 
     example (use with function object)::
 
         LABELS = "is_error"
         MODEL_CLASS = "sklearn.ensemble.RandomForestClassifier"
         DATA_PATH = "s3://bigdata/data.parquet"
-        function = mlrun.import_function("hub://auto_trainer")
+        function = mlrun.import_function("hub://auto-trainer")
         run1 = run_function(function, params={"label_columns": LABELS, "model_class": MODEL_CLASS},
                                       inputs={"dataset": DATA_PATH})
 
     example (use with project)::
 
         # create a project with two functions (local and from marketplace)
         project = mlrun.new_project(project_name, "./proj)
         project.set_function("mycode.py", "myfunc", image="mlrun/mlrun")
-        project.set_function("hub://auto_trainer", "train")
+        project.set_function("hub://auto-trainer", "train")
 
         # run functions (refer to them by name)
         run1 = run_function("myfunc", params={"x": 7})
         run2 = run_function("train", params={"label_columns": LABELS, "model_class": MODEL_CLASS},
                                      inputs={"dataset": run1.outputs["data"]})
 
     example (use in pipeline)::
@@ -139,14 +140,15 @@
     :param auto_build:      when set to True and the function require build it will be built on the first
                             function run, use only if you dont plan on changing the build config between runs
     :param schedule:        ScheduleCronTrigger class instance or a standard crontab expression string
                             (which will be converted to the class using its `from_crontab` constructor),
                             see this link for help:
                             https://apscheduler.readthedocs.io/en/3.x/modules/triggers/cron.html#module-apscheduler.triggers.cron
     :param artifact_path:   path to store artifacts, when running in a workflow this will be set automatically
+    :param notifications:   list of notifications to push when the run is completed
     :param returns:         List of log hints - configurations for how to log the returning values from the handler's
                             run (as artifacts or results). The list's length must be equal to the amount of returning
                             objects. A log hint may be given as:
 
                             * A string of the key to use to log the returning value as result or as an artifact. To
                               specify The artifact type, it is possible to pass a string in the following structure:
                               "<key> : <type>". Available artifact types can be seen in `mlrun.ArtifactType`. If no
@@ -194,14 +196,15 @@
             artifact_path=artifact_path
             # workflow artifact_path has precedence over the project artifact_path equivalent to
             # passing artifact_path to function.run() has precedence over the project.artifact_path and the default one
             or pipeline_context.workflow_artifact_path
             or (project.artifact_path if project else None),
             auto_build=auto_build,
             schedule=schedule,
+            notifications=notifications,
         )
         if run_result:
             run_result._notified = False
             pipeline_context.runs_map[run_result.uid()] = run_result
             run_result.after = (
                 lambda x: run_result
             )  # emulate KFP op, .after() will be ignored
```

## mlrun/projects/pipelines.py

```diff
@@ -701,15 +701,15 @@
         try:
             workflow_handler(**workflow_spec.args)
             state = mlrun.run.RunStatuses.succeeded
         except Exception as e:
             trace = traceback.format_exc()
             logger.error(trace)
             project.notifiers.push(
-                f"Workflow {workflow_id} run failed!, error: {e}\n{trace}", "error"
+                f":x: Workflow {workflow_id} run failed!, error: {e}\n{trace}", "error"
             )
             state = mlrun.run.RunStatuses.failed
         mlrun.run.wait_for_runs_completion(pipeline_context.runs_map.values())
         project.notifiers.push_pipeline_run_results(
             pipeline_context.runs_map.values(), state=state
         )
         pipeline_context.clear()
@@ -870,15 +870,16 @@
             # After fetching the workflow_id the workflow executed successfully
             state = mlrun.run.RunStatuses.succeeded
 
         except Exception as e:
             trace = traceback.format_exc()
             logger.error(trace)
             project.notifiers.push(
-                f"Workflow {workflow_name} run failed!, error: {e}\n{trace}", "error"
+                f":x: Workflow {workflow_name} run failed!, error: {e}\n{trace}",
+                "error",
             )
             state = mlrun.run.RunStatuses.failed
             return _PipelineRunStatus(
                 run_id,
                 inner_engine,
                 project=project,
                 workflow=workflow_spec,
@@ -1029,15 +1030,15 @@
                 f":x: Failed to run scheduled workflow {workflow_name} in Project {project_name} !\n"
                 f"error: ```{error}```\n{link}"
             )
             # Sending Slack Notification without losing the original error:
             try:
                 notification_pusher.push(
                     message=message,
-                    severity=mlrun.utils.notifications.NotificationSeverity.ERROR,
+                    severity=mlrun.api.schemas.NotificationSeverity.ERROR,
                 )
 
             except Exception as exc:
                 logger.error("Failed to send slack notification", exc=exc)
 
         raise error
```

## mlrun/projects/project.py

```diff
@@ -113,15 +113,15 @@
     """Create a new MLRun project, optionally load it from a yaml/zip/git template
 
     example::
 
         # create a project with local and marketplace functions, a workflow, and an artifact
         project = mlrun.new_project("myproj", "./", init_git=True, description="my new project")
         project.set_function('prep_data.py', 'prep-data', image='mlrun/mlrun', handler='prep_data')
-        project.set_function('hub://auto_trainer', 'train')
+        project.set_function('hub://auto-trainer', 'train')
         project.set_artifact('data', Artifact(target_path=data_url))
         project.set_workflow('main', "./myflow.py")
         project.save()
 
         # run the "main" workflow (watch=True to wait for run completion)
         project.run("main", watch=True)
 
@@ -165,15 +165,21 @@
             project = _load_project_dir(context, name)
         else:
             raise ValueError("template must be a path to .yaml or .zip file")
         project.metadata.name = name
         # Remove original owner name for avoiding possible conflicts
         project.spec.owner = None
     else:
-        project = MlrunProject(name=name)
+        project = MlrunProject.from_dict(
+            {
+                "metadata": {
+                    "name": name,
+                }
+            }
+        )
     project.spec.context = context
     project.spec.subpath = subpath or project.spec.subpath
 
     repo, url = init_repo(context, remote, init_git or remote)
     project.spec.repo = repo
     if remote and url != remote:
         project.create_remote(remote)
@@ -415,17 +421,23 @@
             data = fp.read()
             struct = yaml.load(data, Loader=yaml.FullLoader)
             project = _project_instance_from_struct(struct, name)
             project.spec.context = context
 
     elif path.isfile(path.join(context, subpath_str, "function.yaml")):
         func = import_function(path.join(context, subpath_str, "function.yaml"))
-        project = MlrunProject(
-            name=func.metadata.project,
-            functions=[{"url": "function.yaml", "name": func.metadata.name}],
+        project = MlrunProject.from_dict(
+            {
+                "metadata": {
+                    "name": func.metadata.project,
+                },
+                "spec": {
+                    "functions": [{"url": "function.yaml", "name": func.metadata.name}],
+                },
+            }
         )
     else:
         raise mlrun.errors.MLRunNotFoundError(
             "project or function YAML not found in path"
         )
 
     project.spec.context = context
@@ -765,34 +777,55 @@
 
 class MlrunProject(ModelObj):
     kind = "project"
     _dict_fields = ["kind", "metadata", "spec", "status"]
 
     def __init__(
         self,
+        # TODO: remove all arguments except metadata and spec in 1.6.0
         name=None,
         description=None,
         params=None,
         functions=None,
         workflows=None,
         artifacts=None,
         artifact_path=None,
         conda=None,
-        # all except these 2 are for backwards compatibility with MlrunProjectLegacy
+        # all except these metadata and spec are for backwards compatibility with MlrunProjectLegacy
         metadata=None,
         spec=None,
         default_requirements: typing.Union[str, typing.List[str]] = None,
     ):
         self._metadata = None
         self.metadata = metadata
         self._spec = None
         self.spec = spec
         self._status = None
         self.status = None
 
+        if any(
+            [
+                name,
+                description,
+                params,
+                functions,
+                workflows,
+                artifacts,
+                artifact_path,
+                conda,
+                default_requirements,
+            ]
+        ):
+            # TODO: remove in 1.6.0 along with all arguments except metadata and spec
+            warnings.warn(
+                "Project constructor arguments are deprecated in 1.4.0 and will be removed in 1.6.0,"
+                " use metadata and spec instead",
+                FutureWarning,
+            )
+
         # Handling the fields given in the legacy way
         self.metadata.name = name or self.metadata.name
         self.spec.description = description or self.spec.description
         self.spec.params = params or self.spec.params
         self.spec.functions = functions or self.spec.functions
         self.spec.workflows = workflows or self.spec.workflows
         self.spec.artifacts = artifacts or self.spec.artifacts
@@ -1432,20 +1465,23 @@
                 with open(f"{temp_dir}/_spec.yaml", "r") as fp:
                     data = fp.read()
                 spec = yaml.load(data, Loader=yaml.FullLoader)
                 artifact = get_artifact(spec)
                 with open(f"{temp_dir}/_body", "rb") as fp:
                     artifact.spec._body = fp.read()
                 artifact.target_path = ""
+
+                # if the dataitem is not a file, it means we downloaded it from a remote source to a temp file,
+                # so we need to remove it after we're done with it
+                dataitem.remove_local()
+
                 return self.log_artifact(
                     artifact, local_path=temp_dir, artifact_path=artifact_path
                 )
 
-            if dataitem.kind != "file":
-                remove(item_file)
         else:
             raise ValueError("unsupported file suffix, use .yaml, .json, or .zip")
 
         return self.log_artifact(artifact, artifact_path=artifact_path, upload=False)
 
     def reload(self, sync=False, context=None) -> "MlrunProject":
         """reload the project and function objects from the project yaml/specs
@@ -1485,15 +1521,15 @@
         """update or add a function object to the project
 
         function can be provided as an object (func) or a .py/.ipynb/.yaml url
         support url prefixes::
 
             object (s3://, v3io://, ..)
             MLRun DB e.g. db://project/func:ver
-            functions hub/market: e.g. hub://auto_trainer:master
+            functions hub/market: e.g. hub://auto-trainer:master
 
         examples::
 
             proj.set_function(func_object)
             proj.set_function('./src/mycode.py', 'ingest',
                               image='myrepo/ing:latest', with_repo=True)
             proj.set_function('http://.../mynb.ipynb', 'train')
@@ -1532,14 +1568,15 @@
 
             kernel = get_ipython()
             func = nuclio.utils.notebook_file_name(kernel)
             if func.startswith(path.abspath(self.spec.context)):
                 func = path.relpath(func, self.spec.context)
 
         func = func or ""
+        name = mlrun.utils.normalize_name(name) if name else name
         if isinstance(func, str):
             # in hub or db functions name defaults to the function name
             if not name and not (func.startswith("db://") or func.startswith("hub://")):
                 raise ValueError("function name must be specified")
             function_dict = {
                 "url": func,
                 "name": name,
@@ -2147,24 +2184,25 @@
         watch: bool = True,
         local: bool = None,
         verbose: bool = None,
         selector: str = None,
         auto_build: bool = None,
         schedule: typing.Union[str, mlrun.api.schemas.ScheduleCronTrigger] = None,
         artifact_path: str = None,
+        notifications: typing.List[mlrun.model.Notification] = None,
         returns: Optional[List[Union[str, Dict[str, str]]]] = None,
     ) -> typing.Union[mlrun.model.RunObject, kfp.dsl.ContainerOp]:
         """Run a local or remote task as part of a local/kubeflow pipeline
 
         example (use with project)::
 
             # create a project with two functions (local and from marketplace)
             project = mlrun.new_project(project_name, "./proj")
             project.set_function("mycode.py", "myfunc", image="mlrun/mlrun")
-            project.set_function("hub://auto_trainer", "train")
+            project.set_function("hub://auto-trainer", "train")
 
             # run functions (refer to them by name)
             run1 = project.run_function("myfunc", params={"x": 7})
             run2 = project.run_function("train", params={"label_columns": LABELS},
                                                  inputs={"dataset":run1.outputs["data"]})
 
         :param function:        name of the function (in the project) or function object
@@ -2188,14 +2226,15 @@
         :param auto_build:      when set to True and the function require build it will be built on the first
                                 function run, use only if you dont plan on changing the build config between runs
         :param schedule:        ScheduleCronTrigger class instance or a standard crontab expression string
                                 (which will be converted to the class using its `from_crontab` constructor),
                                 see this link for help:
                                 https://apscheduler.readthedocs.io/en/3.x/modules/triggers/cron.html#module-apscheduler.triggers.cron
         :param artifact_path:   path to store artifacts, when running in a workflow this will be set automatically
+        :param notifications:   list of notifications to push when the run is completed
         :param returns:         List of log hints - configurations for how to log the returning values from the
                                 handler's run (as artifacts or results). The list's length must be equal to the amount
                                 of returning objects. A log hint may be given as:
 
                                 * A string of the key to use to log the returning value as result or as an artifact. To
                                   specify The artifact type, it is possible to pass a string in the following structure:
                                   "<key> : <type>". Available artifact types can be seen in `mlrun.ArtifactType`. If no
@@ -2222,14 +2261,15 @@
             local=local,
             verbose=verbose,
             selector=selector,
             project_object=self,
             auto_build=auto_build,
             schedule=schedule,
             artifact_path=artifact_path,
+            notifications=notifications,
             returns=returns,
         )
 
     def build_function(
         self,
         function: typing.Union[str, mlrun.runtimes.BaseRuntime],
         with_mlrun: bool = None,
```

## mlrun/runtimes/__init__.py

```diff
@@ -43,15 +43,15 @@
     MpiRuntimeV1Alpha1,
     MpiV1Alpha1RuntimeHandler,
     MpiV1RuntimeHandler,
 )
 from .nuclio import nuclio_init_hook
 from .remotesparkjob import RemoteSparkRuntime, RemoteSparkRuntimeHandler
 from .serving import ServingRuntime, new_v2_model_server
-from .sparkjob import Spark2Runtime, Spark3Runtime, SparkRuntimeHandler
+from .sparkjob import Spark3Runtime, SparkRuntimeHandler
 
 # for legacy imports (MLModelServer moved from here to /serving)
 from ..serving import MLModelServer, new_v1_model_server  # noqa isort: skip
 
 
 def new_model_server(
     name,
@@ -256,19 +256,15 @@
         crd_version_to_runtime = {
             MPIJobCRDVersions.v1alpha1: MpiRuntimeV1Alpha1,
             MPIJobCRDVersions.v1: MpiRuntimeV1,
         }
         return crd_version_to_runtime[mpijob_crd_version]
 
     if kind == RuntimeKinds.spark:
-        spark_operator_version = resolve_spark_operator_version()
-        if spark_operator_version == 2:
-            return Spark2Runtime
-        elif spark_operator_version == 3:
-            return Spark3Runtime
+        return Spark3Runtime
 
     kind_runtime_map = {
         RuntimeKinds.remote: RemoteRuntime,
         RuntimeKinds.nuclio: RemoteRuntime,
         RuntimeKinds.serving: ServingRuntime,
         RuntimeKinds.dask: DaskCluster,
         RuntimeKinds.job: KubejobRuntime,
```

## mlrun/runtimes/base.py

```diff
@@ -11,15 +11,14 @@
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 import enum
 import getpass
 import http
 import os.path
-import shlex
 import traceback
 import typing
 import uuid
 from abc import ABC, abstractmethod
 from ast import literal_eval
 from base64 import b64encode
 from copy import deepcopy
@@ -29,16 +28,19 @@
 
 import IPython
 import requests.exceptions
 from kubernetes.client.rest import ApiException
 from nuclio.build import mlrun_footer
 from sqlalchemy.orm import Session
 
+import mlrun.api.db.sqldb.session
+import mlrun.api.utils.singletons.db
 import mlrun.errors
 import mlrun.utils.helpers
+import mlrun.utils.notifications
 import mlrun.utils.regex
 from mlrun.api import schemas
 from mlrun.api.constants import LogSources
 from mlrun.api.db.base import DBInterface
 from mlrun.utils.helpers import generate_object_uri, verify_field_regex
 
 from ..config import config, is_running_as_api
@@ -341,14 +343,15 @@
         hyper_param_options: HyperParamOptions = None,
         verbose=None,
         scrape_metrics: bool = None,
         local=False,
         local_code_path=None,
         auto_build=None,
         param_file_secrets: Dict[str, str] = None,
+        notifications: List[mlrun.model.Notification] = None,
         returns: Optional[List[Union[str, Dict[str, str]]]] = None,
     ) -> RunObject:
         """
         Run a local or remote task.
 
         :param runspec:        run template object or dict (see RunTemplate)
         :param handler:        pointer or name of a function handler
@@ -375,14 +378,15 @@
         :param scrape_metrics: whether to add the `mlrun/scrape-metrics` label to this run's resources
         :param local:      run the function locally vs on the runtime/cluster
         :param local_code_path: path of the code for local runs & debug
         :param auto_build: when set to True and the function require build it will be built on the first
                            function run, use only if you dont plan on changing the build config between runs
         :param param_file_secrets: dictionary of secrets to be used only for accessing the hyper-param parameter file.
                             These secrets are only used locally and will not be stored anywhere
+        :param notifications: list of notifications to push when the run is completed
         :param returns: List of log hints - configurations for how to log the returning values from the handler's run
                         (as artifacts or results). The list's length must be equal to the amount of returning objects. A
                         log hint may be given as:
 
                         * A string of the key to use to log the returning value as result or as an artifact. To specify
                           The artifact type, it is possible to pass a string in the following structure:
                           "<key> : <type>". Available artifact types can be seen in `mlrun.ArtifactType`. If no
@@ -404,26 +408,29 @@
         if local:
 
             # do not allow local function to be scheduled
             if schedule is not None:
                 raise mlrun.errors.MLRunInvalidArgumentError(
                     "local and schedule cannot be used together"
                 )
-            return self._run_local(
+            result = self._run_local(
                 run,
                 local_code_path,
                 project,
                 name,
                 workdir,
                 handler,
                 params,
                 inputs,
                 returns,
                 artifact_path,
+                notifications=notifications,
             )
+            self._save_or_push_notifications(result, local)
+            return result
 
         run = self._enrich_run(
             run,
             handler,
             project,
             name,
             params,
@@ -432,14 +439,15 @@
             hyperparams,
             hyper_param_options,
             verbose,
             scrape_metrics,
             out_path,
             artifact_path,
             workdir,
+            notifications,
         )
         self._validate_output_path(run)
         db = self._get_db()
 
         if not self.is_deployed():
             if self.spec.build.auto_build or auto_build:
                 logger.info(
@@ -529,14 +537,16 @@
                     if state not in ["succeeded", "completed"]:
                         logger.warning(f"run ended with state {state}")
                 result = self._update_run_state(resp, task=run)
             except RunError as err:
                 last_err = err
                 result = self._update_run_state(task=run, err=err)
 
+        self._save_or_push_notifications(run)
+
         self._post_run(result, execution)  # hook for runtime specific cleanup
 
         return self._wrap_run_result(result, run, schedule=schedule, err=last_err)
 
     def _wrap_run_result(
         self, result: dict, runspec: RunObject, schedule=None, err=None
     ):
@@ -626,14 +636,15 @@
         name,
         workdir,
         handler,
         params,
         inputs,
         returns,
         artifact_path,
+        notifications: List[mlrun.model.Notification] = None,
     ):
         # allow local run simulation with a flip of a flag
         command = self
         if local_code_path:
             project = project or self.metadata.project
             name = name or self.metadata.name
             command = local_code_path
@@ -646,14 +657,15 @@
             project=project,
             handler=handler,
             params=params,
             inputs=inputs,
             artifact_path=artifact_path,
             mode=self.spec.mode,
             allow_empty_resources=self.spec.allow_empty_resources,
+            notifications=notifications,
             returns=returns,
         )
 
     def _create_run_object(self, runspec):
         # TODO: Once implemented the `Runtime` handlers configurations (doc strings, params type hints and returning
         #       log hints, possible parameter values, etc), the configured type hints and log hints should be set into
         #       the `RunObject` from the `Runtime`.
@@ -684,14 +696,15 @@
         hyperparams,
         hyper_param_options,
         verbose,
         scrape_metrics,
         out_path,
         artifact_path,
         workdir,
+        notifications: List[mlrun.model.Notification] = None,
     ):
         runspec.spec.handler = (
             handler or runspec.spec.handler or self.spec.default_handler or ""
         )
         if runspec.spec.handler and self.kind not in ["handler", "dask"]:
             runspec.spec.handler = runspec.spec.handler_name
 
@@ -785,14 +798,16 @@
         if runspec.spec.output_path:
             runspec.spec.output_path = runspec.spec.output_path.replace(
                 "{{run.uid}}", meta.uid
             )
             runspec.spec.output_path = mlrun.utils.helpers.fill_artifact_path_template(
                 runspec.spec.output_path, runspec.metadata.project
             )
+
+        runspec.spec.notifications = notifications or runspec.spec.notifications or []
         return runspec
 
     def _submit_job(self, run: RunObject, schedule, db, watch):
         if self._secrets:
             run.spec.secret_sources = self._secrets.to_serial()
         try:
             resp = db.submit_job(run, schedule=schedule)
@@ -1045,14 +1060,55 @@
         if self._get_db() and updates:
             project = get_in(resp, "metadata.project")
             iter = get_in(resp, "metadata.iteration", 0)
             self._get_db().update_run(updates, uid, project, iter=iter)
 
         return resp
 
+    def _save_or_push_notifications(self, runobj: RunObject, local: bool = False):
+
+        if not runobj.spec.notifications:
+            logger.debug(
+                "No notifications to push for run", run_uid=runobj.metadata.uid
+            )
+            return
+
+        # TODO: add support for other notifications per run iteration
+        if runobj.metadata.iteration and runobj.metadata.iteration > 0:
+            logger.debug(
+                "Notifications per iteration are not supported, skipping",
+                run_uid=runobj.metadata.uid,
+            )
+            return
+
+        # If the run is remote, and we are in the SDK, we let the api deal with the notifications
+        # so there's nothing to do here.
+        # Otherwise, we continue on.
+        if is_running_as_api():
+
+            # import here to avoid circular imports and to avoid importing api requirements
+            from mlrun.api.crud import Notifications
+
+            # If in the api server, we can assume that watch=False, so we save notification
+            # configs to the DB, for the run monitor to later pick up and push.
+            session = mlrun.api.db.sqldb.session.create_session()
+            Notifications().store_run_notifications(
+                session,
+                runobj.spec.notifications,
+                runobj.metadata.uid,
+                runobj.metadata.project,
+            )
+
+        elif local:
+            # If the run is local, we can assume that watch=True, therefore this code runs
+            # once the run is completed, and we can just push the notifications.
+            # TODO: add store_notifications API endpoint so we can store notifications pushed from the
+            #       SDK for documentation purposes.
+            mlrun.utils.notifications.NotificationPusher([runobj]).push()
+
     def _force_handler(self, handler):
         if not handler:
             raise RunError(f"handler must be provided for {self.kind} runtime")
 
     def full_image_path(
         self, image=None, client_version: str = None, client_python_version: str = None
     ):
@@ -1216,23 +1272,27 @@
         """add package requirements from file or list to build spec.
 
         :param requirements:  python requirements file path or list of packages
         :param overwrite:     overwrite existing requirements
         :param verify_base_image:  verify that the base image is configured
         :return: function object
         """
-        encoded_requirements = self._encode_requirements(requirements)
-        commands = self.spec.build.commands or [] if not overwrite else []
-        new_command = f"python -m pip install {encoded_requirements}"
-        # make sure we dont append the same line twice
-        if new_command not in commands:
-            commands.append(new_command)
-        self.spec.build.commands = commands
+        resolved_requirements = self._resolve_requirements(requirements)
+        requirements = self.spec.build.requirements or [] if not overwrite else []
+
+        # make sure we don't append the same line twice
+        for requirement in resolved_requirements:
+            if requirement not in requirements:
+                requirements.append(requirement)
+
+        self.spec.build.requirements = requirements
+
         if verify_base_image:
             self.verify_base_image()
+
         return self
 
     def with_commands(
         self,
         commands: List[str],
         overwrite: bool = False,
         verify_base_image: bool = True,
@@ -1266,16 +1326,18 @@
             self.spec.image = self.spec.build.base_image
 
         self.spec.build = {}
         return self
 
     def verify_base_image(self):
         build = self.spec.build
-        require_build = build.commands or (
-            build.source and not build.load_source_on_run
+        require_build = (
+            build.commands
+            or build.requirements
+            or (build.source and not build.load_source_on_run)
         )
         image = self.spec.image
         # we allow users to not set an image, in that case we'll use the default
         if (
             not image
             and self.kind in mlrun.mlconf.function_defaults.image_by_kind.to_dict()
         ):
@@ -1392,50 +1454,39 @@
                         if "type" in p:
                             line += f"({p['type']})"
                         line += "  - " + p.get("doc", "")
                         if "default" in p:
                             line += f", default={p['default']}"
                         print("    " + line)
 
-    def _encode_requirements(self, requirements_to_encode):
-
+    @staticmethod
+    def _resolve_requirements(requirements_to_resolve: typing.Union[str, list]) -> list:
         # if a string, read the file then encode
-        if isinstance(requirements_to_encode, str):
-            with open(requirements_to_encode, "r") as fp:
-                requirements_to_encode = fp.read().splitlines()
+        if isinstance(requirements_to_resolve, str):
+            with open(requirements_to_resolve, "r") as fp:
+                requirements_to_resolve = fp.read().splitlines()
 
         requirements = []
-        for requirement in requirements_to_encode:
+        for requirement in requirements_to_resolve:
+            # clean redundant leading and trailing whitespaces
             requirement = requirement.strip()
 
             # ignore empty lines
             # ignore comments
             if not requirement or requirement.startswith("#"):
                 continue
 
             # ignore inline comments as well
             inline_comment = requirement.split(" #")
             if len(inline_comment) > 1:
                 requirement = inline_comment[0].strip()
 
-            # -r / --requirement are flags and should not be escaped
-            # we allow such flags (could be passed within the requirements.txt file) and do not
-            # try to open the file and include its content since it might be a remote file
-            # given on the base image.
-            for req_flag in ["-r", "--requirement"]:
-                if requirement.startswith(req_flag):
-                    requirement = requirement[len(req_flag) :].strip()
-                    requirements.append(req_flag)
-                    break
-
-            # wrap in single quote to ensure that the requirement is treated as a single string
-            # quote the requirement to avoid issues with special characters, double quotes, etc.
-            requirements.append(shlex.quote(requirement))
+            requirements.append(requirement)
 
-        return " ".join(requirements)
+        return requirements
 
     def _validate_output_path(self, run):
         if is_local(run.spec.output_path):
             message = ""
             if not os.path.isabs(run.spec.output_path):
                 message = (
                     "artifact/output path is not defined or is local and relative,"
```

## mlrun/runtimes/function.py

```diff
@@ -10,14 +10,15 @@
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 import asyncio
 import json
+import shlex
 import typing
 import warnings
 from base64 import b64encode
 from datetime import datetime
 from time import sleep
 from urllib.parse import urlparse
 
@@ -1385,14 +1386,35 @@
 
     nuclio_spec = nuclio.ConfigSpec(
         env=env_dict,
         external_source_env=external_source_env_dict,
         config=function.spec.config,
     )
     nuclio_spec.cmd = function.spec.build.commands or []
+
+    if function.spec.build.requirements:
+        resolved_requirements = []
+        # wrap in single quote to ensure that the requirement is treated as a single string
+        # quote the requirement to avoid issues with special characters, double quotes, etc.
+        for requirement in function.spec.build.requirements:
+            # -r / --requirement are flags and should not be escaped
+            # we allow such flags (could be passed within the requirements.txt file) and do not
+            # try to open the file and include its content since it might be a remote file
+            # given on the base image.
+            for req_flag in ["-r", "--requirement"]:
+                if requirement.startswith(req_flag):
+                    requirement = requirement[len(req_flag) :].strip()
+                    resolved_requirements.append(req_flag)
+                    break
+
+            resolved_requirements.append(shlex.quote(requirement))
+
+        encoded_requirements = " ".join(resolved_requirements)
+        nuclio_spec.cmd.append(f"python -m pip install {encoded_requirements}")
+
     project = function.metadata.project or "default"
     tag = function.metadata.tag
     handler = function.spec.function_handler
 
     if function.spec.build.source:
         _compile_nuclio_archive_config(
             nuclio_spec, function, builder_env, project, auth_info=auth_info
```

## mlrun/runtimes/kubejob.py

```diff
@@ -133,24 +133,20 @@
            * True: the existing params are replaced by the new ones
         :param verify_base_image: verify the base image is set
         """
         if image:
             self.spec.build.image = image
         if base_image:
             self.spec.build.base_image = base_image
-        # if overwrite and requirements or commands passed, clear the existing commands
-        # (requirements are added to the commands parameter)
-        if (requirements or commands) and overwrite:
-            self.spec.build.commands = None
+        if commands:
+            self.with_commands(commands, overwrite=overwrite, verify_base_image=False)
         if requirements:
             self.with_requirements(
-                requirements, overwrite=False, verify_base_image=False
+                requirements, overwrite=overwrite, verify_base_image=False
             )
-        if commands:
-            self.with_commands(commands, overwrite=False, verify_base_image=False)
         if extra:
             self.spec.build.extra = extra
         if secret is not None:
             self.spec.build.secret = secret
         if source:
             self.spec.build.source = source
         if load_source_on_run:
@@ -194,15 +190,21 @@
                 with_mlrun = build.with_mlrun
             else:
                 with_mlrun = build.base_image and not (
                     build.base_image.startswith("mlrun/")
                     or "/mlrun/" in build.base_image
                 )
 
-        if not build.source and not build.commands and not build.extra and with_mlrun:
+        if (
+            not build.source
+            and not build.commands
+            and not build.requirements
+            and not build.extra
+            and with_mlrun
+        ):
             logger.info(
                 "running build to add mlrun package, set "
                 "with_mlrun=False to skip if its already in the image"
             )
         self.status.state = ""
         if build.base_image:
             # clear the image so build will not be skipped
```

## mlrun/runtimes/serving.py

```diff
@@ -315,15 +315,15 @@
                                 object. By using TrackingPolicy, the user can apply his model monitoring requirements,
                                 such as setting the scheduling policy of the model monitoring batch job or changing
                                 the image of the model monitoring stream.
 
                                 example::
 
                                     # initialize a new serving function
-                                    serving_fn = mlrun.import_function("hub://v2_model_server", new_name="serving")
+                                    serving_fn = mlrun.import_function("hub://v2-model-server", new_name="serving")
                                     # apply model monitoring and set monitoring batch job to run every 3 hours
                                     tracking_policy = {'default_batch_intervals':"0 */3 * * *"}
                                     serving_fn.set_tracking(tracking_policy=tracking_policy)
 
         """
 
         # Applying model monitoring configurations
```

## mlrun/runtimes/sparkjob/__init__.py

```diff
@@ -11,9 +11,8 @@
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 # flake8: noqa  - this is until we take care of the F401 violations with respect to __all__ & sphinx
 
 from .abstract import SparkRuntimeHandler
-from .spark2job import Spark2Runtime
 from .spark3job import Spark3Runtime
```

## mlrun/runtimes/sparkjob/abstract.py

```diff
@@ -959,16 +959,14 @@
         label_selector: str = None,
         force: bool = False,
         grace_period: int = None,
     ):
         """
         Handling config maps deletion
         """
-        if grace_period is None:
-            grace_period = config.runtime_resources_deletion_grace_period
         uids = []
         for crd_dict in deleted_resources:
             uid = crd_dict["metadata"].get("labels", {}).get("mlrun/uid", None)
             uids.append(uid)
 
         k8s_helper = get_k8s_helper()
         config_maps = k8s_helper.v1api.list_namespaced_config_map(
```

## mlrun/serving/states.py

```diff
@@ -24,15 +24,15 @@
 from ..config import config
 from ..datastore import get_stream_pusher
 from ..datastore.utils import parse_kafka_url
 from ..errors import MLRunInvalidArgumentError, err_to_str
 from ..model import ModelObj, ObjectDict
 from ..platforms.iguazio import parse_path
 from ..utils import get_class, get_function
-from .utils import _extract_input_data, _update_result_body
+from .utils import StepToDict, _extract_input_data, _update_result_body
 
 callable_prefix = "_"
 path_splitter = "/"
 previous_step = "$prev"
 queue_class_names = [">>", "$queue"]
 
 
@@ -275,15 +275,15 @@
                     f"step {step} doesnt exist in the graph under {next_level.fullname}"
                 )
             next_level = next_level[step]
         return next_level
 
     def to(
         self,
-        class_name: Union[str, type] = None,
+        class_name: Union[str, StepToDict] = None,
         name: str = None,
         handler: str = None,
         graph_shape: str = None,
         function: str = None,
         full_event: bool = None,
         input_path: str = None,
         result_path: str = None,
```

## mlrun/utils/helpers.py

```diff
@@ -996,15 +996,15 @@
     splits = pkg_class.split(".")
     clfclass = splits[-1]
     pkg_module = splits[:-1]
     class_ = getattr(import_module(".".join(pkg_module)), clfclass)
     return class_
 
 
-def create_function(pkg_func: list):
+def create_function(pkg_func: str):
     """Create a function from a package.module.function string
 
     :param pkg_func:  full function location,
                       e.g. "sklearn.feature_selection.f_classif"
     """
     splits = pkg_func.split(".")
     pkg_module = ".".join(splits[:-1])
```

## mlrun/utils/notifications/notification_pusher.py

```diff
@@ -9,122 +9,270 @@
 # Unless required by applicable law or agreed to in writing, software
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 import ast
+import asyncio
+import datetime
 import os
 import typing
 
+from fastapi.concurrency import run_in_threadpool
+
+import mlrun.api.db.base
+import mlrun.api.db.session
+import mlrun.api.schemas
+import mlrun.api.utils.singletons.k8s
+import mlrun.config
 import mlrun.lists
 import mlrun.model
 import mlrun.utils.helpers
+from mlrun.utils import logger
 
-from .notification import NotificationBase, NotificationSeverity, NotificationTypes
+from .notification import NotificationBase, NotificationTypes
 
 
 class NotificationPusher(object):
 
     messages = {
-        "success": "Run completed",
+        "completed": "Run completed",
         "error": "Run failed",
     }
 
     def __init__(self, runs: typing.Union[mlrun.lists.RunList, list]):
         self._runs = runs
         self._notification_data = []
         self._notifications = {}
 
         for run in self._runs:
-            for notification_config in run.get("spec", {}).get("notifications", []):
-                if self._should_notify(run, notification_config):
-                    self._notification_data.append((run, notification_config))
-
-    def push(self):
-        for notification_data in self._notification_data:
-            self._send_notification(
-                self._load_notification(notification_data[1]), *notification_data
-            )
+            if isinstance(run, dict):
+                run = mlrun.model.RunObject.from_dict(run)
+
+            for notification in run.spec.notifications:
+                if self._should_notify(run, notification):
+                    self._notification_data.append((run, notification))
+
+    def push(
+        self,
+        db: mlrun.api.db.base.DBInterface = None,
+    ):
+        """
+        Asynchronously push notifications for all runs in the initialized runs list (if they should be pushed).
+        When running from a sync environment, the notifications will be pushed asynchronously however the function will
+        wait for all notifications to be pushed before returning.
+        """
+
+        if not len(self._notification_data):
+            return
+
+        async def _push():
+            tasks = []
+            for notification_data in self._notification_data:
+                tasks.append(
+                    self._push_notification(
+                        self._load_notification(*notification_data),
+                        notification_data[0],
+                        notification_data[1],
+                        db,
+                    )
+                )
+            await asyncio.gather(*tasks)
+
+        logger.debug(
+            "Pushing notifications", notifications_amount=len(self._notification_data)
+        )
+        main_event_loop = asyncio.get_event_loop()
+        if main_event_loop.is_running():
+
+            # If running from the api or from jupyter notebook, we are already in an event loop.
+            # We add the async push function to the loop and run it.
+            asyncio.run_coroutine_threadsafe(_push(), main_event_loop)
+        else:
+
+            # If running mlrun SDK locally (not from jupyter), there isn't necessarily an event loop.
+            # We create a new event loop and run the async push function in it.
+            main_event_loop.run_until_complete(_push())
 
     @staticmethod
     def _should_notify(
-        run: typing.Union[mlrun.model.RunObject, dict], notification_config: dict
+        run: mlrun.model.RunObject,
+        notification: mlrun.model.Notification,
     ) -> bool:
-        when_states = notification_config.get("when", [])
-        condition = notification_config.get("condition", "")
-        run_state = run.get("status", {}).get("state", "")
+        when_states = notification.when
+        condition = notification.condition
+        run_state = run.state()
+
+        # if the notification isn't pending, don't push it
+        if (
+            notification.status
+            and notification.status != mlrun.api.schemas.NotificationStatus.PENDING
+        ):
+            return False
 
         # if at least one condition is met, notify
         for when_state in when_states:
             if (
-                when_state == "success"
-                and run_state == "success"
+                when_state == run_state == "completed"
                 and (not condition or ast.literal_eval(condition))
-            ) or (when_state == "failure" and run_state == "error"):
+            ) or when_state == run_state == "error":
                 return True
 
         return False
 
-    def _load_notification(self, notification_config: dict) -> NotificationBase:
-        params = notification_config.get("params", {})
+    def _load_notification(
+        self, run: mlrun.model.RunObject, notification: mlrun.model.Notification
+    ) -> NotificationBase:
+        name = notification.name
         notification_type = NotificationTypes(
-            notification_config.get("type", "console")
+            notification.kind or NotificationTypes.console
         )
-        if notification_type not in self._notifications:
+        notification_key = f"{run.metadata.uid}-{name or notification_type}"
+        if notification_key not in self._notifications:
             self._notifications[
-                notification_type
-            ] = notification_type.get_notification()(params)
+                notification_key
+            ] = notification_type.get_notification()(name, notification.params)
         else:
-            self._notifications[notification_type].load_notification(params)
+            self._notifications[notification_key].load_notification(notification.params)
+
+        logger.debug(
+            "Loaded notification", notification=self._notifications[notification_key]
+        )
+        return self._notifications[notification_key]
 
-        return self._notifications[notification_type]
+    async def _push_notification(
+        self,
+        notification: NotificationBase,
+        run: mlrun.model.RunObject,
+        notification_object: mlrun.model.Notification,
+        db: mlrun.api.db.base.DBInterface,
+    ):
+        message = self.messages.get(run.state(), "")
+        severity = (
+            notification_object.severity or mlrun.api.schemas.NotificationSeverity.INFO
+        )
+        logger.debug(
+            "Pushing notification",
+            notification=notification_object.to_dict(),
+            run_uid=run.metadata.uid,
+        )
+        try:
+            if asyncio.iscoroutinefunction(notification.push):
+                await notification.push(message, severity, [run.to_dict()])
+            else:
+                notification.push(message, severity, [run.to_dict()])
+
+            if mlrun.config.is_running_as_api():
+                await self._update_notification_status(
+                    db,
+                    run.metadata.uid,
+                    run.metadata.project,
+                    notification_object,
+                    status=mlrun.api.schemas.NotificationStatus.SENT,
+                    sent_time=datetime.datetime.now(tz=datetime.timezone.utc),
+                )
+        except Exception as exc:
+            if mlrun.config.is_running_as_api():
+                await self._update_notification_status(
+                    db,
+                    run.metadata.uid,
+                    run.metadata.project,
+                    notification_object,
+                    status=mlrun.api.schemas.NotificationStatus.ERROR,
+                )
+            raise exc
 
-    def _send_notification(
-        self, notification: NotificationBase, run: dict, notification_config: dict
+    @staticmethod
+    async def _update_notification_status(
+        db: mlrun.api.db.base.DBInterface,
+        run_uid: str,
+        project: str,
+        notification: mlrun.model.Notification,
+        status: str = None,
+        sent_time: datetime.datetime = None,
     ):
-        message = self.messages.get(run.get("status", {}).get("state", ""), "")
-        severity = notification_config.get("severity", NotificationSeverity.INFO)
-        notification.send(message, severity, [run])
+        db_session = mlrun.api.db.session.create_session()
+        notification.status = status or notification.status
+        notification.sent_time = sent_time or notification.sent_time
+
+        # store directly in db, no need to use crud as the secrets are already loaded
+        await run_in_threadpool(
+            db.store_run_notifications,
+            db_session,
+            [notification],
+            run_uid,
+            project,
+        )
 
 
 class CustomNotificationPusher(object):
     def __init__(self, notification_types: typing.List[str] = None):
         self._notifications = {
             notification_type: NotificationTypes(notification_type).get_notification()()
             for notification_type in notification_types
         }
 
     def push(
         self,
         message: str,
-        severity: typing.Union[NotificationSeverity, str] = NotificationSeverity.INFO,
+        severity: typing.Union[
+            mlrun.api.schemas.NotificationSeverity, str
+        ] = mlrun.api.schemas.NotificationSeverity.INFO,
         runs: typing.Union[mlrun.lists.RunList, list] = None,
         custom_html: str = None,
     ):
-        for notification_type, notification in self._notifications.items():
-            if self.should_send_notification(notification_type):
-                notification.send(message, severity, runs, custom_html)
+        async def _push():
+            tasks = []
+            for notification_type, notification in self._notifications.items():
+                if self.should_push_notification(notification_type):
+                    tasks.append(
+                        self._push_notification(
+                            notification, message, severity, runs, custom_html
+                        )
+                    )
+            await asyncio.gather(*tasks)
+
+        main_event_loop = asyncio.get_event_loop()
+        if main_event_loop.is_running():
+            asyncio.run_coroutine_threadsafe(_push(), main_event_loop)
+        else:
+            main_event_loop.run_until_complete(_push())
+
+    @staticmethod
+    async def _push_notification(
+        notification: NotificationBase,
+        message: str,
+        severity: typing.Union[
+            mlrun.api.schemas.NotificationSeverity, str
+        ] = mlrun.api.schemas.NotificationSeverity.INFO,
+        runs: typing.Union[mlrun.lists.RunList, list] = None,
+        custom_html: str = None,
+    ):
+        if asyncio.iscoroutinefunction(notification.push):
+            await notification.push(message, severity, runs, custom_html)
+        else:
+            notification.push(message, severity, runs, custom_html)
 
     def add_notification(
         self, notification_type: str, params: typing.Dict[str, str] = None
     ):
         if notification_type in self._notifications:
             self._notifications[notification_type].load_notification(params)
         else:
             self._notifications[notification_type] = NotificationTypes(
                 notification_type
             ).get_notification()(params)
 
-    def should_send_notification(self, notification_type):
+    def should_push_notification(self, notification_type):
         notification = self._notifications.get(notification_type)
         if not notification or not notification.active:
             return False
 
-        # get notification's inverse dependencies, and only send the notification if
+        # get notification's inverse dependencies, and only push the notification if
         # none of its inverse dependencies are being sent
         inverse_dependencies = NotificationTypes(
             notification_type
         ).inverse_dependencies()
         for inverse_dependency in inverse_dependencies:
             inverse_dependency_notification = self._notifications.get(
                 inverse_dependency
```

## mlrun/utils/notifications/notification/__init__.py

```diff
@@ -11,15 +11,15 @@
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 import enum
 import typing
 
-from .base import NotificationBase, NotificationSeverity  # noqa
+from .base import NotificationBase
 from .console import ConsoleNotification
 from .git import GitNotification
 from .ipython import IPythonNotification
 from .slack import SlackNotification
 
 
 class NotificationTypes(str, enum.Enum):
```

## mlrun/utils/notifications/notification/base.py

```diff
@@ -8,64 +8,65 @@
 #
 # Unless required by applicable law or agreed to in writing, software
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
-import enum
 import typing
 
+import mlrun.api.schemas
 import mlrun.lists
 
 
-class NotificationSeverity(str, enum.Enum):
-    INFO = "info"
-    DEBUG = "debug"
-    VERBOSE = "verbose"
-    WARNING = "warning"
-    ERROR = "error"
-
-
 class NotificationBase:
     def __init__(
         self,
+        name: str = None,
         params: typing.Dict[str, str] = None,
     ):
+        self.name = name
         self.params = params or {}
 
     @property
     def active(self) -> bool:
         return True
 
-    def send(
+    def push(
         self,
         message: str,
-        severity: typing.Union[NotificationSeverity, str] = NotificationSeverity.INFO,
+        severity: typing.Union[
+            mlrun.api.schemas.NotificationSeverity, str
+        ] = mlrun.api.schemas.NotificationSeverity.INFO,
         runs: typing.Union[mlrun.lists.RunList, list] = None,
         custom_html: str = None,
     ):
         raise NotImplementedError()
 
     def load_notification(
         self,
         params: typing.Dict[str, str],
     ) -> None:
         self.params = params or {}
 
-    @staticmethod
     def _get_html(
+        self,
         message: str,
-        severity: typing.Union[NotificationSeverity, str] = NotificationSeverity.INFO,
+        severity: typing.Union[
+            mlrun.api.schemas.NotificationSeverity, str
+        ] = mlrun.api.schemas.NotificationSeverity.INFO,
         runs: typing.Union[mlrun.lists.RunList, list] = None,
         custom_html: str = None,
     ) -> str:
         if custom_html:
             return custom_html
 
+        if self.name:
+            message = f"{self.name}: {message}"
+
         if not runs:
             return f"[{severity}] {message}"
 
         if isinstance(runs, list):
             runs = mlrun.lists.RunList(runs)
 
         html = f"<h2>Run Results</h2><h3>[{severity}] {message}</h3>"
```

## mlrun/utils/notifications/notification/console.py

```diff
@@ -12,29 +12,32 @@
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 import typing
 
 import tabulate
 
+import mlrun.api.schemas
 import mlrun.lists
 import mlrun.utils.helpers
 
-from .base import NotificationBase, NotificationSeverity
+from .base import NotificationBase
 
 
 class ConsoleNotification(NotificationBase):
     """
     Client only notification for printing run status notifications in console
     """
 
-    def send(
+    def push(
         self,
         message: str,
-        severity: typing.Union[NotificationSeverity, str] = NotificationSeverity.INFO,
+        severity: typing.Union[
+            mlrun.api.schemas.NotificationSeverity, str
+        ] = mlrun.api.schemas.NotificationSeverity.INFO,
         runs: typing.Union[mlrun.lists.RunList, list] = None,
         custom_html: str = None,
     ):
         print(f"[{severity}] {message}")
 
         if not runs:
             return
```

## mlrun/utils/notifications/notification/git.py

```diff
@@ -12,54 +12,57 @@
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 import json
 import os
 import typing
 
-import requests
+import aiohttp
 
+import mlrun.api.schemas
 import mlrun.errors
 import mlrun.lists
 
-from .base import NotificationBase, NotificationSeverity
+from .base import NotificationBase
 
 
 class GitNotification(NotificationBase):
     """
     API/Client notification for setting a rich run statuses git issue comment (github/gitlab)
     """
 
-    def send(
+    async def push(
         self,
         message: str,
-        severity: typing.Union[NotificationSeverity, str] = NotificationSeverity.INFO,
+        severity: typing.Union[
+            mlrun.api.schemas.NotificationSeverity, str
+        ] = mlrun.api.schemas.NotificationSeverity.INFO,
         runs: typing.Union[mlrun.lists.RunList, list] = None,
         custom_html: str = None,
     ):
         git_repo = self.params.get("repo", None)
         git_issue = self.params.get("issue", None)
         token = (
             self.params.get("token", None)
             or self.params.get("GIT_TOKEN", None)
             or self.params.get("GITHUB_TOKEN", None)
         )
         server = self.params.get("server", None)
         gitlab = self.params.get("gitlab", False)
-        self._pr_comment(
+        await self._pr_comment(
             self._get_html(message, severity, runs, custom_html),
             git_repo,
             git_issue,
             token=token,
             server=server,
             gitlab=gitlab,
         )
 
     @staticmethod
-    def _pr_comment(
+    async def _pr_comment(
         message: str,
         repo: str = None,
         issue: int = None,
         token: str = None,
         server: str = None,
         gitlab: bool = False,
     ) -> str:
@@ -107,13 +110,17 @@
                         )
                     issue = event["issue"].get("number")
             headers = {
                 "Accept": "application/vnd.github.v3+json",
                 "Authorization": f"token {token}",
             }
             url = f"https://{server}/repos/{repo}/issues/{issue}/comments"
-        resp = requests.post(url=url, json={"body": str(message)}, headers=headers)
-        if not resp.ok:
-            raise mlrun.errors.MLRunBadRequestError(
-                "Failed commenting on PR", response=resp.text, status=resp.status_code
-            )
-        return resp.json()["id"]
+
+        async with aiohttp.ClientSession() as session:
+            resp = await session.post(url, headers=headers, json={"body": message})
+            if not resp.ok:
+                resp_text = await resp.text()
+                raise mlrun.errors.MLRunBadRequestError(
+                    f"Failed commenting on PR: {resp_text}", status=resp.status
+                )
+            data = await resp.json()
+            return data.get("id")
```

## mlrun/utils/notifications/notification/ipython.py

```diff
@@ -10,18 +10,19 @@
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 import typing
 
+import mlrun.api.schemas
 import mlrun.lists
 import mlrun.utils.helpers
 
-from .base import NotificationBase, NotificationSeverity
+from .base import NotificationBase
 
 
 class IPythonNotification(NotificationBase):
     """
     Client only notification for printing rich run statuses in IPython/Jupyter notebooks
     """
 
@@ -41,18 +42,20 @@
         except ImportError:
             pass
 
     @property
     def active(self) -> bool:
         return self._ipython is not None
 
-    def send(
+    def push(
         self,
         message: str,
-        severity: typing.Union[NotificationSeverity, str] = NotificationSeverity.INFO,
+        severity: typing.Union[
+            mlrun.api.schemas.NotificationSeverity, str
+        ] = mlrun.api.schemas.NotificationSeverity.INFO,
         runs: typing.Union[mlrun.lists.RunList, list] = None,
         custom_html: str = None,
     ):
         if not self._ipython:
             mlrun.utils.helpers.logger.debug(
                 "Not in IPython environment, skipping notification"
             )
```

## mlrun/utils/notifications/notification/slack.py

```diff
@@ -8,40 +8,42 @@
 #
 # Unless required by applicable law or agreed to in writing, software
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
-import json
 import typing
 
-import requests
+import aiohttp
 
+import mlrun.api.schemas
 import mlrun.lists
 import mlrun.utils.helpers
 
-from .base import NotificationBase, NotificationSeverity
+from .base import NotificationBase
 
 
 class SlackNotification(NotificationBase):
     """
     API/Client notification for sending run statuses as a slack message
     """
 
     emojis = {
         "completed": ":smiley:",
         "running": ":man-running:",
         "error": ":x:",
     }
 
-    def send(
+    async def push(
         self,
         message: str,
-        severity: typing.Union[NotificationSeverity, str] = NotificationSeverity.INFO,
+        severity: typing.Union[
+            mlrun.api.schemas.NotificationSeverity, str
+        ] = mlrun.api.schemas.NotificationSeverity.INFO,
         runs: typing.Union[mlrun.lists.RunList, list] = None,
         custom_html: str = None,
     ):
         webhook = self.params.get("webhook", None) or mlrun.get_secret_or_env(
             "SLACK_WEBHOOK"
         )
 
@@ -49,25 +51,24 @@
             mlrun.utils.helpers.logger.debug(
                 "No slack webhook is set, skipping notification"
             )
             return
 
         data = self._generate_slack_data(message, severity, runs)
 
-        response = requests.post(
-            webhook,
-            data=json.dumps(data),
-            headers={"Content-Type": "application/json"},
-        )
-        response.raise_for_status()
+        async with aiohttp.ClientSession() as session:
+            async with session.post(webhook, json=data) as response:
+                response.raise_for_status()
 
     def _generate_slack_data(
         self,
         message: str,
-        severity: typing.Union[NotificationSeverity, str] = NotificationSeverity.INFO,
+        severity: typing.Union[
+            mlrun.api.schemas.NotificationSeverity, str
+        ] = mlrun.api.schemas.NotificationSeverity.INFO,
         runs: typing.Union[mlrun.lists.RunList, list] = None,
     ) -> dict:
         data = {
             "blocks": [
                 {
                     "type": "section",
                     "text": self._get_slack_row(f"[{severity}] {message}"),
```

## mlrun/utils/version/version.json

### Pretty-printed

 * *Similarity: 0.5%*

 * *Differences: {"'git_commit'": "'f760105dd81b8903cdd218cadcae06b256e3d958'", "'version'": "'1.4.0-rc1'"}*

```diff
@@ -1,4 +1,4 @@
 {
-    "git_commit": "0934bc1837449e9cd5a7baca2578f99554459891",
-    "version": "1.3.1-rc4"
+    "git_commit": "f760105dd81b8903cdd218cadcae06b256e3d958",
+    "version": "1.4.0-rc1"
 }
```

## Comparing `mlrun-1.3.1rc4.dist-info/LICENSE` & `mlrun-1.4.0rc1.dist-info/LICENSE`

 * *Files identical despite different names*

## Comparing `mlrun-1.3.1rc4.dist-info/METADATA` & `mlrun-1.4.0rc1.dist-info/METADATA`

 * *Files 1% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: mlrun
-Version: 1.3.1rc4
+Version: 1.4.0rc1
 Summary: Tracking and config of machine learning runs
 Home-page: https://github.com/mlrun/mlrun
 Author: Yaron Haviv
 Author-email: yaronh@iguazio.com
 License: MIT
 Platform: UNKNOWN
 Classifier: Development Status :: 4 - Beta
@@ -30,15 +30,15 @@
 Requires-Dist: protobuf (<3.20,>=3.13)
 Requires-Dist: kfp (<1.8.14,~=1.8.0)
 Requires-Dist: nest-asyncio (~=1.0)
 Requires-Dist: ipython (<9.0,>=7.0)
 Requires-Dist: nuclio-jupyter (~=0.9.9)
 Requires-Dist: numpy (<1.23.0,>=1.16.5)
 Requires-Dist: pandas (<1.5.0,~=1.2)
-Requires-Dist: pyarrow (<11,>=10)
+Requires-Dist: pyarrow (<12,>=10.0)
 Requires-Dist: pyyaml (~=5.1)
 Requires-Dist: requests (~=2.22)
 Requires-Dist: sqlalchemy (~=1.4)
 Requires-Dist: tabulate (~=0.8.6)
 Requires-Dist: v3io (~=0.5.20)
 Requires-Dist: pydantic (~=1.5)
 Requires-Dist: orjson (~=3.3)
@@ -59,14 +59,15 @@
 Requires-Dist: inflection (~=0.5.0)
 Requires-Dist: python-dotenv (~=0.17.0)
 Requires-Dist: setuptools (~=65.5)
 Requires-Dist: deprecated (~=1.2)
 Provides-Extra: all
 Requires-Dist: adlfs (~=2021.8.1) ; extra == 'all'
 Requires-Dist: aiobotocore (~=1.4.0) ; extra == 'all'
+Requires-Dist: avro (~=1.11) ; extra == 'all'
 Requires-Dist: azure-core (~=1.24) ; extra == 'all'
 Requires-Dist: azure-identity (~=1.5) ; extra == 'all'
 Requires-Dist: azure-keyvault-secrets (~=4.2) ; extra == 'all'
 Requires-Dist: azure-storage-blob (~=12.13) ; extra == 'all'
 Requires-Dist: bokeh (>=2.4.2,~=2.4) ; extra == 'all'
 Requires-Dist: boto3 (<1.17.107,~=1.9) ; extra == 'all'
 Requires-Dist: botocore (<1.20.107,>=1.20.106) ; extra == 'all'
@@ -98,14 +99,15 @@
 Requires-Dist: azure-keyvault-secrets (~=4.2) ; extra == 'azure-key-vault'
 Requires-Dist: pyopenssl (>=23) ; extra == 'azure-key-vault'
 Provides-Extra: bokeh
 Requires-Dist: bokeh (>=2.4.2,~=2.4) ; extra == 'bokeh'
 Provides-Extra: complete
 Requires-Dist: adlfs (~=2021.8.1) ; extra == 'complete'
 Requires-Dist: aiobotocore (~=1.4.0) ; extra == 'complete'
+Requires-Dist: avro (~=1.11) ; extra == 'complete'
 Requires-Dist: azure-core (~=1.24) ; extra == 'complete'
 Requires-Dist: azure-identity (~=1.5) ; extra == 'complete'
 Requires-Dist: azure-keyvault-secrets (~=4.2) ; extra == 'complete'
 Requires-Dist: azure-storage-blob (~=12.13) ; extra == 'complete'
 Requires-Dist: boto3 (<1.17.107,~=1.9) ; extra == 'complete'
 Requires-Dist: botocore (<1.20.107,>=1.20.106) ; extra == 'complete'
 Requires-Dist: gcsfs (~=2021.8.1) ; extra == 'complete'
@@ -117,14 +119,15 @@
 Requires-Dist: pyopenssl (>=23) ; extra == 'complete'
 Requires-Dist: redis (~=4.3) ; extra == 'complete'
 Requires-Dist: s3fs (~=2021.8.1) ; extra == 'complete'
 Provides-Extra: complete-api
 Requires-Dist: adlfs (~=2021.8.1) ; extra == 'complete-api'
 Requires-Dist: aiobotocore (~=1.4.0) ; extra == 'complete-api'
 Requires-Dist: apscheduler (~=3.6) ; extra == 'complete-api'
+Requires-Dist: avro (~=1.11) ; extra == 'complete-api'
 Requires-Dist: azure-core (~=1.24) ; extra == 'complete-api'
 Requires-Dist: azure-identity (~=1.5) ; extra == 'complete-api'
 Requires-Dist: azure-keyvault-secrets (~=4.2) ; extra == 'complete-api'
 Requires-Dist: azure-storage-blob (~=12.13) ; extra == 'complete-api'
 Requires-Dist: boto3 (<1.17.107,~=1.9) ; extra == 'complete-api'
 Requires-Dist: botocore (<1.20.107,>=1.20.106) ; extra == 'complete-api'
 Requires-Dist: dask-kubernetes (~=0.11.0) ; extra == 'complete-api'
@@ -148,14 +151,15 @@
 Requires-Dist: google-cloud-bigquery[bqstorage,pandas] (~=3.2) ; extra == 'google-cloud-bigquery'
 Provides-Extra: google-cloud-storage
 Requires-Dist: gcsfs (~=2021.8.1) ; extra == 'google-cloud-storage'
 Provides-Extra: graphviz
 Requires-Dist: graphviz (~=0.20.0) ; extra == 'graphviz'
 Provides-Extra: kafka
 Requires-Dist: kafka-python (~=2.0) ; extra == 'kafka'
+Requires-Dist: avro (~=1.11) ; extra == 'kafka'
 Provides-Extra: plotly
 Requires-Dist: plotly (<5.12.0,~=5.4) ; extra == 'plotly'
 Provides-Extra: redis
 Requires-Dist: redis (~=4.3) ; extra == 'redis'
 Provides-Extra: s3
 Requires-Dist: boto3 (<1.17.107,~=1.9) ; extra == 's3'
 Requires-Dist: botocore (<1.20.107,>=1.20.106) ; extra == 's3'
```

## Comparing `mlrun-1.3.1rc4.dist-info/RECORD` & `mlrun-1.4.0rc1.dist-info/RECORD`

 * *Files 4% similar despite different names*

```diff
@@ -1,130 +1,132 @@
 mlrun/__init__.py,sha256=cCTbgyTFsXvEdaq1Cvwz8s8FE75YGIJKX58um-fnfFs,8727
-mlrun/__main__.py,sha256=7rP5R0xv1YziN-yfFqy9IJM1Z16vehUNPVz_PUU0zqQ,47778
-mlrun/builder.py,sha256=4PnePQzFy69RHgzFksdRNskExrjnmGCGPLXMHVPUdwM,24314
-mlrun/config.py,sha256=UbxmDWCDpIMZuPUANsmF0xl3_Ihey9s6K4gVn_SYfcM,49992
+mlrun/__main__.py,sha256=7AXWZ6AYLQ1xGIHgrSnPORYU8ZERr3pHGsRdJpCxpHA,49967
+mlrun/builder.py,sha256=5YKq67e3nHlVtxW0Z9f6j86qnrhclHEvy8OxmlDVyJ4,24965
+mlrun/config.py,sha256=83S9K8pNvlIknMtpTNaVW0LGbFJ37qLtrF4CJHi6dtg,50570
 mlrun/errors.py,sha256=XEb1pxwy5Lzr9q0VT4z_SjP74jy37HFSmdd2hddWgvY,6780
-mlrun/execution.py,sha256=jL7GuRPa4ZHxroW7kGLtBFeiOzDQoPv3bHZ2BGGSaUo,38928
+mlrun/execution.py,sha256=RMuw1D78GOWxDk3aQfFtFRZZ5maM4T7BiXaApoQA_6E,39096
 mlrun/features.py,sha256=pDUvV6HlkxZnUwW3lg7oq3vBwdcJQBprvdyGPNv57X8,15624
-mlrun/k8s_utils.py,sha256=5Ly-7Pgis6W1dHL1fOHSYkLcWEqZLdfGuDgDK-bsmIM,31384
+mlrun/k8s_utils.py,sha256=fGObRopN5-7iS1TzIUzMVggN5-yb5wieLTDdesbhm-8,31688
 mlrun/kfpops.py,sha256=fCq9kqsIO5six8AmHkiRLngyDclRymd7V6U5YXnX_ek,29645
 mlrun/lists.py,sha256=yOKwpS71Fua08sV825Anth8aaR9H5bHZyV544YbnXj4,8360
-mlrun/model.py,sha256=hb7Zwbl9fXp6BAmYt-VBHZRMzhp3Ql8vKzHHqWgsShI,52194
+mlrun/model.py,sha256=kxctSqX1Uqpy_YFd0kzMPppo5PamiM5o0sSd1JnADgk,53402
 mlrun/render.py,sha256=983QAYawKTFlwXLpUwGC1gWEjUQUFxl1lo8bPQuXIA0,11828
-mlrun/run.py,sha256=AoVyOqBTm1Hm3uIlSEkh_cqv0RuGsUFfBKpn085-w6I,64321
+mlrun/run.py,sha256=ccokIwQ1yodQxVBieNl3x9GxDx-Ztsi3O6m0Lh9KCYs,64451
 mlrun/secrets.py,sha256=yboWaNO33RCXmopLL2bGCkDUbHuwJ7IgJaFv1lkoN_I,7731
 mlrun/api/__init__.py,sha256=B-yvMk7vTs3QqtlPkM4pnZk_B4QKTGnfNhYr2n4Z30M,571
 mlrun/api/alembic.ini,sha256=oeSJRHwBbF3c3-N_RJilcZD-diq3F-oPv21gDIkrZGs,2105
 mlrun/api/constants.py,sha256=fyTQXJe4sx4GK8vZxklivgJgaSyOftk_NezGKA1J-mo,685
 mlrun/api/initial_data.py,sha256=Zj9Oan9Qeg45AOv8Dfg3Gvsymuz5cFR7zgLskuxUTFs,23530
-mlrun/api/main.py,sha256=PKT5kdQTSZVKl8-miQwl--V0rc2HPCkuk_Zpn_EVqQM,24019
+mlrun/api/main.py,sha256=1VtkWdILYXSY32i8DjO1Ost7_DrQN1tLO0CLTP9NWbo,26180
 mlrun/api/middlewares.py,sha256=VTW5VV7AGOigXf-ru2V3XSZzw_bMBr8j0uH2aMIGGfk,5235
 mlrun/api/api/__init__.py,sha256=B-yvMk7vTs3QqtlPkM4pnZk_B4QKTGnfNhYr2n4Z30M,571
 mlrun/api/api/api.py,sha256=suDQI8HL_zjtqaY7fBdm49SP73zJN2imdBiOh1hA4fQ,4267
 mlrun/api/api/deps.py,sha256=KTllUn0OHT-gGfnWPcz47QQwiHtxeHZBLEWMMbYWPBc,3143
-mlrun/api/api/utils.py,sha256=R2fVBlahNevk5IshtohBqibmS3Rnc4Ph3xViUoEKNfU,32788
+mlrun/api/api/utils.py,sha256=ia6xAEdGHwL2Z6t8jhI0_qFX4BeHz-qFxlnoe6vqR5s,36224
 mlrun/api/api/endpoints/__init__.py,sha256=B-yvMk7vTs3QqtlPkM4pnZk_B4QKTGnfNhYr2n4Z30M,571
 mlrun/api/api/endpoints/artifacts.py,sha256=oGy-key8BmAUNWvCiOqAcatjV0pVd_0atcn8ZGftgjM,9458
 mlrun/api/api/endpoints/auth.py,sha256=8-vv61tPX_RFabJPPyXAWbSb8i3apcpbqJSs0GXINYM,1190
 mlrun/api/api/endpoints/background_tasks.py,sha256=qVLyyRLpW4TXLsDOGghLXFt1ugWvygcPhfcXMi1SRrg,3588
 mlrun/api/api/endpoints/client_spec.py,sha256=0NzHkmV9O4izIu2bu-NhgaXi_UfJxkfsbOV7XZhzMUM,1202
 mlrun/api/api/endpoints/clusterization_spec.py,sha256=ImsNfHpCmXI83WZqDdBGfw2Qkra00-Q7PcWbSgEiQXA,1160
 mlrun/api/api/endpoints/feature_store.py,sha256=NCstDeosECMVE_JVjFJoL_XWY14ffDOCuZG6XQXwXTo,28813
 mlrun/api/api/endpoints/files.py,sha256=w412iL7Al7VHi_jJUvThyraO5hyWLrXG85iw10PVJx4,6065
 mlrun/api/api/endpoints/frontend_spec.py,sha256=nr4EC25MbXCIDCWQaLD93saVB8cZg3R2UOUePx8xQ7U,5690
 mlrun/api/api/endpoints/functions.py,sha256=dOTy57CyTSqFI7mOB7utl8JUG7pR9idQn18h7P2NUkM,33894
 mlrun/api/api/endpoints/grafana_proxy.py,sha256=NFgIpoxIXAmI_3bKXTNvC0Z0wEu7WcqsBH3zqfhbyZo,5798
 mlrun/api/api/endpoints/healthz.py,sha256=s0TiCIm6AmOj6_esi57mFK5TiNq5U92v7LZcUx_oGtY,1163
 mlrun/api/api/endpoints/logs.py,sha256=1a73ZwNNMDZaaYRqFbL3XZ6OrK3dKCpQI7HC-QJxI78,2429
-mlrun/api/api/endpoints/marketplace.py,sha256=PXc5OftoSoILyHCgSgNdNBEh4JjR8PmcvTQ6uB3nYfo,8283
+mlrun/api/api/endpoints/marketplace.py,sha256=FdgtlvewBVGJ6F5IFlffU6Q8eoVIgcxe82rjbnVRX34,10035
 mlrun/api/api/endpoints/model_endpoints.py,sha256=vlKqhQUJZISBWujGT3BQLWQD0aVyihrMcl8Fb-W8PXo,15724
 mlrun/api/api/endpoints/operations.py,sha256=Fxtp2jY3dlgzYG-2vm1AqNnpxQ-7WaJuibyKX569stg,3700
 mlrun/api/api/endpoints/pipelines.py,sha256=wV3ZvX7LPgb6bBsryXHXkwiiX_oxpK-Cwskj88W3KyE,9099
 mlrun/api/api/endpoints/projects.py,sha256=lFHvfDeeKdNIZ-DhmGKRSqQOuQuOWLu8a0uNay2tyDA,11392
-mlrun/api/api/endpoints/runs.py,sha256=2a_x6-IOLeQwhvLSH7dJOG3Xn-4aO2P4Vjt5T6J3cb8,8956
+mlrun/api/api/endpoints/runs.py,sha256=WyMFtZKU79BhkYwcOyejXyK9D_YX7U7bc7fZwRBUxm0,9076
 mlrun/api/api/endpoints/runtime_resources.py,sha256=Eer8nrP8Hh0y-pXkYr0dOXL7wjw4leE9Q-cxOMdIw08,8988
 mlrun/api/api/endpoints/schedules.py,sha256=Yw3tZNnjfZBgwS-Rsx-i8i8dzi-UNsbfNNvja8eN41I,10579
 mlrun/api/api/endpoints/secrets.py,sha256=l6IzLPMEJr_e7wrTNxLQIn-x8LGBlxeV7diYSAD55t4,6057
 mlrun/api/api/endpoints/submit.py,sha256=mBizUlqKn0lc8YkrB0qVKAhLxF5Mg2Nz_0R_CGsehYA,5265
 mlrun/api/api/endpoints/tags.py,sha256=bnsWCKoOUnVHL42qqUzbXvs8gdmfT-8kcGwiT1svJcY,4843
 mlrun/api/api/endpoints/internal/__init__.py,sha256=Lq7QbwU5hFGCq6hzU28fA5t1soMesi7DVo99T21blU8,1203
 mlrun/api/api/endpoints/internal/config.py,sha256=kXnraXbXv029QZMMEjwvhsUWof69wTvFBLcRyB32JFc,1043
 mlrun/api/api/endpoints/internal/memory_reports.py,sha256=k9cA6NhvAPfA-CYRubpjSrhsHJ7Ig_wTFMIMTEZxS4E,1709
-mlrun/api/crud/__init__.py,sha256=WMo1AvY_XqJJQWd_9hgw0B35Rvnx50eN0uB4HRAms3E,1184
+mlrun/api/crud/__init__.py,sha256=2ea5kCz3AGmRX2uRHCv2oRRIWX4LL0j7RPn8BVKjcTA,1225
 mlrun/api/crud/artifacts.py,sha256=p-CJZKokYwy2ej0K2vEp5EEy5xM-FD7ytSWMHBd7J9Y,5433
 mlrun/api/crud/client_spec.py,sha256=VapHAcFSKCmBq7AarJkpwoHns6fXLJ-VCEQcBuBczmU,7341
 mlrun/api/crud/clusterization_spec.py,sha256=wf9uiLb3DRwegDGlRu-dgfahoyp51bxtAuB8TEnklfc,1049
 mlrun/api/crud/feature_store.py,sha256=SAWhliY9UJAQbaJYKb7CmXTuVbovq3fDl-_5-RMxfxI,18449
 mlrun/api/crud/functions.py,sha256=pqCTL7rsHawfynV6DfqRrWKhnWxw1MNHJhLY_og6cJo,3550
 mlrun/api/crud/logs.py,sha256=r5JWMAtmxA9kIQ0RCi-DZG7njyh9GbmHL-2w_hu-r9M,9578
-mlrun/api/crud/marketplace.py,sha256=dDJG6puO_asotN8gRgkjwVXQwkLFR7MoTghAcb7TRY4,8180
+mlrun/api/crud/marketplace.py,sha256=zS0rQexzKNA2Lhjfao2H_-O4fpzLqSD827x46E8qh8o,11769
+mlrun/api/crud/notifications.py,sha256=aEIx2ByVQzHxdmjePiYXxzUpZA1yZ8YXhR-nvIbet3o,2751
 mlrun/api/crud/pipelines.py,sha256=aW0RDWAyzK0vnCzyuVLEHDsW-MY-Cy5RvvuqbUhh6ow,13982
 mlrun/api/crud/projects.py,sha256=uLLSMZD0Z8BLkm2naHdNyZK1XyF51IAGVqWN6ydI_9Y,13326
-mlrun/api/crud/runs.py,sha256=E_FP0tQcpBQbisVpDmGZ3Y-2Z0wzoQxkJ73V0ioNOZg,5931
+mlrun/api/crud/runs.py,sha256=Vi6RshVl9RWYef8xPdPcpnx-Vw8SzSXanqlERrtXUpQ,6005
 mlrun/api/crud/runtime_resources.py,sha256=XJRxzrh0NKKBqQq-wXAXFTxWkEMqAX_t3buJsVYOfT8,5539
-mlrun/api/crud/secrets.py,sha256=_aIjtNOBI3fNM_2Tz0_W6UMM3gbMfapDFsBaQU7P_WU,19885
+mlrun/api/crud/secrets.py,sha256=SvaOsSFfnk4OKGr-hXTv34XRoR7SOpdLbCxElgW9dVo,19921
 mlrun/api/crud/tags.py,sha256=TKi6u--McIdmcFEXNrbwgsX5wAaENil7FVwi8mnKqok,3265
 mlrun/api/crud/model_monitoring/__init__.py,sha256=CAW_Xhm94IVid0yos0tLQUd_UdCRYz-_2s_rAloZEZw,722
 mlrun/api/crud/model_monitoring/grafana.py,sha256=uyZOa7KsqCkDWdfcWnV8xg2vlrzmPOQX_rbQq2X9bZ0,14943
 mlrun/api/crud/model_monitoring/model_endpoints.py,sha256=VOpm83yvmgycy-pKzin3CcixgDVOFpitqJHE80RLICQ,40998
 mlrun/api/db/__init__.py,sha256=B-yvMk7vTs3QqtlPkM4pnZk_B4QKTGnfNhYr2n4Z30M,571
-mlrun/api/db/base.py,sha256=Kxj491ODRvO7X6sq5gl7oP1wPMPU38mbQPsgNYudTAQ,13684
+mlrun/api/db/base.py,sha256=Cxseet80T_PPFxKA29vNGsMP7x1L3Y3FPU1LP38vTCw,14365
 mlrun/api/db/init_db.py,sha256=5WSrojwOh79O3guN_7IEi9wjqzKj3H74DU2xbGtrElk,870
-mlrun/api/db/session.py,sha256=g2-5rlAE9PENCro6KBMrsvk5IZPrfHdKgEjjcwtDMro,1226
-mlrun/api/db/filedb/__init__.py,sha256=B-yvMk7vTs3QqtlPkM4pnZk_B4QKTGnfNhYr2n4Z30M,571
-mlrun/api/db/filedb/db.py,sha256=iTehkcdD488diqx4oTng8AJcL2fsYKFJ61mdlMlhywg,14555
+mlrun/api/db/session.py,sha256=_5DVL4YyGGFG9sbtHx_Bq2C1aHrZC5V8MS7TJfNeWIk,993
 mlrun/api/db/sqldb/__init__.py,sha256=B-yvMk7vTs3QqtlPkM4pnZk_B4QKTGnfNhYr2n4Z30M,571
-mlrun/api/db/sqldb/db.py,sha256=_i3NmUJcHm3p1NYqGzOavfrak8Vot69kI8A2nkR-IR4,136433
+mlrun/api/db/sqldb/db.py,sha256=C4NUyVn5e1VR_N4sgfe8WPSD16P62zAsUY7t9jB9Lpg,142645
 mlrun/api/db/sqldb/helpers.py,sha256=j8VK-l_qZ5vLUjGkFK3D3fBgDgPmi-U8hU1MkMIAhC0,2340
 mlrun/api/db/sqldb/session.py,sha256=97QcZc7EOhypk3ZMl0F5k1ogsgK834S3SxCj3UNry-s,2542
 mlrun/api/db/sqldb/models/__init__.py,sha256=0cHZKMpzqkC6u3WGPEYE8zPcahY6KxBrK2pwkzTCCME,1063
-mlrun/api/db/sqldb/models/models_mysql.py,sha256=WOyZDnQRvvXPrPWqJoJ5x-HULSXPssVy3GPru6JAgIM,18687
-mlrun/api/db/sqldb/models/models_sqlite.py,sha256=8tHiSP5ruRjenfZzoDvjnp7kLD7wfEi3XhZx1iXPHd8,16908
+mlrun/api/db/sqldb/models/models_mysql.py,sha256=ZRerU-oWljKFkzXZ7nTb22y-qWpX_RXxvDH_gFhcbK4,20624
+mlrun/api/db/sqldb/models/models_sqlite.py,sha256=uMUkomR_YOa7d14g2XZcaIGtq1OlQ_fqkbOG9MbcVfE,18286
 mlrun/api/migrations_mysql/env.py,sha256=U5Fu1WLV5vggRYy4sa7d1ItJr1H3-T71BnkOw4ZjWIs,2906
 mlrun/api/migrations_mysql/versions/32bae1b0e29c_increase_timestamp_fields_precision.py,sha256=MF0DwcRcbyRXdWNeWieEWIu5zMpxZ5IQPmF__werbkU,4614
 mlrun/api/migrations_mysql/versions/4903aef6a91d_tag_foreign_key_and_cascades.py,sha256=BthqApYJLuzuHZEJfrOaERD8M-2FRGsZ3e5tRFvMk78,1936
 mlrun/api/migrations_mysql/versions/5f1351c88a19_adding_background_tasks_table.py,sha256=AuFHglUWD_ibU301xio--zcodAJ9yeGqbc8XFQ3zGGw,1909
 mlrun/api/migrations_mysql/versions/88e656800d6a_add_requested_logs_column_and_index_to_.py,sha256=jlQ40Yqcasyqu4qaetGxoY-DCn-GfWpU-K_Tb9zJVxo,1415
 mlrun/api/migrations_mysql/versions/9d16de5f03a7_adding_data_versions_table.py,sha256=1U5dpO6k_SLNZ0MAd5AukDddcxp8eCUTEx-2o3b_U9k,1504
 mlrun/api/migrations_mysql/versions/b86f5b53f3d7_adding_name_and_updated_to_runs_table.py,sha256=lppZKpOBbGoyzP855Q8Y5hWfcqCzCjOlz-FefAqenUQ,1649
 mlrun/api/migrations_mysql/versions/c4af40b0bf61_init.py,sha256=CGh1ihmMJ4GNpDXNoiB9ksSe1P7PyrV3NqWTiq6GTIg,24057
+mlrun/api/migrations_mysql/versions/c905d15bd91d_notifications.py,sha256=IU4QdjJrnqJK-fzf5SL3mtpXduTxieoog_HH9aahq3M,2457
 mlrun/api/migrations_mysql/versions/ee041e8fdaa0_adding_next_run_time_column_to_schedule_.py,sha256=18_SGHfgvNE6TcjsP2_bmqAjL3YI70B0J5-NojmxRr4,1351
 mlrun/api/migrations_sqlite/env.py,sha256=U5Fu1WLV5vggRYy4sa7d1ItJr1H3-T71BnkOw4ZjWIs,2906
 mlrun/api/migrations_sqlite/versions/11f8dd2dc9fe_init.py,sha256=Kp1VTDMqS72UMODn1GboBo-IwUEZ8IWuflxrBTbATj0,11473
 mlrun/api/migrations_sqlite/versions/1c954f8cb32d_schedule_last_run_uri.py,sha256=w_l46X5Sl53fkku0t4lqmHtEkU_t9A8-lniMM9USknI,1348
 mlrun/api/migrations_sqlite/versions/2b6d23c715aa_adding_feature_sets.py,sha256=7PxARbyyFR1SlNHwTT5D41GpDGjd8b0zSSkYI4TtYmg,5180
 mlrun/api/migrations_sqlite/versions/6401142f2d7c_adding_next_run_time_column_to_schedule_.py,sha256=r0svJ5DsE633B2ss1yWwv50lPMjtSIMsKYOPvfCPBfo,1388
 mlrun/api/migrations_sqlite/versions/64d90a1a69bc_adding_background_tasks_table.py,sha256=pJqfbcEjG7I8yacspyFnbBZvVVpJ4mPLXc4VcJ8X1oQ,1767
 mlrun/api/migrations_sqlite/versions/803438ecd005_add_requested_logs_column_to_runs.py,sha256=3Q_PnbBjaD-04YfjH2MW4IUocOWVUfa-a1_Y-snzBHA,1360
 mlrun/api/migrations_sqlite/versions/863114f0c659_refactoring_feature_set.py,sha256=cNFtnxsL4tTnfZiEo3uhATcqmgU6aqh2jEf521G0jH8,1259
+mlrun/api/migrations_sqlite/versions/959ae00528ad_notifications.py,sha256=Lth-_bXTG-8l-vUi_YxwfWdMVC6aJAKVHQnQ609GmsQ,2147
 mlrun/api/migrations_sqlite/versions/accf9fc83d38_adding_data_versions_table.py,sha256=Q7KfNsbnnPWhXUnLMmbGFZIaItOS_Hvr2bY_td-K3vw,1482
 mlrun/api/migrations_sqlite/versions/b68e8e897a28_schedule_labels.py,sha256=1indyv5TlsDK4haAC9xxNznRjXgqjNIjgfFOakgBpNo,1892
 mlrun/api/migrations_sqlite/versions/bcd0c1f9720c_adding_project_labels.py,sha256=JyUhI_H02D0fkBDZr3Hv4-KAiHEOL62z4-YE25ik5Rs,1882
 mlrun/api/migrations_sqlite/versions/cf21882f938e_schedule_id.py,sha256=A5aBWsOuCzs5cZrPiWO9ha26-N3JvzwsaI6wgOarHjY,1420
 mlrun/api/migrations_sqlite/versions/d781f58f607f_tag_object_name_string.py,sha256=icsKlQUC9lJkpdu0RbDpl3L1MMk3Bwb8pzCXZKO9xcw,2034
 mlrun/api/migrations_sqlite/versions/deac06871ace_adding_marketplace_sources_table.py,sha256=po2-IqIvS4pSY8Bw02q6ZEucjEnkXdH5UDudGVC-5S8,1828
 mlrun/api/migrations_sqlite/versions/e1dd5983c06b_schedule_concurrency_limit.py,sha256=9oGlxz4o7BlZbykO3zzedHqzOEoPnvPPeWMLxyRCBnY,1380
 mlrun/api/migrations_sqlite/versions/e5594ed3ab53_adding_name_and_updated_to_runs_table.py,sha256=lQ0lPq6xZD59iupkbAo0wCV-otE0G9lmjEpqIBZEguA,1831
 mlrun/api/migrations_sqlite/versions/f4249b4ba6fa_adding_feature_vectors.py,sha256=AWkrtG6jWOMJHyLqR8jrmbp95Fk9qB6qhjjYLb1mezo,3936
 mlrun/api/migrations_sqlite/versions/f7b5a1a03629_adding_feature_labels.py,sha256=KrIm5pHwHlJr5e3DdtMcBiEjgbopOniWzDi9T1XTSHQ,2588
-mlrun/api/schemas/__init__.py,sha256=9qJuHKGc6nLZzUNuKZImwqMRXQSTwfrT_gB6l-SAhNQ,3962
+mlrun/api/schemas/__init__.py,sha256=XwgaWHdXLIASbqnw7YPEfW43AO6PmHxJbzXaBZY7VzA,4029
 mlrun/api/schemas/artifact.py,sha256=gpAdViV_3TQ-W2KPPNvdOArEfQZdd427YUW9bml9vE4,2070
 mlrun/api/schemas/auth.py,sha256=9MnT6Ckuy8_kAI7edsAqwN9-wp3noh5xZlL40utYXqA,5311
 mlrun/api/schemas/background_task.py,sha256=RayGDZ3_KYCYVx-n7CgMNDQJQp78ajrb5unQW6wFzhU,1563
 mlrun/api/schemas/client_spec.py,sha256=bQhGYtkcJg27yo82y3FNiiNZbYuwWce8SQxcXtVKJpg,2751
 mlrun/api/schemas/clusterization_spec.py,sha256=QmQ95NFgRuKCZZYCQFCpQGa-rutxY7wAjJI7tVS8Oc4,898
 mlrun/api/schemas/constants.py,sha256=JmIZGD2R1qjJIRk5fHNEFTVLw-6eh4cJ0FCP8i1r6xI,6278
 mlrun/api/schemas/feature_store.py,sha256=kX3Wd107ZfyGrDOcNmLEcgdVrFgtHTswzVhmH6VVWX4,3671
 mlrun/api/schemas/frontend_spec.py,sha256=-kYKekdyrUAx-dOhhyvhh54y-KWV3bGfFAxqJQ3jmiw,2571
 mlrun/api/schemas/function.py,sha256=5Iy0aZYwXw9_vLSPBUwhuD_YMuQn95_11oX7DSTFIeo,3991
 mlrun/api/schemas/http.py,sha256=q9l7LBK1pIWlax2gHK9rPQfeugHjBMUrLDWAxdGxUII,715
 mlrun/api/schemas/k8s.py,sha256=R6Ufggp8MqA0lQ68AMsh_qiRcbsovaWKJg1a40XzcZg,1405
-mlrun/api/schemas/marketplace.py,sha256=BD0Gb_VFxcvJS7_6gQqxb524TL2ZPn9xwbUhwvleoTo,4258
+mlrun/api/schemas/marketplace.py,sha256=fpvHrAkmtpJEu4-6UNtnvSQz_Rrb87en5VBMvLZFPok,4592
 mlrun/api/schemas/memory_reports.py,sha256=SlNJ-uya5RywEysm_IZMwF1t4j-zYsjOj8oPYwLRO08,920
 mlrun/api/schemas/model_endpoints.py,sha256=j1U0bqYSv_ytjsQ7ZM0qEk4ebUdk-1Yks3h9dNEJijo,12343
+mlrun/api/schemas/notification.py,sha256=sCVgEsQUWANr4zxXtvTjS2lve8eaTKv3me7dy5zLoDI,894
 mlrun/api/schemas/object.py,sha256=bLMt30Kgch6_4Q_KML68NerU_HuTqW8K-4LUc8KfyVc,1965
 mlrun/api/schemas/pipeline.py,sha256=qT-4NW2vOXmLGxwbGhSPbmDRoeoOhCA2I-j52pop4dU,1194
 mlrun/api/schemas/project.py,sha256=EhGRhSa_Pzzy8cxl_vtu93v2bydX9VHo12rM5rCSeOY,3935
 mlrun/api/schemas/runtime_resource.py,sha256=r4Inv2-ujfgpuYsp0e82A8MM-jdt0pJjD-oKWDNwlz0,1646
 mlrun/api/schemas/schedule.py,sha256=RlHpjOaoiKn15DZkwCLZIBW9g8ArBKUhoTaCBlpx768,4192
 mlrun/api/schemas/secret.py,sha256=xdzAG8JCJVGy4f-qzcLH23uq4eNIuGePLdZPPFhunXs,1494
 mlrun/api/schemas/tag.py,sha256=x7l-nxJyjxqupu6-3CQLh_r6mD5-EST3KM-WyuTH-DM,919
@@ -160,58 +162,58 @@
 mlrun/api/utils/projects/member.py,sha256=bOQq5wNRGYR8uI0BwQJjdvtb3CbepEuiQZ00dDWgD8s,7040
 mlrun/api/utils/projects/remotes/__init__.py,sha256=B-yvMk7vTs3QqtlPkM4pnZk_B4QKTGnfNhYr2n4Z30M,571
 mlrun/api/utils/projects/remotes/follower.py,sha256=UrtXlvliQ6Uyi7qn_y1HZTm1WuXNl_1mJhYqHrFT4Vc,2614
 mlrun/api/utils/projects/remotes/leader.py,sha256=D0V41b5rcr-w4AgEOCp0THG7ve2v4BePQG41ms1HJKs,2064
 mlrun/api/utils/projects/remotes/nop_follower.py,sha256=lMnq7uZcNbNc4A3ghhTdYzJjSo6V3sYnyqnFTbzpbP0,4601
 mlrun/api/utils/projects/remotes/nop_leader.py,sha256=0sLDBZcGtacQwygS1p7GD--EGFLFWohOGFyXmIiy5x0,3801
 mlrun/api/utils/singletons/__init__.py,sha256=B-yvMk7vTs3QqtlPkM4pnZk_B4QKTGnfNhYr2n4Z30M,571
-mlrun/api/utils/singletons/db.py,sha256=4jzYXBZYHGjEARXCbHFwIcvlqW-05efUZVvrsnXiLf8,1439
+mlrun/api/utils/singletons/db.py,sha256=y-v3JdLIHb_GtPvdzKH137jsflTav5TY9CafsSXfkN8,1202
 mlrun/api/utils/singletons/k8s.py,sha256=fxQuohr-iIGKQEAR6V5iZ3dka0438Tfm0xq_j2D5OGo,694
 mlrun/api/utils/singletons/logs_dir.py,sha256=zCALZ1N8IylkfvATfsbWfBtEPvWKl2AEQ2-QF-J0VWs,840
 mlrun/api/utils/singletons/project_member.py,sha256=1xlvJjbY-HvQuUV5rsQg9rMt-Y9MKU77Az5f98v-D28,1279
 mlrun/api/utils/singletons/scheduler.py,sha256=LmauJTsB69P_gkx4xTMzQrW1kaaN050txZzrrl08i_k,1063
 mlrun/artifacts/__init__.py,sha256=b86JkwaOMjN9gPzeL-RlkAtiITaVmGS9viNlvGG1lrs,1091
 mlrun/artifacts/base.py,sha256=l-dRIaK89NOIiBqiSbo1vbPks8CeRv83wSKndybJt0U,30849
 mlrun/artifacts/dataset.py,sha256=30N8bYHiX6vW-w6yKAcTGHqxDQ8yGDvxYSVrR2g2VNM,20366
 mlrun/artifacts/manager.py,sha256=O3V_T7Tw6Q425N6SwbWs5M4pAngRa6wc2DQdrdpZfDM,12110
 mlrun/artifacts/model.py,sha256=SmzieOo7d78CPhVyyHMmI6WltkCSVn-d72jAxhHKd7E,23673
 mlrun/artifacts/plots.py,sha256=0Jq5OgDB1srtUlcISF696E_q3S_D-mqeMe6Wyn1S6ZQ,15383
 mlrun/data_types/__init__.py,sha256=hBd2-QsTqesw3HUDoIUaUtCR1mWEcRc4V7Z1V8lNP0s,1087
 mlrun/data_types/data_types.py,sha256=xjsnUw144Lbkg4JqYLYym8qQpucYQUjphxay_BIc7VA,4647
 mlrun/data_types/infer.py,sha256=ErGpXigp8bG6hkPJfbJt8cJZxsZvj-bK0dLSiTlUYzk,5813
-mlrun/data_types/spark.py,sha256=f7ila08Hnckxs-RjhzubRbg2_ZzyNpvCV_Vrgak7yUM,9118
+mlrun/data_types/spark.py,sha256=BVM_FeWh1mKYLu6QILYfZRCOGefQzRJ2t0LeHo-pqwA,9426
 mlrun/datastore/__init__.py,sha256=lEcQKc3_Q2dfK6CTg2hwlTH3IoKQg-xE0WeMOanmxfo,3300
 mlrun/datastore/azure_blob.py,sha256=XFBpXZfwMKvv0rrYVP2J6RDqziNPHW6KqCbsY-VLzto,6946
-mlrun/datastore/base.py,sha256=5njgvevYPBEAAKJ0AFAh-fzebietmifi4sNuFYWAxa0,17304
+mlrun/datastore/base.py,sha256=5jODaKrJHSeCFQFHVBeREj3k9LaDLgyh5kW20-0ePGw,17575
 mlrun/datastore/datastore.py,sha256=l6CfmIYn7rdPQyRZ8kZu45cfyDZcDXDH5CwLKvsFlI8,7995
 mlrun/datastore/filestore.py,sha256=v9-BTJMgamGN_neoXNkIbNNr56UpgOewMEX70P8MTbc,3791
 mlrun/datastore/google_cloud_storage.py,sha256=9dtZt7Opytrra45urj6ObYa1fxf7UIOHXSoog4G9l7I,5114
 mlrun/datastore/inmem.py,sha256=o6Svv12k5PxJNT24nMgV9FBYEPCzD3OQzuuvU6OeCYY,2627
 mlrun/datastore/redis.py,sha256=pywWgjGJ51pmvKuwX1MI3ILWqh6WtgDs9igOQAhmIhc,4873
 mlrun/datastore/s3.py,sha256=fn1Yg5Rs33ugHlwTKvBfu_jMKqkSZWgHNw0ocQ5nO7A,7035
-mlrun/datastore/sources.py,sha256=89ckC7p5wmLdKCtZjSdWog6On97k8-JfhsUPKnRsucE,34025
+mlrun/datastore/sources.py,sha256=HqcD7cmI5tL5vsIA31g6lQ9qKv-P_QFN9V5NiNUowxc,34023
 mlrun/datastore/spark_udf.py,sha256=LFICcRzj7Yx03ttgQZImodEXjOZVvkcQd0OKwHuMLCg,1402
 mlrun/datastore/store_resources.py,sha256=u60_0LGXbagkG2UIm2o2pntWioF4kPu7FLMd0tlrR-8,6889
 mlrun/datastore/targets.py,sha256=3pA6jyHPzEHwfoMEDK3SObDAnLakpZU2AcJ30URO0KQ,62054
 mlrun/datastore/utils.py,sha256=WNKBhgG2w9xAviyieGCB6hTnESEYzCwzgjcjz6uaWC4,1660
 mlrun/datastore/v3io.py,sha256=ArEYq78irv5bwlRwcLeVfFJvcwtXEamGsZ2I0sVt7Qg,8097
 mlrun/datastore/wasbfs/__init__.py,sha256=4CK7vZeJmC4Ak9cJjG07cGnk7jlkBlpCxw-ANfbBmzk,1343
 mlrun/datastore/wasbfs/fs.py,sha256=DEZgwrmQSPeR93MNlC9OCwuU9wvTSmIM534p5ccQzAE,6152
-mlrun/db/__init__.py,sha256=4_UTWWoVZU5B2D70NLTjYlMM7GVmLofnPRo5nGzT7XY,2810
-mlrun/db/base.py,sha256=FR1LnEP0Y4UlarcxM6wki4HeYnL0raccPkt_2tkEngU,14796
-mlrun/db/filedb.py,sha256=c-mpjJL_hcx2paRPcb4XdoXGyX6Dlv17tMNdsjULVJY,28411
-mlrun/db/httpdb.py,sha256=7pa5nwfwsptKakNBOFCWI7TQ-J_VoU3wv97KHzkC7b0,128262
-mlrun/db/sqldb.py,sha256=CdiF5D2t3oQLtphKNUzBY4DJSY-ThGSxS5ks108uxIQ,24292
+mlrun/db/__init__.py,sha256=HA6ahbEFrRd5I81eJQ1xrHmUch6JOy3JeEKMf7KrOTM,2816
+mlrun/db/base.py,sha256=eOWjqPEVq6UnffIw4s9XM_ESakcaVxLJHZzMUI2bOGU,14771
+mlrun/db/httpdb.py,sha256=OOgn0D6lPM1vHuzOM2oVpVTIGwHXD4HIoLCYNOHH1G4,129128
+mlrun/db/nopdb.py,sha256=J_7mlHfF9rSwGK1WL12_f4ciUcrRD3ZZ48AYisaNBmQ,12257
+mlrun/db/sqldb.py,sha256=sk2sJZpAAootYnTCDsUPo5JvPgqVSC6PanSODFelnh8,25370
 mlrun/feature_store/__init__.py,sha256=guoak0hQTMoE4YsWwyoyso0CYE9NSPoP0eUal4crfVA,1501
-mlrun/feature_store/api.py,sha256=2HGosxeChN_OZD04t3OX3x6pop1wPgJKcRze2mRgMRg,43335
-mlrun/feature_store/common.py,sha256=bFpPyFgGFuh-SwTl5AMUGD1mJr3GhVsFcDu-yIP5HAc,12807
+mlrun/feature_store/api.py,sha256=N2Vr1Z_hoQudXbYZ4_WmjjwdYbllfrAP5n1vodqs3_U,43761
+mlrun/feature_store/common.py,sha256=vgBs-jQKffjwOLNnOzrNnaU3yhzQTu-eh3X4yCy2ExQ,12807
 mlrun/feature_store/feature_set.py,sha256=SE6qCVpNCn2aImrVXRWLaE3SmD17iF49SOHj9uzltt4,47059
 mlrun/feature_store/feature_vector.py,sha256=hLOyejUK-itqZRzbqOQEQcijJHsJlypuHD7ZWQ6B5aE,21937
 mlrun/feature_store/ingestion.py,sha256=7qcBfNkDZsD4IXRdRN4OCSPIlpQDVo3WaO8pnAAYY6Q,11813
-mlrun/feature_store/steps.py,sha256=sqwY_IsUUA0ATNQryExjjzRwqgRKN4Ez66OktXVSoFY,23868
+mlrun/feature_store/steps.py,sha256=khDqxTusXDtBNfS7ESZh-QEsWu3_8FTR5ep_AY_Nvdo,28635
 mlrun/feature_store/retrieval/__init__.py,sha256=2b2WoPmH4TqcSSJ2OQYSjsDIcUe1KA5DnG7-wkrIayM,1232
 mlrun/feature_store/retrieval/base.py,sha256=38n5qY60V-wvn5vAVSd4qQlfkMMTMchX0c2TdZ8XqqE,25911
 mlrun/feature_store/retrieval/dask_merger.py,sha256=-xRgRPWUblu3KtVhEoL0YXEAcgkZrSUykDe31xnEzRI,4261
 mlrun/feature_store/retrieval/job.py,sha256=NwVrTKlR_w4KpMgQwTkreddYUbWI-6pYuksXowZQY9c,7106
 mlrun/feature_store/retrieval/local_merger.py,sha256=h6FE11EZxxqVe2EhVnQtwl5cxOBsOCXQCbTLOJk3op8,4765
 mlrun/feature_store/retrieval/online.py,sha256=tnpHqcbaA16lKTuvlU6WoXwnb_SLmbWBLzyJSvhss28,3352
 mlrun/feature_store/retrieval/spark_merger.py,sha256=R-xHI2ubdx8y_bvgnxYfLtOTOWCy5q6Bjd2AZD1fh1w,9661
@@ -319,75 +321,74 @@
 mlrun/model_monitoring/stores/models/base.py,sha256=Az7Q2JZKCTqZJ2hqYaOLr2owVMagClFp2KwuriKMx24,655
 mlrun/model_monitoring/stores/models/mysql.py,sha256=o8vaYdE1Cu2Rsd7AM6-xMHIr-qFEQ_LOvqoZlgFbnFM,3744
 mlrun/model_monitoring/stores/models/sqlite.py,sha256=kkQvEVzJcSZcf2PkA9-3tLpkJU5KZ-J-aht4uA2qU2c,3661
 mlrun/platforms/__init__.py,sha256=NNh9MSxgjdi7QftO3DHp4axQnBeO5IjxD8oR13_jp3A,2400
 mlrun/platforms/iguazio.py,sha256=gPOXoIRGcUCNmyMOddeHQT9DXW3835kB9AduZm_S0E0,23113
 mlrun/platforms/other.py,sha256=DwqbdbMNlkC2nEl1yJ0jF9WZJzjVu2IVPTC3bQ_W9Y0,11852
 mlrun/projects/__init__.py,sha256=dsXSDyqBhLi8OOfpdjLJpYOwC2fy_Q_Ki95Bk6gVSwc,1153
-mlrun/projects/operations.py,sha256=RZAyhsi3VuqvJjA3gwknuSpWhM1BfOFsZ-lGX9fIXCQ,17302
-mlrun/projects/pipelines.py,sha256=6iYVViKMUaEfqGIrVgQdl4UjtbDHe0nzlNXkLKte8fo,37882
-mlrun/projects/project.py,sha256=I0ll0JGWf13OfEeA2XgHgSBigLHHpbCCQtBBlegTsRM,103146
-mlrun/runtimes/__init__.py,sha256=1rNfzU3G76BxDkqvTVVrxlQkhLDSmlzv838_56OID7E,8973
-mlrun/runtimes/base.py,sha256=M5bJyOLqhEfSlkOD49SCpd_wH1bd4dMZle_03otYiG4,107571
+mlrun/projects/operations.py,sha256=rxxpSemZIp4_V6IC2gm2MnUH84aB4Q_7n_Y_BcbjK_c,17485
+mlrun/projects/pipelines.py,sha256=845_9berjVxxGB2OHkuGO2m5xRI-69_cp7Y2aqb5t9U,37899
+mlrun/projects/project.py,sha256=BP0hZ0DoflSkUNwJpp2eRVZvZwYen0DZkgSyw7AvCF0,104532
+mlrun/runtimes/__init__.py,sha256=NpPeD7XxDNxmeOqLSEmb7tUN59cYZlvw-DnJxla_peE,8773
+mlrun/runtimes/base.py,sha256=qYMiFbf3mAifyCnNzrlRAWhCNuds8Eh2SMEly0vJHf8,109502
 mlrun/runtimes/constants.py,sha256=Os_6YpWE8WMhigm1h3RKvn9Uo4LXNaEbA2xNSEDDEao,6689
 mlrun/runtimes/daskjob.py,sha256=Hol5_kzTfJBP4WN6orPlGSlSRDPec1HcBD8id_jSdPA,30403
 mlrun/runtimes/funcdoc.py,sha256=U5Hrkeo7i7CUnZFQ5g7-CyWMvXiQXPGrfsNdgsDAraQ,9190
-mlrun/runtimes/function.py,sha256=vKTRqXtHAm__vVvaUJVozzFWqCdLFzulYr0Yy8_ZiKM,69047
+mlrun/runtimes/function.py,sha256=Px4WakU2rYBDrgl8_GtoeABZIoCjn7HIKNYiv-YEDf4,70153
 mlrun/runtimes/function_reference.py,sha256=ikxeXeFPAn7PpfYR1DPBRFc9MSXXFM34uH5z6iRTz9M,4911
 mlrun/runtimes/generators.py,sha256=WvXzsfZZWqxLV1ncZ-lzFHZH2ITK6ICROgDv2vfQUs4,6530
-mlrun/runtimes/kubejob.py,sha256=nNxXZWKgLLgDdOSPaetZUngnSIp-yK9YUmBtCMUUQPU,17034
+mlrun/runtimes/kubejob.py,sha256=1ct6ox1cyWYSDk73VQctAEssArOPWpgr5-7Wnvm2R5o,16895
 mlrun/runtimes/local.py,sha256=gsLkfQSbvt1DjDuO6_9tjZC4AxOGBAypR3qJQomPqIY,18005
 mlrun/runtimes/nuclio.py,sha256=ih2iwrJieeEom3iW0yU99QG4_u_Bdv7VWgs1CK4Q1P8,2885
 mlrun/runtimes/pod.py,sha256=sWtw5wkme43VrQVEYDiU67uSC4zBbSyzqXZFYwWYewM,60648
 mlrun/runtimes/remotesparkjob.py,sha256=Lp2EN32GQ1rY_34MEepdUzRTg-AP-OKyUM7xcy0Npb8,7695
-mlrun/runtimes/serving.py,sha256=ylR-qQJe-EvMrHc3C9g7oYRi3WVDSnTAvFXezus3dtE,29852
+mlrun/runtimes/serving.py,sha256=bgqd97gJmfeLqtKKyPphWg6XeptIJACEZRnPpRx2Bt4,29852
 mlrun/runtimes/utils.py,sha256=r1FGNRETsZykdsy_DNpbyvqxsVcTetYRdHg-aelFt1k,21249
 mlrun/runtimes/mpijob/__init__.py,sha256=E0oiOsSYsRBBR0HV6e_EGaL_j2_dYEJwAcICnF8mOYU,790
 mlrun/runtimes/mpijob/abstract.py,sha256=_6CCDl4FXNpDzg1qTiEQGaqXyblx4gXYquAdKIG0fk0,14782
 mlrun/runtimes/mpijob/v1.py,sha256=o-ZDw3O0HOzTMZ3lI3gMjGG0NYY0Ux3RqL0Kz9K3eV4,13845
 mlrun/runtimes/mpijob/v1alpha1.py,sha256=4rMpJk1C_gL6QtOmEFcgcmaCkHcor9mdKvIL46fEKFw,8460
 mlrun/runtimes/package/__init__.py,sha256=EHFvxDWnRkXqjmdv9Mj3O-nCYAFLbRsNgX5zR0ElwAk,673
 mlrun/runtimes/package/context_handler.py,sha256=5br30fRHHhWQJgSWF2zqf0M8XOxVr27ZkOFWVDgf4f0,27044
-mlrun/runtimes/sparkjob/__init__.py,sha256=cDzK8jEJvNsSSujDmEt03h1Mnlj7MUvdCEUXDNAb1wc,788
-mlrun/runtimes/sparkjob/abstract.py,sha256=o5ykIx4GkwLU2QoQNQS9oNm5qebB17sOVblbh0ZDjG8,35976
-mlrun/runtimes/sparkjob/spark2job.py,sha256=StWv5hk99pHslkIpOzz5T-szCYN2kkC20ixEdlD3yIA,2033
+mlrun/runtimes/sparkjob/__init__.py,sha256=7damn-nBbM0unppemEuVwZxCAGwXq7EzXECMJ9AaRPY,751
+mlrun/runtimes/sparkjob/abstract.py,sha256=NyHcddXo97s2S3hjHmDUoEDaGd8AjmKltd5PJTVd3BA,35869
 mlrun/runtimes/sparkjob/spark3job.py,sha256=JzwinNIiPXBapSC-gAsbhf81oouxhx41U5oQwoNeYhM,28722
 mlrun/serving/__init__.py,sha256=FOIyvEwEOH6QuJovcDrrP5VSdLeKoqummSlfhNMvFXg,1078
 mlrun/serving/merger.py,sha256=oRX6gJ3LUVeCJcTpJ1nwh4d1tk5FrSZshkXcH-y-dd4,6116
 mlrun/serving/remote.py,sha256=HJS9bz5_mUuaKGsNbqRKpo-eVHKbc1fIEOEsECPmnko,18038
 mlrun/serving/routers.py,sha256=avhQ5cgogYA_TP_6kgzC_U2VQW24-yWWUXJGP449-Qg,55209
 mlrun/serving/server.py,sha256=ePfYiefH3HkNag5qHDzDyoowaNNMbjJ9YKpPS9wX9Xw,19005
 mlrun/serving/serving_wrapper.py,sha256=ivoSlFNuC92plPHRfMzHr-hdN-jGqxneGiufJdgoxVc,836
-mlrun/serving/states.py,sha256=b5pNgAQWW5o60acjgp5fLI24FaFVUBfdYwO1HOCbJTw,53922
+mlrun/serving/states.py,sha256=7ykG0Q66OQvRF32nQDQGwkmVYEyHczCvNrQxneVdUdM,53940
 mlrun/serving/utils.py,sha256=1fLfn07R4-RlUcdUgYYwUTFF47NozQmV9BnZVbu4-lU,3468
 mlrun/serving/v1_serving.py,sha256=UF6Ydgyo-DuHZ4DkrEdNMQl5oopVaZqm4EfBMBSvhDY,11814
 mlrun/serving/v2_serving.py,sha256=uIKQnTITJozqk6WrmJhO0hKfjCl8FLYc_IpCEYt5elA,21441
 mlrun/utils/__init__.py,sha256=jT8jJCOKKOA8PnL4KC5eVd7yKmYJuN9_qrzGmvHcGns,855
 mlrun/utils/async_http.py,sha256=AvI4a9D0frI6XxHvqnQ4AzEXopezo90zZHvsOAJJt6g,10397
 mlrun/utils/azure_vault.py,sha256=atz9fIu1vfgWAND1g6flRQDhrX-xBxZ_6MOWm34Onh0,3456
 mlrun/utils/clones.py,sha256=lKgQeibQ3xQ9LH5bZTZCoYCXoOx_2mYNGD5A-OOxwAQ,6245
 mlrun/utils/db.py,sha256=SqDrvIpGX_qHs0MNx_PWQNRcUhHaKLngoHFKLW3m5j0,1662
-mlrun/utils/helpers.py,sha256=V7mWXFogvtNGPIrx_D7AdT7wNixCpU1XVniAHHQXZkA,41426
+mlrun/utils/helpers.py,sha256=r128kqmGIHpDaPnSlnryLUmlqN81x0sPyjFvJs_SJ9o,41425
 mlrun/utils/http.py,sha256=FVgdYV8Np3TKbqszEtXrlgwqNyjScTMLAjJhlsWLifo,7093
 mlrun/utils/logger.py,sha256=O4pH45kdz0cO-e4eKeRxbZUIRLGn2X0BJcjSY9cWB04,5637
 mlrun/utils/model_monitoring.py,sha256=wS6T9KgG-XCB21MNc6edNODEqFBBqzi5bUgSvPpKt-c,7875
 mlrun/utils/regex.py,sha256=3hSOVEU5128xio_3BLBEmvvRGLipmGP2Sh7XgVAYs8w,3954
 mlrun/utils/singleton.py,sha256=kV9HhbzdmXo8gGKBPdbHWspRDutlkKX1ZEn96xs_LRs,883
 mlrun/utils/v3io_clients.py,sha256=ekxhjfcUnjV8cejQYTQUHnhYOKHA4KekIdSaywydTdM,1319
 mlrun/utils/vault.py,sha256=1zr_3gkXoerYID_4Z5vYkBO9FeCKd43Qm-XlmGBk_Ok,9957
 mlrun/utils/notifications/__init__.py,sha256=CgWLxslSqhTH-tExi_UR4AT-ipjkGUF4gwf9mKcNua8,990
-mlrun/utils/notifications/notification_pusher.py,sha256=C5PZYwHPHmwnbES1zTVGKz4_wbX7cR3pDl1PDqjM4hA,7093
-mlrun/utils/notifications/notification/__init__.py,sha256=s7owPm6jGxuN_JBU0nFac6iD6BuLhEbnhq-NMF1TLf8,1833
-mlrun/utils/notifications/notification/base.py,sha256=dkUmwB1-o1qpFs9MCIOkYAZYsODelkU2xm1iRM3wJlU,2067
-mlrun/utils/notifications/notification/console.py,sha256=QCdulv9i8nCCYAA8ftmf22vvZwBp3SRBCKiB0v1WBQY,1901
-mlrun/utils/notifications/notification/git.py,sha256=qI5Kd4U0PX8vfIVT_yjBIrToiJYzCS-XvY96Xck2Nkc,4510
-mlrun/utils/notifications/notification/ipython.py,sha256=jsM_tTV3ZzXv5NoQN2anfZJDTYsk95NDYVQnWFc9Zow,1951
-mlrun/utils/notifications/notification/slack.py,sha256=wt6RlqJu9QC99Ki-3HNYmizYTyAnIVimFQ7bf-fYX2E,3650
+mlrun/utils/notifications/notification_pusher.py,sha256=WdkBRLg_upmcInkwYcjRJkuRexKMaZ_a_47d0yMfhSs,12297
+mlrun/utils/notifications/notification/__init__.py,sha256=iNF31hiEkenkp1VmJ4keyjixS17-gZ0oGuWNO7tlnm4,1803
+mlrun/utils/notifications/notification/base.py,sha256=0q419xnXHH6raEcpR8j1uvBUn1jHcJmIAfjFNt2XkKQ,2162
+mlrun/utils/notifications/notification/console.py,sha256=nzucPPOj3jFceJKZSV4UJLT0mu8V1yVqGUl3MbnlwZc,1962
+mlrun/utils/notifications/notification/git.py,sha256=iXjjBbJMWA741Z6aRNpGGg8FjZC78jzS2uR9UYM0yHY,4733
+mlrun/utils/notifications/notification/ipython.py,sha256=zP1jAE39Dn6rrbQIxi4R4iDhMLFBQ_GJrEtMMj8G80E,2012
+mlrun/utils/notifications/notification/slack.py,sha256=QnXQvAMOe3GUUKnlrNy_fEtUEjdG8n80FDl4hYdqXyc,3736
 mlrun/utils/version/__init__.py,sha256=hwfJgGWYGWFpepVGI1GbuCPqqEFGRbgguJg5sC0v4TU,614
-mlrun/utils/version/version.json,sha256=2VsUbSoedRV662tuEFNWLVbo077kHBXuswXxTOjsw4o,88
+mlrun/utils/version/version.json,sha256=RGaJg-_3jpIykXALBcvENS8YU9lSUXgA1D66iI4vWGQ,88
 mlrun/utils/version/version.py,sha256=O4Q4kwtKlI73oK7oBPuz4SVkUI8BC11E9DJIKHT91kU,1970
-mlrun-1.3.1rc4.dist-info/LICENSE,sha256=xx0jnfkXJvxRnG63LTGOxlggYnIysveWIZ6H3PNdCrQ,11357
-mlrun-1.3.1rc4.dist-info/METADATA,sha256=aXcFixKd8QEOwhoc_e8fWl_9Bd6Aq-Nne1SPFnTmkqg,16975
-mlrun-1.3.1rc4.dist-info/WHEEL,sha256=pkctZYzUS4AYVn6dJ-7367OJZivF2e8RA9b_ZBjif18,92
-mlrun-1.3.1rc4.dist-info/entry_points.txt,sha256=ZbXmb36B9JmK7EaleP8MIAbZSOQXQV0iwKR6si0HUWk,47
-mlrun-1.3.1rc4.dist-info/top_level.txt,sha256=NObLzw3maSF9wVrgSeYBv-fgnHkAJ1kEkh12DLdd5KM,6
-mlrun-1.3.1rc4.dist-info/RECORD,,
+mlrun-1.4.0rc1.dist-info/LICENSE,sha256=xx0jnfkXJvxRnG63LTGOxlggYnIysveWIZ6H3PNdCrQ,11357
+mlrun-1.4.0rc1.dist-info/METADATA,sha256=5UzilPcYjKxEs6MpuTO8ovsXbXWSwBpRCg-SfeoXEL4,17177
+mlrun-1.4.0rc1.dist-info/WHEEL,sha256=pkctZYzUS4AYVn6dJ-7367OJZivF2e8RA9b_ZBjif18,92
+mlrun-1.4.0rc1.dist-info/entry_points.txt,sha256=ZbXmb36B9JmK7EaleP8MIAbZSOQXQV0iwKR6si0HUWk,47
+mlrun-1.4.0rc1.dist-info/top_level.txt,sha256=NObLzw3maSF9wVrgSeYBv-fgnHkAJ1kEkh12DLdd5KM,6
+mlrun-1.4.0rc1.dist-info/RECORD,,
```

