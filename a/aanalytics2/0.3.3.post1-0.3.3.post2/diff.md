# Comparing `tmp/aanalytics2-0.3.3.post1.tar.gz` & `tmp/aanalytics2-0.3.3.post2.tar.gz`

## filetype from file(1)

```diff
@@ -1 +1 @@
-gzip compressed data, was "aanalytics2-0.3.3.post1.tar", last modified: Wed Nov 30 13:53:44 2022, max compression
+gzip compressed data, was "aanalytics2-0.3.3.post2.tar", last modified: Wed Apr 26 09:48:26 2023, max compression
```

## Comparing `aanalytics2-0.3.3.post1.tar` & `aanalytics2-0.3.3.post2.tar`

### file list

```diff
@@ -1,30 +1,30 @@
-drwxrwxrwx   0        0        0        0 2022-11-30 13:53:44.068118 aanalytics2-0.3.3.post1/
--rw-rw-rw-   0        0        0    10337 2021-10-20 19:45:40.000000 aanalytics2-0.3.3.post1/LICENSE
--rw-rw-rw-   0        0        0       16 2021-10-20 19:45:40.000000 aanalytics2-0.3.3.post1/MANIFEST.in
--rw-rw-rw-   0        0        0     4348 2022-11-30 13:53:44.069132 aanalytics2-0.3.3.post1/PKG-INFO
--rw-rw-rw-   0        0        0     3418 2022-03-17 11:22:37.000000 aanalytics2-0.3.3.post1/README.md
-drwxrwxrwx   0        0        0        0 2022-11-30 13:53:44.032078 aanalytics2-0.3.3.post1/aanalytics2/
--rw-rw-rw-   0        0        0      177 2021-12-01 07:28:32.000000 aanalytics2-0.3.3.post1/aanalytics2/__init__.py
--rw-rw-rw-   0        0        0       23 2022-11-30 13:47:48.000000 aanalytics2-0.3.3.post1/aanalytics2/__version__.py
--rw-rw-rw-   0        0        0     2872 2021-10-20 19:45:40.000000 aanalytics2-0.3.3.post1/aanalytics2/aanalytics14.py
--rw-rw-rw-   0        0        0   161462 2022-11-30 09:36:04.000000 aanalytics2-0.3.3.post1/aanalytics2/aanalytics2.py
--rw-rw-rw-   0        0        0      596 2021-10-20 19:45:40.000000 aanalytics2-0.3.3.post1/aanalytics2/config.py
--rw-rw-rw-   0        0        0     6916 2022-08-08 11:33:47.000000 aanalytics2-0.3.3.post1/aanalytics2/configs.py
--rw-rw-rw-   0        0        0    10880 2022-08-08 11:36:15.000000 aanalytics2-0.3.3.post1/aanalytics2/connector.py
--rw-rw-rw-   0        0        0    12776 2022-01-11 13:10:08.000000 aanalytics2-0.3.3.post1/aanalytics2/ingestion.py
--rw-rw-rw-   0        0        0    10668 2022-02-21 08:55:42.000000 aanalytics2-0.3.3.post1/aanalytics2/projects.py
--rw-rw-rw-   0        0        0    17790 2022-03-22 10:37:58.000000 aanalytics2-0.3.3.post1/aanalytics2/requestCreator.py
--rw-rw-rw-   0        0        0     2318 2021-10-20 19:45:40.000000 aanalytics2-0.3.3.post1/aanalytics2/token_provider.py
--rw-rw-rw-   0        0        0    10106 2022-11-30 10:33:46.000000 aanalytics2-0.3.3.post1/aanalytics2/workspace.py
-drwxrwxrwx   0        0        0        0 2022-11-30 13:53:44.052386 aanalytics2-0.3.3.post1/aanalytics2.egg-info/
--rw-rw-rw-   0        0        0     4348 2022-11-30 13:53:43.000000 aanalytics2-0.3.3.post1/aanalytics2.egg-info/PKG-INFO
--rw-rw-rw-   0        0        0      604 2022-11-30 13:53:43.000000 aanalytics2-0.3.3.post1/aanalytics2.egg-info/SOURCES.txt
--rw-rw-rw-   0        0        0        1 2022-11-30 13:53:43.000000 aanalytics2-0.3.3.post1/aanalytics2.egg-info/dependency_links.txt
--rw-rw-rw-   0        0        0       93 2022-11-30 13:53:43.000000 aanalytics2-0.3.3.post1/aanalytics2.egg-info/requires.txt
--rw-rw-rw-   0        0        0       17 2022-11-30 13:53:43.000000 aanalytics2-0.3.3.post1/aanalytics2.egg-info/top_level.txt
--rw-rw-rw-   0        0        0       86 2022-11-30 13:53:44.070465 aanalytics2-0.3.3.post1/setup.cfg
--rw-rw-rw-   0        0        0     1873 2021-10-20 19:45:40.000000 aanalytics2-0.3.3.post1/setup.py
-drwxrwxrwx   0        0        0        0 2022-11-30 13:53:44.064647 aanalytics2-0.3.3.post1/test/
--rw-rw-rw-   0        0        0        0 2021-10-20 19:45:40.000000 aanalytics2-0.3.3.post1/test/__init__.py
--rw-rw-rw-   0        0        0      907 2021-10-20 19:45:40.000000 aanalytics2-0.3.3.post1/test/test_configuration.py
--rw-rw-rw-   0        0        0     2538 2021-10-20 19:45:40.000000 aanalytics2-0.3.3.post1/test/test_core_analytics.py
+drwxrwxrwx   0        0        0        0 2023-04-26 09:48:26.002685 aanalytics2-0.3.3.post2/
+-rw-rw-rw-   0        0        0    10337 2021-10-20 19:45:40.000000 aanalytics2-0.3.3.post2/LICENSE
+-rw-rw-rw-   0        0        0       16 2021-10-20 19:45:40.000000 aanalytics2-0.3.3.post2/MANIFEST.in
+-rw-rw-rw-   0        0        0     4348 2023-04-26 09:48:26.004616 aanalytics2-0.3.3.post2/PKG-INFO
+-rw-rw-rw-   0        0        0     3418 2022-03-17 11:22:37.000000 aanalytics2-0.3.3.post2/README.md
+drwxrwxrwx   0        0        0        0 2023-04-26 09:48:25.965811 aanalytics2-0.3.3.post2/aanalytics2/
+-rw-rw-rw-   0        0        0      177 2021-12-01 07:28:32.000000 aanalytics2-0.3.3.post2/aanalytics2/__init__.py
+-rw-rw-rw-   0        0        0       23 2023-04-26 09:46:10.000000 aanalytics2-0.3.3.post2/aanalytics2/__version__.py
+-rw-rw-rw-   0        0        0     2872 2021-10-20 19:45:40.000000 aanalytics2-0.3.3.post2/aanalytics2/aanalytics14.py
+-rw-rw-rw-   0        0        0   161811 2023-04-26 09:46:30.000000 aanalytics2-0.3.3.post2/aanalytics2/aanalytics2.py
+-rw-rw-rw-   0        0        0      596 2021-10-20 19:45:40.000000 aanalytics2-0.3.3.post2/aanalytics2/config.py
+-rw-rw-rw-   0        0        0     6916 2022-08-08 11:33:47.000000 aanalytics2-0.3.3.post2/aanalytics2/configs.py
+-rw-rw-rw-   0        0        0    10880 2023-04-26 08:09:56.000000 aanalytics2-0.3.3.post2/aanalytics2/connector.py
+-rw-rw-rw-   0        0        0    12776 2022-01-11 13:10:08.000000 aanalytics2-0.3.3.post2/aanalytics2/ingestion.py
+-rw-rw-rw-   0        0        0    10668 2022-02-21 08:55:42.000000 aanalytics2-0.3.3.post2/aanalytics2/projects.py
+-rw-rw-rw-   0        0        0    17764 2023-04-26 09:46:13.000000 aanalytics2-0.3.3.post2/aanalytics2/requestCreator.py
+-rw-rw-rw-   0        0        0     2318 2021-10-20 19:45:40.000000 aanalytics2-0.3.3.post2/aanalytics2/token_provider.py
+-rw-rw-rw-   0        0        0    10180 2023-04-26 09:45:00.000000 aanalytics2-0.3.3.post2/aanalytics2/workspace.py
+drwxrwxrwx   0        0        0        0 2023-04-26 09:48:25.986727 aanalytics2-0.3.3.post2/aanalytics2.egg-info/
+-rw-rw-rw-   0        0        0     4348 2023-04-26 09:48:25.000000 aanalytics2-0.3.3.post2/aanalytics2.egg-info/PKG-INFO
+-rw-rw-rw-   0        0        0      604 2023-04-26 09:48:25.000000 aanalytics2-0.3.3.post2/aanalytics2.egg-info/SOURCES.txt
+-rw-rw-rw-   0        0        0        1 2023-04-26 09:48:25.000000 aanalytics2-0.3.3.post2/aanalytics2.egg-info/dependency_links.txt
+-rw-rw-rw-   0        0        0       93 2023-04-26 09:48:25.000000 aanalytics2-0.3.3.post2/aanalytics2.egg-info/requires.txt
+-rw-rw-rw-   0        0        0       17 2023-04-26 09:48:25.000000 aanalytics2-0.3.3.post2/aanalytics2.egg-info/top_level.txt
+-rw-rw-rw-   0        0        0       86 2023-04-26 09:48:26.006673 aanalytics2-0.3.3.post2/setup.cfg
+-rw-rw-rw-   0        0        0     1873 2021-10-20 19:45:40.000000 aanalytics2-0.3.3.post2/setup.py
+drwxrwxrwx   0        0        0        0 2023-04-26 09:48:25.997698 aanalytics2-0.3.3.post2/test/
+-rw-rw-rw-   0        0        0        0 2021-10-20 19:45:40.000000 aanalytics2-0.3.3.post2/test/__init__.py
+-rw-rw-rw-   0        0        0      907 2021-10-20 19:45:40.000000 aanalytics2-0.3.3.post2/test/test_configuration.py
+-rw-rw-rw-   0        0        0     2538 2021-10-20 19:45:40.000000 aanalytics2-0.3.3.post2/test/test_core_analytics.py
```

### Comparing `aanalytics2-0.3.3.post1/LICENSE` & `aanalytics2-0.3.3.post2/LICENSE`

 * *Files identical despite different names*

### Comparing `aanalytics2-0.3.3.post1/PKG-INFO` & `aanalytics2-0.3.3.post2/PKG-INFO`

 * *Files 1% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: aanalytics2
-Version: 0.3.3.post1
+Version: 0.3.3.post2
 Summary: Adobe Analytics API 2.0 python wrapper
 Home-page: https://github.com/pitchmuc/adobe-analytics-api-2.0
 Author: Julien Piccini
 Author-email: piccini.julien@gmail.com
 License: Apache License 2.0
 Keywords: adobe,analytics,API,python
 Classifier: Intended Audience :: Developers
```

### Comparing `aanalytics2-0.3.3.post1/README.md` & `aanalytics2-0.3.3.post2/README.md`

 * *Files identical despite different names*

### Comparing `aanalytics2-0.3.3.post1/aanalytics2/aanalytics14.py` & `aanalytics2-0.3.3.post2/aanalytics2/aanalytics14.py`

 * *Files identical despite different names*

### Comparing `aanalytics2-0.3.3.post1/aanalytics2/aanalytics2.py` & `aanalytics2-0.3.3.post2/aanalytics2/aanalytics2.py`

 * *Files 1% similar despite different names*

```diff
@@ -8431,1662 +8431,1684 @@
 00020ee0: 220d 0a20 2020 2020 2020 2069 6620 7365  "..        if se
 00020ef0: 6c66 2e6c 6f67 6769 6e67 456e 6162 6c65  lf.loggingEnable
 00020f00: 643a 0d0a 2020 2020 2020 2020 2020 2020  d:..            
 00020f10: 7365 6c66 2e6c 6f67 6765 722e 6465 6275  self.logger.debu
 00020f20: 6728 6622 7374 6172 7469 6e67 205f 6461  g(f"starting _da
 00020f30: 7461 4465 7363 7269 7074 6f72 2229 0d0a  taDescriptor")..
 00020f40: 2020 2020 2020 2020 6f62 6a20 3d20 7b7d          obj = {}
-00020f50: 0d0a 2020 2020 2020 2020 6f62 6a5b 2764  ..        obj['d
-00020f60: 696d 656e 7369 6f6e 275d 203d 206a 736f  imension'] = jso
-00020f70: 6e5f 7265 7175 6573 745b 2764 696d 656e  n_request['dimen
-00020f80: 7369 6f6e 275d 0d0a 2020 2020 2020 2020  sion']..        
-00020f90: 6f62 6a5b 2766 696c 7465 7273 275d 203d  obj['filters'] =
-00020fa0: 207b 2767 6c6f 6261 6c46 696c 7465 7273   {'globalFilters
-00020fb0: 273a 205b 5d2c 2027 6d65 7472 6963 7346  ': [], 'metricsF
-00020fc0: 696c 7465 7273 273a 207b 7d7d 0d0a 2020  ilters': {}}..  
-00020fd0: 2020 2020 2020 6f62 6a5b 2772 7369 6427        obj['rsid'
-00020fe0: 5d20 3d20 6a73 6f6e 5f72 6571 7565 7374  ] = json_request
-00020ff0: 5b27 7273 6964 275d 0d0a 2020 2020 2020  ['rsid']..      
-00021000: 2020 6d65 7472 6963 735f 696e 666f 203d    metrics_info =
-00021010: 206a 736f 6e5f 7265 7175 6573 745b 276d   json_request['m
-00021020: 6574 7269 6343 6f6e 7461 696e 6572 275d  etricContainer']
-00021030: 0d0a 2020 2020 2020 2020 6f62 6a5b 276d  ..        obj['m
-00021040: 6574 7269 6373 275d 203d 205b 6d65 7472  etrics'] = [metr
-00021050: 6963 5b27 6964 275d 2066 6f72 206d 6574  ic['id'] for met
-00021060: 7269 6320 696e 206d 6574 7269 6373 5f69  ric in metrics_i
-00021070: 6e66 6f5b 276d 6574 7269 6373 275d 5d0d  nfo['metrics']].
-00021080: 0a20 2020 2020 2020 2069 6620 276d 6574  .        if 'met
-00021090: 7269 6346 696c 7465 7273 2720 696e 206d  ricFilters' in m
-000210a0: 6574 7269 6373 5f69 6e66 6f2e 6b65 7973  etrics_info.keys
-000210b0: 2829 3a0d 0a20 2020 2020 2020 2020 2020  ():..           
-000210c0: 206d 6574 7269 6373 4669 6c74 6572 203d   metricsFilter =
-000210d0: 207b 6d65 7472 6963 5b27 6964 275d 3a20   {metric['id']: 
-000210e0: 6d65 7472 6963 5b27 6669 6c74 6572 7327  metric['filters'
-000210f0: 5d20 666f 7220 6d65 7472 6963 2069 6e20  ] for metric in 
-00021100: 6d65 7472 6963 735f 696e 666f 5b27 6d65  metrics_info['me
-00021110: 7472 6963 7327 5d20 6966 0d0a 2020 2020  trics'] if..    
-00021120: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021130: 2020 2020 2020 2020 206c 656e 286d 6574           len(met
-00021140: 7269 632e 6765 7428 2766 696c 7465 7273  ric.get('filters
-00021150: 272c 205b 5d29 2920 3e20 307d 0d0a 2020  ', [])) > 0}..  
-00021160: 2020 2020 2020 2020 2020 6669 6c74 6572            filter
-00021170: 7320 3d20 5b5d 0d0a 2020 2020 2020 2020  s = []..        
-00021180: 2020 2020 666f 7220 6d65 7472 6963 2069      for metric i
-00021190: 6e20 6d65 7472 6963 7346 696c 7465 723a  n metricsFilter:
-000211a0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-000211b0: 2020 666f 7220 6974 656d 2069 6e20 6d65    for item in me
-000211c0: 7472 6963 7346 696c 7465 725b 6d65 7472  tricsFilter[metr
-000211d0: 6963 5d3a 0d0a 2020 2020 2020 2020 2020  ic]:..          
-000211e0: 2020 2020 2020 2020 2020 6966 2027 7365            if 'se
-000211f0: 676d 656e 7449 6427 2069 6e20 6d65 7472  gmentId' in metr
-00021200: 6963 735f 696e 666f 5b27 6d65 7472 6963  ics_info['metric
-00021210: 4669 6c74 6572 7327 5d5b 696e 7428 6974  Filters'][int(it
-00021220: 656d 295d 2e6b 6579 7328 293a 0d0a 2020  em)].keys():..  
-00021230: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021240: 2020 2020 2020 6669 6c74 6572 732e 6170        filters.ap
-00021250: 7065 6e64 280d 0a20 2020 2020 2020 2020  pend(..         
-00021260: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021270: 2020 206d 6574 7269 6373 5f69 6e66 6f5b     metrics_info[
-00021280: 276d 6574 7269 6346 696c 7465 7273 275d  'metricFilters']
-00021290: 5b69 6e74 2869 7465 6d29 5d5b 2773 6567  [int(item)]['seg
-000212a0: 6d65 6e74 4964 275d 290d 0a20 2020 2020  mentId'])..     
-000212b0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-000212c0: 6620 2764 696d 656e 7369 6f6e 2720 696e  f 'dimension' in
-000212d0: 206d 6574 7269 6373 5f69 6e66 6f5b 276d   metrics_info['m
-000212e0: 6574 7269 6346 696c 7465 7273 275d 5b69  etricFilters'][i
-000212f0: 6e74 2869 7465 6d29 5d2e 6b65 7973 2829  nt(item)].keys()
-00021300: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-00021310: 2020 2020 2020 2020 2020 2066 696c 7465             filte
-00021320: 7273 2e61 7070 656e 6428 0d0a 2020 2020  rs.append(..    
-00021330: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021340: 2020 2020 2020 2020 6d65 7472 6963 735f          metrics_
-00021350: 696e 666f 5b27 6d65 7472 6963 4669 6c74  info['metricFilt
-00021360: 6572 7327 5d5b 696e 7428 6974 656d 295d  ers'][int(item)]
-00021370: 5b27 6469 6d65 6e73 696f 6e27 5d29 0d0a  ['dimension'])..
-00021380: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021390: 2020 2020 6f62 6a5b 2766 696c 7465 7273      obj['filters
-000213a0: 275d 5b27 6d65 7472 6963 7346 696c 7465  ']['metricsFilte
-000213b0: 7273 275d 5b6d 6574 7269 635d 203d 2073  rs'][metric] = s
-000213c0: 6574 2866 696c 7465 7273 290d 0a20 2020  et(filters)..   
-000213d0: 2020 2020 2066 6f72 2066 696c 2069 6e20       for fil in 
-000213e0: 6a73 6f6e 5f72 6571 7565 7374 5b27 676c  json_request['gl
-000213f0: 6f62 616c 4669 6c74 6572 7327 5d3a 0d0a  obalFilters']:..
-00021400: 2020 2020 2020 2020 2020 2020 6966 2027              if '
-00021410: 6461 7465 5261 6e67 6527 2069 6e20 6669  dateRange' in fi
-00021420: 6c2e 6b65 7973 2829 3a0d 0a20 2020 2020  l.keys():..     
-00021430: 2020 2020 2020 2020 2020 206f 626a 5b27             obj['
-00021440: 6669 6c74 6572 7327 5d5b 2767 6c6f 6261  filters']['globa
-00021450: 6c46 696c 7465 7273 275d 2e61 7070 656e  lFilters'].appen
-00021460: 6428 6669 6c5b 2764 6174 6552 616e 6765  d(fil['dateRange
-00021470: 275d 290d 0a20 2020 2020 2020 2020 2020  '])..           
-00021480: 2069 6620 2764 696d 656e 7369 6f6e 2720   if 'dimension' 
-00021490: 696e 2066 696c 2e6b 6579 7328 293a 0d0a  in fil.keys():..
-000214a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000214b0: 6f62 6a5b 2766 696c 7465 7273 275d 5b27  obj['filters']['
-000214c0: 676c 6f62 616c 4669 6c74 6572 7327 5d2e  globalFilters'].
-000214d0: 6170 7065 6e64 2866 696c 5b27 6469 6d65  append(fil['dime
-000214e0: 6e73 696f 6e27 5d29 0d0a 2020 2020 2020  nsion'])..      
-000214f0: 2020 2020 2020 6966 2027 7365 676d 656e        if 'segmen
-00021500: 7449 6427 2069 6e20 6669 6c2e 6b65 7973  tId' in fil.keys
-00021510: 2829 3a0d 0a20 2020 2020 2020 2020 2020  ():..           
-00021520: 2020 2020 206f 626a 5b27 6669 6c74 6572       obj['filter
-00021530: 7327 5d5b 2767 6c6f 6261 6c46 696c 7465  s']['globalFilte
-00021540: 7273 275d 2e61 7070 656e 6428 6669 6c5b  rs'].append(fil[
-00021550: 2773 6567 6d65 6e74 4964 275d 290d 0a20  'segmentId']).. 
-00021560: 2020 2020 2020 2072 6574 7572 6e20 6f62         return ob
-00021570: 6a0d 0a0d 0a20 2020 2064 6566 205f 7265  j....    def _re
-00021580: 6164 4461 7461 280d 0a20 2020 2020 2020  adData(..       
-00021590: 2020 2020 2073 656c 662c 0d0a 2020 2020       self,..    
-000215a0: 2020 2020 2020 2020 6461 7461 5f72 6f77          data_row
-000215b0: 733a 206c 6973 742c 0d0a 2020 2020 2020  s: list,..      
-000215c0: 2020 2020 2020 616e 6f6d 616c 793a 2062        anomaly: b
-000215d0: 6f6f 6c20 3d20 4661 6c73 652c 0d0a 2020  ool = False,..  
-000215e0: 2020 2020 2020 2020 2020 636f 6c73 3a20            cols: 
-000215f0: 6c69 7374 203d 204e 6f6e 652c 0d0a 2020  list = None,..  
-00021600: 2020 2020 2020 2020 2020 6974 656d 5f69            item_i
-00021610: 643a 2062 6f6f 6c20 3d20 4661 6c73 650d  d: bool = False.
-00021620: 0a20 2020 2029 202d 3e20 7064 2e44 6174  .    ) -> pd.Dat
-00021630: 6146 7261 6d65 3a0d 0a20 2020 2020 2020  aFrame:..       
-00021640: 2022 2222 0d0a 2020 2020 2020 2020 7265   """..        re
-00021650: 6164 2074 6865 2064 6174 6120 6672 6f6d  ad the data from
-00021660: 2074 6865 2072 6571 7565 7374 7320 616e   the requests an
-00021670: 6420 7265 7475 726e 7320 6120 6461 7461  d returns a data
-00021680: 6672 616d 652e 200d 0a20 2020 2020 2020  frame. ..       
-00021690: 2050 6172 616d 6574 6572 733a 0d0a 2020   Parameters:..  
-000216a0: 2020 2020 2020 2020 2020 6461 7461 5f72            data_r
-000216b0: 6f77 7320 3a20 5245 5155 4952 4544 203a  ows : REQUIRED :
-000216c0: 2052 6f77 7320 7468 6174 2068 6176 6520   Rows that have 
-000216d0: 6265 656e 2072 6574 7572 6e65 6420 6279  been returned by
-000216e0: 2074 6865 2072 6571 7565 7374 2e0d 0a20   the request... 
-000216f0: 2020 2020 2020 2020 2020 2061 6e6f 6d61             anoma
-00021700: 6c79 203a 204f 5054 494f 4e41 4c20 3a20  ly : OPTIONAL : 
-00021710: 426f 6f6c 6561 6e20 746f 2074 656c 6c20  Boolean to tell 
-00021720: 6966 2074 6865 2061 6e6f 6d61 6c79 2064  if the anomaly d
-00021730: 6574 6563 7469 6f6e 2068 6173 2062 6565  etection has bee
-00021740: 6e20 7573 6564 2e20 0d0a 2020 2020 2020  n used. ..      
-00021750: 2020 2020 2020 636f 6c73 203a 204f 5054        cols : OPT
-00021760: 494f 4e41 4c20 3a20 6c69 7374 206f 6620  IONAL : list of 
-00021770: 636f 6c75 6d6e 7320 6e61 6d65 730d 0a20  columns names.. 
-00021780: 2020 2020 2020 2022 2222 0d0a 2020 2020         """..    
-00021790: 2020 2020 6966 2073 656c 662e 6c6f 6767      if self.logg
-000217a0: 696e 6745 6e61 626c 6564 3a0d 0a20 2020  ingEnabled:..   
-000217b0: 2020 2020 2020 2020 2073 656c 662e 6c6f           self.lo
-000217c0: 6767 6572 2e64 6562 7567 2866 2273 7461  gger.debug(f"sta
-000217d0: 7274 696e 6720 5f72 6561 6444 6174 6122  rting _readData"
-000217e0: 290d 0a20 2020 2020 2020 2069 6620 636f  )..        if co
-000217f0: 6c73 2069 7320 4e6f 6e65 3a0d 0a20 2020  ls is None:..   
-00021800: 2020 2020 2020 2020 2072 6169 7365 2056           raise V
-00021810: 616c 7565 4572 726f 7228 226c 6973 7420  alueError("list 
-00021820: 6f66 2063 6f6c 756d 6e73 206d 7573 7420  of columns must 
-00021830: 6265 2073 7065 6369 6669 6564 2229 0d0a  be specified")..
-00021840: 2020 2020 2020 2020 6461 7461 5f72 6f77          data_row
-00021850: 7320 3d20 6465 6570 636f 7079 2864 6174  s = deepcopy(dat
-00021860: 615f 726f 7773 290d 0a20 2020 2020 2020  a_rows)..       
-00021870: 2064 6963 745f 6461 7461 203d 207b 726f   dict_data = {ro
-00021880: 772e 6765 7428 2776 616c 7565 272c 2027  w.get('value', '
-00021890: 6d69 7373 696e 675f 7661 6c75 6527 293a  missing_value'):
-000218a0: 2072 6f77 5b27 6461 7461 275d 2066 6f72   row['data'] for
-000218b0: 2072 6f77 2069 6e20 6461 7461 5f72 6f77   row in data_row
-000218c0: 737d 0d0a 2020 2020 2020 2020 6966 2063  s}..        if c
-000218d0: 6f6c 7320 6973 206e 6f74 204e 6f6e 653a  ols is not None:
-000218e0: 0d0a 2020 2020 2020 2020 2020 2020 6e5f  ..            n_
-000218f0: 6d65 7472 6963 7320 3d20 6c65 6e28 636f  metrics = len(co
-00021900: 6c73 2920 2d20 310d 0a20 2020 2020 2020  ls) - 1..       
-00021910: 2069 6620 6974 656d 5f69 643a 2020 2320   if item_id:  # 
-00021920: 6164 6469 6e67 2074 6865 2069 7465 6d49  adding the itemI
-00021930: 6420 696e 2074 6865 2064 6174 6120 7265  d in the data re
-00021940: 7475 726e 6564 0d0a 2020 2020 2020 2020  turned..        
-00021950: 2020 2020 636f 6c73 2e61 7070 656e 6428      cols.append(
-00021960: 2769 7465 6d5f 6964 2729 0d0a 2020 2020  'item_id')..    
-00021970: 2020 2020 2020 2020 666f 7220 726f 7720          for row 
-00021980: 696e 2064 6174 615f 726f 7773 3a0d 0a20  in data_rows:.. 
-00021990: 2020 2020 2020 2020 2020 2020 2020 2064                 d
-000219a0: 6963 745f 6461 7461 5b72 6f77 2e67 6574  ict_data[row.get
-000219b0: 2827 7661 6c75 6527 2c20 276d 6973 7369  ('value', 'missi
-000219c0: 6e67 5f76 616c 7565 2729 5d2e 6170 7065  ng_value')].appe
-000219d0: 6e64 2872 6f77 5b27 6974 656d 4964 275d  nd(row['itemId']
-000219e0: 290d 0a20 2020 2020 2020 2069 6620 616e  )..        if an
-000219f0: 6f6d 616c 793a 0d0a 2020 2020 2020 2020  omaly:..        
-00021a00: 2020 2020 2320 7365 7420 6675 6c6c 2063      # set full c
-00021a10: 6f6c 756d 6e73 0d0a 2020 2020 2020 2020  olumns..        
-00021a20: 2020 2020 636f 6c73 203d 2063 6f6c 7320      cols = cols 
-00021a30: 2b20 5b66 277b 6d65 7472 6963 7d2d 7b73  + [f'{metric}-{s
-00021a40: 7566 6669 787d 2720 666f 7220 6d65 7472  uffix}' for metr
-00021a50: 6963 2069 6e20 636f 6c73 5b31 3a5d 2066  ic in cols[1:] f
-00021a60: 6f72 2073 7566 6669 7820 696e 0d0a 2020  or suffix in..  
-00021a70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021a80: 2020 2020 2020 2020 205b 2765 7870 6563           ['expec
-00021a90: 7465 6427 2c20 2755 7070 6572 426f 756e  ted', 'UpperBoun
-00021aa0: 6427 2c20 274c 6f77 6572 426f 756e 6427  d', 'LowerBound'
-00021ab0: 5d5d 0d0a 2020 2020 2020 2020 2020 2020  ]]..            
-00021ac0: 2320 6164 6420 6461 7461 2074 6f20 7468  # add data to th
-00021ad0: 6520 6469 6374 696f 6e61 7279 0d0a 2020  e dictionary..  
-00021ae0: 2020 2020 2020 2020 2020 666f 7220 726f            for ro
-00021af0: 7720 696e 2064 6174 615f 726f 7773 3a0d  w in data_rows:.
-00021b00: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00021b10: 2066 6f72 2069 7465 6d20 696e 2072 616e   for item in ran
-00021b20: 6765 286e 5f6d 6574 7269 6373 293a 0d0a  ge(n_metrics):..
-00021b30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021b40: 2020 2020 6469 6374 5f64 6174 615b 726f      dict_data[ro
-00021b50: 775b 2776 616c 7565 275d 5d2e 6170 7065  w['value']].appe
-00021b60: 6e64 280d 0a20 2020 2020 2020 2020 2020  nd(..           
-00021b70: 2020 2020 2020 2020 2020 2020 2072 6f77               row
-00021b80: 2e67 6574 2827 6461 7461 4578 7065 6374  .get('dataExpect
-00021b90: 6564 272c 205b 3020 666f 7220 6920 696e  ed', [0 for i in
-00021ba0: 2072 616e 6765 286e 5f6d 6574 7269 6373   range(n_metrics
-00021bb0: 295d 295b 6974 656d 5d29 0d0a 2020 2020  )])[item])..    
-00021bc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021bd0: 6469 6374 5f64 6174 615b 726f 775b 2776  dict_data[row['v
-00021be0: 616c 7565 275d 5d2e 6170 7065 6e64 280d  alue']].append(.
-00021bf0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00021c00: 2020 2020 2020 2020 2072 6f77 2e67 6574           row.get
-00021c10: 2827 6461 7461 5570 7065 7242 6f75 6e64  ('dataUpperBound
-00021c20: 272c 205b 3020 666f 7220 6920 696e 2072  ', [0 for i in r
-00021c30: 616e 6765 286e 5f6d 6574 7269 6373 295d  ange(n_metrics)]
-00021c40: 295b 6974 656d 5d29 0d0a 2020 2020 2020  )[item])..      
-00021c50: 2020 2020 2020 2020 2020 2020 2020 6469                di
-00021c60: 6374 5f64 6174 615b 726f 775b 2776 616c  ct_data[row['val
-00021c70: 7565 275d 5d2e 6170 7065 6e64 280d 0a20  ue']].append(.. 
-00021c80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021c90: 2020 2020 2020 2072 6f77 2e67 6574 2827         row.get('
-00021ca0: 6461 7461 4c6f 7765 7242 6f75 6e64 272c  dataLowerBound',
-00021cb0: 205b 3020 666f 7220 6920 696e 2072 616e   [0 for i in ran
-00021cc0: 6765 286e 5f6d 6574 7269 6373 295d 295b  ge(n_metrics)])[
-00021cd0: 6974 656d 5d29 0d0a 2020 2020 2020 2020  item])..        
-00021ce0: 6466 203d 2070 642e 4461 7461 4672 616d  df = pd.DataFram
-00021cf0: 6528 6469 6374 5f64 6174 6129 2e54 2020  e(dict_data).T  
-00021d00: 2320 7265 7175 6972 6520 746f 2074 7261  # require to tra
-00021d10: 6e73 666f 726d 2074 6865 2064 6174 610d  nsform the data.
-00021d20: 0a20 2020 2020 2020 2064 662e 7265 7365  .        df.rese
-00021d30: 745f 696e 6465 7828 696e 706c 6163 653d  t_index(inplace=
-00021d40: 5472 7565 2c20 290d 0a20 2020 2020 2020  True, )..       
-00021d50: 2064 662e 636f 6c75 6d6e 7320 3d20 636f   df.columns = co
-00021d60: 6c73 0d0a 2020 2020 2020 2020 7265 7475  ls..        retu
-00021d70: 726e 2064 660d 0a0d 0a20 2020 2064 6566  rn df....    def
-00021d80: 2067 6574 5265 706f 7274 280d 0a20 2020   getReport(..   
-00021d90: 2020 2020 2020 2020 2073 656c 662c 0d0a           self,..
-00021da0: 2020 2020 2020 2020 2020 2020 6a73 6f6e              json
-00021db0: 5f72 6571 7565 7374 3a20 556e 696f 6e5b  _request: Union[
-00021dc0: 6469 6374 2c20 7374 722c 2049 4f2c 5265  dict, str, IO,Re
-00021dd0: 7175 6573 7443 7265 6174 6f72 5d2c 0d0a  questCreator],..
-00021de0: 2020 2020 2020 2020 2020 2020 6c69 6d69              limi
-00021df0: 743a 2069 6e74 203d 2031 3030 302c 0d0a  t: int = 1000,..
-00021e00: 2020 2020 2020 2020 2020 2020 6e5f 7265              n_re
-00021e10: 7375 6c74 733a 2055 6e69 6f6e 5b69 6e74  sults: Union[int
-00021e20: 2c20 7374 725d 203d 2031 3030 302c 0d0a  , str] = 1000,..
-00021e30: 2020 2020 2020 2020 2020 2020 7361 7665              save
-00021e40: 3a20 626f 6f6c 203d 2046 616c 7365 2c0d  : bool = False,.
-00021e50: 0a20 2020 2020 2020 2020 2020 2069 7465  .            ite
-00021e60: 6d5f 6964 3a20 626f 6f6c 203d 2046 616c  m_id: bool = Fal
-00021e70: 7365 2c0d 0a20 2020 2020 2020 2020 2020  se,..           
-00021e80: 2075 6e73 6166 653a 2062 6f6f 6c20 3d20   unsafe: bool = 
-00021e90: 4661 6c73 652c 0d0a 2020 2020 2020 2020  False,..        
-00021ea0: 2020 2020 7665 7262 6f73 653a 2062 6f6f      verbose: boo
-00021eb0: 6c20 3d20 4661 6c73 652c 0d0a 2020 2020  l = False,..    
-00021ec0: 2020 2020 2020 2020 6465 6275 673d 4661          debug=Fa
-00021ed0: 6c73 652c 0d0a 2020 2020 2020 2020 2020  lse,..          
-00021ee0: 2020 2a2a 6b77 6172 6773 2c0d 0a20 2020    **kwargs,..   
-00021ef0: 2029 202d 3e20 6f62 6a65 6374 3a0d 0a20   ) -> object:.. 
-00021f00: 2020 2020 2020 2022 2222 0d0a 2020 2020         """..    
-00021f10: 2020 2020 5265 7472 6965 7665 2064 6174      Retrieve dat
-00021f20: 6120 6672 6f6d 2061 204a 534f 4e20 7265  a from a JSON re
-00021f30: 7175 6573 742e 5265 7475 726e 7320 616e  quest.Returns an
-00021f40: 206f 626a 6563 7420 636f 6e74 6169 6e69   object containi
-00021f50: 6e67 206d 6574 6120 696e 666f 2061 6e64  ng meta info and
-00021f60: 2064 6174 6166 7261 6d65 2e20 0d0a 2020   dataframe. ..  
-00021f70: 2020 2020 2020 4172 6775 6d65 6e74 733a        Arguments:
-00021f80: 0d0a 2020 2020 2020 2020 2020 2020 6a73  ..            js
-00021f90: 6f6e 5f72 6571 7565 7374 3a20 5245 5155  on_request: REQU
-00021fa0: 4952 4544 203a 204a 534f 4e20 7374 6174  IRED : JSON stat
-00021fb0: 656d 656e 7420 7468 6174 2063 6f6e 7461  ement that conta
-00021fc0: 696e 7320 796f 7572 2072 6571 7565 7374  ins your request
-00021fd0: 2066 6f72 2041 6e61 6c79 7469 6373 2041   for Analytics A
-00021fe0: 5049 2032 2e30 2e0d 0a20 2020 2020 2020  PI 2.0...       
-00021ff0: 2020 2020 206c 696d 6974 203a 204f 5054       limit : OPT
-00022000: 494f 4e41 4c20 3a20 6e75 6d62 6572 206f  IONAL : number o
-00022010: 6620 7265 7375 6c74 2070 6572 2072 6571  f result per req
-00022020: 7565 7374 2028 6465 6661 7574 2031 3030  uest (defaut 100
-00022030: 3029 0d0a 2020 2020 2020 2020 2020 2020  0)..            
-00022040: 5468 6520 6172 6775 6d65 6e74 2063 616e  The argument can
-00022050: 2062 6520 3a20 0d0a 2020 2020 2020 2020   be : ..        
-00022060: 2020 2020 2020 2020 2d20 6120 6469 6374          - a dict
-00022070: 696f 6e61 7279 203a 2049 7420 7769 6c6c  ionary : It will
-00022080: 2062 6520 7573 6564 2061 7320 6974 2069   be used as it i
-00022090: 732e 0d0a 2020 2020 2020 2020 2020 2020  s...            
-000220a0: 2020 2020 2d20 6120 7374 7269 6e67 2074      - a string t
-000220b0: 6861 7420 6973 2061 2064 6963 7469 6f6e  hat is a diction
-000220c0: 6172 7920 3a20 4974 2077 696c 6c20 6265  ary : It will be
-000220d0: 2074 7261 6e73 666f 726d 6564 2074 6f20   transformed to 
-000220e0: 6120 6469 6374 696f 6e61 7279 202f 204a  a dictionary / J
-000220f0: 534f 4e2e 0d0a 2020 2020 2020 2020 2020  SON...          
-00022100: 2020 2020 2020 2d20 6120 7061 7468 2074        - a path t
-00022110: 6f20 6120 4a53 4f4e 2066 696c 6520 7468  o a JSON file th
-00022120: 6174 2063 6f6e 7461 696e 7320 7468 6520  at contains the 
-00022130: 7374 6174 656d 656e 7420 286d 7573 7420  statement (must 
-00022140: 656e 6420 7769 7468 2022 2e6a 736f 6e22  end with ".json"
-00022150: 292e 200d 0a20 2020 2020 2020 2020 2020  ). ..           
-00022160: 2020 2020 202d 2061 6e20 696e 7374 616e       - an instan
-00022170: 6365 206f 6620 7468 6520 5265 7175 6573  ce of the Reques
-00022180: 7443 7265 6174 6f72 2063 6c61 7373 0d0a  tCreator class..
-00022190: 2020 2020 2020 2020 2020 2020 6e5f 7265              n_re
-000221a0: 7375 6c74 7320 3a20 4f50 5449 4f4e 414c  sults : OPTIONAL
-000221b0: 203a 204e 756d 6265 7220 6f66 2072 6573   : Number of res
-000221c0: 756c 7420 7468 6174 2079 6f75 2077 6f75  ult that you wou
-000221d0: 6c64 206c 696b 6520 746f 2072 6574 7269  ld like to retri
-000221e0: 6576 652e 2028 6465 6661 756c 7420 3130  eve. (default 10
-000221f0: 3030 290d 0a20 2020 2020 2020 2020 2020  00)..           
-00022200: 2020 2020 2069 6620 796f 7520 7761 6e74       if you want
-00022210: 2074 6f20 6861 7665 2061 6c6c 2070 6f73   to have all pos
-00022220: 7369 626c 6520 6461 7461 2c20 7573 6520  sible data, use 
-00022230: 2269 6e66 222e 0d0a 2020 2020 2020 2020  "inf"...        
-00022240: 2020 2020 6974 656d 5f69 6420 3a20 4f50      item_id : OP
-00022250: 5449 4f4e 414c 203a 2042 6f6f 6c65 616e  TIONAL : Boolean
-00022260: 2074 6f20 6465 6669 6e65 2069 6620 796f   to define if yo
-00022270: 7520 7761 6e74 2074 6f20 7265 7475 726e  u want to return
-00022280: 2074 6865 2069 7465 6d20 6964 2066 6f72   the item id for
-00022290: 2073 7562 2072 6571 7565 7374 7320 2864   sub requests (d
-000222a0: 6566 6175 6c74 2046 616c 7365 290d 0a20  efault False).. 
-000222b0: 2020 2020 2020 2020 2020 2075 6e73 6166             unsaf
-000222c0: 6520 3a20 4f50 5449 4f4e 414c 203a 2049  e : OPTIONAL : I
-000222d0: 6620 7365 7420 746f 2054 7275 652c 2069  f set to True, i
-000222e0: 7420 7769 6c6c 206e 6f74 2063 6865 636b  t will not check
-000222f0: 2022 6c61 7374 5061 6765 2220 7061 7261   "lastPage" para
-00022300: 6d65 7465 7220 616e 6420 6173 7375 6d65  meter and assume
-00022310: 2066 6972 7374 2072 6571 7565 7374 2069   first request i
-00022320: 7320 636f 6d70 6c65 7465 2e20 0d0a 2020  s complete. ..  
-00022330: 2020 2020 2020 2020 2020 2020 2020 5468                Th
-00022340: 6973 206d 6179 2062 7265 616b 2074 6865  is may break the
-00022350: 2073 6372 6970 7420 6f72 2072 6574 7572   script or retur
-00022360: 6e20 696e 636f 6d70 6c65 7465 2064 6174  n incomplete dat
-00022370: 612e 2028 6465 6661 756c 7420 4661 6c73  a. (default Fals
-00022380: 6529 2e0d 0a20 2020 2020 2020 2020 2020  e)...           
-00022390: 2073 6176 6520 3a20 4f50 5449 4f4e 414c   save : OPTIONAL
-000223a0: 203a 2049 6620 796f 7520 776f 756c 6420   : If you would 
-000223b0: 6c69 6b65 2074 6f20 7361 7665 2074 6865  like to save the
-000223c0: 2064 6174 6120 7769 7468 696e 2061 2043   data within a C
-000223d0: 5356 2066 696c 652e 2028 6465 6661 756c  SV file. (defaul
-000223e0: 7420 4661 6c73 6529 0d0a 2020 2020 2020  t False)..      
-000223f0: 2020 2020 2020 7665 7262 6f73 6520 3a20        verbose : 
-00022400: 4f50 5449 4f4e 414c 203a 2049 6620 796f  OPTIONAL : If yo
-00022410: 7520 7761 6e74 2074 6f20 6861 7665 2063  u want to have c
-00022420: 6f6d 6d65 6e74 7320 6469 7370 6c61 7965  omments displaye
-00022430: 6420 2864 6566 6175 6c74 2046 616c 7365  d (default False
-00022440: 290d 0a20 2020 2020 2020 2020 2020 200d  )..            .
-00022450: 0a20 2020 2020 2020 2022 2222 0d0a 2020  .        """..  
-00022460: 2020 2020 2020 6966 2075 6e73 6166 6520        if unsafe 
-00022470: 616e 6420 7665 7262 6f73 653a 0d0a 2020  and verbose:..  
-00022480: 2020 2020 2020 2020 2020 7072 696e 7428            print(
-00022490: 272d 2d2d 2d20 7275 6e6e 696e 6720 7468  '---- running th
-000224a0: 6520 6765 7452 6570 6f72 7420 696e 2022  e getReport in "
-000224b0: 756e 7361 6665 2220 6d6f 6465 202d 2d2d  unsafe" mode ---
-000224c0: 2d27 290d 0a20 2020 2020 2020 206f 626a  -')..        obj
-000224d0: 203d 207b 7d0d 0a20 2020 2020 2020 200d   = {}..        .
-000224e0: 0a20 2020 2020 2020 2069 6620 6973 696e  .        if isin
-000224f0: 7374 616e 6365 286a 736f 6e5f 7265 7175  stance(json_requ
-00022500: 6573 742c 5265 7175 6573 7443 7265 6174  est,RequestCreat
-00022510: 6f72 293a 0d0a 2020 2020 2020 2020 2020  or):..          
-00022520: 2020 7265 7175 6573 7420 3d20 6a73 6f6e    request = json
-00022530: 5f72 6571 7565 7374 2e74 6f5f 6469 6374  _request.to_dict
-00022540: 2829 0d0a 2020 2020 2020 2020 656c 6966  ()..        elif
-00022550: 2074 7970 6528 6a73 6f6e 5f72 6571 7565   type(json_reque
-00022560: 7374 2920 3d3d 2064 6963 743a 0d0a 2020  st) == dict:..  
-00022570: 2020 2020 2020 2020 2020 7265 7175 6573            reques
-00022580: 7420 3d20 6a73 6f6e 5f72 6571 7565 7374  t = json_request
-00022590: 0d0a 2020 2020 2020 2020 656c 6966 2074  ..        elif t
-000225a0: 7970 6528 6a73 6f6e 5f72 6571 7565 7374  ype(json_request
-000225b0: 2920 3d3d 2073 7472 2061 6e64 2027 2e6a  ) == str and '.j
-000225c0: 736f 6e27 206e 6f74 2069 6e20 6a73 6f6e  son' not in json
-000225d0: 5f72 6571 7565 7374 3a0d 0a20 2020 2020  _request:..     
-000225e0: 2020 2020 2020 2074 7279 3a0d 0a20 2020         try:..   
-000225f0: 2020 2020 2020 2020 2020 2020 2072 6571               req
-00022600: 7565 7374 203d 206a 736f 6e2e 6c6f 6164  uest = json.load
-00022610: 7328 6a73 6f6e 5f72 6571 7565 7374 290d  s(json_request).
-00022620: 0a20 2020 2020 2020 2020 2020 2065 7863  .            exc
-00022630: 6570 743a 0d0a 2020 2020 2020 2020 2020  ept:..          
-00022640: 2020 2020 2020 7261 6973 6520 5479 7065        raise Type
-00022650: 4572 726f 7228 2265 7870 6563 7465 6420  Error("expected 
-00022660: 6120 7061 7273 6162 6c65 2073 7472 696e  a parsable strin
-00022670: 6722 290d 0a20 2020 2020 2020 2065 6c69  g")..        eli
-00022680: 6620 272e 6a73 6f6e 2720 696e 206a 736f  f '.json' in jso
-00022690: 6e5f 7265 7175 6573 743a 0d0a 2020 2020  n_request:..    
-000226a0: 2020 2020 2020 2020 7472 793a 0d0a 2020          try:..  
-000226b0: 2020 2020 2020 2020 2020 2020 2020 7769                wi
-000226c0: 7468 206f 7065 6e28 5061 7468 286a 736f  th open(Path(jso
-000226d0: 6e5f 7265 7175 6573 7429 2c20 2772 2729  n_request), 'r')
-000226e0: 2061 7320 6669 6c65 3a0d 0a20 2020 2020   as file:..     
-000226f0: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-00022700: 696c 655f 7374 7269 6e67 203d 2066 696c  ile_string = fil
-00022710: 652e 7265 6164 2829 0d0a 2020 2020 2020  e.read()..      
-00022720: 2020 2020 2020 2020 2020 7265 7175 6573            reques
-00022730: 7420 3d20 6a73 6f6e 2e6c 6f61 6473 2866  t = json.loads(f
-00022740: 696c 655f 7374 7269 6e67 290d 0a20 2020  ile_string)..   
-00022750: 2020 2020 2020 2020 2065 7863 6570 743a           except:
+00020f50: 0d0a 2020 2020 2020 2020 6966 206a 736f  ..        if jso
+00020f60: 6e5f 7265 7175 6573 742e 6765 7428 2764  n_request.get('d
+00020f70: 696d 656e 7369 6f6e 272c 4e6f 6e65 2920  imension',None) 
+00020f80: 6973 206e 6f74 204e 6f6e 653a 0d0a 2020  is not None:..  
+00020f90: 2020 2020 2020 2020 2020 6f62 6a5b 2764            obj['d
+00020fa0: 696d 656e 7369 6f6e 275d 203d 206a 736f  imension'] = jso
+00020fb0: 6e5f 7265 7175 6573 742e 6765 7428 2764  n_request.get('d
+00020fc0: 696d 656e 7369 6f6e 2729 0d0a 2020 2020  imension')..    
+00020fd0: 2020 2020 6f62 6a5b 2766 696c 7465 7273      obj['filters
+00020fe0: 275d 203d 207b 2767 6c6f 6261 6c46 696c  '] = {'globalFil
+00020ff0: 7465 7273 273a 205b 5d2c 2027 6d65 7472  ters': [], 'metr
+00021000: 6963 7346 696c 7465 7273 273a 207b 7d7d  icsFilters': {}}
+00021010: 0d0a 2020 2020 2020 2020 6f62 6a5b 2772  ..        obj['r
+00021020: 7369 6427 5d20 3d20 6a73 6f6e 5f72 6571  sid'] = json_req
+00021030: 7565 7374 5b27 7273 6964 275d 0d0a 2020  uest['rsid']..  
+00021040: 2020 2020 2020 6d65 7472 6963 735f 696e        metrics_in
+00021050: 666f 203d 206a 736f 6e5f 7265 7175 6573  fo = json_reques
+00021060: 745b 276d 6574 7269 6343 6f6e 7461 696e  t['metricContain
+00021070: 6572 275d 0d0a 2020 2020 2020 2020 6f62  er']..        ob
+00021080: 6a5b 276d 6574 7269 6373 275d 203d 205b  j['metrics'] = [
+00021090: 6d65 7472 6963 5b27 6964 275d 2066 6f72  metric['id'] for
+000210a0: 206d 6574 7269 6320 696e 206d 6574 7269   metric in metri
+000210b0: 6373 5f69 6e66 6f5b 276d 6574 7269 6373  cs_info['metrics
+000210c0: 275d 5d0d 0a20 2020 2020 2020 2069 6620  ']]..        if 
+000210d0: 276d 6574 7269 6346 696c 7465 7273 2720  'metricFilters' 
+000210e0: 696e 206d 6574 7269 6373 5f69 6e66 6f2e  in metrics_info.
+000210f0: 6b65 7973 2829 3a0d 0a20 2020 2020 2020  keys():..       
+00021100: 2020 2020 206d 6574 7269 6373 4669 6c74       metricsFilt
+00021110: 6572 203d 207b 6d65 7472 6963 5b27 6964  er = {metric['id
+00021120: 275d 3a20 6d65 7472 6963 5b27 6669 6c74  ']: metric['filt
+00021130: 6572 7327 5d20 666f 7220 6d65 7472 6963  ers'] for metric
+00021140: 2069 6e20 6d65 7472 6963 735f 696e 666f   in metrics_info
+00021150: 5b27 6d65 7472 6963 7327 5d20 6966 0d0a  ['metrics'] if..
+00021160: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021170: 2020 2020 2020 2020 2020 2020 206c 656e               len
+00021180: 286d 6574 7269 632e 6765 7428 2766 696c  (metric.get('fil
+00021190: 7465 7273 272c 205b 5d29 2920 3e20 307d  ters', [])) > 0}
+000211a0: 0d0a 2020 2020 2020 2020 2020 2020 6669  ..            fi
+000211b0: 6c74 6572 7320 3d20 5b5d 0d0a 2020 2020  lters = []..    
+000211c0: 2020 2020 2020 2020 666f 7220 6d65 7472          for metr
+000211d0: 6963 2069 6e20 6d65 7472 6963 7346 696c  ic in metricsFil
+000211e0: 7465 723a 0d0a 2020 2020 2020 2020 2020  ter:..          
+000211f0: 2020 2020 2020 666f 7220 6974 656d 2069        for item i
+00021200: 6e20 6d65 7472 6963 7346 696c 7465 725b  n metricsFilter[
+00021210: 6d65 7472 6963 5d3a 0d0a 2020 2020 2020  metric]:..      
+00021220: 2020 2020 2020 2020 2020 2020 2020 6966                if
+00021230: 2027 7365 676d 656e 7449 6427 2069 6e20   'segmentId' in 
+00021240: 6d65 7472 6963 735f 696e 666f 5b27 6d65  metrics_info['me
+00021250: 7472 6963 4669 6c74 6572 7327 5d5b 696e  tricFilters'][in
+00021260: 7428 6974 656d 295d 2e6b 6579 7328 293a  t(item)].keys():
+00021270: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00021280: 2020 2020 2020 2020 2020 6669 6c74 6572            filter
+00021290: 732e 6170 7065 6e64 280d 0a20 2020 2020  s.append(..     
+000212a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000212b0: 2020 2020 2020 206d 6574 7269 6373 5f69         metrics_i
+000212c0: 6e66 6f5b 276d 6574 7269 6346 696c 7465  nfo['metricFilte
+000212d0: 7273 275d 5b69 6e74 2869 7465 6d29 5d5b  rs'][int(item)][
+000212e0: 2773 6567 6d65 6e74 4964 275d 290d 0a20  'segmentId']).. 
+000212f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021300: 2020 2069 6620 2764 696d 656e 7369 6f6e     if 'dimension
+00021310: 2720 696e 206d 6574 7269 6373 5f69 6e66  ' in metrics_inf
+00021320: 6f5b 276d 6574 7269 6346 696c 7465 7273  o['metricFilters
+00021330: 275d 5b69 6e74 2869 7465 6d29 5d2e 6b65  '][int(item)].ke
+00021340: 7973 2829 3a0d 0a20 2020 2020 2020 2020  ys():..         
+00021350: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+00021360: 696c 7465 7273 2e61 7070 656e 6428 0d0a  ilters.append(..
+00021370: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021380: 2020 2020 2020 2020 2020 2020 6d65 7472              metr
+00021390: 6963 735f 696e 666f 5b27 6d65 7472 6963  ics_info['metric
+000213a0: 4669 6c74 6572 7327 5d5b 696e 7428 6974  Filters'][int(it
+000213b0: 656d 295d 5b27 6469 6d65 6e73 696f 6e27  em)]['dimension'
+000213c0: 5d29 0d0a 2020 2020 2020 2020 2020 2020  ])..            
+000213d0: 2020 2020 2020 2020 6f62 6a5b 2766 696c          obj['fil
+000213e0: 7465 7273 275d 5b27 6d65 7472 6963 7346  ters']['metricsF
+000213f0: 696c 7465 7273 275d 5b6d 6574 7269 635d  ilters'][metric]
+00021400: 203d 2073 6574 2866 696c 7465 7273 290d   = set(filters).
+00021410: 0a20 2020 2020 2020 2066 6f72 2066 696c  .        for fil
+00021420: 2069 6e20 6a73 6f6e 5f72 6571 7565 7374   in json_request
+00021430: 5b27 676c 6f62 616c 4669 6c74 6572 7327  ['globalFilters'
+00021440: 5d3a 0d0a 2020 2020 2020 2020 2020 2020  ]:..            
+00021450: 6966 2027 6461 7465 5261 6e67 6527 2069  if 'dateRange' i
+00021460: 6e20 6669 6c2e 6b65 7973 2829 3a0d 0a20  n fil.keys():.. 
+00021470: 2020 2020 2020 2020 2020 2020 2020 206f                 o
+00021480: 626a 5b27 6669 6c74 6572 7327 5d5b 2767  bj['filters']['g
+00021490: 6c6f 6261 6c46 696c 7465 7273 275d 2e61  lobalFilters'].a
+000214a0: 7070 656e 6428 6669 6c5b 2764 6174 6552  ppend(fil['dateR
+000214b0: 616e 6765 275d 290d 0a20 2020 2020 2020  ange'])..       
+000214c0: 2020 2020 2069 6620 2764 696d 656e 7369       if 'dimensi
+000214d0: 6f6e 2720 696e 2066 696c 2e6b 6579 7328  on' in fil.keys(
+000214e0: 293a 0d0a 2020 2020 2020 2020 2020 2020  ):..            
+000214f0: 2020 2020 6f62 6a5b 2766 696c 7465 7273      obj['filters
+00021500: 275d 5b27 676c 6f62 616c 4669 6c74 6572  ']['globalFilter
+00021510: 7327 5d2e 6170 7065 6e64 2866 696c 5b27  s'].append(fil['
+00021520: 6469 6d65 6e73 696f 6e27 5d29 0d0a 2020  dimension'])..  
+00021530: 2020 2020 2020 2020 2020 6966 2027 7365            if 'se
+00021540: 676d 656e 7449 6427 2069 6e20 6669 6c2e  gmentId' in fil.
+00021550: 6b65 7973 2829 3a0d 0a20 2020 2020 2020  keys():..       
+00021560: 2020 2020 2020 2020 206f 626a 5b27 6669           obj['fi
+00021570: 6c74 6572 7327 5d5b 2767 6c6f 6261 6c46  lters']['globalF
+00021580: 696c 7465 7273 275d 2e61 7070 656e 6428  ilters'].append(
+00021590: 6669 6c5b 2773 6567 6d65 6e74 4964 275d  fil['segmentId']
+000215a0: 290d 0a20 2020 2020 2020 2072 6574 7572  )..        retur
+000215b0: 6e20 6f62 6a0d 0a0d 0a20 2020 2064 6566  n obj....    def
+000215c0: 205f 7265 6164 4461 7461 280d 0a20 2020   _readData(..   
+000215d0: 2020 2020 2020 2020 2073 656c 662c 0d0a           self,..
+000215e0: 2020 2020 2020 2020 2020 2020 6461 7461              data
+000215f0: 5f72 6f77 733a 206c 6973 742c 0d0a 2020  _rows: list,..  
+00021600: 2020 2020 2020 2020 2020 616e 6f6d 616c            anomal
+00021610: 793a 2062 6f6f 6c20 3d20 4661 6c73 652c  y: bool = False,
+00021620: 0d0a 2020 2020 2020 2020 2020 2020 636f  ..            co
+00021630: 6c73 3a20 6c69 7374 203d 204e 6f6e 652c  ls: list = None,
+00021640: 0d0a 2020 2020 2020 2020 2020 2020 6974  ..            it
+00021650: 656d 5f69 643a 2062 6f6f 6c20 3d20 4661  em_id: bool = Fa
+00021660: 6c73 650d 0a20 2020 2029 202d 3e20 7064  lse..    ) -> pd
+00021670: 2e44 6174 6146 7261 6d65 3a0d 0a20 2020  .DataFrame:..   
+00021680: 2020 2020 2022 2222 0d0a 2020 2020 2020       """..      
+00021690: 2020 7265 6164 2074 6865 2064 6174 6120    read the data 
+000216a0: 6672 6f6d 2074 6865 2072 6571 7565 7374  from the request
+000216b0: 7320 616e 6420 7265 7475 726e 7320 6120  s and returns a 
+000216c0: 6461 7461 6672 616d 652e 200d 0a20 2020  dataframe. ..   
+000216d0: 2020 2020 2050 6172 616d 6574 6572 733a       Parameters:
+000216e0: 0d0a 2020 2020 2020 2020 2020 2020 6461  ..            da
+000216f0: 7461 5f72 6f77 7320 3a20 5245 5155 4952  ta_rows : REQUIR
+00021700: 4544 203a 2052 6f77 7320 7468 6174 2068  ED : Rows that h
+00021710: 6176 6520 6265 656e 2072 6574 7572 6e65  ave been returne
+00021720: 6420 6279 2074 6865 2072 6571 7565 7374  d by the request
+00021730: 2e0d 0a20 2020 2020 2020 2020 2020 2061  ...            a
+00021740: 6e6f 6d61 6c79 203a 204f 5054 494f 4e41  nomaly : OPTIONA
+00021750: 4c20 3a20 426f 6f6c 6561 6e20 746f 2074  L : Boolean to t
+00021760: 656c 6c20 6966 2074 6865 2061 6e6f 6d61  ell if the anoma
+00021770: 6c79 2064 6574 6563 7469 6f6e 2068 6173  ly detection has
+00021780: 2062 6565 6e20 7573 6564 2e20 0d0a 2020   been used. ..  
+00021790: 2020 2020 2020 2020 2020 636f 6c73 203a            cols :
+000217a0: 204f 5054 494f 4e41 4c20 3a20 6c69 7374   OPTIONAL : list
+000217b0: 206f 6620 636f 6c75 6d6e 7320 6e61 6d65   of columns name
+000217c0: 730d 0a20 2020 2020 2020 2022 2222 0d0a  s..        """..
+000217d0: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
+000217e0: 6c6f 6767 696e 6745 6e61 626c 6564 3a0d  loggingEnabled:.
+000217f0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+00021800: 662e 6c6f 6767 6572 2e64 6562 7567 2866  f.logger.debug(f
+00021810: 2273 7461 7274 696e 6720 5f72 6561 6444  "starting _readD
+00021820: 6174 6122 290d 0a20 2020 2020 2020 2069  ata")..        i
+00021830: 6620 636f 6c73 2069 7320 4e6f 6e65 3a0d  f cols is None:.
+00021840: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
+00021850: 7365 2056 616c 7565 4572 726f 7228 226c  se ValueError("l
+00021860: 6973 7420 6f66 2063 6f6c 756d 6e73 206d  ist of columns m
+00021870: 7573 7420 6265 2073 7065 6369 6669 6564  ust be specified
+00021880: 2229 0d0a 2020 2020 2020 2020 6461 7461  ")..        data
+00021890: 5f72 6f77 7320 3d20 6465 6570 636f 7079  _rows = deepcopy
+000218a0: 2864 6174 615f 726f 7773 290d 0a20 2020  (data_rows)..   
+000218b0: 2020 2020 2064 6963 745f 6461 7461 203d       dict_data =
+000218c0: 207b 726f 772e 6765 7428 2776 616c 7565   {row.get('value
+000218d0: 272c 2027 6d69 7373 696e 675f 7661 6c75  ', 'missing_valu
+000218e0: 6527 293a 2072 6f77 5b27 6461 7461 275d  e'): row['data']
+000218f0: 2066 6f72 2072 6f77 2069 6e20 6461 7461   for row in data
+00021900: 5f72 6f77 737d 0d0a 2020 2020 2020 2020  _rows}..        
+00021910: 6966 2063 6f6c 7320 6973 206e 6f74 204e  if cols is not N
+00021920: 6f6e 653a 0d0a 2020 2020 2020 2020 2020  one:..          
+00021930: 2020 6e5f 6d65 7472 6963 7320 3d20 6c65    n_metrics = le
+00021940: 6e28 636f 6c73 2920 2d20 310d 0a20 2020  n(cols) - 1..   
+00021950: 2020 2020 2069 6620 6974 656d 5f69 643a       if item_id:
+00021960: 2020 2320 6164 6469 6e67 2074 6865 2069    # adding the i
+00021970: 7465 6d49 6420 696e 2074 6865 2064 6174  temId in the dat
+00021980: 6120 7265 7475 726e 6564 0d0a 2020 2020  a returned..    
+00021990: 2020 2020 2020 2020 636f 6c73 2e61 7070          cols.app
+000219a0: 656e 6428 2769 7465 6d5f 6964 2729 0d0a  end('item_id')..
+000219b0: 2020 2020 2020 2020 2020 2020 666f 7220              for 
+000219c0: 726f 7720 696e 2064 6174 615f 726f 7773  row in data_rows
+000219d0: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+000219e0: 2020 2064 6963 745f 6461 7461 5b72 6f77     dict_data[row
+000219f0: 2e67 6574 2827 7661 6c75 6527 2c20 276d  .get('value', 'm
+00021a00: 6973 7369 6e67 5f76 616c 7565 2729 5d2e  issing_value')].
+00021a10: 6170 7065 6e64 2872 6f77 5b27 6974 656d  append(row['item
+00021a20: 4964 275d 290d 0a20 2020 2020 2020 2069  Id'])..        i
+00021a30: 6620 616e 6f6d 616c 793a 0d0a 2020 2020  f anomaly:..    
+00021a40: 2020 2020 2020 2020 2320 7365 7420 6675          # set fu
+00021a50: 6c6c 2063 6f6c 756d 6e73 0d0a 2020 2020  ll columns..    
+00021a60: 2020 2020 2020 2020 636f 6c73 203d 2063          cols = c
+00021a70: 6f6c 7320 2b20 5b66 277b 6d65 7472 6963  ols + [f'{metric
+00021a80: 7d2d 7b73 7566 6669 787d 2720 666f 7220  }-{suffix}' for 
+00021a90: 6d65 7472 6963 2069 6e20 636f 6c73 5b31  metric in cols[1
+00021aa0: 3a5d 2066 6f72 2073 7566 6669 7820 696e  :] for suffix in
+00021ab0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00021ac0: 2020 2020 2020 2020 2020 2020 205b 2765               ['e
+00021ad0: 7870 6563 7465 6427 2c20 2755 7070 6572  xpected', 'Upper
+00021ae0: 426f 756e 6427 2c20 274c 6f77 6572 426f  Bound', 'LowerBo
+00021af0: 756e 6427 5d5d 0d0a 2020 2020 2020 2020  und']]..        
+00021b00: 2020 2020 2320 6164 6420 6461 7461 2074      # add data t
+00021b10: 6f20 7468 6520 6469 6374 696f 6e61 7279  o the dictionary
+00021b20: 0d0a 2020 2020 2020 2020 2020 2020 666f  ..            fo
+00021b30: 7220 726f 7720 696e 2064 6174 615f 726f  r row in data_ro
+00021b40: 7773 3a0d 0a20 2020 2020 2020 2020 2020  ws:..           
+00021b50: 2020 2020 2066 6f72 2069 7465 6d20 696e       for item in
+00021b60: 2072 616e 6765 286e 5f6d 6574 7269 6373   range(n_metrics
+00021b70: 293a 0d0a 2020 2020 2020 2020 2020 2020  ):..            
+00021b80: 2020 2020 2020 2020 6469 6374 5f64 6174          dict_dat
+00021b90: 615b 726f 775b 2776 616c 7565 275d 5d2e  a[row['value']].
+00021ba0: 6170 7065 6e64 280d 0a20 2020 2020 2020  append(..       
+00021bb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021bc0: 2072 6f77 2e67 6574 2827 6461 7461 4578   row.get('dataEx
+00021bd0: 7065 6374 6564 272c 205b 3020 666f 7220  pected', [0 for 
+00021be0: 6920 696e 2072 616e 6765 286e 5f6d 6574  i in range(n_met
+00021bf0: 7269 6373 295d 295b 6974 656d 5d29 0d0a  rics)])[item])..
+00021c00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021c10: 2020 2020 6469 6374 5f64 6174 615b 726f      dict_data[ro
+00021c20: 775b 2776 616c 7565 275d 5d2e 6170 7065  w['value']].appe
+00021c30: 6e64 280d 0a20 2020 2020 2020 2020 2020  nd(..           
+00021c40: 2020 2020 2020 2020 2020 2020 2072 6f77               row
+00021c50: 2e67 6574 2827 6461 7461 5570 7065 7242  .get('dataUpperB
+00021c60: 6f75 6e64 272c 205b 3020 666f 7220 6920  ound', [0 for i 
+00021c70: 696e 2072 616e 6765 286e 5f6d 6574 7269  in range(n_metri
+00021c80: 6373 295d 295b 6974 656d 5d29 0d0a 2020  cs)])[item])..  
+00021c90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021ca0: 2020 6469 6374 5f64 6174 615b 726f 775b    dict_data[row[
+00021cb0: 2776 616c 7565 275d 5d2e 6170 7065 6e64  'value']].append
+00021cc0: 280d 0a20 2020 2020 2020 2020 2020 2020  (..             
+00021cd0: 2020 2020 2020 2020 2020 2072 6f77 2e67             row.g
+00021ce0: 6574 2827 6461 7461 4c6f 7765 7242 6f75  et('dataLowerBou
+00021cf0: 6e64 272c 205b 3020 666f 7220 6920 696e  nd', [0 for i in
+00021d00: 2072 616e 6765 286e 5f6d 6574 7269 6373   range(n_metrics
+00021d10: 295d 295b 6974 656d 5d29 0d0a 2020 2020  )])[item])..    
+00021d20: 2020 2020 6466 203d 2070 642e 4461 7461      df = pd.Data
+00021d30: 4672 616d 6528 6469 6374 5f64 6174 6129  Frame(dict_data)
+00021d40: 2e54 2020 2320 7265 7175 6972 6520 746f  .T  # require to
+00021d50: 2074 7261 6e73 666f 726d 2074 6865 2064   transform the d
+00021d60: 6174 610d 0a20 2020 2020 2020 2064 662e  ata..        df.
+00021d70: 7265 7365 745f 696e 6465 7828 696e 706c  reset_index(inpl
+00021d80: 6163 653d 5472 7565 2c20 290d 0a20 2020  ace=True, )..   
+00021d90: 2020 2020 2064 662e 636f 6c75 6d6e 7320       df.columns 
+00021da0: 3d20 636f 6c73 0d0a 2020 2020 2020 2020  = cols..        
+00021db0: 7265 7475 726e 2064 660d 0a0d 0a20 2020  return df....   
+00021dc0: 2064 6566 2067 6574 5265 706f 7274 280d   def getReport(.
+00021dd0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+00021de0: 662c 0d0a 2020 2020 2020 2020 2020 2020  f,..            
+00021df0: 6a73 6f6e 5f72 6571 7565 7374 3a20 556e  json_request: Un
+00021e00: 696f 6e5b 6469 6374 2c20 7374 722c 2049  ion[dict, str, I
+00021e10: 4f2c 5265 7175 6573 7443 7265 6174 6f72  O,RequestCreator
+00021e20: 5d2c 0d0a 2020 2020 2020 2020 2020 2020  ],..            
+00021e30: 6c69 6d69 743a 2069 6e74 203d 2031 3030  limit: int = 100
+00021e40: 302c 0d0a 2020 2020 2020 2020 2020 2020  0,..            
+00021e50: 6e5f 7265 7375 6c74 733a 2055 6e69 6f6e  n_results: Union
+00021e60: 5b69 6e74 2c20 7374 725d 203d 2031 3030  [int, str] = 100
+00021e70: 302c 0d0a 2020 2020 2020 2020 2020 2020  0,..            
+00021e80: 7361 7665 3a20 626f 6f6c 203d 2046 616c  save: bool = Fal
+00021e90: 7365 2c0d 0a20 2020 2020 2020 2020 2020  se,..           
+00021ea0: 2069 7465 6d5f 6964 3a20 626f 6f6c 203d   item_id: bool =
+00021eb0: 2046 616c 7365 2c0d 0a20 2020 2020 2020   False,..       
+00021ec0: 2020 2020 2075 6e73 6166 653a 2062 6f6f       unsafe: boo
+00021ed0: 6c20 3d20 4661 6c73 652c 0d0a 2020 2020  l = False,..    
+00021ee0: 2020 2020 2020 2020 7665 7262 6f73 653a          verbose:
+00021ef0: 2062 6f6f 6c20 3d20 4661 6c73 652c 0d0a   bool = False,..
+00021f00: 2020 2020 2020 2020 2020 2020 6465 6275              debu
+00021f10: 673d 4661 6c73 652c 0d0a 2020 2020 2020  g=False,..      
+00021f20: 2020 2020 2020 2a2a 6b77 6172 6773 2c0d        **kwargs,.
+00021f30: 0a20 2020 2029 202d 3e20 6f62 6a65 6374  .    ) -> object
+00021f40: 3a0d 0a20 2020 2020 2020 2022 2222 0d0a  :..        """..
+00021f50: 2020 2020 2020 2020 5265 7472 6965 7665          Retrieve
+00021f60: 2064 6174 6120 6672 6f6d 2061 204a 534f   data from a JSO
+00021f70: 4e20 7265 7175 6573 742e 5265 7475 726e  N request.Return
+00021f80: 7320 616e 206f 626a 6563 7420 636f 6e74  s an object cont
+00021f90: 6169 6e69 6e67 206d 6574 6120 696e 666f  aining meta info
+00021fa0: 2061 6e64 2064 6174 6166 7261 6d65 2e20   and dataframe. 
+00021fb0: 0d0a 2020 2020 2020 2020 4172 6775 6d65  ..        Argume
+00021fc0: 6e74 733a 0d0a 2020 2020 2020 2020 2020  nts:..          
+00021fd0: 2020 6a73 6f6e 5f72 6571 7565 7374 3a20    json_request: 
+00021fe0: 5245 5155 4952 4544 203a 204a 534f 4e20  REQUIRED : JSON 
+00021ff0: 7374 6174 656d 656e 7420 7468 6174 2063  statement that c
+00022000: 6f6e 7461 696e 7320 796f 7572 2072 6571  ontains your req
+00022010: 7565 7374 2066 6f72 2041 6e61 6c79 7469  uest for Analyti
+00022020: 6373 2041 5049 2032 2e30 2e0d 0a20 2020  cs API 2.0...   
+00022030: 2020 2020 2020 2020 2020 2020 2054 6865               The
+00022040: 2061 7267 756d 656e 7420 6361 6e20 6265   argument can be
+00022050: 203a 200d 0a20 2020 2020 2020 2020 2020   : ..           
+00022060: 2020 2020 202d 2061 2064 6963 7469 6f6e       - a diction
+00022070: 6172 7920 3a20 4974 2077 696c 6c20 6265  ary : It will be
+00022080: 2075 7365 6420 6173 2069 7420 6973 2e0d   used as it is..
+00022090: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000220a0: 202d 2061 2073 7472 696e 6720 7468 6174   - a string that
+000220b0: 2069 7320 6120 6469 6374 696f 6e61 7279   is a dictionary
+000220c0: 203a 2049 7420 7769 6c6c 2062 6520 7472   : It will be tr
+000220d0: 616e 7366 6f72 6d65 6420 746f 2061 2064  ansformed to a d
+000220e0: 6963 7469 6f6e 6172 7920 2f20 4a53 4f4e  ictionary / JSON
+000220f0: 2e0d 0a20 2020 2020 2020 2020 2020 2020  ...             
+00022100: 2020 202d 2061 2070 6174 6820 746f 2061     - a path to a
+00022110: 204a 534f 4e20 6669 6c65 2074 6861 7420   JSON file that 
+00022120: 636f 6e74 6169 6e73 2074 6865 2073 7461  contains the sta
+00022130: 7465 6d65 6e74 2028 6d75 7374 2065 6e64  tement (must end
+00022140: 2077 6974 6820 222e 6a73 6f6e 2229 2e20   with ".json"). 
+00022150: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00022160: 2020 2d20 616e 2069 6e73 7461 6e63 6520    - an instance 
+00022170: 6f66 2074 6865 2052 6571 7565 7374 4372  of the RequestCr
+00022180: 6561 746f 7220 636c 6173 730d 0a20 2020  eator class..   
+00022190: 2020 2020 2020 2020 206c 696d 6974 203a           limit :
+000221a0: 204f 5054 494f 4e41 4c20 3a20 6e75 6d62   OPTIONAL : numb
+000221b0: 6572 206f 6620 7265 7375 6c74 2070 6572  er of result per
+000221c0: 2072 6571 7565 7374 2028 6465 6661 7574   request (defaut
+000221d0: 2031 3030 3029 0d0a 2020 2020 2020 2020   1000)..        
+000221e0: 2020 2020 6e5f 7265 7375 6c74 7320 3a20      n_results : 
+000221f0: 4f50 5449 4f4e 414c 203a 204e 756d 6265  OPTIONAL : Numbe
+00022200: 7220 6f66 2072 6573 756c 7420 7468 6174  r of result that
+00022210: 2079 6f75 2077 6f75 6c64 206c 696b 6520   you would like 
+00022220: 746f 2072 6574 7269 6576 652e 2028 6465  to retrieve. (de
+00022230: 6661 756c 7420 3130 3030 290d 0a20 2020  fault 1000)..   
+00022240: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+00022250: 796f 7520 7761 6e74 2074 6f20 6861 7665  you want to have
+00022260: 2061 6c6c 2070 6f73 7369 626c 6520 6461   all possible da
+00022270: 7461 2c20 7573 6520 2269 6e66 222e 0d0a  ta, use "inf"...
+00022280: 2020 2020 2020 2020 2020 2020 6974 656d              item
+00022290: 5f69 6420 3a20 4f50 5449 4f4e 414c 203a  _id : OPTIONAL :
+000222a0: 2042 6f6f 6c65 616e 2074 6f20 6465 6669   Boolean to defi
+000222b0: 6e65 2069 6620 796f 7520 7761 6e74 2074  ne if you want t
+000222c0: 6f20 7265 7475 726e 2074 6865 2069 7465  o return the ite
+000222d0: 6d20 6964 2066 6f72 2073 7562 2072 6571  m id for sub req
+000222e0: 7565 7374 7320 2864 6566 6175 6c74 2046  uests (default F
+000222f0: 616c 7365 290d 0a20 2020 2020 2020 2020  alse)..         
+00022300: 2020 2075 6e73 6166 6520 3a20 4f50 5449     unsafe : OPTI
+00022310: 4f4e 414c 203a 2049 6620 7365 7420 746f  ONAL : If set to
+00022320: 2054 7275 652c 2069 7420 7769 6c6c 206e   True, it will n
+00022330: 6f74 2063 6865 636b 2022 6c61 7374 5061  ot check "lastPa
+00022340: 6765 2220 7061 7261 6d65 7465 7220 616e  ge" parameter an
+00022350: 6420 6173 7375 6d65 2066 6972 7374 2072  d assume first r
+00022360: 6571 7565 7374 2069 7320 636f 6d70 6c65  equest is comple
+00022370: 7465 2e20 0d0a 2020 2020 2020 2020 2020  te. ..          
+00022380: 2020 2020 2020 5468 6973 206d 6179 2062        This may b
+00022390: 7265 616b 2074 6865 2073 6372 6970 7420  reak the script 
+000223a0: 6f72 2072 6574 7572 6e20 696e 636f 6d70  or return incomp
+000223b0: 6c65 7465 2064 6174 612e 2028 6465 6661  lete data. (defa
+000223c0: 756c 7420 4661 6c73 6529 2e0d 0a20 2020  ult False)...   
+000223d0: 2020 2020 2020 2020 2073 6176 6520 3a20           save : 
+000223e0: 4f50 5449 4f4e 414c 203a 2049 6620 796f  OPTIONAL : If yo
+000223f0: 7520 776f 756c 6420 6c69 6b65 2074 6f20  u would like to 
+00022400: 7361 7665 2074 6865 2064 6174 6120 7769  save the data wi
+00022410: 7468 696e 2061 2043 5356 2066 696c 652e  thin a CSV file.
+00022420: 2028 6465 6661 756c 7420 4661 6c73 6529   (default False)
+00022430: 0d0a 2020 2020 2020 2020 2020 2020 7665  ..            ve
+00022440: 7262 6f73 6520 3a20 4f50 5449 4f4e 414c  rbose : OPTIONAL
+00022450: 203a 2049 6620 796f 7520 7761 6e74 2074   : If you want t
+00022460: 6f20 6861 7665 2063 6f6d 6d65 6e74 7320  o have comments 
+00022470: 6469 7370 6c61 7965 6420 2864 6566 6175  displayed (defau
+00022480: 6c74 2046 616c 7365 290d 0a20 2020 2020  lt False)..     
+00022490: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
+000224a0: 2022 2222 0d0a 2020 2020 2020 2020 6966   """..        if
+000224b0: 2075 6e73 6166 6520 616e 6420 7665 7262   unsafe and verb
+000224c0: 6f73 653a 0d0a 2020 2020 2020 2020 2020  ose:..          
+000224d0: 2020 7072 696e 7428 272d 2d2d 2d20 7275    print('---- ru
+000224e0: 6e6e 696e 6720 7468 6520 6765 7452 6570  nning the getRep
+000224f0: 6f72 7420 696e 2022 756e 7361 6665 2220  ort in "unsafe" 
+00022500: 6d6f 6465 202d 2d2d 2d27 290d 0a20 2020  mode ----')..   
+00022510: 2020 2020 206f 626a 203d 207b 7d0d 0a20       obj = {}.. 
+00022520: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
+00022530: 2069 6620 6973 696e 7374 616e 6365 286a   if isinstance(j
+00022540: 736f 6e5f 7265 7175 6573 742c 5265 7175  son_request,Requ
+00022550: 6573 7443 7265 6174 6f72 293a 0d0a 2020  estCreator):..  
+00022560: 2020 2020 2020 2020 2020 7265 7175 6573            reques
+00022570: 7420 3d20 6a73 6f6e 5f72 6571 7565 7374  t = json_request
+00022580: 2e74 6f5f 6469 6374 2829 0d0a 2020 2020  .to_dict()..    
+00022590: 2020 2020 656c 6966 2074 7970 6528 6a73      elif type(js
+000225a0: 6f6e 5f72 6571 7565 7374 2920 3d3d 2064  on_request) == d
+000225b0: 6963 743a 0d0a 2020 2020 2020 2020 2020  ict:..          
+000225c0: 2020 7265 7175 6573 7420 3d20 6a73 6f6e    request = json
+000225d0: 5f72 6571 7565 7374 0d0a 2020 2020 2020  _request..      
+000225e0: 2020 656c 6966 2074 7970 6528 6a73 6f6e    elif type(json
+000225f0: 5f72 6571 7565 7374 2920 3d3d 2073 7472  _request) == str
+00022600: 2061 6e64 2027 2e6a 736f 6e27 206e 6f74   and '.json' not
+00022610: 2069 6e20 6a73 6f6e 5f72 6571 7565 7374   in json_request
+00022620: 3a0d 0a20 2020 2020 2020 2020 2020 2074  :..            t
+00022630: 7279 3a0d 0a20 2020 2020 2020 2020 2020  ry:..           
+00022640: 2020 2020 2072 6571 7565 7374 203d 206a       request = j
+00022650: 736f 6e2e 6c6f 6164 7328 6a73 6f6e 5f72  son.loads(json_r
+00022660: 6571 7565 7374 290d 0a20 2020 2020 2020  equest)..       
+00022670: 2020 2020 2065 7863 6570 743a 0d0a 2020       except:..  
+00022680: 2020 2020 2020 2020 2020 2020 2020 7261                ra
+00022690: 6973 6520 5479 7065 4572 726f 7228 2265  ise TypeError("e
+000226a0: 7870 6563 7465 6420 6120 7061 7273 6162  xpected a parsab
+000226b0: 6c65 2073 7472 696e 6722 290d 0a20 2020  le string")..   
+000226c0: 2020 2020 2065 6c69 6620 272e 6a73 6f6e       elif '.json
+000226d0: 2720 696e 206a 736f 6e5f 7265 7175 6573  ' in json_reques
+000226e0: 743a 0d0a 2020 2020 2020 2020 2020 2020  t:..            
+000226f0: 7472 793a 0d0a 2020 2020 2020 2020 2020  try:..          
+00022700: 2020 2020 2020 7769 7468 206f 7065 6e28        with open(
+00022710: 5061 7468 286a 736f 6e5f 7265 7175 6573  Path(json_reques
+00022720: 7429 2c20 2772 2729 2061 7320 6669 6c65  t), 'r') as file
+00022730: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+00022740: 2020 2020 2020 2066 696c 655f 7374 7269         file_stri
+00022750: 6e67 203d 2066 696c 652e 7265 6164 2829  ng = file.read()
 00022760: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00022770: 2020 7261 6973 6520 5479 7065 4572 726f    raise TypeErro
-00022780: 7228 2265 7870 6563 7465 6420 6120 7061  r("expected a pa
-00022790: 7273 6162 6c65 2073 7472 696e 6722 290d  rsable string").
-000227a0: 0a20 2020 2020 2020 2072 6571 7565 7374  .        request
-000227b0: 5b27 7365 7474 696e 6773 275d 5b27 6c69  ['settings']['li
-000227c0: 6d69 7427 5d20 3d20 6c69 6d69 740d 0a20  mit'] = limit.. 
-000227d0: 2020 2020 2020 2023 2069 6e66 6f20 666f         # info fo
-000227e0: 7220 6372 6561 7469 6e67 2072 6570 6f72  r creating repor
-000227f0: 740d 0a20 2020 2020 2020 2064 6174 615f  t..        data_
-00022800: 696e 666f 203d 2073 656c 662e 5f64 6174  info = self._dat
-00022810: 6144 6573 6372 6970 746f 7228 7265 7175  aDescriptor(requ
-00022820: 6573 7429 0d0a 2020 2020 2020 2020 6966  est)..        if
-00022830: 2076 6572 626f 7365 3a0d 0a20 2020 2020   verbose:..     
-00022840: 2020 2020 2020 2070 7269 6e74 2827 5265         print('Re
-00022850: 7175 6573 7420 6465 6372 7970 7465 6427  quest decrypted'
-00022860: 290d 0a20 2020 2020 2020 206f 626a 2e75  )..        obj.u
-00022870: 7064 6174 6528 6461 7461 5f69 6e66 6f29  pdate(data_info)
-00022880: 0d0a 2020 2020 2020 2020 616e 6f6d 616c  ..        anomal
-00022890: 7920 3d20 7265 7175 6573 745b 2773 6574  y = request['set
-000228a0: 7469 6e67 7327 5d2e 6765 7428 2769 6e63  tings'].get('inc
-000228b0: 6c75 6465 416e 6f6d 616c 7944 6574 6563  ludeAnomalyDetec
-000228c0: 7469 6f6e 272c 2046 616c 7365 290d 0a20  tion', False).. 
-000228d0: 2020 2020 2020 2063 6f6c 756d 6e73 203d         columns =
-000228e0: 205b 6461 7461 5f69 6e66 6f5b 2764 696d   [data_info['dim
-000228f0: 656e 7369 6f6e 275d 5d20 2b20 6461 7461  ension']] + data
-00022900: 5f69 6e66 6f5b 276d 6574 7269 6373 275d  _info['metrics']
-00022910: 0d0a 2020 2020 2020 2020 2320 7072 6570  ..        # prep
-00022920: 6172 696e 6720 666f 7220 7468 6520 6c6f  aring for the lo
-00022930: 6f70 0d0a 2020 2020 2020 2020 2320 696e  op..        # in
-00022940: 2063 6173 6520 2269 6e66 2220 6861 7320   case "inf" has 
-00022950: 6265 656e 2075 7365 642e 2054 7572 6e20  been used. Turn 
-00022960: 6974 2074 6f20 6120 6e75 6d62 6572 0d0a  it to a number..
-00022970: 2020 2020 2020 2020 6e5f 7265 7375 6c74          n_result
-00022980: 7320 3d20 6b77 6172 6773 2e67 6574 2827  s = kwargs.get('
-00022990: 6e5f 7265 7375 6c74 272c 6e5f 7265 7375  n_result',n_resu
-000229a0: 6c74 7329 0d0a 2020 2020 2020 2020 6e5f  lts)..        n_
-000229b0: 7265 7375 6c74 7320 3d20 666c 6f61 7428  results = float(
-000229c0: 6e5f 7265 7375 6c74 7329 0d0a 2020 2020  n_results)..    
-000229d0: 2020 2020 6966 206e 5f72 6573 756c 7473      if n_results
-000229e0: 2021 3d20 666c 6f61 7428 2769 6e66 2729   != float('inf')
-000229f0: 2061 6e64 206e 5f72 6573 756c 7473 203c   and n_results <
-00022a00: 2072 6571 7565 7374 5b27 7365 7474 696e   request['settin
-00022a10: 6773 275d 5b27 6c69 6d69 7427 5d3a 0d0a  gs']['limit']:..
-00022a20: 2020 2020 2020 2020 2020 2020 2320 6d61              # ma
-00022a30: 6b69 6e67 2073 7572 6520 7765 2064 6f6e  king sure we don
-00022a40: 2774 2063 616c 6c20 6d6f 7265 2074 6861  't call more tha
-00022a50: 6e20 7365 7420 696e 2077 7261 7070 6572  n set in wrapper
-00022a60: 0d0a 2020 2020 2020 2020 2020 2020 7265  ..            re
-00022a70: 7175 6573 745b 2773 6574 7469 6e67 7327  quest['settings'
-00022a80: 5d5b 276c 696d 6974 275d 203d 206e 5f72  ]['limit'] = n_r
-00022a90: 6573 756c 7473 0d0a 2020 2020 2020 2020  esults..        
-00022aa0: 6461 7461 5f6c 6973 7420 3d20 5b5d 0d0a  data_list = []..
-00022ab0: 2020 2020 2020 2020 6c61 7374 5f70 6167          last_pag
-00022ac0: 6520 3d20 4661 6c73 650d 0a20 2020 2020  e = False..     
-00022ad0: 2020 2070 6167 655f 6e62 2c20 636f 756e     page_nb, coun
-00022ae0: 745f 656c 656d 656e 7473 2c20 746f 7461  t_elements, tota
-00022af0: 6c5f 656c 656d 656e 7473 203d 2030 2c20  l_elements = 0, 
-00022b00: 302c 2030 0d0a 2020 2020 2020 2020 6966  0, 0..        if
-00022b10: 2076 6572 626f 7365 3a0d 0a20 2020 2020   verbose:..     
-00022b20: 2020 2020 2020 2070 7269 6e74 2827 5374         print('St
-00022b30: 6172 7469 6e67 2074 6f20 6665 7463 6820  arting to fetch 
-00022b40: 7468 6520 6461 7461 2e2e 2e27 290d 0a20  the data...').. 
-00022b50: 2020 2020 2020 2077 6869 6c65 206e 6f74         while not
-00022b60: 206c 6173 745f 7061 6765 3a0d 0a20 2020   last_page:..   
-00022b70: 2020 2020 2020 2020 2074 696d 6573 7461           timesta
-00022b80: 6d70 203d 2072 6f75 6e64 2874 696d 652e  mp = round(time.
-00022b90: 7469 6d65 2829 290d 0a20 2020 2020 2020  time())..       
-00022ba0: 2020 2020 2072 6571 7565 7374 5b27 7365       request['se
-00022bb0: 7474 696e 6773 275d 5b27 7061 6765 275d  ttings']['page']
-00022bc0: 203d 2070 6167 655f 6e62 0d0a 2020 2020   = page_nb..    
-00022bd0: 2020 2020 2020 2020 7265 706f 7274 203d          report =
-00022be0: 2073 656c 662e 636f 6e6e 6563 746f 722e   self.connector.
-00022bf0: 706f 7374 4461 7461 2873 656c 662e 656e  postData(self.en
-00022c00: 6470 6f69 6e74 5f63 6f6d 7061 6e79 202b  dpoint_company +
-00022c10: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00022c20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022c30: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-00022c40: 656c 662e 5f67 6574 5265 706f 7274 2c20  elf._getReport, 
-00022c50: 6461 7461 3d72 6571 7565 7374 2c20 6865  data=request, he
-00022c60: 6164 6572 733d 7365 6c66 2e68 6561 6465  aders=self.heade
-00022c70: 7229 0d0a 2020 2020 2020 2020 2020 2020  r)..            
-00022c80: 6966 2076 6572 626f 7365 3a0d 0a20 2020  if verbose:..   
-00022c90: 2020 2020 2020 2020 2020 2020 2070 7269               pri
-00022ca0: 6e74 2827 4461 7461 2072 6563 6569 7665  nt('Data receive
-00022cb0: 642e 2729 0d0a 2020 2020 2020 2020 2020  d.')..          
-00022cc0: 2020 2320 5265 6375 7273 696f 6e20 746f    # Recursion to
-00022cd0: 2074 616b 6520 6361 7265 206f 6620 7468   take care of th
-00022ce0: 726f 7474 6c69 6e67 206c 696d 6974 0d0a  rottling limit..
-00022cf0: 2020 2020 2020 2020 2020 2020 7768 696c              whil
-00022d00: 6520 7265 706f 7274 2e67 6574 2827 7374  e report.get('st
-00022d10: 6174 7573 5f63 6f64 6527 2c20 3230 3029  atus_code', 200)
-00022d20: 203d 3d20 3432 3920 6f72 2072 6570 6f72   == 429 or repor
-00022d30: 742e 6765 7428 2765 7272 6f72 5f63 6f64  t.get('error_cod
-00022d40: 6527 2c4e 6f6e 6529 203d 3d20 2234 3239  e',None) == "429
-00022d50: 3035 3022 3a0d 0a20 2020 2020 2020 2020  050":..         
-00022d60: 2020 2020 2020 2069 6620 7665 7262 6f73         if verbos
-00022d70: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
-00022d80: 2020 2020 2020 2020 7072 696e 7428 2772          print('r
-00022d90: 6561 6368 696e 6720 7468 6520 6c69 6d69  eaching the limi
-00022da0: 7420 3a20 7061 7573 6520 666f 7220 3530  t : pause for 50
-00022db0: 2073 2061 6e64 2065 6e74 6572 696e 6720   s and entering 
-00022dc0: 7265 6375 7273 696f 6e2e 2729 0d0a 2020  recursion.')..  
-00022dd0: 2020 2020 2020 2020 2020 2020 2020 6966                if
-00022de0: 2064 6562 7567 3a0d 0a20 2020 2020 2020   debug:..       
-00022df0: 2020 2020 2020 2020 2020 2020 2077 6974               wit
-00022e00: 6820 6f70 656e 2866 276c 696d 6974 5f72  h open(f'limit_r
-00022e10: 6561 6368 5f7b 7469 6d65 7374 616d 707d  each_{timestamp}
-00022e20: 2e6a 736f 6e27 2c20 2777 2729 2061 7320  .json', 'w') as 
-00022e30: 663a 0d0a 2020 2020 2020 2020 2020 2020  f:..            
-00022e40: 2020 2020 2020 2020 2020 2020 662e 7772              f.wr
-00022e50: 6974 6528 6a73 6f6e 2e64 756d 7073 2872  ite(json.dumps(r
-00022e60: 6570 6f72 742c 2069 6e64 656e 743d 3429  eport, indent=4)
-00022e70: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
-00022e80: 2020 2074 696d 652e 736c 6565 7028 3530     time.sleep(50
-00022e90: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
-00022ea0: 2020 2072 6570 6f72 7420 3d20 7365 6c66     report = self
-00022eb0: 2e63 6f6e 6e65 6374 6f72 2e70 6f73 7444  .connector.postD
-00022ec0: 6174 6128 7365 6c66 2e65 6e64 706f 696e  ata(self.endpoin
-00022ed0: 745f 636f 6d70 616e 7920 2b0d 0a20 2020  t_company +..   
-00022ee0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022ef0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022f00: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
-00022f10: 6765 7452 6570 6f72 742c 2064 6174 613d  getReport, data=
-00022f20: 7265 7175 6573 742c 2068 6561 6465 7273  request, headers
-00022f30: 3d73 656c 662e 6865 6164 6572 290d 0a20  =self.header).. 
-00022f40: 2020 2020 2020 2020 2020 2069 6620 276c             if 'l
-00022f50: 6173 7450 6167 6527 206e 6f74 2069 6e20  astPage' not in 
-00022f60: 7265 706f 7274 2061 6e64 2075 6e73 6166  report and unsaf
-00022f70: 6520 3d3d 2046 616c 7365 3a20 2023 2063  e == False:  # c
-00022f80: 6865 636b 696e 6720 6572 726f 7220 7768  hecking error wh
-00022f90: 656e 206e 6f20 6c61 7374 5061 6765 206b  en no lastPage k
-00022fa0: 6579 2069 6e20 7265 706f 7274 0d0a 2020  ey in report..  
-00022fb0: 2020 2020 2020 2020 2020 2020 2020 6966                if
-00022fc0: 2076 6572 626f 7365 3a0d 0a20 2020 2020   verbose:..     
-00022fd0: 2020 2020 2020 2020 2020 2020 2020 2070                 p
-00022fe0: 7269 6e74 286a 736f 6e2e 6475 6d70 7328  rint(json.dumps(
-00022ff0: 7265 706f 7274 2c20 696e 6465 6e74 3d32  report, indent=2
-00023000: 2929 0d0a 2020 2020 2020 2020 2020 2020  ))..            
-00023010: 2020 2020 7072 696e 7428 2757 6172 6e69      print('Warni
-00023020: 6e67 203a 2053 6572 7665 7220 4572 726f  ng : Server Erro
-00023030: 7227 290d 0a20 2020 2020 2020 2020 2020  r')..           
-00023040: 2020 2020 2070 7269 6e74 286a 736f 6e2e       print(json.
-00023050: 6475 6d70 7328 7265 706f 7274 2929 0d0a  dumps(report))..
-00023060: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023070: 6966 2064 6562 7567 3a0d 0a20 2020 2020  if debug:..     
-00023080: 2020 2020 2020 2020 2020 2020 2020 2077                 w
-00023090: 6974 6820 6f70 656e 2866 2773 6572 7665  ith open(f'serve
-000230a0: 725f 6661 696c 7572 655f 7265 7175 6573  r_failure_reques
-000230b0: 745f 7b74 696d 6573 7461 6d70 7d2e 6a73  t_{timestamp}.js
-000230c0: 6f6e 272c 2027 7727 2920 6173 2066 3a0d  on', 'w') as f:.
-000230d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000230e0: 2020 2020 2020 2020 2066 2e77 7269 7465           f.write
-000230f0: 286a 736f 6e2e 6475 6d70 7328 7265 7175  (json.dumps(requ
-00023100: 6573 742c 2069 6e64 656e 743d 3429 290d  est, indent=4)).
-00023110: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00023120: 2020 2020 2077 6974 6820 6f70 656e 2866       with open(f
-00023130: 2773 6572 7665 725f 6661 696c 7572 655f  'server_failure_
-00023140: 7265 7370 6f6e 7365 5f7b 7469 6d65 7374  response_{timest
-00023150: 616d 707d 2e6a 736f 6e27 2c20 2777 2729  amp}.json', 'w')
-00023160: 2061 7320 663a 0d0a 2020 2020 2020 2020   as f:..        
-00023170: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023180: 662e 7772 6974 6528 6a73 6f6e 2e64 756d  f.write(json.dum
-00023190: 7073 2872 6570 6f72 742c 2069 6e64 656e  ps(report, inden
-000231a0: 743d 3429 290d 0a20 2020 2020 2020 2020  t=4))..         
-000231b0: 2020 2020 2020 2020 2020 2070 7269 6e74             print
-000231c0: 280d 0a20 2020 2020 2020 2020 2020 2020  (..             
-000231d0: 2020 2020 2020 2020 2020 2066 2757 6172             f'War
-000231e0: 6e69 6e67 203a 2053 6176 6520 4a53 4f4e  ning : Save JSON
-000231f0: 2072 6571 7565 7374 203a 2073 6572 7665   request : serve
-00023200: 725f 6661 696c 7572 655f 7265 7175 6573  r_failure_reques
-00023210: 745f 7b74 696d 6573 7461 6d70 7d2e 6a73  t_{timestamp}.js
-00023220: 6f6e 2729 0d0a 2020 2020 2020 2020 2020  on')..          
-00023230: 2020 2020 2020 2020 2020 7072 696e 7428            print(
-00023240: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00023250: 2020 2020 2020 2020 2020 6627 5761 726e            f'Warn
-00023260: 696e 6720 3a20 5361 7665 204a 534f 4e20  ing : Save JSON 
-00023270: 7265 7370 6f6e 7365 203a 2073 6572 7665  response : serve
-00023280: 725f 6661 696c 7572 655f 7265 7370 6f6e  r_failure_respon
-00023290: 7365 5f7b 7469 6d65 7374 616d 707d 2e6a  se_{timestamp}.j
-000232a0: 736f 6e27 290d 0a20 2020 2020 2020 2020  son')..         
-000232b0: 2020 2020 2020 206f 626a 5b27 6461 7461         obj['data
-000232c0: 275d 203d 2070 642e 4461 7461 4672 616d  '] = pd.DataFram
-000232d0: 6528 290d 0a20 2020 2020 2020 2020 2020  e()..           
-000232e0: 2020 2020 2072 6574 7572 6e20 6f62 6a0d       return obj.
-000232f0: 0a20 2020 2020 2020 2020 2020 2023 2066  .            # f
-00023300: 616c 6c62 6163 6b20 7768 656e 206e 6f20  allback when no 
-00023310: 6c61 7374 5061 6765 2069 6e20 7265 706f  lastPage in repo
-00023320: 7274 0d0a 2020 2020 2020 2020 2020 2020  rt..            
-00023330: 6c61 7374 5f70 6167 6520 3d20 7265 706f  last_page = repo
-00023340: 7274 2e67 6574 2827 6c61 7374 5061 6765  rt.get('lastPage
-00023350: 272c 2054 7275 6529 0d0a 2020 2020 2020  ', True)..      
-00023360: 2020 2020 2020 6966 2076 6572 626f 7365        if verbose
-00023370: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-00023380: 2020 2070 7269 6e74 2866 276c 6173 7420     print(f'last 
-00023390: 7061 6765 2073 7461 7475 7320 3a20 7b6c  page status : {l
-000233a0: 6173 745f 7061 6765 7d27 290d 0a20 2020  ast_page}')..   
-000233b0: 2020 2020 2020 2020 2069 6620 2765 7272           if 'err
-000233c0: 6f72 436f 6465 2720 696e 2072 6570 6f72  orCode' in repor
-000233d0: 742e 6b65 7973 2829 3a0d 0a20 2020 2020  t.keys():..     
-000233e0: 2020 2020 2020 2020 2020 2070 7269 6e74             print
-000233f0: 2827 4572 726f 7220 7769 7468 2079 6f75  ('Error with you
-00023400: 7220 7374 6174 656d 656e 7420 5c6e 2720  r statement \n' 
-00023410: 2b0d 0a20 2020 2020 2020 2020 2020 2020  +..             
-00023420: 2020 2020 2020 2020 2072 6570 6f72 745b           report[
-00023430: 2765 7272 6f72 4465 7363 7269 7074 696f  'errorDescriptio
-00023440: 6e27 5d29 0d0a 2020 2020 2020 2020 2020  n'])..          
-00023450: 2020 2020 2020 7265 7475 726e 207b 7265        return {re
-00023460: 706f 7274 5b27 6572 726f 7243 6f64 6527  port['errorCode'
-00023470: 5d3a 2072 6570 6f72 745b 2765 7272 6f72  ]: report['error
-00023480: 4465 7363 7269 7074 696f 6e27 5d7d 0d0a  Description']}..
-00023490: 2020 2020 2020 2020 2020 2020 636f 756e              coun
-000234a0: 745f 656c 656d 656e 7473 202b 3d20 7265  t_elements += re
-000234b0: 706f 7274 2e67 6574 2827 6e75 6d62 6572  port.get('number
-000234c0: 4f66 456c 656d 656e 7473 272c 2030 290d  OfElements', 0).
-000234d0: 0a20 2020 2020 2020 2020 2020 2074 6f74  .            tot
-000234e0: 616c 5f65 6c65 6d65 6e74 7320 3d20 7265  al_elements = re
-000234f0: 706f 7274 2e67 6574 280d 0a20 2020 2020  port.get(..     
-00023500: 2020 2020 2020 2020 2020 2027 746f 7461             'tota
-00023510: 6c45 6c65 6d65 6e74 7327 2c20 7265 7175  lElements', requ
-00023520: 6573 745b 2773 6574 7469 6e67 7327 5d5b  est['settings'][
-00023530: 276c 696d 6974 275d 290d 0a20 2020 2020  'limit'])..     
-00023540: 2020 2020 2020 2069 6620 746f 7461 6c5f         if total_
-00023550: 656c 656d 656e 7473 203d 3d20 303a 0d0a  elements == 0:..
-00023560: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023570: 6f62 6a5b 2764 6174 6127 5d20 3d20 7064  obj['data'] = pd
-00023580: 2e44 6174 6146 7261 6d65 2829 0d0a 2020  .DataFrame()..  
-00023590: 2020 2020 2020 2020 2020 2020 2020 7072                pr
-000235a0: 696e 7428 0d0a 2020 2020 2020 2020 2020  int(..          
-000235b0: 2020 2020 2020 2020 2020 2757 6172 6e69            'Warni
-000235c0: 6e67 203a 204e 6f20 6461 7461 2072 6574  ng : No data ret
-000235d0: 7572 6e65 6420 2620 6c61 7374 5061 6765  urned & lastPage
-000235e0: 2069 7320 4661 6c73 652e 5c6e 4578 6974   is False.\nExit
-000235f0: 2074 6865 206c 6f6f 7020 2d20 6e6f 2073   the loop - no s
-00023600: 6176 6520 6669 6c65 2026 2065 6d70 7479  ave file & empty
-00023610: 2064 6174 6166 7261 6d65 2e27 290d 0a20   dataframe.').. 
-00023620: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00023630: 6620 6465 6275 673a 0d0a 2020 2020 2020  f debug:..      
-00023640: 2020 2020 2020 2020 2020 2020 2020 7769                wi
-00023650: 7468 206f 7065 6e28 6627 7265 706f 7274  th open(f'report
-00023660: 5f6e 6f5f 656c 656d 656e 745f 7b74 696d  _no_element_{tim
-00023670: 6573 7461 6d70 7d2e 6a73 6f6e 272c 2027  estamp}.json', '
-00023680: 7727 2920 6173 2066 3a0d 0a20 2020 2020  w') as f:..     
-00023690: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000236a0: 2020 2066 2e77 7269 7465 286a 736f 6e2e     f.write(json.
-000236b0: 6475 6d70 7328 7265 706f 7274 2c20 696e  dumps(report, in
-000236c0: 6465 6e74 3d34 2929 0d0a 2020 2020 2020  dent=4))..      
-000236d0: 2020 2020 2020 2020 2020 6966 2076 6572            if ver
-000236e0: 626f 7365 3a0d 0a20 2020 2020 2020 2020  bose:..         
-000236f0: 2020 2020 2020 2020 2020 2070 7269 6e74             print
-00023700: 280d 0a20 2020 2020 2020 2020 2020 2020  (..             
-00023710: 2020 2020 2020 2020 2020 2066 2725 206f             f'% o
-00023720: 6620 746f 7461 6c20 656c 656d 656e 7473  f total elements
-00023730: 2072 6574 7269 6576 6564 2e20 546f 7461   retrieved. Tota
-00023740: 6c45 6c65 6d65 6e74 733a 207b 7265 706f  lElements: {repo
-00023750: 7274 2e67 6574 2822 746f 7461 6c45 6c65  rt.get("totalEle
-00023760: 6d65 6e74 7322 2c20 226e 6f20 6461 7461  ments", "no data
-00023770: 2229 7d27 290d 0a20 2020 2020 2020 2020  ")}')..         
-00023780: 2020 2020 2020 2072 6574 7572 6e20 6f62         return ob
-00023790: 6a20 2023 2069 6e20 6361 7365 206c 6f6f  j  # in case loo
-000237a0: 7020 6861 7070 656e 696e 6720 7769 7468  p happening with
-000237b0: 2065 6d70 7479 2064 6174 612c 2072 6574   empty data, ret
-000237c0: 7572 6e73 2065 6d70 7479 2064 6174 610d  urns empty data.
-000237d0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-000237e0: 7665 7262 6f73 6520 616e 6420 746f 7461  verbose and tota
-000237f0: 6c5f 656c 656d 656e 7473 2021 3d20 303a  l_elements != 0:
-00023800: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00023810: 2020 7072 696e 7428 0d0a 2020 2020 2020    print(..      
-00023820: 2020 2020 2020 2020 2020 2020 2020 6627                f'
-00023830: 2520 6f66 2074 6f74 616c 2065 6c65 6d65  % of total eleme
-00023840: 6e74 7320 7265 7472 6965 7665 643a 207b  nts retrieved: {
-00023850: 726f 756e 6428 2863 6f75 6e74 5f65 6c65  round((count_ele
-00023860: 6d65 6e74 7320 2f20 746f 7461 6c5f 656c  ments / total_el
-00023870: 656d 656e 7473 2920 2a20 3130 302c 2032  ements) * 100, 2
-00023880: 297d 2025 2729 0d0a 2020 2020 2020 2020  )} %')..        
-00023890: 2020 2020 6966 206c 6173 745f 7061 6765      if last_page
-000238a0: 203d 3d20 4661 6c73 6520 616e 6420 6e5f   == False and n_
-000238b0: 7265 7375 6c74 7320 213d 2066 6c6f 6174  results != float
-000238c0: 2827 696e 6627 293a 0d0a 2020 2020 2020  ('inf'):..      
-000238d0: 2020 2020 2020 2020 2020 6966 2063 6f75            if cou
-000238e0: 6e74 5f65 6c65 6d65 6e74 7320 3e3d 206e  nt_elements >= n
-000238f0: 5f72 6573 756c 7473 3a0d 0a20 2020 2020  _results:..     
-00023900: 2020 2020 2020 2020 2020 2020 2020 206c                 l
-00023910: 6173 745f 7061 6765 203d 2054 7275 650d  ast_page = True.
-00023920: 0a20 2020 2020 2020 2020 2020 2064 6174  .            dat
-00023930: 6120 3d20 7265 706f 7274 5b27 726f 7773  a = report['rows
-00023940: 275d 0d0a 2020 2020 2020 2020 2020 2020  ']..            
-00023950: 6461 7461 5f6c 6973 7420 2b3d 2064 6565  data_list += dee
-00023960: 7063 6f70 7928 6461 7461 2920 2023 2064  pcopy(data)  # d
-00023970: 6f20 6120 6465 6570 636f 7079 0d0a 2020  o a deepcopy..  
-00023980: 2020 2020 2020 2020 2020 7061 6765 5f6e            page_n
-00023990: 6220 2b3d 2031 0d0a 2020 2020 2020 2020  b += 1..        
-000239a0: 2020 2020 6966 2076 6572 626f 7365 3a0d      if verbose:.
-000239b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000239c0: 2070 7269 6e74 2866 2723 206f 6620 7265   print(f'# of re
-000239d0: 7175 6573 7473 203a 207b 7061 6765 5f6e  quests : {page_n
-000239e0: 627d 2729 0d0a 2020 2020 2020 2020 2320  b}')..        # 
-000239f0: 7265 7475 726e 2072 6570 6f72 740d 0a20  return report.. 
-00023a00: 2020 2020 2020 2064 6620 3d20 7365 6c66         df = self
-00023a10: 2e5f 7265 6164 4461 7461 2864 6174 615f  ._readData(data_
-00023a20: 6c69 7374 2c20 616e 6f6d 616c 793d 616e  list, anomaly=an
-00023a30: 6f6d 616c 792c 0d0a 2020 2020 2020 2020  omaly,..        
-00023a40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023a50: 2020 2020 636f 6c73 3d63 6f6c 756d 6e73      cols=columns
-00023a60: 2c20 6974 656d 5f69 643d 6974 656d 5f69  , item_id=item_i
-00023a70: 6429 0d0a 2020 2020 2020 2020 6966 2073  d)..        if s
-00023a80: 6176 653a 0d0a 2020 2020 2020 2020 2020  ave:..          
-00023a90: 2020 7469 6d65 7374 616d 7052 6570 6f72    timestampRepor
-00023aa0: 7420 3d20 726f 756e 6428 7469 6d65 2e74  t = round(time.t
-00023ab0: 696d 6528 2929 0d0a 2020 2020 2020 2020  ime())..        
-00023ac0: 2020 2020 6466 2e74 6f5f 6373 7628 6627      df.to_csv(f'
-00023ad0: 7265 706f 7274 2d7b 7469 6d65 7374 616d  report-{timestam
-00023ae0: 7052 6570 6f72 747d 2e63 7376 272c 2069  pReport}.csv', i
-00023af0: 6e64 6578 3d46 616c 7365 290d 0a20 2020  ndex=False)..   
-00023b00: 2020 2020 2020 2020 2069 6620 7665 7262           if verb
-00023b10: 6f73 653a 0d0a 2020 2020 2020 2020 2020  ose:..          
-00023b20: 2020 2020 2020 7072 696e 7428 0d0a 2020        print(..  
-00023b30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023b40: 2020 6627 5361 7669 6e67 2064 6174 6120    f'Saving data 
-00023b50: 696e 2066 696c 6520 3a20 7b6f 732e 6765  in file : {os.ge
-00023b60: 7463 7764 2829 7d7b 6f73 2e73 6570 7d72  tcwd()}{os.sep}r
-00023b70: 6570 6f72 742d 7b74 696d 6573 7461 6d70  eport-{timestamp
-00023b80: 5265 706f 7274 7d2e 6373 7627 290d 0a20  Report}.csv').. 
-00023b90: 2020 2020 2020 206f 626a 5b27 6461 7461         obj['data
-00023ba0: 275d 203d 2064 660d 0a20 2020 2020 2020  '] = df..       
-00023bb0: 2069 6620 7665 7262 6f73 653a 0d0a 2020   if verbose:..  
-00023bc0: 2020 2020 2020 2020 2020 7072 696e 7428            print(
-00023bd0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00023be0: 2020 6627 5265 706f 7274 2063 6f6e 7461    f'Report conta
-00023bf0: 696e 7320 7b28 636f 756e 745f 656c 656d  ins {(count_elem
-00023c00: 656e 7473 202f 2074 6f74 616c 5f65 6c65  ents / total_ele
-00023c10: 6d65 6e74 7329 202a 2031 3030 7d20 2520  ments) * 100} % 
-00023c20: 6f66 2074 6865 2061 7661 696c 6162 6c65  of the available
-00023c30: 2064 696d 656e 7369 6f6e 7327 290d 0a20   dimensions').. 
-00023c40: 2020 2020 2020 2072 6574 7572 6e20 6f62         return ob
-00023c50: 6a0d 0a20 2020 200d 0a20 2020 2064 6566  j..    ..    def
-00023c60: 205f 7072 6570 6172 6544 6174 6128 0d0a   _prepareData(..
-00023c70: 2020 2020 2020 2020 7365 6c66 2c0d 0a20          self,.. 
-00023c80: 2020 2020 2020 2064 6174 6152 6f77 733a         dataRows:
-00023c90: 206c 6973 7420 3d20 4e6f 6e65 2c0d 0a20   list = None,.. 
-00023ca0: 2020 2020 2020 2072 6570 6f72 7454 7970         reportTyp
-00023cb0: 653a 2073 7472 203d 2022 6e6f 726d 616c  e: str = "normal
-00023cc0: 222c 0d0a 2020 2020 2920 2d3e 2064 6963  ",..    ) -> dic
-00023cd0: 743a 0d0a 2020 2020 2020 2020 2222 220d  t:..        """.
-00023ce0: 0a20 2020 2020 2020 2052 6561 6420 7468  .        Read th
-00023cf0: 6520 6461 7461 2072 6574 7572 6e65 6420  e data returned 
-00023d00: 6279 2074 6865 2067 6574 5265 706f 7274  by the getReport
-00023d10: 2061 6e64 2072 6574 7572 6e73 2061 2064   and returns a d
-00023d20: 6963 7469 6f6e 6172 7920 7573 6564 2062  ictionary used b
-00023d30: 7920 7468 6520 576f 726b 7370 6163 6520  y the Workspace 
-00023d40: 636c 6173 732e 0d0a 2020 2020 2020 2020  class...        
-00023d50: 4172 6775 6d65 6e74 733a 0d0a 2020 2020  Arguments:..    
-00023d60: 2020 2020 2020 2020 6461 7461 526f 7773          dataRows
-00023d70: 203a 2052 4551 5549 5245 4420 3a20 6461   : REQUIRED : da
-00023d80: 7461 2072 6f77 7320 6461 7461 2066 726f  ta rows data fro
-00023d90: 6d20 434a 4120 4150 4920 6765 7452 6570  m CJA API getRep
-00023da0: 6f72 740d 0a20 2020 2020 2020 2020 2020  ort..           
-00023db0: 2072 6570 6f72 7454 7970 6520 3a20 5245   reportType : RE
-00023dc0: 5155 4952 4544 203a 2022 6e6f 726d 616c  QUIRED : "normal
-00023dd0: 2220 6f72 2022 7374 6174 6963 220d 0a20  " or "static".. 
-00023de0: 2020 2020 2020 2022 2222 0d0a 2020 2020         """..    
-00023df0: 2020 2020 6966 2064 6174 6152 6f77 7320      if dataRows 
-00023e00: 6973 204e 6f6e 653a 0d0a 2020 2020 2020  is None:..      
-00023e10: 2020 2020 2020 7261 6973 6520 5661 6c75        raise Valu
-00023e20: 6545 7272 6f72 2822 5265 7175 6972 6520  eError("Require 
-00023e30: 6461 7461 526f 7773 2229 0d0a 2020 2020  dataRows")..    
-00023e40: 2020 2020 6461 7461 5f72 6f77 7320 3d20      data_rows = 
-00023e50: 6465 6570 636f 7079 2864 6174 6152 6f77  deepcopy(dataRow
-00023e60: 7329 0d0a 2020 2020 2020 2020 6578 7061  s)..        expa
-00023e70: 6e64 6564 5f72 6f77 7320 3d20 7b7d 0d0a  nded_rows = {}..
-00023e80: 2020 2020 2020 2020 6966 2072 6570 6f72          if repor
-00023e90: 7454 7970 6520 3d3d 2022 6e6f 726d 616c  tType == "normal
-00023ea0: 223a 0d0a 2020 2020 2020 2020 2020 2020  ":..            
-00023eb0: 666f 7220 726f 7720 696e 2064 6174 615f  for row in data_
-00023ec0: 726f 7773 3a0d 0a20 2020 2020 2020 2020  rows:..         
-00023ed0: 2020 2020 2020 2065 7870 616e 6465 645f         expanded_
-00023ee0: 726f 7773 5b72 6f77 5b22 6974 656d 4964  rows[row["itemId
-00023ef0: 225d 5d20 3d20 5b72 6f77 5b22 7661 6c75  "]] = [row["valu
-00023f00: 6522 5d5d 0d0a 2020 2020 2020 2020 2020  e"]]..          
-00023f10: 2020 2020 2020 6578 7061 6e64 6564 5f72        expanded_r
-00023f20: 6f77 735b 726f 775b 2269 7465 6d49 6422  ows[row["itemId"
-00023f30: 5d5d 202b 3d20 726f 775b 2264 6174 6122  ]] += row["data"
-00023f40: 5d0d 0a20 2020 2020 2020 2065 6c69 6620  ]..        elif 
-00023f50: 7265 706f 7274 5479 7065 203d 3d20 2273  reportType == "s
-00023f60: 7461 7469 6322 3a0d 0a20 2020 2020 2020  tatic":..       
-00023f70: 2020 2020 2065 7870 616e 6465 645f 726f       expanded_ro
-00023f80: 7773 203d 2064 6174 615f 726f 7773 0d0a  ws = data_rows..
-00023f90: 2020 2020 2020 2020 7265 7475 726e 2065          return e
-00023fa0: 7870 616e 6465 645f 726f 7773 0d0a 0d0a  xpanded_rows....
-00023fb0: 2020 2020 6465 6620 5f64 6563 7279 7074      def _decrypt
-00023fc0: 6553 7461 7469 6344 6174 6128 0d0a 2020  eStaticData(..  
-00023fd0: 2020 2020 2020 7365 6c66 2c20 6461 7461        self, data
-00023fe0: 5265 7175 6573 743a 2064 6963 7420 3d20  Request: dict = 
-00023ff0: 4e6f 6e65 2c20 7265 7370 6f6e 7365 3a20  None, response: 
-00024000: 6469 6374 203d 204e 6f6e 650d 0a20 2020  dict = None..   
-00024010: 2029 202d 3e20 6469 6374 3a0d 0a20 2020   ) -> dict:..   
-00024020: 2020 2020 2022 2222 0d0a 2020 2020 2020       """..      
-00024030: 2020 4672 6f6d 2074 6865 2072 6571 7565    From the reque
-00024040: 7374 2064 6963 7469 6f6e 6172 7920 616e  st dictionary an
-00024050: 6420 7468 6520 7265 7370 6f6e 7365 2c20  d the response, 
-00024060: 6465 6372 7970 7465 2074 6865 2064 6174  decrypte the dat
-00024070: 6120 746f 2073 7461 6e64 6172 6469 7365  a to standardise
-00024080: 2074 6865 2072 6561 6469 6e67 2e0d 0a20   the reading... 
-00024090: 2020 2020 2020 2022 2222 0d0a 2020 2020         """..    
-000240a0: 2020 2020 6461 7461 526f 7773 203d 205b      dataRows = [
-000240b0: 5d0d 0a20 2020 2020 2020 2023 2320 7265  ]..        ## re
-000240c0: 7472 6965 7665 2053 7461 7469 6352 6f77  trieve StaticRow
-000240d0: 2049 4420 616e 6420 7365 676d 656e 7449   ID and segmentI
-000240e0: 440d 0a20 2020 2020 2020 2069 6620 6c65  D..        if le
-000240f0: 6e28 5b6d 6574 7269 6320 666f 7220 6d65  n([metric for me
-00024100: 7472 6963 2069 6e20 6461 7461 5265 7175  tric in dataRequ
-00024110: 6573 745b 276d 6574 7269 6343 6f6e 7461  est['metricConta
-00024120: 696e 6572 275d 2e67 6574 2827 6d65 7472  iner'].get('metr
-00024130: 6963 4669 6c74 6572 7327 2c5b 5d29 2069  icFilters',[]) i
-00024140: 6620 6d65 7472 6963 2e67 6574 2827 6964  f metric.get('id
-00024150: 272c 2727 292e 7374 6172 7473 7769 7468  ','').startswith
-00024160: 2822 5354 4154 4943 5f52 4f57 5f43 4f4d  ("STATIC_ROW_COM
-00024170: 504f 4e45 4e54 2229 5d29 3e30 3a0d 0a20  PONENT")])>0:.. 
-00024180: 2020 2020 2020 2020 2020 2069 6620 2022             if  "
-00024190: 6461 7465 5261 6e67 6522 2069 6e20 6c69  dateRange" in li
-000241a0: 7374 2864 6174 6152 6571 7565 7374 5b27  st(dataRequest['
-000241b0: 6d65 7472 6963 436f 6e74 6169 6e65 7227  metricContainer'
-000241c0: 5d2e 6765 7428 276d 6574 7269 6346 696c  ].get('metricFil
-000241d0: 7465 7273 272c 5b5d 295b 305d 2e6b 6579  ters',[])[0].key
-000241e0: 7328 2929 3a0d 0a20 2020 2020 2020 2020  s()):..         
-000241f0: 2020 2020 2020 2074 6162 6c65 5365 676d         tableSegm
-00024200: 656e 7473 526f 7773 203d 207b 0d0a 2020  entsRows = {..  
-00024210: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00024220: 2020 6f62 6a5b 2269 6422 5d3a 206f 626a    obj["id"]: obj
-00024230: 5b22 6461 7465 5261 6e67 6522 5d0d 0a20  ["dateRange"].. 
-00024240: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00024250: 2020 2066 6f72 206f 626a 2069 6e20 6461     for obj in da
-00024260: 7461 5265 7175 6573 745b 226d 6574 7269  taRequest["metri
-00024270: 6343 6f6e 7461 696e 6572 225d 5b22 6d65  cContainer"]["me
-00024280: 7472 6963 4669 6c74 6572 7322 5d0d 0a20  tricFilters"].. 
-00024290: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000242a0: 2020 2069 6620 6f62 6a5b 2269 6422 5d2e     if obj["id"].
-000242b0: 7374 6172 7473 7769 7468 2822 5354 4154  startswith("STAT
-000242c0: 4943 5f52 4f57 5f43 4f4d 504f 4e45 4e54  IC_ROW_COMPONENT
-000242d0: 2229 0d0a 2020 2020 2020 2020 2020 2020  ")..            
-000242e0: 2020 2020 7d0d 0a20 2020 2020 2020 2020      }..         
-000242f0: 2020 2065 6c69 6620 2273 6567 6d65 6e74     elif "segment
-00024300: 4964 2220 696e 206c 6973 7428 6461 7461  Id" in list(data
-00024310: 5265 7175 6573 745b 276d 6574 7269 6343  Request['metricC
-00024320: 6f6e 7461 696e 6572 275d 2e67 6574 2827  ontainer'].get('
-00024330: 6d65 7472 6963 4669 6c74 6572 7327 2c5b  metricFilters',[
-00024340: 5d29 5b30 5d2e 6b65 7973 2829 293a 0d0a  ])[0].keys()):..
-00024350: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00024360: 7461 626c 6553 6567 6d65 6e74 7352 6f77  tableSegmentsRow
-00024370: 7320 3d20 7b0d 0a20 2020 2020 2020 2020  s = {..         
-00024380: 2020 2020 2020 2020 2020 206f 626a 5b22             obj["
-00024390: 6964 225d 3a20 6f62 6a5b 2273 6567 6d65  id"]: obj["segme
-000243a0: 6e74 4964 225d 0d0a 2020 2020 2020 2020  ntId"]..        
-000243b0: 2020 2020 2020 2020 2020 2020 666f 7220              for 
-000243c0: 6f62 6a20 696e 2064 6174 6152 6571 7565  obj in dataReque
-000243d0: 7374 5b22 6d65 7472 6963 436f 6e74 6169  st["metricContai
-000243e0: 6e65 7222 5d5b 226d 6574 7269 6346 696c  ner"]["metricFil
-000243f0: 7465 7273 225d 0d0a 2020 2020 2020 2020  ters"]..        
-00024400: 2020 2020 2020 2020 2020 2020 6966 206f              if o
-00024410: 626a 5b22 6964 225d 2e73 7461 7274 7377  bj["id"].startsw
-00024420: 6974 6828 2253 5441 5449 435f 524f 575f  ith("STATIC_ROW_
-00024430: 434f 4d50 4f4e 454e 5422 290d 0a20 2020  COMPONENT")..   
-00024440: 2020 2020 2020 2020 2020 2020 207d 0d0a               }..
-00024450: 2020 2020 2020 2020 656c 7365 3a0d 0a20          else:.. 
-00024460: 2020 2020 2020 2020 2020 2074 6162 6c65             table
-00024470: 5365 676d 656e 7473 526f 7773 203d 207b  SegmentsRows = {
-00024480: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00024490: 2020 6f62 6a5b 2269 6422 5d3a 206f 626a    obj["id"]: obj
-000244a0: 5b22 7365 676d 656e 7449 6422 5d0d 0a20  ["segmentId"].. 
-000244b0: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-000244c0: 6f72 206f 626a 2069 6e20 6461 7461 5265  or obj in dataRe
-000244d0: 7175 6573 745b 226d 6574 7269 6343 6f6e  quest["metricCon
-000244e0: 7461 696e 6572 225d 5b22 6d65 7472 6963  tainer"]["metric
-000244f0: 4669 6c74 6572 7322 5d0d 0a20 2020 2020  Filters"]..     
-00024500: 2020 2020 2020 207d 0d0a 2020 2020 2020         }..      
-00024510: 2020 2323 2072 6574 7269 6576 6520 706c    ## retrieve pl
-00024520: 6163 6520 616e 6420 7365 676d 656e 7449  ace and segmentI
-00024530: 440d 0a20 2020 2020 2020 2073 6567 6d65  D..        segme
-00024540: 6e74 4170 706c 6965 6420 3d20 7b7d 0d0a  ntApplied = {}..
-00024550: 2020 2020 2020 2020 666f 7220 6f62 6a20          for obj 
-00024560: 696e 2064 6174 6152 6571 7565 7374 5b22  in dataRequest["
-00024570: 6d65 7472 6963 436f 6e74 6169 6e65 7222  metricContainer"
-00024580: 5d5b 226d 6574 7269 6346 696c 7465 7273  ]["metricFilters
-00024590: 225d 3a0d 0a20 2020 2020 2020 2020 2020  "]:..           
-000245a0: 2069 6620 6f62 6a5b 2269 6422 5d2e 7374   if obj["id"].st
-000245b0: 6172 7473 7769 7468 2822 5354 4154 4943  artswith("STATIC
-000245c0: 5f52 4f57 2229 203d 3d20 4661 6c73 653a  _ROW") == False:
-000245d0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-000245e0: 2020 6966 206f 626a 5b22 7479 7065 225d    if obj["type"]
-000245f0: 203d 3d20 2262 7265 616b 646f 776e 223a   == "breakdown":
-00024600: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00024610: 2020 2020 2020 7365 676d 656e 7441 7070        segmentApp
-00024620: 6c69 6564 5b6f 626a 5b22 6964 225d 5d20  lied[obj["id"]] 
-00024630: 3d20 6622 7b6f 626a 5b27 6469 6d65 6e73  = f"{obj['dimens
-00024640: 696f 6e27 5d7d 3a3a 3a7b 6f62 6a5b 2769  ion']}:::{obj['i
-00024650: 7465 6d49 6427 5d7d 220d 0a20 2020 2020  temId']}"..     
-00024660: 2020 2020 2020 2020 2020 2065 6c69 6620             elif 
-00024670: 6f62 6a5b 2274 7970 6522 5d20 3d3d 2022  obj["type"] == "
-00024680: 7365 676d 656e 7422 3a0d 0a20 2020 2020  segment":..     
-00024690: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-000246a0: 6567 6d65 6e74 4170 706c 6965 645b 6f62  egmentApplied[ob
-000246b0: 6a5b 2269 6422 5d5d 203d 206f 626a 5b22  j["id"]] = obj["
-000246c0: 7365 676d 656e 7449 6422 5d0d 0a20 2020  segmentId"]..   
-000246d0: 2020 2020 2020 2020 2020 2020 2065 6c69               eli
-000246e0: 6620 6f62 6a5b 2274 7970 6522 5d20 3d3d  f obj["type"] ==
-000246f0: 2022 6461 7465 5261 6e67 6522 3a0d 0a20   "dateRange":.. 
-00024700: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00024710: 2020 2073 6567 6d65 6e74 4170 706c 6965     segmentApplie
-00024720: 645b 6f62 6a5b 2269 6422 5d5d 203d 206f  d[obj["id"]] = o
-00024730: 626a 5b22 6461 7465 5261 6e67 6522 5d0d  bj["dateRange"].
-00024740: 0a20 2020 2020 2020 2023 2323 2074 6162  .        ### tab
-00024750: 6c65 2063 6f6c 756d 6e49 6473 2061 6e64  le columnIds and
-00024760: 2053 7461 7469 6352 6f77 2049 4473 0d0a   StaticRow IDs..
-00024770: 2020 2020 2020 2020 7461 626c 6543 6f6c          tableCol
-00024780: 756d 6e49 6473 203d 207b 0d0a 2020 2020  umnIds = {..    
-00024790: 2020 2020 2020 2020 6f62 6a5b 2263 6f6c          obj["col
-000247a0: 756d 6e49 6422 5d3a 206f 626a 5b22 6669  umnId"]: obj["fi
-000247b0: 6c74 6572 7322 5d5b 305d 0d0a 2020 2020  lters"][0]..    
-000247c0: 2020 2020 2020 2020 666f 7220 6f62 6a20          for obj 
-000247d0: 696e 2064 6174 6152 6571 7565 7374 5b22  in dataRequest["
-000247e0: 6d65 7472 6963 436f 6e74 6169 6e65 7222  metricContainer"
-000247f0: 5d5b 226d 6574 7269 6373 225d 0d0a 2020  ]["metrics"]..  
-00024800: 2020 2020 2020 7d0d 0a20 2020 2020 2020        }..       
-00024810: 2023 2323 2063 7265 6174 6520 7265 6c61   ### create rela
-00024820: 7469 6f6e 7320 666f 7220 6d65 7472 6963  tions for metric
-00024830: 7320 7769 7468 2046 696c 7465 7220 6f6e  s with Filter on
-00024840: 2074 6f70 0d0a 2020 2020 2020 2020 6669   top..        fi
-00024850: 6c74 6572 5265 6c61 7469 6f6e 7320 3d20  lterRelations = 
-00024860: 7b0d 0a20 2020 2020 2020 2020 2020 206f  {..            o
-00024870: 626a 5b22 6669 6c74 6572 7322 5d5b 305d  bj["filters"][0]
-00024880: 3a20 6f62 6a5b 2266 696c 7465 7273 225d  : obj["filters"]
-00024890: 5b31 3a5d 0d0a 2020 2020 2020 2020 2020  [1:]..          
-000248a0: 2020 666f 7220 6f62 6a20 696e 2064 6174    for obj in dat
-000248b0: 6152 6571 7565 7374 5b22 6d65 7472 6963  aRequest["metric
-000248c0: 436f 6e74 6169 6e65 7222 5d5b 226d 6574  Container"]["met
-000248d0: 7269 6373 225d 0d0a 2020 2020 2020 2020  rics"]..        
-000248e0: 2020 2020 6966 206c 656e 286f 626a 5b22      if len(obj["
-000248f0: 6669 6c74 6572 7322 5d29 203e 2031 0d0a  filters"]) > 1..
-00024900: 2020 2020 2020 2020 7d0d 0a20 2020 2020          }..     
-00024910: 2020 2073 7461 7469 6352 6f77 7320 3d20     staticRows = 
-00024920: 7365 7428 7661 6c20 666f 7220 7661 6c20  set(val for val 
-00024930: 696e 2074 6162 6c65 5365 676d 656e 7473  in tableSegments
-00024940: 526f 7773 2e76 616c 7565 7328 2929 0d0a  Rows.values())..
-00024950: 2020 2020 2020 2020 6e62 5f72 6f77 7320          nb_rows 
-00024960: 3d20 6c65 6e28 7374 6174 6963 526f 7773  = len(staticRows
-00024970: 2920 2023 2320 6465 6669 6e65 2020 686f  )  ## define  ho
-00024980: 7720 6d61 6e79 2073 6567 6d65 6e74 2075  w many segment u
-00024990: 7365 6420 6173 2072 6f77 730d 0a20 2020  sed as rows..   
-000249a0: 2020 2020 206e 625f 636f 6c75 6d6e 7320       nb_columns 
-000249b0: 3d20 696e 7428 0d0a 2020 2020 2020 2020  = int(..        
-000249c0: 2020 2020 6c65 6e28 6461 7461 5265 7175      len(dataRequ
-000249d0: 6573 745b 226d 6574 7269 6343 6f6e 7461  est["metricConta
-000249e0: 696e 6572 225d 5b22 6d65 7472 6963 7322  iner"]["metrics"
-000249f0: 5d29 202f 206e 625f 726f 7773 0d0a 2020  ]) / nb_rows..  
-00024a00: 2020 2020 2020 2920 2023 2320 7573 6520        )  ## use 
-00024a10: 746f 2064 6574 6563 7420 726f 7773 0d0a  to detect rows..
-00024a20: 2020 2020 2020 2020 7374 6174 6963 526f          staticRo
-00024a30: 7773 203d 2073 6574 2876 616c 2066 6f72  ws = set(val for
-00024a40: 2076 616c 2069 6e20 7461 626c 6553 6567   val in tableSeg
-00024a50: 6d65 6e74 7352 6f77 732e 7661 6c75 6573  mentsRows.values
-00024a60: 2829 290d 0a20 2020 2020 2020 2073 7461  ())..        sta
-00024a70: 7469 6352 6f77 734e 616d 6573 203d 205b  ticRowsNames = [
-00024a80: 5d0d 0a20 2020 2020 2020 2066 6f72 2072  ]..        for r
-00024a90: 6f77 2069 6e20 7374 6174 6963 526f 7773  ow in staticRows
-00024aa0: 3a0d 0a20 2020 2020 2020 2020 2020 2069  :..            i
-00024ab0: 6620 726f 772e 7374 6172 7473 7769 7468  f row.startswith
-00024ac0: 2822 7322 2920 616e 6420 2240 4164 6f62  ("s") and "@Adob
-00024ad0: 654f 7267 2220 696e 2072 6f77 3a0d 0a20  eOrg" in row:.. 
-00024ae0: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-00024af0: 696c 7465 7220 3d20 7365 6c66 2e53 6567  ilter = self.Seg
-00024b00: 6d65 6e74 2872 6f77 290d 0a20 2020 2020  ment(row)..     
-00024b10: 2020 2020 2020 2020 2020 2073 7461 7469             stati
-00024b20: 6352 6f77 734e 616d 6573 2e61 7070 656e  cRowsNames.appen
-00024b30: 6428 6669 6c74 6572 5b22 6e61 6d65 225d  d(filter["name"]
-00024b40: 290d 0a20 2020 2020 2020 2020 2020 2065  )..            e
-00024b50: 6c73 653a 0d0a 2020 2020 2020 2020 2020  lse:..          
-00024b60: 2020 2020 2020 7374 6174 6963 526f 7773        staticRows
-00024b70: 4e61 6d65 732e 6170 7065 6e64 2872 6f77  Names.append(row
-00024b80: 290d 0a20 2020 2020 2020 2073 7461 7469  )..        stati
-00024b90: 6352 6f77 4469 6374 203d 207b 0d0a 2020  cRowDict = {..  
-00024ba0: 2020 2020 2020 2020 2020 726f 773a 2072            row: r
-00024bb0: 6f77 4e61 6d65 2066 6f72 2072 6f77 2c20  owName for row, 
-00024bc0: 726f 774e 616d 6520 696e 207a 6970 2873  rowName in zip(s
-00024bd0: 7461 7469 6352 6f77 732c 2073 7461 7469  taticRows, stati
-00024be0: 6352 6f77 734e 616d 6573 290d 0a20 2020  cRowsNames)..   
-00024bf0: 2020 2020 207d 0d0a 2020 2020 2020 2020       }..        
-00024c00: 2323 2320 6d65 7472 6963 730d 0a20 2020  ### metrics..   
-00024c10: 2020 2020 2064 6174 6152 6f77 7320 3d20       dataRows = 
-00024c20: 6465 6661 756c 7464 6963 7428 6c69 7374  defaultdict(list
-00024c30: 290d 0a20 2020 2020 2020 2066 6f72 2072  )..        for r
-00024c40: 6f77 2069 6e20 7374 6174 6963 526f 7744  ow in staticRowD
-00024c50: 6963 743a 2020 2323 2069 7465 7220 6f6e  ict:  ## iter on
-00024c60: 2074 6865 2064 6966 6665 7265 6e74 2073   the different s
-00024c70: 7461 7469 6320 726f 7773 0d0a 2020 2020  tatic rows..    
-00024c80: 2020 2020 2020 2020 666f 7220 636f 6c75          for colu
-00024c90: 6d6e 2c20 6461 7461 2069 6e20 7a69 7028  mn, data in zip(
-00024ca0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00024cb0: 2020 7265 7370 6f6e 7365 5b22 636f 6c75    response["colu
-00024cc0: 6d6e 7322 5d5b 2263 6f6c 756d 6e49 6473  mns"]["columnIds
-00024cd0: 225d 2c20 7265 7370 6f6e 7365 5b22 7375  "], response["su
-00024ce0: 6d6d 6172 7944 6174 6122 5d5b 2274 6f74  mmaryData"]["tot
-00024cf0: 616c 7322 5d0d 0a20 2020 2020 2020 2020  als"]..         
-00024d00: 2020 2029 3a0d 0a20 2020 2020 2020 2020     ):..         
-00024d10: 2020 2020 2020 2069 6620 7461 626c 6553         if tableS
-00024d20: 6567 6d65 6e74 7352 6f77 735b 7461 626c  egmentsRows[tabl
-00024d30: 6543 6f6c 756d 6e49 6473 5b63 6f6c 756d  eColumnIds[colum
-00024d40: 6e5d 5d20 3d3d 2072 6f77 3a0d 0a20 2020  n]] == row:..   
-00024d50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00024d60: 2023 2320 6368 6563 6b20 7472 616e 736c   ## check transl
-00024d70: 6174 696f 6e20 6f66 206d 6574 7269 6349  ation of metricI
-00024d80: 6420 7769 7468 2053 7461 7469 6320 526f  d with Static Ro
-00024d90: 7720 4944 0d0a 2020 2020 2020 2020 2020  w ID..          
-00024da0: 2020 2020 2020 2020 2020 6966 2072 6f77            if row
-00024db0: 206e 6f74 2069 6e20 6461 7461 526f 7773   not in dataRows
-00024dc0: 5b73 7461 7469 6352 6f77 4469 6374 5b72  [staticRowDict[r
-00024dd0: 6f77 5d5d 3a0d 0a20 2020 2020 2020 2020  ow]]:..         
-00024de0: 2020 2020 2020 2020 2020 2020 2020 2064                 d
-00024df0: 6174 6152 6f77 735b 7374 6174 6963 526f  ataRows[staticRo
-00024e00: 7744 6963 745b 726f 775d 5d2e 6170 7065  wDict[row]].appe
-00024e10: 6e64 2872 6f77 290d 0a20 2020 2020 2020  nd(row)..       
-00024e20: 2020 2020 2020 2020 2020 2020 2064 6174               dat
-00024e30: 6152 6f77 735b 7374 6174 6963 526f 7744  aRows[staticRowD
-00024e40: 6963 745b 726f 775d 5d2e 6170 7065 6e64  ict[row]].append
-00024e50: 2864 6174 6129 0d0a 2020 2020 2020 2020  (data)..        
-00024e60: 2020 2020 2020 2020 2323 2073 686f 756c          ## shoul
-00024e70: 6420 656e 6473 206c 696b 6520 3a20 7b27  d ends like : {'
-00024e80: 7365 676d 656e 744e 616d 6527 203a 205b  segmentName' : [
-00024e90: 2753 5441 5449 4327 2c31 3233 2c34 3536  'STATIC',123,456
-00024ea0: 5d7d 0d0a 2020 2020 2020 2020 7265 7475  ]}..        retu
-00024eb0: 726e 206e 625f 636f 6c75 6d6e 732c 2074  rn nb_columns, t
-00024ec0: 6162 6c65 436f 6c75 6d6e 4964 732c 2073  ableColumnIds, s
-00024ed0: 6567 6d65 6e74 4170 706c 6965 642c 2066  egmentApplied, f
-00024ee0: 696c 7465 7252 656c 6174 696f 6e73 2c20  ilterRelations, 
-00024ef0: 6461 7461 526f 7773 0d0a 0d0a 2020 2020  dataRows....    
-00024f00: 6465 6620 6765 7452 6570 6f72 7432 280d  def getReport2(.
-00024f10: 0a20 2020 2020 2020 2073 656c 662c 0d0a  .        self,..
-00024f20: 2020 2020 2020 2020 7265 7175 6573 743a          request:
-00024f30: 2055 6e69 6f6e 5b64 6963 742c 2049 4f2c   Union[dict, IO,
-00024f40: 5265 7175 6573 7443 7265 6174 6f72 5d20  RequestCreator] 
-00024f50: 3d20 4e6f 6e65 2c0d 0a20 2020 2020 2020  = None,..       
-00024f60: 206c 696d 6974 3a20 696e 7420 3d20 3230   limit: int = 20
-00024f70: 3030 302c 0d0a 2020 2020 2020 2020 6e5f  000,..        n_
-00024f80: 7265 7375 6c74 733a 2055 6e69 6f6e 5b69  results: Union[i
-00024f90: 6e74 2c20 7374 725d 203d 2022 696e 6622  nt, str] = "inf"
-00024fa0: 2c0d 0a20 2020 2020 2020 2061 6c6c 6f77  ,..        allow
-00024fb0: 5265 6d6f 7465 4c6f 6164 3a20 7374 7220  RemoteLoad: str 
-00024fc0: 3d20 2264 6566 6175 6c74 222c 0d0a 2020  = "default",..  
-00024fd0: 2020 2020 2020 7573 6543 6163 6865 3a20        useCache: 
-00024fe0: 626f 6f6c 203d 2054 7275 652c 0d0a 2020  bool = True,..  
-00024ff0: 2020 2020 2020 7573 6552 6573 756c 7473        useResults
-00025000: 4361 6368 653a 2062 6f6f 6c20 3d20 4661  Cache: bool = Fa
-00025010: 6c73 652c 0d0a 2020 2020 2020 2020 696e  lse,..        in
-00025020: 636c 7564 654f 6265 726f 6e58 6d6c 3a20  cludeOberonXml: 
-00025030: 626f 6f6c 203d 2046 616c 7365 2c0d 0a20  bool = False,.. 
-00025040: 2020 2020 2020 2069 6e63 6c75 6465 5072         includePr
-00025050: 6564 6963 7469 7665 4f62 6a65 6374 733a  edictiveObjects:
-00025060: 2062 6f6f 6c20 3d20 4661 6c73 652c 0d0a   bool = False,..
-00025070: 2020 2020 2020 2020 7265 7475 726e 734e          returnsN
-00025080: 6f6e 653a 2062 6f6f 6c20 3d20 4e6f 6e65  one: bool = None
-00025090: 2c0d 0a20 2020 2020 2020 2063 6f75 6e74  ,..        count
-000250a0: 5265 7065 6174 496e 7374 616e 6365 733a  RepeatInstances:
-000250b0: 2062 6f6f 6c20 3d20 4e6f 6e65 2c0d 0a20   bool = None,.. 
-000250c0: 2020 2020 2020 2069 676e 6f72 655a 6572         ignoreZer
-000250d0: 6f65 733a 2062 6f6f 6c20 3d20 4e6f 6e65  oes: bool = None
-000250e0: 2c0d 0a20 2020 2020 2020 2072 7369 643a  ,..        rsid:
-000250f0: 2073 7472 203d 204e 6f6e 652c 0d0a 2020   str = None,..  
-00025100: 2020 2020 2020 7265 736f 6c76 6543 6f6c        resolveCol
-00025110: 756d 6e73 3a20 626f 6f6c 203d 2054 7275  umns: bool = Tru
-00025120: 652c 0d0a 2020 2020 2020 2020 7361 7665  e,..        save
-00025130: 3a20 626f 6f6c 203d 2046 616c 7365 2c0d  : bool = False,.
-00025140: 0a20 2020 2020 2020 2072 6574 7572 6e43  .        returnC
-00025150: 6c61 7373 3a20 626f 6f6c 203d 2054 7275  lass: bool = Tru
-00025160: 652c 0d0a 2020 2020 2920 2d3e 2055 6e69  e,..    ) -> Uni
-00025170: 6f6e 5b57 6f72 6b73 7061 6365 2c20 6469  on[Workspace, di
-00025180: 6374 5d3a 0d0a 2020 2020 2020 2020 2222  ct]:..        ""
-00025190: 220d 0a20 2020 2020 2020 2052 6574 7572  "..        Retur
-000251a0: 6e20 616e 2069 6e73 7461 6e63 6520 6f66  n an instance of
-000251b0: 2057 6f72 6b73 7061 6365 2074 6861 7420   Workspace that 
-000251c0: 636f 6e74 6169 6e73 2074 6865 2064 6174  contains the dat
-000251d0: 6120 7265 7175 6573 7465 642e 0d0a 2020  a requested...  
-000251e0: 2020 2020 2020 4172 6775 6d6e 656e 7473        Argumnents
-000251f0: 3a0d 0a20 2020 2020 2020 2020 2020 2072  :..            r
-00025200: 6571 7565 7374 203a 2052 4551 5549 5245  equest : REQUIRE
-00025210: 4420 3a20 6569 7468 6572 2061 2064 6963  D : either a dic
-00025220: 7469 6f6e 6172 7920 6f66 2061 204a 534f  tionary of a JSO
-00025230: 4e20 6669 6c65 2074 6861 7420 636f 6e74  N file that cont
-00025240: 6169 6e73 2074 6865 2072 6571 7565 7374  ains the request
-00025250: 2069 6e66 6f72 6d61 7469 6f6e 2e0d 0a20   information... 
-00025260: 2020 2020 2020 2020 2020 206c 696d 6974             limit
-00025270: 203a 204f 5054 494f 4e41 4c20 3a20 6e75   : OPTIONAL : nu
-00025280: 6d62 6572 206f 6620 7265 7375 6c74 7320  mber of results 
-00025290: 7065 7220 7265 7175 6573 7420 2864 6566  per request (def
-000252a0: 6175 6c74 2031 3030 3029 0d0a 2020 2020  ault 1000)..    
-000252b0: 2020 2020 2020 2020 6e5f 7265 7375 6c74          n_result
-000252c0: 7320 3a20 4f50 5449 4f4e 414c 203a 2074  s : OPTIONAL : t
-000252d0: 6f74 616c 206e 756d 6265 7220 6f66 2072  otal number of r
-000252e0: 6573 756c 7473 2072 6574 7572 6e73 2e20  esults returns. 
-000252f0: 5573 6520 2269 6e66 2220 746f 2072 6574  Use "inf" to ret
-00025300: 7572 6e20 6576 6572 7974 6869 6e67 2028  urn everything (
-00025310: 6465 6661 756c 7420 2269 6e66 2229 0d0a  default "inf")..
-00025320: 2020 2020 2020 2020 2020 2020 616c 6c6f              allo
-00025330: 7752 656d 6f74 654c 6f61 6420 3a20 4f50  wRemoteLoad : OP
-00025340: 5449 4f4e 414c 203a 2043 6f6e 7472 6f6c  TIONAL : Control
-00025350: 7320 6966 204f 6265 726f 6e20 7368 6f75  s if Oberon shou
-00025360: 6c64 2072 656d 6f74 6520 6c6f 6164 2064  ld remote load d
-00025370: 6174 612e 2044 6566 6175 6c74 2062 6568  ata. Default beh
-00025380: 6176 696f 7220 6973 2074 7275 6520 7769  avior is true wi
-00025390: 7468 2066 616c 6c62 6163 6b20 746f 2066  th fallback to f
-000253a0: 616c 7365 2069 6620 7265 6d6f 7465 2064  alse if remote d
-000253b0: 6174 6120 646f 6573 206e 6f74 2065 7869  ata does not exi
-000253c0: 7374 0d0a 2020 2020 2020 2020 2020 2020  st..            
-000253d0: 7573 6543 6163 6865 203a 204f 5054 494f  useCache : OPTIO
-000253e0: 4e41 4c20 3a20 5573 6520 6361 6368 696e  NAL : Use cachin
-000253f0: 6720 666f 7220 6661 7374 6572 2072 6571  g for faster req
-00025400: 7565 7374 7320 2844 6f20 6e6f 7420 646f  uests (Do not do
-00025410: 2061 6e79 2072 6570 6f72 7420 6361 6368   any report cach
-00025420: 696e 6729 0d0a 2020 2020 2020 2020 2020  ing)..          
-00025430: 2020 7573 6552 6573 756c 7473 4361 6368    useResultsCach
-00025440: 6520 3a20 4f50 5449 4f4e 414c 203a 2055  e : OPTIONAL : U
-00025450: 7365 2072 6573 756c 7473 2063 6163 6869  se results cachi
-00025460: 6e67 2066 6f72 2066 6173 7465 7220 7265  ng for faster re
-00025470: 706f 7274 696e 6720 7469 6d65 7320 2854  porting times (T
-00025480: 6869 7320 6973 2061 2070 6173 7320 7468  his is a pass th
-00025490: 726f 7567 6820 746f 204f 6265 726f 6e20  rough to Oberon 
-000254a0: 7768 6963 6820 6d61 6e61 6765 7320 7468  which manages th
-000254b0: 6520 4361 6368 6529 0d0a 2020 2020 2020  e Cache)..      
-000254c0: 2020 2020 2020 696e 636c 7564 654f 6265        includeObe
-000254d0: 726f 6e58 6d6c 203a 204f 5054 494f 4e41  ronXml : OPTIONA
-000254e0: 4c20 3a20 436f 6e74 726f 6c73 2069 6620  L : Controls if 
-000254f0: 4f62 6572 6f6e 2058 4d4c 2073 686f 756c  Oberon XML shoul
-00025500: 6420 6265 2072 6574 7572 6e65 6420 696e  d be returned in
-00025510: 2074 6865 2072 6573 706f 6e73 6520 2d20   the response - 
-00025520: 4445 4255 4720 4f4e 4c59 0d0a 2020 2020  DEBUG ONLY..    
-00025530: 2020 2020 2020 2020 696e 636c 7564 6550          includeP
-00025540: 7265 6469 6374 6976 654f 626a 6563 7473  redictiveObjects
-00025550: 203a 204f 5054 494f 4e41 4c20 3a20 436f   : OPTIONAL : Co
-00025560: 6e74 726f 6c73 2069 6620 706c 6174 666f  ntrols if platfo
-00025570: 726d 2050 7265 6469 6374 6976 6520 4f62  rm Predictive Ob
-00025580: 6a65 6374 7320 7368 6f75 6c64 2062 6520  jects should be 
-00025590: 7265 7475 726e 6564 2069 6e20 7468 6520  returned in the 
-000255a0: 7265 7370 6f6e 7365 2e20 4f6e 6c79 2061  response. Only a
-000255b0: 7661 696c 6162 6c65 2077 6865 6e20 7573  vailable when us
-000255c0: 696e 6720 416e 6f6d 616c 7920 4465 7465  ing Anomaly Dete
-000255d0: 6374 696f 6e20 6f72 2046 6f72 6563 6173  ction or Forecas
-000255e0: 7469 6e67 2d20 4445 4255 4720 4f4e 4c59  ting- DEBUG ONLY
-000255f0: 0d0a 2020 2020 2020 2020 2020 2020 7265  ..            re
-00025600: 7475 726e 734e 6f6e 6520 3a20 4f50 5449  turnsNone : OPTI
-00025610: 4f4e 414c 3a20 4f76 6572 7772 6974 7465  ONAL: Overwritte
-00025620: 2074 6865 2072 6571 7565 7374 2073 6574   the request set
-00025630: 7469 6e67 2074 6f20 7265 7475 726e 204e  ting to return N
-00025640: 6f6e 6520 7661 6c75 6573 2e0d 0a20 2020  one values...   
-00025650: 2020 2020 2020 2020 2063 6f75 6e74 5265           countRe
-00025660: 7065 6174 496e 7374 616e 6365 7320 3a20  peatInstances : 
-00025670: 4f50 5449 4f4e 414c 3a20 4f76 6572 7772  OPTIONAL: Overwr
-00025680: 6974 6520 7468 6520 7265 7175 6573 7420  ite the request 
-00025690: 7365 7474 696e 6720 746f 2063 6f75 6e74  setting to count
-000256a0: 2072 6570 6561 7449 6e73 7461 6e63 6573   repeatInstances
-000256b0: 2076 616c 7565 732e 0d0a 2020 2020 2020   values...      
-000256c0: 2020 2020 2020 6967 6e6f 7265 5a65 726f        ignoreZero
-000256d0: 6573 203a 204f 5054 494f 4e41 4c20 3a20  es : OPTIONAL : 
-000256e0: 4967 6e6f 7265 207a 6572 6f73 2069 6e20  Ignore zeros in 
-000256f0: 7468 6520 7265 7375 6c74 730d 0a20 2020  the results..   
-00025700: 2020 2020 2020 2020 2072 7369 6420 3a20           rsid : 
-00025710: 4f50 5449 4f4e 414c 203a 204f 7665 7277  OPTIONAL : Overw
-00025720: 7269 7465 2074 6865 2052 6570 6f72 7453  rite the ReportS
-00025730: 7569 7465 4964 2075 7365 6420 666f 7220  uiteId used for 
-00025740: 7265 706f 7274 2e20 4f6e 6c79 2077 6f72  report. Only wor
-00025750: 6b73 2069 6620 7468 6520 7361 6d65 2063  ks if the same c
-00025760: 6f6d 706f 6e65 6e74 7320 6172 6520 7072  omponents are pr
-00025770: 6573 656e 7473 2e0d 0a20 2020 2020 2020  esents...       
-00025780: 2020 2020 2072 6573 6f6c 7665 436f 6c75       resolveColu
-00025790: 6d6e 733a 204f 5054 494f 4e41 4c20 3a20  mns: OPTIONAL : 
-000257a0: 6175 746f 6d61 7469 6361 6c6c 7920 7265  automatically re
-000257b0: 736f 6c76 6520 636f 6c75 6d6e 7320 6672  solve columns fr
-000257c0: 6f6d 2049 4420 746f 206e 616d 6520 666f  om ID to name fo
-000257d0: 7220 6361 6c63 756c 6174 6564 206d 6574  r calculated met
-000257e0: 7269 6373 2026 2073 6567 6d65 6e74 732e  rics & segments.
-000257f0: 2044 6566 6175 6c74 2054 7275 652e 2028   Default True. (
-00025800: 776f 726b 7320 6f6e 2072 6574 7572 6e43  works on returnC
-00025810: 6c61 7373 206f 6e6c 7929 0d0a 2020 2020  lass only)..    
-00025820: 2020 2020 2020 2020 7361 7665 203a 204f          save : O
-00025830: 5054 494f 4e41 4c20 3a20 4966 2079 6f75  PTIONAL : If you
-00025840: 2077 616e 7420 746f 2073 6176 6520 7468   want to save th
-00025850: 6520 6461 7461 2028 696e 204a 534f 4e20  e data (in JSON 
-00025860: 6f72 2043 5356 2c20 6465 7065 6e64 696e  or CSV, dependin
-00025870: 6720 7468 6520 636c 6173 7320 6973 2075  g the class is u
-00025880: 7365 6420 6f72 206e 6f74 290d 0a20 2020  sed or not)..   
-00025890: 2020 2020 2020 2020 2072 6574 7572 6e43           returnC
-000258a0: 6c61 7373 203a 204f 5054 494f 4e41 4c20  lass : OPTIONAL 
-000258b0: 3a20 7265 7475 726e 2074 6865 2063 6c61  : return the cla
-000258c0: 7373 2062 7569 6c64 696e 6720 6461 7461  ss building data
-000258d0: 6672 616d 6520 616e 6420 6265 7474 6572  frame and better
-000258e0: 2063 6f6d 7072 6568 656e 7369 6f6e 206f   comprehension o
-000258f0: 6620 6461 7461 2e20 2864 6566 6175 6c74  f data. (default
-00025900: 2079 6573 290d 0a20 2020 2020 2020 2022   yes)..        "
-00025910: 2222 0d0a 2020 2020 2020 2020 6966 2073  ""..        if s
-00025920: 656c 662e 6c6f 6767 696e 6745 6e61 626c  elf.loggingEnabl
-00025930: 6564 3a0d 0a20 2020 2020 2020 2020 2020  ed:..           
-00025940: 2073 656c 662e 6c6f 6767 6572 2e64 6562   self.logger.deb
-00025950: 7567 2866 2253 7461 7274 2067 6574 5265  ug(f"Start getRe
-00025960: 706f 7274 2229 0d0a 2020 2020 2020 2020  port")..        
-00025970: 7061 7468 203d 2022 2f72 6570 6f72 7473  path = "/reports
-00025980: 220d 0a20 2020 2020 2020 2070 6172 616d  "..        param
-00025990: 7320 3d20 7b0d 0a20 2020 2020 2020 2020  s = {..         
-000259a0: 2020 2022 616c 6c6f 7752 656d 6f74 654c     "allowRemoteL
-000259b0: 6f61 6422 3a20 616c 6c6f 7752 656d 6f74  oad": allowRemot
-000259c0: 654c 6f61 642c 0d0a 2020 2020 2020 2020  eLoad,..        
-000259d0: 2020 2020 2275 7365 4361 6368 6522 3a20      "useCache": 
-000259e0: 7573 6543 6163 6865 2c0d 0a20 2020 2020  useCache,..     
-000259f0: 2020 2020 2020 2022 7573 6552 6573 756c         "useResul
-00025a00: 7473 4361 6368 6522 3a20 7573 6552 6573  tsCache": useRes
-00025a10: 756c 7473 4361 6368 652c 0d0a 2020 2020  ultsCache,..    
-00025a20: 2020 2020 2020 2020 2269 6e63 6c75 6465          "include
-00025a30: 4f62 6572 6f6e 586d 6c22 3a20 696e 636c  OberonXml": incl
-00025a40: 7564 654f 6265 726f 6e58 6d6c 2c0d 0a20  udeOberonXml,.. 
-00025a50: 2020 2020 2020 2020 2020 2022 696e 636c             "incl
-00025a60: 7564 6550 6c61 7466 6f72 6d50 7265 6469  udePlatformPredi
-00025a70: 6374 6976 654f 626a 6563 7473 223a 2069  ctiveObjects": i
-00025a80: 6e63 6c75 6465 5072 6564 6963 7469 7665  ncludePredictive
-00025a90: 4f62 6a65 6374 732c 0d0a 2020 2020 2020  Objects,..      
-00025aa0: 2020 7d0d 0a20 2020 2020 2020 2069 6620    }..        if 
-00025ab0: 7479 7065 2872 6571 7565 7374 2920 3d3d  type(request) ==
-00025ac0: 2064 6963 743a 0d0a 2020 2020 2020 2020   dict:..        
-00025ad0: 2020 2020 6461 7461 5265 7175 6573 7420      dataRequest 
-00025ae0: 3d20 7265 7175 6573 740d 0a20 2020 2020  = request..     
-00025af0: 2020 2065 6c69 6620 6973 696e 7374 616e     elif isinstan
-00025b00: 6365 2872 6571 7565 7374 2c52 6571 7565  ce(request,Reque
-00025b10: 7374 4372 6561 746f 7229 3a0d 0a20 2020  stCreator):..   
-00025b20: 2020 2020 2020 2020 2064 6174 6152 6571           dataReq
-00025b30: 7565 7374 203d 2072 6571 7565 7374 2e74  uest = request.t
-00025b40: 6f5f 6469 6374 2829 0d0a 2020 2020 2020  o_dict()..      
-00025b50: 2020 656c 6966 2022 2e6a 736f 6e22 2069    elif ".json" i
-00025b60: 6e20 7265 7175 6573 743a 0d0a 2020 2020  n request:..    
-00025b70: 2020 2020 2020 2020 7769 7468 206f 7065          with ope
-00025b80: 6e28 7265 7175 6573 742c 2022 7222 2920  n(request, "r") 
-00025b90: 6173 2066 3a0d 0a20 2020 2020 2020 2020  as f:..         
-00025ba0: 2020 2020 2020 2064 6174 6152 6571 7565         dataReque
-00025bb0: 7374 203d 206a 736f 6e2e 6c6f 6164 2866  st = json.load(f
-00025bc0: 290d 0a20 2020 2020 2020 2065 6c73 653a  )..        else:
-00025bd0: 0d0a 2020 2020 2020 2020 2020 2020 7261  ..            ra
-00025be0: 6973 6520 5661 6c75 6545 7272 6f72 2822  ise ValueError("
-00025bf0: 5265 7175 6972 6520 6120 4a53 4f4e 206f  Require a JSON o
-00025c00: 7220 4469 6374 696f 6e61 7279 2074 6f20  r Dictionary to 
-00025c10: 7265 7175 6573 7420 6461 7461 2229 0d0a  request data")..
-00025c20: 2020 2020 2020 2020 2323 2320 5365 7474          ### Sett
-00025c30: 696e 6773 0d0a 2020 2020 2020 2020 6461  ings..        da
-00025c40: 7461 5265 7175 6573 745b 2273 6574 7469  taRequest["setti
-00025c50: 6e67 7322 5d5b 2270 6167 6522 5d20 3d20  ngs"]["page"] = 
-00025c60: 300d 0a20 2020 2020 2020 2064 6174 6152  0..        dataR
-00025c70: 6571 7565 7374 5b22 7365 7474 696e 6773  equest["settings
-00025c80: 225d 5b22 6c69 6d69 7422 5d20 3d20 6c69  "]["limit"] = li
-00025c90: 6d69 740d 0a20 2020 2020 2020 2069 6620  mit..        if 
-00025ca0: 7265 7475 726e 734e 6f6e 653a 0d0a 2020  returnsNone:..  
-00025cb0: 2020 2020 2020 2020 2020 6461 7461 5265            dataRe
-00025cc0: 7175 6573 745b 2273 6574 7469 6e67 7322  quest["settings"
-00025cd0: 5d5b 226e 6f6e 6573 4265 6861 7669 6f72  ]["nonesBehavior
-00025ce0: 225d 203d 2022 7265 7475 726e 2d6e 6f6e  "] = "return-non
-00025cf0: 6573 220d 0a20 2020 2020 2020 2065 6c73  es"..        els
-00025d00: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
-00025d10: 6461 7461 5265 7175 6573 745b 2273 6574  dataRequest["set
-00025d20: 7469 6e67 7322 5d5b 226e 6f6e 6573 4265  tings"]["nonesBe
-00025d30: 6861 7669 6f72 225d 203d 2022 6578 636c  havior"] = "excl
-00025d40: 7564 652d 6e6f 6e65 7322 0d0a 2020 2020  ude-nones"..    
-00025d50: 2020 2020 6966 2063 6f75 6e74 5265 7065      if countRepe
-00025d60: 6174 496e 7374 616e 6365 733a 0d0a 2020  atInstances:..  
-00025d70: 2020 2020 2020 2020 2020 6461 7461 5265            dataRe
-00025d80: 7175 6573 745b 2273 6574 7469 6e67 7322  quest["settings"
-00025d90: 5d5b 2263 6f75 6e74 5265 7065 6174 496e  ]["countRepeatIn
-00025da0: 7374 616e 6365 7322 5d20 3d20 5472 7565  stances"] = True
-00025db0: 0d0a 2020 2020 2020 2020 656c 7365 3a0d  ..        else:.
-00025dc0: 0a20 2020 2020 2020 2020 2020 2064 6174  .            dat
-00025dd0: 6152 6571 7565 7374 5b22 7365 7474 696e  aRequest["settin
-00025de0: 6773 225d 5b22 636f 756e 7452 6570 6561  gs"]["countRepea
-00025df0: 7449 6e73 7461 6e63 6573 225d 203d 2046  tInstances"] = F
-00025e00: 616c 7365 0d0a 2020 2020 2020 2020 6966  alse..        if
-00025e10: 2072 7369 6420 6973 206e 6f74 204e 6f6e   rsid is not Non
-00025e20: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
-00025e30: 6461 7461 5265 7175 6573 745b 2272 7369  dataRequest["rsi
-00025e40: 6422 5d20 3d20 7273 6964 0d0a 2020 2020  d"] = rsid..    
-00025e50: 2020 2020 6966 2069 676e 6f72 655a 6572      if ignoreZer
-00025e60: 6f65 733a 0d0a 2020 2020 2020 2020 2020  oes:..          
-00025e70: 2020 6461 7461 5265 7175 6573 742e 6765    dataRequest.ge
-00025e80: 7428 2273 7461 7469 7374 6963 7322 2c7b  t("statistics",{
-00025e90: 2769 676e 6f72 655a 6572 6f65 7327 3a54  'ignoreZeroes':T
-00025ea0: 7275 657d 295b 2269 676e 6f72 655a 6572  rue})["ignoreZer
-00025eb0: 6f65 7322 5d20 3d20 5472 7565 0d0a 2020  oes"] = True..  
-00025ec0: 2020 2020 2020 656c 7365 3a0d 0a20 2020        else:..   
-00025ed0: 2020 2020 2020 2020 2064 6174 6152 6571           dataReq
-00025ee0: 7565 7374 2e67 6574 2822 7374 6174 6973  uest.get("statis
-00025ef0: 7469 6373 222c 7b27 6967 6e6f 7265 5a65  tics",{'ignoreZe
-00025f00: 726f 6573 273a 4661 6c73 657d 295b 2269  roes':False})["i
-00025f10: 676e 6f72 655a 6572 6f65 7322 5d20 3d20  gnoreZeroes"] = 
-00025f20: 4661 6c73 650d 0a20 2020 2020 2020 2023  False..        #
-00025f30: 2323 2052 6571 7565 7374 2064 6174 610d  ## Request data.
-00025f40: 0a20 2020 2020 2020 2069 6620 7365 6c66  .        if self
-00025f50: 2e6c 6f67 6769 6e67 456e 6162 6c65 643a  .loggingEnabled:
-00025f60: 0d0a 2020 2020 2020 2020 2020 2020 7365  ..            se
-00025f70: 6c66 2e6c 6f67 6765 722e 6465 6275 6728  lf.logger.debug(
-00025f80: 6622 6765 7452 6570 6f72 7420 7265 7175  f"getReport requ
-00025f90: 6573 743a 207b 6a73 6f6e 2e64 756d 7073  est: {json.dumps
-00025fa0: 2864 6174 6152 6571 7565 7374 2c69 6e64  (dataRequest,ind
-00025fb0: 656e 743d 3429 7d22 290d 0a20 2020 2020  ent=4)}")..     
-00025fc0: 2020 2072 6573 203d 2073 656c 662e 636f     res = self.co
-00025fd0: 6e6e 6563 746f 722e 706f 7374 4461 7461  nnector.postData
-00025fe0: 280d 0a20 2020 2020 2020 2020 2020 2073  (..            s
-00025ff0: 656c 662e 656e 6470 6f69 6e74 5f63 6f6d  elf.endpoint_com
-00026000: 7061 6e79 202b 2070 6174 682c 2064 6174  pany + path, dat
-00026010: 613d 6461 7461 5265 7175 6573 742c 2070  a=dataRequest, p
-00026020: 6172 616d 733d 7061 7261 6d73 0d0a 2020  arams=params..  
-00026030: 2020 2020 2020 290d 0a20 2020 2020 2020        )..       
-00026040: 2069 6620 2272 6f77 7322 2069 6e20 7265   if "rows" in re
-00026050: 732e 6b65 7973 2829 3a0d 0a20 2020 2020  s.keys():..     
-00026060: 2020 2020 2020 2072 6570 6f72 7454 7970         reportTyp
-00026070: 6520 3d20 226e 6f72 6d61 6c22 0d0a 2020  e = "normal"..  
-00026080: 2020 2020 2020 2020 2020 6966 2073 656c            if sel
-00026090: 662e 6c6f 6767 696e 6745 6e61 626c 6564  f.loggingEnabled
-000260a0: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-000260b0: 2020 2073 656c 662e 6c6f 6767 6572 2e64     self.logger.d
-000260c0: 6562 7567 2866 2272 6570 6f72 7454 7970  ebug(f"reportTyp
-000260d0: 653a 207b 7265 706f 7274 5479 7065 7d22  e: {reportType}"
-000260e0: 290d 0a20 2020 2020 2020 2020 2020 2064  )..            d
-000260f0: 6174 6152 6f77 7320 3d20 7265 732e 6765  ataRows = res.ge
-00026100: 7428 2272 6f77 7322 290d 0a20 2020 2020  t("rows")..     
-00026110: 2020 2020 2020 2063 6f6c 756d 6e73 203d         columns =
-00026120: 2072 6573 2e67 6574 2822 636f 6c75 6d6e   res.get("column
-00026130: 7322 290d 0a20 2020 2020 2020 2020 2020  s")..           
-00026140: 2073 756d 6d61 7279 4461 7461 203d 2072   summaryData = r
-00026150: 6573 2e67 6574 2822 7375 6d6d 6172 7944  es.get("summaryD
-00026160: 6174 6122 290d 0a20 2020 2020 2020 2020  ata")..         
-00026170: 2020 2074 6f74 616c 456c 656d 656e 7473     totalElements
-00026180: 203d 2072 6573 2e67 6574 2822 6e75 6d62   = res.get("numb
-00026190: 6572 4f66 456c 656d 656e 7473 2229 0d0a  erOfElements")..
-000261a0: 2020 2020 2020 2020 2020 2020 6c61 7374              last
-000261b0: 5061 6765 203d 2072 6573 2e67 6574 2822  Page = res.get("
-000261c0: 6c61 7374 5061 6765 222c 2054 7275 6529  lastPage", True)
-000261d0: 0d0a 2020 2020 2020 2020 2020 2020 6966  ..            if
-000261e0: 2066 6c6f 6174 286c 656e 2864 6174 6152   float(len(dataR
-000261f0: 6f77 7329 2920 3e3d 2066 6c6f 6174 286e  ows)) >= float(n
-00026200: 5f72 6573 756c 7473 293a 0d0a 2020 2020  _results):..    
-00026210: 2020 2020 2020 2020 2020 2020 2323 2066              ## f
-00026220: 6f72 6365 2065 6e64 206f 6620 6c6f 6f70  orce end of loop
-00026230: 2077 6865 6e20 6120 6c69 6d69 7420 6973   when a limit is
-00026240: 2073 6574 206f 6e20 6e5f 7265 7375 6c74   set on n_result
-00026250: 730d 0a20 2020 2020 2020 2020 2020 2020  s..             
-00026260: 2020 206c 6173 7450 6167 6520 3d20 5472     lastPage = Tr
-00026270: 7565 0d0a 2020 2020 2020 2020 2020 2020  ue..            
-00026280: 7768 696c 6520 6c61 7374 5061 6765 2021  while lastPage !
-00026290: 3d20 5472 7565 3a0d 0a20 2020 2020 2020  = True:..       
-000262a0: 2020 2020 2020 2020 2064 6174 6152 6571           dataReq
-000262b0: 7565 7374 5b22 7365 7474 696e 6773 225d  uest["settings"]
-000262c0: 5b22 7061 6765 225d 202b 3d20 310d 0a20  ["page"] += 1.. 
-000262d0: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-000262e0: 6573 203d 2073 656c 662e 636f 6e6e 6563  es = self.connec
-000262f0: 746f 722e 706f 7374 4461 7461 280d 0a20  tor.postData(.. 
-00026300: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00026310: 2020 2073 656c 662e 656e 6470 6f69 6e74     self.endpoint
-00026320: 5f63 6f6d 7061 6e79 202b 2070 6174 682c  _company + path,
-00026330: 2064 6174 613d 6461 7461 5265 7175 6573   data=dataReques
-00026340: 742c 2070 6172 616d 733d 7061 7261 6d73  t, params=params
-00026350: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00026360: 2020 290d 0a20 2020 2020 2020 2020 2020    )..           
-00026370: 2020 2020 2064 6174 6152 6f77 7320 2b3d       dataRows +=
-00026380: 2072 6573 2e67 6574 2822 726f 7773 2229   res.get("rows")
+00022770: 2020 7265 7175 6573 7420 3d20 6a73 6f6e    request = json
+00022780: 2e6c 6f61 6473 2866 696c 655f 7374 7269  .loads(file_stri
+00022790: 6e67 290d 0a20 2020 2020 2020 2020 2020  ng)..           
+000227a0: 2065 7863 6570 743a 0d0a 2020 2020 2020   except:..      
+000227b0: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+000227c0: 5479 7065 4572 726f 7228 2265 7870 6563  TypeError("expec
+000227d0: 7465 6420 6120 7061 7273 6162 6c65 2073  ted a parsable s
+000227e0: 7472 696e 6722 290d 0a20 2020 2020 2020  tring")..       
+000227f0: 2072 6571 7565 7374 5b27 7365 7474 696e   request['settin
+00022800: 6773 275d 5b27 6c69 6d69 7427 5d20 3d20  gs']['limit'] = 
+00022810: 6c69 6d69 740d 0a20 2020 2020 2020 2023  limit..        #
+00022820: 2069 6e66 6f20 666f 7220 6372 6561 7469   info for creati
+00022830: 6e67 2072 6570 6f72 740d 0a20 2020 2020  ng report..     
+00022840: 2020 2064 6174 615f 696e 666f 203d 2073     data_info = s
+00022850: 656c 662e 5f64 6174 6144 6573 6372 6970  elf._dataDescrip
+00022860: 746f 7228 7265 7175 6573 7429 0d0a 2020  tor(request)..  
+00022870: 2020 2020 2020 6966 2076 6572 626f 7365        if verbose
+00022880: 3a0d 0a20 2020 2020 2020 2020 2020 2070  :..            p
+00022890: 7269 6e74 2827 5265 7175 6573 7420 6465  rint('Request de
+000228a0: 6372 7970 7465 6427 290d 0a20 2020 2020  crypted')..     
+000228b0: 2020 206f 626a 2e75 7064 6174 6528 6461     obj.update(da
+000228c0: 7461 5f69 6e66 6f29 0d0a 2020 2020 2020  ta_info)..      
+000228d0: 2020 616e 6f6d 616c 7920 3d20 7265 7175    anomaly = requ
+000228e0: 6573 745b 2773 6574 7469 6e67 7327 5d2e  est['settings'].
+000228f0: 6765 7428 2769 6e63 6c75 6465 416e 6f6d  get('includeAnom
+00022900: 616c 7944 6574 6563 7469 6f6e 272c 2046  alyDetection', F
+00022910: 616c 7365 290d 0a20 2020 2020 2020 2063  alse)..        c
+00022920: 6f6c 756d 6e73 203d 205b 6461 7461 5f69  olumns = [data_i
+00022930: 6e66 6f5b 2764 696d 656e 7369 6f6e 275d  nfo['dimension']
+00022940: 5d20 2b20 6461 7461 5f69 6e66 6f5b 276d  ] + data_info['m
+00022950: 6574 7269 6373 275d 0d0a 2020 2020 2020  etrics']..      
+00022960: 2020 2320 7072 6570 6172 696e 6720 666f    # preparing fo
+00022970: 7220 7468 6520 6c6f 6f70 0d0a 2020 2020  r the loop..    
+00022980: 2020 2020 2320 696e 2063 6173 6520 2269      # in case "i
+00022990: 6e66 2220 6861 7320 6265 656e 2075 7365  nf" has been use
+000229a0: 642e 2054 7572 6e20 6974 2074 6f20 6120  d. Turn it to a 
+000229b0: 6e75 6d62 6572 0d0a 2020 2020 2020 2020  number..        
+000229c0: 6e5f 7265 7375 6c74 7320 3d20 6b77 6172  n_results = kwar
+000229d0: 6773 2e67 6574 2827 6e5f 7265 7375 6c74  gs.get('n_result
+000229e0: 272c 6e5f 7265 7375 6c74 7329 0d0a 2020  ',n_results)..  
+000229f0: 2020 2020 2020 6e5f 7265 7375 6c74 7320        n_results 
+00022a00: 3d20 666c 6f61 7428 6e5f 7265 7375 6c74  = float(n_result
+00022a10: 7329 0d0a 2020 2020 2020 2020 6966 206e  s)..        if n
+00022a20: 5f72 6573 756c 7473 2021 3d20 666c 6f61  _results != floa
+00022a30: 7428 2769 6e66 2729 2061 6e64 206e 5f72  t('inf') and n_r
+00022a40: 6573 756c 7473 203c 2072 6571 7565 7374  esults < request
+00022a50: 5b27 7365 7474 696e 6773 275d 5b27 6c69  ['settings']['li
+00022a60: 6d69 7427 5d3a 0d0a 2020 2020 2020 2020  mit']:..        
+00022a70: 2020 2020 2320 6d61 6b69 6e67 2073 7572      # making sur
+00022a80: 6520 7765 2064 6f6e 2774 2063 616c 6c20  e we don't call 
+00022a90: 6d6f 7265 2074 6861 6e20 7365 7420 696e  more than set in
+00022aa0: 2077 7261 7070 6572 0d0a 2020 2020 2020   wrapper..      
+00022ab0: 2020 2020 2020 7265 7175 6573 745b 2773        request['s
+00022ac0: 6574 7469 6e67 7327 5d5b 276c 696d 6974  ettings']['limit
+00022ad0: 275d 203d 206e 5f72 6573 756c 7473 0d0a  '] = n_results..
+00022ae0: 2020 2020 2020 2020 6461 7461 5f6c 6973          data_lis
+00022af0: 7420 3d20 5b5d 0d0a 2020 2020 2020 2020  t = []..        
+00022b00: 6c61 7374 5f70 6167 6520 3d20 4661 6c73  last_page = Fals
+00022b10: 650d 0a20 2020 2020 2020 2070 6167 655f  e..        page_
+00022b20: 6e62 2c20 636f 756e 745f 656c 656d 656e  nb, count_elemen
+00022b30: 7473 2c20 746f 7461 6c5f 656c 656d 656e  ts, total_elemen
+00022b40: 7473 203d 2030 2c20 302c 2030 0d0a 2020  ts = 0, 0, 0..  
+00022b50: 2020 2020 2020 6966 2076 6572 626f 7365        if verbose
+00022b60: 3a0d 0a20 2020 2020 2020 2020 2020 2070  :..            p
+00022b70: 7269 6e74 2827 5374 6172 7469 6e67 2074  rint('Starting t
+00022b80: 6f20 6665 7463 6820 7468 6520 6461 7461  o fetch the data
+00022b90: 2e2e 2e27 290d 0a20 2020 2020 2020 2077  ...')..        w
+00022ba0: 6869 6c65 206e 6f74 206c 6173 745f 7061  hile not last_pa
+00022bb0: 6765 3a0d 0a20 2020 2020 2020 2020 2020  ge:..           
+00022bc0: 2074 696d 6573 7461 6d70 203d 2072 6f75   timestamp = rou
+00022bd0: 6e64 2874 696d 652e 7469 6d65 2829 290d  nd(time.time()).
+00022be0: 0a20 2020 2020 2020 2020 2020 2072 6571  .            req
+00022bf0: 7565 7374 5b27 7365 7474 696e 6773 275d  uest['settings']
+00022c00: 5b27 7061 6765 275d 203d 2070 6167 655f  ['page'] = page_
+00022c10: 6e62 0d0a 2020 2020 2020 2020 2020 2020  nb..            
+00022c20: 7265 706f 7274 203d 2073 656c 662e 636f  report = self.co
+00022c30: 6e6e 6563 746f 722e 706f 7374 4461 7461  nnector.postData
+00022c40: 2873 656c 662e 656e 6470 6f69 6e74 5f63  (self.endpoint_c
+00022c50: 6f6d 7061 6e79 202b 0d0a 2020 2020 2020  ompany +..      
+00022c60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022c70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022c80: 2020 2020 2020 2073 656c 662e 5f67 6574         self._get
+00022c90: 5265 706f 7274 2c20 6461 7461 3d72 6571  Report, data=req
+00022ca0: 7565 7374 2c20 6865 6164 6572 733d 7365  uest, headers=se
+00022cb0: 6c66 2e68 6561 6465 7229 0d0a 2020 2020  lf.header)..    
+00022cc0: 2020 2020 2020 2020 6966 2076 6572 626f          if verbo
+00022cd0: 7365 3a0d 0a20 2020 2020 2020 2020 2020  se:..           
+00022ce0: 2020 2020 2070 7269 6e74 2827 4461 7461       print('Data
+00022cf0: 2072 6563 6569 7665 642e 2729 0d0a 2020   received.')..  
+00022d00: 2020 2020 2020 2020 2020 2320 5265 6375            # Recu
+00022d10: 7273 696f 6e20 746f 2074 616b 6520 6361  rsion to take ca
+00022d20: 7265 206f 6620 7468 726f 7474 6c69 6e67  re of throttling
+00022d30: 206c 696d 6974 0d0a 2020 2020 2020 2020   limit..        
+00022d40: 2020 2020 7768 696c 6520 7265 706f 7274      while report
+00022d50: 2e67 6574 2827 7374 6174 7573 5f63 6f64  .get('status_cod
+00022d60: 6527 2c20 3230 3029 203d 3d20 3432 3920  e', 200) == 429 
+00022d70: 6f72 2072 6570 6f72 742e 6765 7428 2765  or report.get('e
+00022d80: 7272 6f72 5f63 6f64 6527 2c4e 6f6e 6529  rror_code',None)
+00022d90: 203d 3d20 2234 3239 3035 3022 3a0d 0a20   == "429050":.. 
+00022da0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00022db0: 6620 7665 7262 6f73 653a 0d0a 2020 2020  f verbose:..    
+00022dc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022dd0: 7072 696e 7428 2772 6561 6368 696e 6720  print('reaching 
+00022de0: 7468 6520 6c69 6d69 7420 3a20 7061 7573  the limit : paus
+00022df0: 6520 666f 7220 3530 2073 2061 6e64 2065  e for 50 s and e
+00022e00: 6e74 6572 696e 6720 7265 6375 7273 696f  ntering recursio
+00022e10: 6e2e 2729 0d0a 2020 2020 2020 2020 2020  n.')..          
+00022e20: 2020 2020 2020 6966 2064 6562 7567 3a0d        if debug:.
+00022e30: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00022e40: 2020 2020 2077 6974 6820 6f70 656e 2866       with open(f
+00022e50: 276c 696d 6974 5f72 6561 6368 5f7b 7469  'limit_reach_{ti
+00022e60: 6d65 7374 616d 707d 2e6a 736f 6e27 2c20  mestamp}.json', 
+00022e70: 2777 2729 2061 7320 663a 0d0a 2020 2020  'w') as f:..    
+00022e80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022e90: 2020 2020 662e 7772 6974 6528 6a73 6f6e      f.write(json
+00022ea0: 2e64 756d 7073 2872 6570 6f72 742c 2069  .dumps(report, i
+00022eb0: 6e64 656e 743d 3429 290d 0a20 2020 2020  ndent=4))..     
+00022ec0: 2020 2020 2020 2020 2020 2074 696d 652e             time.
+00022ed0: 736c 6565 7028 3530 290d 0a20 2020 2020  sleep(50)..     
+00022ee0: 2020 2020 2020 2020 2020 2072 6570 6f72             repor
+00022ef0: 7420 3d20 7365 6c66 2e63 6f6e 6e65 6374  t = self.connect
+00022f00: 6f72 2e70 6f73 7444 6174 6128 7365 6c66  or.postData(self
+00022f10: 2e65 6e64 706f 696e 745f 636f 6d70 616e  .endpoint_compan
+00022f20: 7920 2b0d 0a20 2020 2020 2020 2020 2020  y +..           
+00022f30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022f40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022f50: 2020 7365 6c66 2e5f 6765 7452 6570 6f72    self._getRepor
+00022f60: 742c 2064 6174 613d 7265 7175 6573 742c  t, data=request,
+00022f70: 2068 6561 6465 7273 3d73 656c 662e 6865   headers=self.he
+00022f80: 6164 6572 290d 0a20 2020 2020 2020 2020  ader)..         
+00022f90: 2020 2069 6620 276c 6173 7450 6167 6527     if 'lastPage'
+00022fa0: 206e 6f74 2069 6e20 7265 706f 7274 2061   not in report a
+00022fb0: 6e64 2075 6e73 6166 6520 3d3d 2046 616c  nd unsafe == Fal
+00022fc0: 7365 3a20 2023 2063 6865 636b 696e 6720  se:  # checking 
+00022fd0: 6572 726f 7220 7768 656e 206e 6f20 6c61  error when no la
+00022fe0: 7374 5061 6765 206b 6579 2069 6e20 7265  stPage key in re
+00022ff0: 706f 7274 0d0a 2020 2020 2020 2020 2020  port..          
+00023000: 2020 2020 2020 6966 2076 6572 626f 7365        if verbose
+00023010: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+00023020: 2020 2020 2020 2070 7269 6e74 286a 736f         print(jso
+00023030: 6e2e 6475 6d70 7328 7265 706f 7274 2c20  n.dumps(report, 
+00023040: 696e 6465 6e74 3d32 2929 0d0a 2020 2020  indent=2))..    
+00023050: 2020 2020 2020 2020 2020 2020 7072 696e              prin
+00023060: 7428 2757 6172 6e69 6e67 203a 2053 6572  t('Warning : Ser
+00023070: 7665 7220 4572 726f 7227 290d 0a20 2020  ver Error')..   
+00023080: 2020 2020 2020 2020 2020 2020 2070 7269               pri
+00023090: 6e74 286a 736f 6e2e 6475 6d70 7328 7265  nt(json.dumps(re
+000230a0: 706f 7274 2929 0d0a 2020 2020 2020 2020  port))..        
+000230b0: 2020 2020 2020 2020 6966 2064 6562 7567          if debug
+000230c0: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+000230d0: 2020 2020 2020 2077 6974 6820 6f70 656e         with open
+000230e0: 2866 2773 6572 7665 725f 6661 696c 7572  (f'server_failur
+000230f0: 655f 7265 7175 6573 745f 7b74 696d 6573  e_request_{times
+00023100: 7461 6d70 7d2e 6a73 6f6e 272c 2027 7727  tamp}.json', 'w'
+00023110: 2920 6173 2066 3a0d 0a20 2020 2020 2020  ) as f:..       
+00023120: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00023130: 2066 2e77 7269 7465 286a 736f 6e2e 6475   f.write(json.du
+00023140: 6d70 7328 7265 7175 6573 742c 2069 6e64  mps(request, ind
+00023150: 656e 743d 3429 290d 0a20 2020 2020 2020  ent=4))..       
+00023160: 2020 2020 2020 2020 2020 2020 2077 6974               wit
+00023170: 6820 6f70 656e 2866 2773 6572 7665 725f  h open(f'server_
+00023180: 6661 696c 7572 655f 7265 7370 6f6e 7365  failure_response
+00023190: 5f7b 7469 6d65 7374 616d 707d 2e6a 736f  _{timestamp}.jso
+000231a0: 6e27 2c20 2777 2729 2061 7320 663a 0d0a  n', 'w') as f:..
+000231b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000231c0: 2020 2020 2020 2020 662e 7772 6974 6528          f.write(
+000231d0: 6a73 6f6e 2e64 756d 7073 2872 6570 6f72  json.dumps(repor
+000231e0: 742c 2069 6e64 656e 743d 3429 290d 0a20  t, indent=4)).. 
+000231f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00023200: 2020 2070 7269 6e74 280d 0a20 2020 2020     print(..     
+00023210: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00023220: 2020 2066 2757 6172 6e69 6e67 203a 2053     f'Warning : S
+00023230: 6176 6520 4a53 4f4e 2072 6571 7565 7374  ave JSON request
+00023240: 203a 2073 6572 7665 725f 6661 696c 7572   : server_failur
+00023250: 655f 7265 7175 6573 745f 7b74 696d 6573  e_request_{times
+00023260: 7461 6d70 7d2e 6a73 6f6e 2729 0d0a 2020  tamp}.json')..  
+00023270: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00023280: 2020 7072 696e 7428 0d0a 2020 2020 2020    print(..      
+00023290: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000232a0: 2020 6627 5761 726e 696e 6720 3a20 5361    f'Warning : Sa
+000232b0: 7665 204a 534f 4e20 7265 7370 6f6e 7365  ve JSON response
+000232c0: 203a 2073 6572 7665 725f 6661 696c 7572   : server_failur
+000232d0: 655f 7265 7370 6f6e 7365 5f7b 7469 6d65  e_response_{time
+000232e0: 7374 616d 707d 2e6a 736f 6e27 290d 0a20  stamp}.json').. 
+000232f0: 2020 2020 2020 2020 2020 2020 2020 206f                 o
+00023300: 626a 5b27 6461 7461 275d 203d 2070 642e  bj['data'] = pd.
+00023310: 4461 7461 4672 616d 6528 290d 0a20 2020  DataFrame()..   
+00023320: 2020 2020 2020 2020 2020 2020 2072 6574               ret
+00023330: 7572 6e20 6f62 6a0d 0a20 2020 2020 2020  urn obj..       
+00023340: 2020 2020 2023 2066 616c 6c62 6163 6b20       # fallback 
+00023350: 7768 656e 206e 6f20 6c61 7374 5061 6765  when no lastPage
+00023360: 2069 6e20 7265 706f 7274 0d0a 2020 2020   in report..    
+00023370: 2020 2020 2020 2020 6c61 7374 5f70 6167          last_pag
+00023380: 6520 3d20 7265 706f 7274 2e67 6574 2827  e = report.get('
+00023390: 6c61 7374 5061 6765 272c 2054 7275 6529  lastPage', True)
+000233a0: 0d0a 2020 2020 2020 2020 2020 2020 6966  ..            if
+000233b0: 2076 6572 626f 7365 3a0d 0a20 2020 2020   verbose:..     
+000233c0: 2020 2020 2020 2020 2020 2070 7269 6e74             print
+000233d0: 2866 276c 6173 7420 7061 6765 2073 7461  (f'last page sta
+000233e0: 7475 7320 3a20 7b6c 6173 745f 7061 6765  tus : {last_page
+000233f0: 7d27 290d 0a20 2020 2020 2020 2020 2020  }')..           
+00023400: 2069 6620 2765 7272 6f72 436f 6465 2720   if 'errorCode' 
+00023410: 696e 2072 6570 6f72 742e 6b65 7973 2829  in report.keys()
+00023420: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+00023430: 2020 2070 7269 6e74 2827 4572 726f 7220     print('Error 
+00023440: 7769 7468 2079 6f75 7220 7374 6174 656d  with your statem
+00023450: 656e 7420 5c6e 2720 2b0d 0a20 2020 2020  ent \n' +..     
+00023460: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00023470: 2072 6570 6f72 745b 2765 7272 6f72 4465   report['errorDe
+00023480: 7363 7269 7074 696f 6e27 5d29 0d0a 2020  scription'])..  
+00023490: 2020 2020 2020 2020 2020 2020 2020 7265                re
+000234a0: 7475 726e 207b 7265 706f 7274 5b27 6572  turn {report['er
+000234b0: 726f 7243 6f64 6527 5d3a 2072 6570 6f72  rorCode']: repor
+000234c0: 745b 2765 7272 6f72 4465 7363 7269 7074  t['errorDescript
+000234d0: 696f 6e27 5d7d 0d0a 2020 2020 2020 2020  ion']}..        
+000234e0: 2020 2020 636f 756e 745f 656c 656d 656e      count_elemen
+000234f0: 7473 202b 3d20 7265 706f 7274 2e67 6574  ts += report.get
+00023500: 2827 6e75 6d62 6572 4f66 456c 656d 656e  ('numberOfElemen
+00023510: 7473 272c 2030 290d 0a20 2020 2020 2020  ts', 0)..       
+00023520: 2020 2020 2074 6f74 616c 5f65 6c65 6d65       total_eleme
+00023530: 6e74 7320 3d20 7265 706f 7274 2e67 6574  nts = report.get
+00023540: 280d 0a20 2020 2020 2020 2020 2020 2020  (..             
+00023550: 2020 2027 746f 7461 6c45 6c65 6d65 6e74     'totalElement
+00023560: 7327 2c20 7265 7175 6573 745b 2773 6574  s', request['set
+00023570: 7469 6e67 7327 5d5b 276c 696d 6974 275d  tings']['limit']
+00023580: 290d 0a20 2020 2020 2020 2020 2020 2069  )..            i
+00023590: 6620 746f 7461 6c5f 656c 656d 656e 7473  f total_elements
+000235a0: 203d 3d20 303a 0d0a 2020 2020 2020 2020   == 0:..        
+000235b0: 2020 2020 2020 2020 6f62 6a5b 2764 6174          obj['dat
+000235c0: 6127 5d20 3d20 7064 2e44 6174 6146 7261  a'] = pd.DataFra
+000235d0: 6d65 2829 0d0a 2020 2020 2020 2020 2020  me()..          
+000235e0: 2020 2020 2020 7072 696e 7428 0d0a 2020        print(..  
+000235f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00023600: 2020 2757 6172 6e69 6e67 203a 204e 6f20    'Warning : No 
+00023610: 6461 7461 2072 6574 7572 6e65 6420 2620  data returned & 
+00023620: 6c61 7374 5061 6765 2069 7320 4661 6c73  lastPage is Fals
+00023630: 652e 5c6e 4578 6974 2074 6865 206c 6f6f  e.\nExit the loo
+00023640: 7020 2d20 6e6f 2073 6176 6520 6669 6c65  p - no save file
+00023650: 2026 2065 6d70 7479 2064 6174 6166 7261   & empty datafra
+00023660: 6d65 2e27 290d 0a20 2020 2020 2020 2020  me.')..         
+00023670: 2020 2020 2020 2069 6620 6465 6275 673a         if debug:
+00023680: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00023690: 2020 2020 2020 7769 7468 206f 7065 6e28        with open(
+000236a0: 6627 7265 706f 7274 5f6e 6f5f 656c 656d  f'report_no_elem
+000236b0: 656e 745f 7b74 696d 6573 7461 6d70 7d2e  ent_{timestamp}.
+000236c0: 6a73 6f6e 272c 2027 7727 2920 6173 2066  json', 'w') as f
+000236d0: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+000236e0: 2020 2020 2020 2020 2020 2066 2e77 7269             f.wri
+000236f0: 7465 286a 736f 6e2e 6475 6d70 7328 7265  te(json.dumps(re
+00023700: 706f 7274 2c20 696e 6465 6e74 3d34 2929  port, indent=4))
+00023710: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00023720: 2020 6966 2076 6572 626f 7365 3a0d 0a20    if verbose:.. 
+00023730: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00023740: 2020 2070 7269 6e74 280d 0a20 2020 2020     print(..     
+00023750: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00023760: 2020 2066 2725 206f 6620 746f 7461 6c20     f'% of total 
+00023770: 656c 656d 656e 7473 2072 6574 7269 6576  elements retriev
+00023780: 6564 2e20 546f 7461 6c45 6c65 6d65 6e74  ed. TotalElement
+00023790: 733a 207b 7265 706f 7274 2e67 6574 2822  s: {report.get("
+000237a0: 746f 7461 6c45 6c65 6d65 6e74 7322 2c20  totalElements", 
+000237b0: 226e 6f20 6461 7461 2229 7d27 290d 0a20  "no data")}').. 
+000237c0: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+000237d0: 6574 7572 6e20 6f62 6a20 2023 2069 6e20  eturn obj  # in 
+000237e0: 6361 7365 206c 6f6f 7020 6861 7070 656e  case loop happen
+000237f0: 696e 6720 7769 7468 2065 6d70 7479 2064  ing with empty d
+00023800: 6174 612c 2072 6574 7572 6e73 2065 6d70  ata, returns emp
+00023810: 7479 2064 6174 610d 0a20 2020 2020 2020  ty data..       
+00023820: 2020 2020 2069 6620 7665 7262 6f73 6520       if verbose 
+00023830: 616e 6420 746f 7461 6c5f 656c 656d 656e  and total_elemen
+00023840: 7473 2021 3d20 303a 0d0a 2020 2020 2020  ts != 0:..      
+00023850: 2020 2020 2020 2020 2020 7072 696e 7428            print(
+00023860: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00023870: 2020 2020 2020 6627 2520 6f66 2074 6f74        f'% of tot
+00023880: 616c 2065 6c65 6d65 6e74 7320 7265 7472  al elements retr
+00023890: 6965 7665 643a 207b 726f 756e 6428 2863  ieved: {round((c
+000238a0: 6f75 6e74 5f65 6c65 6d65 6e74 7320 2f20  ount_elements / 
+000238b0: 746f 7461 6c5f 656c 656d 656e 7473 2920  total_elements) 
+000238c0: 2a20 3130 302c 2032 297d 2025 2729 0d0a  * 100, 2)} %')..
+000238d0: 2020 2020 2020 2020 2020 2020 6966 206c              if l
+000238e0: 6173 745f 7061 6765 203d 3d20 4661 6c73  ast_page == Fals
+000238f0: 6520 616e 6420 6e5f 7265 7375 6c74 7320  e and n_results 
+00023900: 213d 2066 6c6f 6174 2827 696e 6627 293a  != float('inf'):
+00023910: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00023920: 2020 6966 2063 6f75 6e74 5f65 6c65 6d65    if count_eleme
+00023930: 6e74 7320 3e3d 206e 5f72 6573 756c 7473  nts >= n_results
+00023940: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+00023950: 2020 2020 2020 206c 6173 745f 7061 6765         last_page
+00023960: 203d 2054 7275 650d 0a20 2020 2020 2020   = True..       
+00023970: 2020 2020 2064 6174 6120 3d20 7265 706f       data = repo
+00023980: 7274 5b27 726f 7773 275d 0d0a 2020 2020  rt['rows']..    
+00023990: 2020 2020 2020 2020 6461 7461 5f6c 6973          data_lis
+000239a0: 7420 2b3d 2064 6565 7063 6f70 7928 6461  t += deepcopy(da
+000239b0: 7461 2920 2023 2064 6f20 6120 6465 6570  ta)  # do a deep
+000239c0: 636f 7079 0d0a 2020 2020 2020 2020 2020  copy..          
+000239d0: 2020 7061 6765 5f6e 6220 2b3d 2031 0d0a    page_nb += 1..
+000239e0: 2020 2020 2020 2020 2020 2020 6966 2076              if v
+000239f0: 6572 626f 7365 3a0d 0a20 2020 2020 2020  erbose:..       
+00023a00: 2020 2020 2020 2020 2070 7269 6e74 2866           print(f
+00023a10: 2723 206f 6620 7265 7175 6573 7473 203a  '# of requests :
+00023a20: 207b 7061 6765 5f6e 627d 2729 0d0a 2020   {page_nb}')..  
+00023a30: 2020 2020 2020 2320 7265 7475 726e 2072        # return r
+00023a40: 6570 6f72 740d 0a20 2020 2020 2020 2064  eport..        d
+00023a50: 6620 3d20 7365 6c66 2e5f 7265 6164 4461  f = self._readDa
+00023a60: 7461 2864 6174 615f 6c69 7374 2c20 616e  ta(data_list, an
+00023a70: 6f6d 616c 793d 616e 6f6d 616c 792c 0d0a  omaly=anomaly,..
+00023a80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00023a90: 2020 2020 2020 2020 2020 2020 636f 6c73              cols
+00023aa0: 3d63 6f6c 756d 6e73 2c20 6974 656d 5f69  =columns, item_i
+00023ab0: 643d 6974 656d 5f69 6429 0d0a 2020 2020  d=item_id)..    
+00023ac0: 2020 2020 6966 2073 6176 653a 0d0a 2020      if save:..  
+00023ad0: 2020 2020 2020 2020 2020 7469 6d65 7374            timest
+00023ae0: 616d 7052 6570 6f72 7420 3d20 726f 756e  ampReport = roun
+00023af0: 6428 7469 6d65 2e74 696d 6528 2929 0d0a  d(time.time())..
+00023b00: 2020 2020 2020 2020 2020 2020 6466 2e74              df.t
+00023b10: 6f5f 6373 7628 6627 7265 706f 7274 2d7b  o_csv(f'report-{
+00023b20: 7469 6d65 7374 616d 7052 6570 6f72 747d  timestampReport}
+00023b30: 2e63 7376 272c 2069 6e64 6578 3d46 616c  .csv', index=Fal
+00023b40: 7365 290d 0a20 2020 2020 2020 2020 2020  se)..           
+00023b50: 2069 6620 7665 7262 6f73 653a 0d0a 2020   if verbose:..  
+00023b60: 2020 2020 2020 2020 2020 2020 2020 7072                pr
+00023b70: 696e 7428 0d0a 2020 2020 2020 2020 2020  int(..          
+00023b80: 2020 2020 2020 2020 2020 6627 5361 7669            f'Savi
+00023b90: 6e67 2064 6174 6120 696e 2066 696c 6520  ng data in file 
+00023ba0: 3a20 7b6f 732e 6765 7463 7764 2829 7d7b  : {os.getcwd()}{
+00023bb0: 6f73 2e73 6570 7d72 6570 6f72 742d 7b74  os.sep}report-{t
+00023bc0: 696d 6573 7461 6d70 5265 706f 7274 7d2e  imestampReport}.
+00023bd0: 6373 7627 290d 0a20 2020 2020 2020 206f  csv')..        o
+00023be0: 626a 5b27 6461 7461 275d 203d 2064 660d  bj['data'] = df.
+00023bf0: 0a20 2020 2020 2020 2069 6620 7665 7262  .        if verb
+00023c00: 6f73 653a 0d0a 2020 2020 2020 2020 2020  ose:..          
+00023c10: 2020 7072 696e 7428 0d0a 2020 2020 2020    print(..      
+00023c20: 2020 2020 2020 2020 2020 6627 5265 706f            f'Repo
+00023c30: 7274 2063 6f6e 7461 696e 7320 7b28 636f  rt contains {(co
+00023c40: 756e 745f 656c 656d 656e 7473 202f 2074  unt_elements / t
+00023c50: 6f74 616c 5f65 6c65 6d65 6e74 7329 202a  otal_elements) *
+00023c60: 2031 3030 7d20 2520 6f66 2074 6865 2061   100} % of the a
+00023c70: 7661 696c 6162 6c65 2064 696d 656e 7369  vailable dimensi
+00023c80: 6f6e 7327 290d 0a20 2020 2020 2020 2072  ons')..        r
+00023c90: 6574 7572 6e20 6f62 6a0d 0a20 2020 200d  eturn obj..    .
+00023ca0: 0a20 2020 2064 6566 205f 7072 6570 6172  .    def _prepar
+00023cb0: 6544 6174 6128 0d0a 2020 2020 2020 2020  eData(..        
+00023cc0: 7365 6c66 2c0d 0a20 2020 2020 2020 2064  self,..        d
+00023cd0: 6174 6152 6f77 733a 206c 6973 7420 3d20  ataRows: list = 
+00023ce0: 4e6f 6e65 2c0d 0a20 2020 2020 2020 2072  None,..        r
+00023cf0: 6570 6f72 7454 7970 653a 2073 7472 203d  eportType: str =
+00023d00: 2022 6e6f 726d 616c 222c 0d0a 2020 2020   "normal",..    
+00023d10: 2920 2d3e 2064 6963 743a 0d0a 2020 2020  ) -> dict:..    
+00023d20: 2020 2020 2222 220d 0a20 2020 2020 2020      """..       
+00023d30: 2052 6561 6420 7468 6520 6461 7461 2072   Read the data r
+00023d40: 6574 7572 6e65 6420 6279 2074 6865 2067  eturned by the g
+00023d50: 6574 5265 706f 7274 2061 6e64 2072 6574  etReport and ret
+00023d60: 7572 6e73 2061 2064 6963 7469 6f6e 6172  urns a dictionar
+00023d70: 7920 7573 6564 2062 7920 7468 6520 576f  y used by the Wo
+00023d80: 726b 7370 6163 6520 636c 6173 732e 0d0a  rkspace class...
+00023d90: 2020 2020 2020 2020 4172 6775 6d65 6e74          Argument
+00023da0: 733a 0d0a 2020 2020 2020 2020 2020 2020  s:..            
+00023db0: 6461 7461 526f 7773 203a 2052 4551 5549  dataRows : REQUI
+00023dc0: 5245 4420 3a20 6461 7461 2072 6f77 7320  RED : data rows 
+00023dd0: 6461 7461 2066 726f 6d20 434a 4120 4150  data from CJA AP
+00023de0: 4920 6765 7452 6570 6f72 740d 0a20 2020  I getReport..   
+00023df0: 2020 2020 2020 2020 2072 6570 6f72 7454           reportT
+00023e00: 7970 6520 3a20 5245 5155 4952 4544 203a  ype : REQUIRED :
+00023e10: 2022 6e6f 726d 616c 2220 6f72 2022 7374   "normal" or "st
+00023e20: 6174 6963 220d 0a20 2020 2020 2020 2022  atic"..        "
+00023e30: 2222 0d0a 2020 2020 2020 2020 6966 2064  ""..        if d
+00023e40: 6174 6152 6f77 7320 6973 204e 6f6e 653a  ataRows is None:
+00023e50: 0d0a 2020 2020 2020 2020 2020 2020 7261  ..            ra
+00023e60: 6973 6520 5661 6c75 6545 7272 6f72 2822  ise ValueError("
+00023e70: 5265 7175 6972 6520 6461 7461 526f 7773  Require dataRows
+00023e80: 2229 0d0a 2020 2020 2020 2020 6461 7461  ")..        data
+00023e90: 5f72 6f77 7320 3d20 6465 6570 636f 7079  _rows = deepcopy
+00023ea0: 2864 6174 6152 6f77 7329 0d0a 2020 2020  (dataRows)..    
+00023eb0: 2020 2020 6578 7061 6e64 6564 5f72 6f77      expanded_row
+00023ec0: 7320 3d20 7b7d 0d0a 2020 2020 2020 2020  s = {}..        
+00023ed0: 6966 2072 6570 6f72 7454 7970 6520 3d3d  if reportType ==
+00023ee0: 2022 6e6f 726d 616c 223a 0d0a 2020 2020   "normal":..    
+00023ef0: 2020 2020 2020 2020 666f 7220 726f 7720          for row 
+00023f00: 696e 2064 6174 615f 726f 7773 3a0d 0a20  in data_rows:.. 
+00023f10: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+00023f20: 7870 616e 6465 645f 726f 7773 5b72 6f77  xpanded_rows[row
+00023f30: 5b22 6974 656d 4964 225d 5d20 3d20 5b72  ["itemId"]] = [r
+00023f40: 6f77 5b22 7661 6c75 6522 5d5d 0d0a 2020  ow["value"]]..  
+00023f50: 2020 2020 2020 2020 2020 2020 2020 6578                ex
+00023f60: 7061 6e64 6564 5f72 6f77 735b 726f 775b  panded_rows[row[
+00023f70: 2269 7465 6d49 6422 5d5d 202b 3d20 726f  "itemId"]] += ro
+00023f80: 775b 2264 6174 6122 5d0d 0a20 2020 2020  w["data"]..     
+00023f90: 2020 2065 6c69 6620 7265 706f 7274 5479     elif reportTy
+00023fa0: 7065 203d 3d20 2273 7461 7469 6322 3a0d  pe == "static":.
+00023fb0: 0a20 2020 2020 2020 2020 2020 2065 7870  .            exp
+00023fc0: 616e 6465 645f 726f 7773 203d 2064 6174  anded_rows = dat
+00023fd0: 615f 726f 7773 0d0a 2020 2020 2020 2020  a_rows..        
+00023fe0: 7265 7475 726e 2065 7870 616e 6465 645f  return expanded_
+00023ff0: 726f 7773 0d0a 0d0a 2020 2020 6465 6620  rows....    def 
+00024000: 5f64 6563 7279 7074 6553 7461 7469 6344  _decrypteStaticD
+00024010: 6174 6128 0d0a 2020 2020 2020 2020 7365  ata(..        se
+00024020: 6c66 2c20 6461 7461 5265 7175 6573 743a  lf, dataRequest:
+00024030: 2064 6963 7420 3d20 4e6f 6e65 2c20 7265   dict = None, re
+00024040: 7370 6f6e 7365 3a20 6469 6374 203d 204e  sponse: dict = N
+00024050: 6f6e 652c 7265 736f 6c76 6543 6f6c 756d  one,resolveColum
+00024060: 6e73 3a62 6f6f 6c3d 4661 6c73 650d 0a20  ns:bool=False.. 
+00024070: 2020 2029 202d 3e20 6469 6374 3a0d 0a20     ) -> dict:.. 
+00024080: 2020 2020 2020 2022 2222 0d0a 2020 2020         """..    
+00024090: 2020 2020 4672 6f6d 2074 6865 2072 6571      From the req
+000240a0: 7565 7374 2064 6963 7469 6f6e 6172 7920  uest dictionary 
+000240b0: 616e 6420 7468 6520 7265 7370 6f6e 7365  and the response
+000240c0: 2c20 6465 6372 7970 7465 2074 6865 2064  , decrypte the d
+000240d0: 6174 6120 746f 2073 7461 6e64 6172 6469  ata to standardi
+000240e0: 7365 2074 6865 2072 6561 6469 6e67 2e0d  se the reading..
+000240f0: 0a20 2020 2020 2020 2022 2222 0d0a 2020  .        """..  
+00024100: 2020 2020 2020 6461 7461 526f 7773 203d        dataRows =
+00024110: 205b 5d0d 0a20 2020 2020 2020 2023 2320   []..        ## 
+00024120: 7265 7472 6965 7665 2053 7461 7469 6352  retrieve StaticR
+00024130: 6f77 2049 4420 616e 6420 7365 676d 656e  ow ID and segmen
+00024140: 7449 440d 0a20 2020 2020 2020 2069 6620  tID..        if 
+00024150: 6c65 6e28 5b6d 6574 7269 6320 666f 7220  len([metric for 
+00024160: 6d65 7472 6963 2069 6e20 6461 7461 5265  metric in dataRe
+00024170: 7175 6573 745b 276d 6574 7269 6343 6f6e  quest['metricCon
+00024180: 7461 696e 6572 275d 2e67 6574 2827 6d65  tainer'].get('me
+00024190: 7472 6963 4669 6c74 6572 7327 2c5b 5d29  tricFilters',[])
+000241a0: 2069 6620 6d65 7472 6963 2e67 6574 2827   if metric.get('
+000241b0: 6964 272c 2727 292e 7374 6172 7473 7769  id','').startswi
+000241c0: 7468 2822 5354 4154 4943 5f52 4f57 5f43  th("STATIC_ROW_C
+000241d0: 4f4d 504f 4e45 4e54 2229 5d29 3e30 3a0d  OMPONENT")])>0:.
+000241e0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+000241f0: 2022 6461 7465 5261 6e67 6522 2069 6e20   "dateRange" in 
+00024200: 6c69 7374 2864 6174 6152 6571 7565 7374  list(dataRequest
+00024210: 5b27 6d65 7472 6963 436f 6e74 6169 6e65  ['metricContaine
+00024220: 7227 5d2e 6765 7428 276d 6574 7269 6346  r'].get('metricF
+00024230: 696c 7465 7273 272c 5b5d 295b 305d 2e6b  ilters',[])[0].k
+00024240: 6579 7328 2929 3a0d 0a20 2020 2020 2020  eys()):..       
+00024250: 2020 2020 2020 2020 2074 6162 6c65 5365           tableSe
+00024260: 676d 656e 7473 526f 7773 203d 207b 0d0a  gmentsRows = {..
+00024270: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00024280: 2020 2020 6f62 6a5b 2269 6422 5d3a 206f      obj["id"]: o
+00024290: 626a 5b22 6461 7465 5261 6e67 6522 5d0d  bj["dateRange"].
+000242a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000242b0: 2020 2020 2066 6f72 206f 626a 2069 6e20       for obj in 
+000242c0: 6461 7461 5265 7175 6573 745b 226d 6574  dataRequest["met
+000242d0: 7269 6343 6f6e 7461 696e 6572 225d 5b22  ricContainer"]["
+000242e0: 6d65 7472 6963 4669 6c74 6572 7322 5d0d  metricFilters"].
+000242f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00024300: 2020 2020 2069 6620 6f62 6a5b 2269 6422       if obj["id"
+00024310: 5d2e 7374 6172 7473 7769 7468 2822 5354  ].startswith("ST
+00024320: 4154 4943 5f52 4f57 5f43 4f4d 504f 4e45  ATIC_ROW_COMPONE
+00024330: 4e54 2229 0d0a 2020 2020 2020 2020 2020  NT")..          
+00024340: 2020 2020 2020 7d0d 0a20 2020 2020 2020        }..       
+00024350: 2020 2020 2065 6c69 6620 2273 6567 6d65       elif "segme
+00024360: 6e74 4964 2220 696e 206c 6973 7428 6461  ntId" in list(da
+00024370: 7461 5265 7175 6573 745b 276d 6574 7269  taRequest['metri
+00024380: 6343 6f6e 7461 696e 6572 275d 2e67 6574  cContainer'].get
+00024390: 2827 6d65 7472 6963 4669 6c74 6572 7327  ('metricFilters'
+000243a0: 2c5b 5d29 5b30 5d2e 6b65 7973 2829 293a  ,[])[0].keys()):
+000243b0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+000243c0: 2020 7461 626c 6553 6567 6d65 6e74 7352    tableSegmentsR
+000243d0: 6f77 7320 3d20 7b0d 0a20 2020 2020 2020  ows = {..       
+000243e0: 2020 2020 2020 2020 2020 2020 206f 626a               obj
+000243f0: 5b22 6964 225d 3a20 6f62 6a5b 2273 6567  ["id"]: obj["seg
+00024400: 6d65 6e74 4964 225d 0d0a 2020 2020 2020  mentId"]..      
+00024410: 2020 2020 2020 2020 2020 2020 2020 666f                fo
+00024420: 7220 6f62 6a20 696e 2064 6174 6152 6571  r obj in dataReq
+00024430: 7565 7374 5b22 6d65 7472 6963 436f 6e74  uest["metricCont
+00024440: 6169 6e65 7222 5d5b 226d 6574 7269 6346  ainer"]["metricF
+00024450: 696c 7465 7273 225d 0d0a 2020 2020 2020  ilters"]..      
+00024460: 2020 2020 2020 2020 2020 2020 2020 6966                if
+00024470: 206f 626a 5b22 6964 225d 2e73 7461 7274   obj["id"].start
+00024480: 7377 6974 6828 2253 5441 5449 435f 524f  swith("STATIC_RO
+00024490: 575f 434f 4d50 4f4e 454e 5422 290d 0a20  W_COMPONENT").. 
+000244a0: 2020 2020 2020 2020 2020 2020 2020 207d                 }
+000244b0: 0d0a 2020 2020 2020 2020 656c 7365 3a0d  ..        else:.
+000244c0: 0a20 2020 2020 2020 2020 2020 2074 6162  .            tab
+000244d0: 6c65 5365 676d 656e 7473 526f 7773 203d  leSegmentsRows =
+000244e0: 207b 0d0a 2020 2020 2020 2020 2020 2020   {..            
+000244f0: 2020 2020 6f62 6a5b 2269 6422 5d3a 206f      obj["id"]: o
+00024500: 626a 5b22 7365 676d 656e 7449 6422 5d0d  bj["segmentId"].
+00024510: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00024520: 2066 6f72 206f 626a 2069 6e20 6461 7461   for obj in data
+00024530: 5265 7175 6573 745b 226d 6574 7269 6343  Request["metricC
+00024540: 6f6e 7461 696e 6572 225d 5b22 6d65 7472  ontainer"]["metr
+00024550: 6963 4669 6c74 6572 7322 5d0d 0a20 2020  icFilters"]..   
+00024560: 2020 2020 2020 2020 207d 0d0a 2020 2020           }..    
+00024570: 2020 2020 2323 2072 6574 7269 6576 6520      ## retrieve 
+00024580: 706c 6163 6520 616e 6420 7365 676d 656e  place and segmen
+00024590: 7449 440d 0a20 2020 2020 2020 2073 6567  tID..        seg
+000245a0: 6d65 6e74 4170 706c 6965 6420 3d20 7b7d  mentApplied = {}
+000245b0: 0d0a 2020 2020 2020 2020 666f 7220 6f62  ..        for ob
+000245c0: 6a20 696e 2064 6174 6152 6571 7565 7374  j in dataRequest
+000245d0: 5b22 6d65 7472 6963 436f 6e74 6169 6e65  ["metricContaine
+000245e0: 7222 5d5b 226d 6574 7269 6346 696c 7465  r"]["metricFilte
+000245f0: 7273 225d 3a0d 0a20 2020 2020 2020 2020  rs"]:..         
+00024600: 2020 2069 6620 6f62 6a5b 2269 6422 5d2e     if obj["id"].
+00024610: 7374 6172 7473 7769 7468 2822 5354 4154  startswith("STAT
+00024620: 4943 5f52 4f57 2229 203d 3d20 4661 6c73  IC_ROW") == Fals
+00024630: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
+00024640: 2020 2020 6966 206f 626a 5b22 7479 7065      if obj["type
+00024650: 225d 203d 3d20 2262 7265 616b 646f 776e  "] == "breakdown
+00024660: 223a 0d0a 2020 2020 2020 2020 2020 2020  ":..            
+00024670: 2020 2020 2020 2020 7365 676d 656e 7441          segmentA
+00024680: 7070 6c69 6564 5b6f 626a 5b22 6964 225d  pplied[obj["id"]
+00024690: 5d20 3d20 6622 7b6f 626a 5b27 6469 6d65  ] = f"{obj['dime
+000246a0: 6e73 696f 6e27 5d7d 3a3a 3a7b 6f62 6a5b  nsion']}:::{obj[
+000246b0: 2769 7465 6d49 6427 5d7d 220d 0a20 2020  'itemId']}"..   
+000246c0: 2020 2020 2020 2020 2020 2020 2065 6c69               eli
+000246d0: 6620 6f62 6a5b 2274 7970 6522 5d20 3d3d  f obj["type"] ==
+000246e0: 2022 7365 676d 656e 7422 3a0d 0a20 2020   "segment":..   
+000246f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00024700: 2073 6567 6d65 6e74 4170 706c 6965 645b   segmentApplied[
+00024710: 6f62 6a5b 2269 6422 5d5d 203d 206f 626a  obj["id"]] = obj
+00024720: 5b22 7365 676d 656e 7449 6422 5d0d 0a20  ["segmentId"].. 
+00024730: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+00024740: 6c69 6620 6f62 6a5b 2274 7970 6522 5d20  lif obj["type"] 
+00024750: 3d3d 2022 6461 7465 5261 6e67 6522 3a0d  == "dateRange":.
+00024760: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00024770: 2020 2020 2073 6567 6d65 6e74 4170 706c       segmentAppl
+00024780: 6965 645b 6f62 6a5b 2269 6422 5d5d 203d  ied[obj["id"]] =
+00024790: 206f 626a 5b22 6461 7465 5261 6e67 6522   obj["dateRange"
+000247a0: 5d0d 0a20 2020 2020 2020 2023 2323 2074  ]..        ### t
+000247b0: 6162 6c65 2063 6f6c 756d 6e49 6473 2061  able columnIds a
+000247c0: 6e64 2053 7461 7469 6352 6f77 2049 4473  nd StaticRow IDs
+000247d0: 0d0a 2020 2020 2020 2020 7461 626c 6543  ..        tableC
+000247e0: 6f6c 756d 6e49 6473 203d 207b 0d0a 2020  olumnIds = {..  
+000247f0: 2020 2020 2020 2020 2020 6f62 6a5b 2263            obj["c
+00024800: 6f6c 756d 6e49 6422 5d3a 206f 626a 5b22  olumnId"]: obj["
+00024810: 6669 6c74 6572 7322 5d5b 305d 0d0a 2020  filters"][0]..  
+00024820: 2020 2020 2020 2020 2020 666f 7220 6f62            for ob
+00024830: 6a20 696e 2064 6174 6152 6571 7565 7374  j in dataRequest
+00024840: 5b22 6d65 7472 6963 436f 6e74 6169 6e65  ["metricContaine
+00024850: 7222 5d5b 226d 6574 7269 6373 225d 0d0a  r"]["metrics"]..
+00024860: 2020 2020 2020 2020 7d0d 0a20 2020 2020          }..     
+00024870: 2020 2023 2323 2063 7265 6174 6520 7265     ### create re
+00024880: 6c61 7469 6f6e 7320 666f 7220 6d65 7472  lations for metr
+00024890: 6963 7320 7769 7468 2046 696c 7465 7220  ics with Filter 
+000248a0: 6f6e 2074 6f70 0d0a 2020 2020 2020 2020  on top..        
+000248b0: 6669 6c74 6572 5265 6c61 7469 6f6e 7320  filterRelations 
+000248c0: 3d20 7b0d 0a20 2020 2020 2020 2020 2020  = {..           
+000248d0: 206f 626a 5b22 6669 6c74 6572 7322 5d5b   obj["filters"][
+000248e0: 305d 3a20 6f62 6a5b 2266 696c 7465 7273  0]: obj["filters
+000248f0: 225d 5b31 3a5d 0d0a 2020 2020 2020 2020  "][1:]..        
+00024900: 2020 2020 666f 7220 6f62 6a20 696e 2064      for obj in d
+00024910: 6174 6152 6571 7565 7374 5b22 6d65 7472  ataRequest["metr
+00024920: 6963 436f 6e74 6169 6e65 7222 5d5b 226d  icContainer"]["m
+00024930: 6574 7269 6373 225d 0d0a 2020 2020 2020  etrics"]..      
+00024940: 2020 2020 2020 6966 206c 656e 286f 626a        if len(obj
+00024950: 5b22 6669 6c74 6572 7322 5d29 203e 2031  ["filters"]) > 1
+00024960: 0d0a 2020 2020 2020 2020 7d0d 0a20 2020  ..        }..   
+00024970: 2020 2020 2073 7461 7469 6352 6f77 7320       staticRows 
+00024980: 3d20 7365 7428 7661 6c20 666f 7220 7661  = set(val for va
+00024990: 6c20 696e 2074 6162 6c65 5365 676d 656e  l in tableSegmen
+000249a0: 7473 526f 7773 2e76 616c 7565 7328 2929  tsRows.values())
+000249b0: 0d0a 2020 2020 2020 2020 6e62 5f72 6f77  ..        nb_row
+000249c0: 7320 3d20 6c65 6e28 7374 6174 6963 526f  s = len(staticRo
+000249d0: 7773 2920 2023 2320 6465 6669 6e65 2020  ws)  ## define  
+000249e0: 686f 7720 6d61 6e79 2073 6567 6d65 6e74  how many segment
+000249f0: 2075 7365 6420 6173 2072 6f77 730d 0a20   used as rows.. 
+00024a00: 2020 2020 2020 206e 625f 636f 6c75 6d6e         nb_column
+00024a10: 7320 3d20 696e 7428 0d0a 2020 2020 2020  s = int(..      
+00024a20: 2020 2020 2020 6c65 6e28 6461 7461 5265        len(dataRe
+00024a30: 7175 6573 745b 226d 6574 7269 6343 6f6e  quest["metricCon
+00024a40: 7461 696e 6572 225d 5b22 6d65 7472 6963  tainer"]["metric
+00024a50: 7322 5d29 202f 206e 625f 726f 7773 0d0a  s"]) / nb_rows..
+00024a60: 2020 2020 2020 2020 2920 2023 2320 7573          )  ## us
+00024a70: 6520 746f 2064 6574 6563 7420 726f 7773  e to detect rows
+00024a80: 0d0a 2020 2020 2020 2020 7374 6174 6963  ..        static
+00024a90: 526f 7773 203d 2073 6574 2876 616c 2066  Rows = set(val f
+00024aa0: 6f72 2076 616c 2069 6e20 7461 626c 6553  or val in tableS
+00024ab0: 6567 6d65 6e74 7352 6f77 732e 7661 6c75  egmentsRows.valu
+00024ac0: 6573 2829 290d 0a20 2020 2020 2020 2073  es())..        s
+00024ad0: 7461 7469 6352 6f77 734e 616d 6573 203d  taticRowsNames =
+00024ae0: 205b 5d0d 0a20 2020 2020 2020 2066 6f72   []..        for
+00024af0: 2072 6f77 2069 6e20 7374 6174 6963 526f   row in staticRo
+00024b00: 7773 3a0d 0a20 2020 2020 2020 2020 2020  ws:..           
+00024b10: 2069 6620 726f 772e 7374 6172 7473 7769   if row.startswi
+00024b20: 7468 2822 7322 2920 616e 6420 2240 4164  th("s") and "@Ad
+00024b30: 6f62 654f 7267 2220 696e 2072 6f77 3a0d  obeOrg" in row:.
+00024b40: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00024b50: 2066 696c 7465 7220 3d20 7365 6c66 2e53   filter = self.S
+00024b60: 6567 6d65 6e74 2872 6f77 290d 0a20 2020  egment(row)..   
+00024b70: 2020 2020 2020 2020 2020 2020 2073 7461               sta
+00024b80: 7469 6352 6f77 734e 616d 6573 2e61 7070  ticRowsNames.app
+00024b90: 656e 6428 6669 6c74 6572 5b22 6e61 6d65  end(filter["name
+00024ba0: 225d 290d 0a20 2020 2020 2020 2020 2020  "])..           
+00024bb0: 2065 6c73 653a 0d0a 2020 2020 2020 2020   else:..        
+00024bc0: 2020 2020 2020 2020 7374 6174 6963 526f          staticRo
+00024bd0: 7773 4e61 6d65 732e 6170 7065 6e64 2872  wsNames.append(r
+00024be0: 6f77 290d 0a20 2020 2020 2020 2069 6620  ow)..        if 
+00024bf0: 7265 736f 6c76 6543 6f6c 756d 6e73 3a0d  resolveColumns:.
+00024c00: 0a20 2020 2020 2020 2020 2020 2073 7461  .            sta
+00024c10: 7469 6352 6f77 4469 6374 203d 207b 0d0a  ticRowDict = {..
+00024c20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00024c30: 726f 773a 2073 656c 662e 6765 7453 6567  row: self.getSeg
+00024c40: 6d65 6e74 2872 6f77 4e61 6d65 292e 6765  ment(rowName).ge
+00024c50: 7428 276e 616d 6527 2c72 6f77 4e61 6d65  t('name',rowName
+00024c60: 2920 666f 7220 726f 772c 2072 6f77 4e61  ) for row, rowNa
+00024c70: 6d65 2069 6e20 7a69 7028 7374 6174 6963  me in zip(static
+00024c80: 526f 7773 2c20 7374 6174 6963 526f 7773  Rows, staticRows
+00024c90: 4e61 6d65 7329 0d0a 2020 2020 2020 2020  Names)..        
+00024ca0: 2020 2020 7d0d 0a20 2020 2020 2020 2065      }..        e
+00024cb0: 6c73 653a 0d0a 2020 2020 2020 2020 2020  lse:..          
+00024cc0: 2020 7374 6174 6963 526f 7744 6963 7420    staticRowDict 
+00024cd0: 3d20 7b0d 0a20 2020 2020 2020 2020 2020  = {..           
+00024ce0: 2020 2020 2072 6f77 3a20 726f 774e 616d       row: rowNam
+00024cf0: 6520 666f 7220 726f 772c 2072 6f77 4e61  e for row, rowNa
+00024d00: 6d65 2069 6e20 7a69 7028 7374 6174 6963  me in zip(static
+00024d10: 526f 7773 2c20 7374 6174 6963 526f 7773  Rows, staticRows
+00024d20: 4e61 6d65 7329 0d0a 2020 2020 2020 2020  Names)..        
+00024d30: 2020 2020 7d0d 0a20 2020 2020 2020 2023      }..        #
+00024d40: 2323 206d 6574 7269 6373 0d0a 2020 2020  ## metrics..    
+00024d50: 2020 2020 6461 7461 526f 7773 203d 2064      dataRows = d
+00024d60: 6566 6175 6c74 6469 6374 286c 6973 7429  efaultdict(list)
+00024d70: 0d0a 2020 2020 2020 2020 666f 7220 726f  ..        for ro
+00024d80: 7720 696e 2073 7461 7469 6352 6f77 4469  w in staticRowDi
+00024d90: 6374 3a20 2023 2320 6974 6572 206f 6e20  ct:  ## iter on 
+00024da0: 7468 6520 6469 6666 6572 656e 7420 7374  the different st
+00024db0: 6174 6963 2072 6f77 730d 0a20 2020 2020  atic rows..     
+00024dc0: 2020 2020 2020 2066 6f72 2063 6f6c 756d         for colum
+00024dd0: 6e2c 2064 6174 6120 696e 207a 6970 280d  n, data in zip(.
+00024de0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00024df0: 2072 6573 706f 6e73 655b 2263 6f6c 756d   response["colum
+00024e00: 6e73 225d 5b22 636f 6c75 6d6e 4964 7322  ns"]["columnIds"
+00024e10: 5d2c 2072 6573 706f 6e73 655b 2273 756d  ], response["sum
+00024e20: 6d61 7279 4461 7461 225d 5b22 746f 7461  maryData"]["tota
+00024e30: 6c73 225d 0d0a 2020 2020 2020 2020 2020  ls"]..          
+00024e40: 2020 293a 0d0a 2020 2020 2020 2020 2020    ):..          
+00024e50: 2020 2020 2020 6966 2074 6162 6c65 5365        if tableSe
+00024e60: 676d 656e 7473 526f 7773 5b74 6162 6c65  gmentsRows[table
+00024e70: 436f 6c75 6d6e 4964 735b 636f 6c75 6d6e  ColumnIds[column
+00024e80: 5d5d 203d 3d20 726f 773a 0d0a 2020 2020  ]] == row:..    
+00024e90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00024ea0: 2323 2063 6865 636b 2074 7261 6e73 6c61  ## check transla
+00024eb0: 7469 6f6e 206f 6620 6d65 7472 6963 4964  tion of metricId
+00024ec0: 2077 6974 6820 5374 6174 6963 2052 6f77   with Static Row
+00024ed0: 2049 440d 0a20 2020 2020 2020 2020 2020   ID..           
+00024ee0: 2020 2020 2020 2020 2069 6620 726f 7720           if row 
+00024ef0: 6e6f 7420 696e 2064 6174 6152 6f77 735b  not in dataRows[
+00024f00: 7374 6174 6963 526f 7744 6963 745b 726f  staticRowDict[ro
+00024f10: 775d 5d3a 0d0a 2020 2020 2020 2020 2020  w]]:..          
+00024f20: 2020 2020 2020 2020 2020 2020 2020 6461                da
+00024f30: 7461 526f 7773 5b73 7461 7469 6352 6f77  taRows[staticRow
+00024f40: 4469 6374 5b72 6f77 5d5d 2e61 7070 656e  Dict[row]].appen
+00024f50: 6428 726f 7729 0d0a 2020 2020 2020 2020  d(row)..        
+00024f60: 2020 2020 2020 2020 2020 2020 6461 7461              data
+00024f70: 526f 7773 5b73 7461 7469 6352 6f77 4469  Rows[staticRowDi
+00024f80: 6374 5b72 6f77 5d5d 2e61 7070 656e 6428  ct[row]].append(
+00024f90: 6461 7461 290d 0a20 2020 2020 2020 2020  data)..         
+00024fa0: 2020 2020 2020 2023 2320 7368 6f75 6c64         ## should
+00024fb0: 2065 6e64 7320 6c69 6b65 203a 207b 2773   ends like : {'s
+00024fc0: 6567 6d65 6e74 4e61 6d65 2720 3a20 5b27  egmentName' : ['
+00024fd0: 5354 4154 4943 272c 3132 332c 3435 365d  STATIC',123,456]
+00024fe0: 7d0d 0a20 2020 2020 2020 2072 6574 7572  }..        retur
+00024ff0: 6e20 6e62 5f63 6f6c 756d 6e73 2c20 7461  n nb_columns, ta
+00025000: 626c 6543 6f6c 756d 6e49 6473 2c20 7365  bleColumnIds, se
+00025010: 676d 656e 7441 7070 6c69 6564 2c20 6669  gmentApplied, fi
+00025020: 6c74 6572 5265 6c61 7469 6f6e 732c 2064  lterRelations, d
+00025030: 6174 6152 6f77 730d 0a0d 0a20 2020 2064  ataRows....    d
+00025040: 6566 2067 6574 5265 706f 7274 3228 0d0a  ef getReport2(..
+00025050: 2020 2020 2020 2020 7365 6c66 2c0d 0a20          self,.. 
+00025060: 2020 2020 2020 2072 6571 7565 7374 3a20         request: 
+00025070: 556e 696f 6e5b 6469 6374 2c20 494f 2c52  Union[dict, IO,R
+00025080: 6571 7565 7374 4372 6561 746f 725d 203d  equestCreator] =
+00025090: 204e 6f6e 652c 0d0a 2020 2020 2020 2020   None,..        
+000250a0: 6c69 6d69 743a 2069 6e74 203d 2032 3030  limit: int = 200
+000250b0: 3030 2c0d 0a20 2020 2020 2020 206e 5f72  00,..        n_r
+000250c0: 6573 756c 7473 3a20 556e 696f 6e5b 696e  esults: Union[in
+000250d0: 742c 2073 7472 5d20 3d20 2269 6e66 222c  t, str] = "inf",
+000250e0: 0d0a 2020 2020 2020 2020 616c 6c6f 7752  ..        allowR
+000250f0: 656d 6f74 654c 6f61 643a 2073 7472 203d  emoteLoad: str =
+00025100: 2022 6465 6661 756c 7422 2c0d 0a20 2020   "default",..   
+00025110: 2020 2020 2075 7365 4361 6368 653a 2062       useCache: b
+00025120: 6f6f 6c20 3d20 5472 7565 2c0d 0a20 2020  ool = True,..   
+00025130: 2020 2020 2075 7365 5265 7375 6c74 7343       useResultsC
+00025140: 6163 6865 3a20 626f 6f6c 203d 2046 616c  ache: bool = Fal
+00025150: 7365 2c0d 0a20 2020 2020 2020 2069 6e63  se,..        inc
+00025160: 6c75 6465 4f62 6572 6f6e 586d 6c3a 2062  ludeOberonXml: b
+00025170: 6f6f 6c20 3d20 4661 6c73 652c 0d0a 2020  ool = False,..  
+00025180: 2020 2020 2020 696e 636c 7564 6550 7265        includePre
+00025190: 6469 6374 6976 654f 626a 6563 7473 3a20  dictiveObjects: 
+000251a0: 626f 6f6c 203d 2046 616c 7365 2c0d 0a20  bool = False,.. 
+000251b0: 2020 2020 2020 2072 6574 7572 6e73 4e6f         returnsNo
+000251c0: 6e65 3a20 626f 6f6c 203d 204e 6f6e 652c  ne: bool = None,
+000251d0: 0d0a 2020 2020 2020 2020 636f 756e 7452  ..        countR
+000251e0: 6570 6561 7449 6e73 7461 6e63 6573 3a20  epeatInstances: 
+000251f0: 626f 6f6c 203d 204e 6f6e 652c 0d0a 2020  bool = None,..  
+00025200: 2020 2020 2020 6967 6e6f 7265 5a65 726f        ignoreZero
+00025210: 6573 3a20 626f 6f6c 203d 204e 6f6e 652c  es: bool = None,
+00025220: 0d0a 2020 2020 2020 2020 7273 6964 3a20  ..        rsid: 
+00025230: 7374 7220 3d20 4e6f 6e65 2c0d 0a20 2020  str = None,..   
+00025240: 2020 2020 2072 6573 6f6c 7665 436f 6c75       resolveColu
+00025250: 6d6e 733a 2062 6f6f 6c20 3d20 5472 7565  mns: bool = True
+00025260: 2c0d 0a20 2020 2020 2020 2073 6176 653a  ,..        save:
+00025270: 2062 6f6f 6c20 3d20 4661 6c73 652c 0d0a   bool = False,..
+00025280: 2020 2020 2020 2020 7265 7475 726e 436c          returnCl
+00025290: 6173 733a 2062 6f6f 6c20 3d20 5472 7565  ass: bool = True
+000252a0: 2c0d 0a20 2020 2029 202d 3e20 556e 696f  ,..    ) -> Unio
+000252b0: 6e5b 576f 726b 7370 6163 652c 2064 6963  n[Workspace, dic
+000252c0: 745d 3a0d 0a20 2020 2020 2020 2022 2222  t]:..        """
+000252d0: 0d0a 2020 2020 2020 2020 5265 7475 726e  ..        Return
+000252e0: 2061 6e20 696e 7374 616e 6365 206f 6620   an instance of 
+000252f0: 576f 726b 7370 6163 6520 7468 6174 2063  Workspace that c
+00025300: 6f6e 7461 696e 7320 7468 6520 6461 7461  ontains the data
+00025310: 2072 6571 7565 7374 6564 2e0d 0a20 2020   requested...   
+00025320: 2020 2020 2041 7267 756d 6e65 6e74 733a       Argumnents:
+00025330: 0d0a 2020 2020 2020 2020 2020 2020 7265  ..            re
+00025340: 7175 6573 7420 3a20 5245 5155 4952 4544  quest : REQUIRED
+00025350: 203a 2065 6974 6865 7220 6120 6469 6374   : either a dict
+00025360: 696f 6e61 7279 206f 6620 6120 4a53 4f4e  ionary of a JSON
+00025370: 2066 696c 6520 7468 6174 2063 6f6e 7461   file that conta
+00025380: 696e 7320 7468 6520 7265 7175 6573 7420  ins the request 
+00025390: 696e 666f 726d 6174 696f 6e2e 0d0a 2020  information...  
+000253a0: 2020 2020 2020 2020 2020 6c69 6d69 7420            limit 
+000253b0: 3a20 4f50 5449 4f4e 414c 203a 206e 756d  : OPTIONAL : num
+000253c0: 6265 7220 6f66 2072 6573 756c 7473 2070  ber of results p
+000253d0: 6572 2072 6571 7565 7374 2028 6465 6661  er request (defa
+000253e0: 756c 7420 3130 3030 290d 0a20 2020 2020  ult 1000)..     
+000253f0: 2020 2020 2020 206e 5f72 6573 756c 7473         n_results
+00025400: 203a 204f 5054 494f 4e41 4c20 3a20 746f   : OPTIONAL : to
+00025410: 7461 6c20 6e75 6d62 6572 206f 6620 7265  tal number of re
+00025420: 7375 6c74 7320 7265 7475 726e 732e 2055  sults returns. U
+00025430: 7365 2022 696e 6622 2074 6f20 7265 7475  se "inf" to retu
+00025440: 726e 2065 7665 7279 7468 696e 6720 2864  rn everything (d
+00025450: 6566 6175 6c74 2022 696e 6622 290d 0a20  efault "inf").. 
+00025460: 2020 2020 2020 2020 2020 2061 6c6c 6f77             allow
+00025470: 5265 6d6f 7465 4c6f 6164 203a 204f 5054  RemoteLoad : OPT
+00025480: 494f 4e41 4c20 3a20 436f 6e74 726f 6c73  IONAL : Controls
+00025490: 2069 6620 4f62 6572 6f6e 2073 686f 756c   if Oberon shoul
+000254a0: 6420 7265 6d6f 7465 206c 6f61 6420 6461  d remote load da
+000254b0: 7461 2e20 4465 6661 756c 7420 6265 6861  ta. Default beha
+000254c0: 7669 6f72 2069 7320 7472 7565 2077 6974  vior is true wit
+000254d0: 6820 6661 6c6c 6261 636b 2074 6f20 6661  h fallback to fa
+000254e0: 6c73 6520 6966 2072 656d 6f74 6520 6461  lse if remote da
+000254f0: 7461 2064 6f65 7320 6e6f 7420 6578 6973  ta does not exis
+00025500: 740d 0a20 2020 2020 2020 2020 2020 2075  t..            u
+00025510: 7365 4361 6368 6520 3a20 4f50 5449 4f4e  seCache : OPTION
+00025520: 414c 203a 2055 7365 2063 6163 6869 6e67  AL : Use caching
+00025530: 2066 6f72 2066 6173 7465 7220 7265 7175   for faster requ
+00025540: 6573 7473 2028 446f 206e 6f74 2064 6f20  ests (Do not do 
+00025550: 616e 7920 7265 706f 7274 2063 6163 6869  any report cachi
+00025560: 6e67 290d 0a20 2020 2020 2020 2020 2020  ng)..           
+00025570: 2075 7365 5265 7375 6c74 7343 6163 6865   useResultsCache
+00025580: 203a 204f 5054 494f 4e41 4c20 3a20 5573   : OPTIONAL : Us
+00025590: 6520 7265 7375 6c74 7320 6361 6368 696e  e results cachin
+000255a0: 6720 666f 7220 6661 7374 6572 2072 6570  g for faster rep
+000255b0: 6f72 7469 6e67 2074 696d 6573 2028 5468  orting times (Th
+000255c0: 6973 2069 7320 6120 7061 7373 2074 6872  is is a pass thr
+000255d0: 6f75 6768 2074 6f20 4f62 6572 6f6e 2077  ough to Oberon w
+000255e0: 6869 6368 206d 616e 6167 6573 2074 6865  hich manages the
+000255f0: 2043 6163 6865 290d 0a20 2020 2020 2020   Cache)..       
+00025600: 2020 2020 2069 6e63 6c75 6465 4f62 6572       includeOber
+00025610: 6f6e 586d 6c20 3a20 4f50 5449 4f4e 414c  onXml : OPTIONAL
+00025620: 203a 2043 6f6e 7472 6f6c 7320 6966 204f   : Controls if O
+00025630: 6265 726f 6e20 584d 4c20 7368 6f75 6c64  beron XML should
+00025640: 2062 6520 7265 7475 726e 6564 2069 6e20   be returned in 
+00025650: 7468 6520 7265 7370 6f6e 7365 202d 2044  the response - D
+00025660: 4542 5547 204f 4e4c 590d 0a20 2020 2020  EBUG ONLY..     
+00025670: 2020 2020 2020 2069 6e63 6c75 6465 5072         includePr
+00025680: 6564 6963 7469 7665 4f62 6a65 6374 7320  edictiveObjects 
+00025690: 3a20 4f50 5449 4f4e 414c 203a 2043 6f6e  : OPTIONAL : Con
+000256a0: 7472 6f6c 7320 6966 2070 6c61 7466 6f72  trols if platfor
+000256b0: 6d20 5072 6564 6963 7469 7665 204f 626a  m Predictive Obj
+000256c0: 6563 7473 2073 686f 756c 6420 6265 2072  ects should be r
+000256d0: 6574 7572 6e65 6420 696e 2074 6865 2072  eturned in the r
+000256e0: 6573 706f 6e73 652e 204f 6e6c 7920 6176  esponse. Only av
+000256f0: 6169 6c61 626c 6520 7768 656e 2075 7369  ailable when usi
+00025700: 6e67 2041 6e6f 6d61 6c79 2044 6574 6563  ng Anomaly Detec
+00025710: 7469 6f6e 206f 7220 466f 7265 6361 7374  tion or Forecast
+00025720: 696e 672d 2044 4542 5547 204f 4e4c 590d  ing- DEBUG ONLY.
+00025730: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
+00025740: 7572 6e73 4e6f 6e65 203a 204f 5054 494f  urnsNone : OPTIO
+00025750: 4e41 4c3a 204f 7665 7277 7269 7474 6520  NAL: Overwritte 
+00025760: 7468 6520 7265 7175 6573 7420 7365 7474  the request sett
+00025770: 696e 6720 746f 2072 6574 7572 6e20 4e6f  ing to return No
+00025780: 6e65 2076 616c 7565 732e 0d0a 2020 2020  ne values...    
+00025790: 2020 2020 2020 2020 636f 756e 7452 6570          countRep
+000257a0: 6561 7449 6e73 7461 6e63 6573 203a 204f  eatInstances : O
+000257b0: 5054 494f 4e41 4c3a 204f 7665 7277 7269  PTIONAL: Overwri
+000257c0: 7465 2074 6865 2072 6571 7565 7374 2073  te the request s
+000257d0: 6574 7469 6e67 2074 6f20 636f 756e 7420  etting to count 
+000257e0: 7265 7065 6174 496e 7374 616e 6365 7320  repeatInstances 
+000257f0: 7661 6c75 6573 2e0d 0a20 2020 2020 2020  values...       
+00025800: 2020 2020 2069 676e 6f72 655a 6572 6f65       ignoreZeroe
+00025810: 7320 3a20 4f50 5449 4f4e 414c 203a 2049  s : OPTIONAL : I
+00025820: 676e 6f72 6520 7a65 726f 7320 696e 2074  gnore zeros in t
+00025830: 6865 2072 6573 756c 7473 0d0a 2020 2020  he results..    
+00025840: 2020 2020 2020 2020 7273 6964 203a 204f          rsid : O
+00025850: 5054 494f 4e41 4c20 3a20 4f76 6572 7772  PTIONAL : Overwr
+00025860: 6974 6520 7468 6520 5265 706f 7274 5375  ite the ReportSu
+00025870: 6974 6549 6420 7573 6564 2066 6f72 2072  iteId used for r
+00025880: 6570 6f72 742e 204f 6e6c 7920 776f 726b  eport. Only work
+00025890: 7320 6966 2074 6865 2073 616d 6520 636f  s if the same co
+000258a0: 6d70 6f6e 656e 7473 2061 7265 2070 7265  mponents are pre
+000258b0: 7365 6e74 732e 0d0a 2020 2020 2020 2020  sents...        
+000258c0: 2020 2020 7265 736f 6c76 6543 6f6c 756d      resolveColum
+000258d0: 6e73 3a20 4f50 5449 4f4e 414c 203a 2061  ns: OPTIONAL : a
+000258e0: 7574 6f6d 6174 6963 616c 6c79 2072 6573  utomatically res
+000258f0: 6f6c 7665 2063 6f6c 756d 6e73 2066 726f  olve columns fro
+00025900: 6d20 4944 2074 6f20 6e61 6d65 2066 6f72  m ID to name for
+00025910: 2063 616c 6375 6c61 7465 6420 6d65 7472   calculated metr
+00025920: 6963 7320 2620 7365 676d 656e 7473 2e20  ics & segments. 
+00025930: 4465 6661 756c 7420 5472 7565 2e20 2877  Default True. (w
+00025940: 6f72 6b73 206f 6e20 7265 7475 726e 436c  orks on returnCl
+00025950: 6173 7320 6f6e 6c79 290d 0a20 2020 2020  ass only)..     
+00025960: 2020 2020 2020 2073 6176 6520 3a20 4f50         save : OP
+00025970: 5449 4f4e 414c 203a 2049 6620 796f 7520  TIONAL : If you 
+00025980: 7761 6e74 2074 6f20 7361 7665 2074 6865  want to save the
+00025990: 2064 6174 6120 2869 6e20 4a53 4f4e 206f   data (in JSON o
+000259a0: 7220 4353 562c 2064 6570 656e 6469 6e67  r CSV, depending
+000259b0: 2074 6865 2063 6c61 7373 2069 7320 7573   the class is us
+000259c0: 6564 206f 7220 6e6f 7429 0d0a 2020 2020  ed or not)..    
+000259d0: 2020 2020 2020 2020 7265 7475 726e 436c          returnCl
+000259e0: 6173 7320 3a20 4f50 5449 4f4e 414c 203a  ass : OPTIONAL :
+000259f0: 2072 6574 7572 6e20 7468 6520 636c 6173   return the clas
+00025a00: 7320 6275 696c 6469 6e67 2064 6174 6166  s building dataf
+00025a10: 7261 6d65 2061 6e64 2062 6574 7465 7220  rame and better 
+00025a20: 636f 6d70 7265 6865 6e73 696f 6e20 6f66  comprehension of
+00025a30: 2064 6174 612e 2028 6465 6661 756c 7420   data. (default 
+00025a40: 7965 7329 0d0a 2020 2020 2020 2020 2222  yes)..        ""
+00025a50: 220d 0a20 2020 2020 2020 2069 6620 7365  "..        if se
+00025a60: 6c66 2e6c 6f67 6769 6e67 456e 6162 6c65  lf.loggingEnable
+00025a70: 643a 0d0a 2020 2020 2020 2020 2020 2020  d:..            
+00025a80: 7365 6c66 2e6c 6f67 6765 722e 6465 6275  self.logger.debu
+00025a90: 6728 6622 5374 6172 7420 6765 7452 6570  g(f"Start getRep
+00025aa0: 6f72 7422 290d 0a20 2020 2020 2020 2070  ort")..        p
+00025ab0: 6174 6820 3d20 222f 7265 706f 7274 7322  ath = "/reports"
+00025ac0: 0d0a 2020 2020 2020 2020 7061 7261 6d73  ..        params
+00025ad0: 203d 207b 0d0a 2020 2020 2020 2020 2020   = {..          
+00025ae0: 2020 2261 6c6c 6f77 5265 6d6f 7465 4c6f    "allowRemoteLo
+00025af0: 6164 223a 2061 6c6c 6f77 5265 6d6f 7465  ad": allowRemote
+00025b00: 4c6f 6164 2c0d 0a20 2020 2020 2020 2020  Load,..         
+00025b10: 2020 2022 7573 6543 6163 6865 223a 2075     "useCache": u
+00025b20: 7365 4361 6368 652c 0d0a 2020 2020 2020  seCache,..      
+00025b30: 2020 2020 2020 2275 7365 5265 7375 6c74        "useResult
+00025b40: 7343 6163 6865 223a 2075 7365 5265 7375  sCache": useResu
+00025b50: 6c74 7343 6163 6865 2c0d 0a20 2020 2020  ltsCache,..     
+00025b60: 2020 2020 2020 2022 696e 636c 7564 654f         "includeO
+00025b70: 6265 726f 6e58 6d6c 223a 2069 6e63 6c75  beronXml": inclu
+00025b80: 6465 4f62 6572 6f6e 586d 6c2c 0d0a 2020  deOberonXml,..  
+00025b90: 2020 2020 2020 2020 2020 2269 6e63 6c75            "inclu
+00025ba0: 6465 506c 6174 666f 726d 5072 6564 6963  dePlatformPredic
+00025bb0: 7469 7665 4f62 6a65 6374 7322 3a20 696e  tiveObjects": in
+00025bc0: 636c 7564 6550 7265 6469 6374 6976 654f  cludePredictiveO
+00025bd0: 626a 6563 7473 2c0d 0a20 2020 2020 2020  bjects,..       
+00025be0: 207d 0d0a 2020 2020 2020 2020 6966 2074   }..        if t
+00025bf0: 7970 6528 7265 7175 6573 7429 203d 3d20  ype(request) == 
+00025c00: 6469 6374 3a0d 0a20 2020 2020 2020 2020  dict:..         
+00025c10: 2020 2064 6174 6152 6571 7565 7374 203d     dataRequest =
+00025c20: 2072 6571 7565 7374 0d0a 2020 2020 2020   request..      
+00025c30: 2020 656c 6966 2069 7369 6e73 7461 6e63    elif isinstanc
+00025c40: 6528 7265 7175 6573 742c 5265 7175 6573  e(request,Reques
+00025c50: 7443 7265 6174 6f72 293a 0d0a 2020 2020  tCreator):..    
+00025c60: 2020 2020 2020 2020 6461 7461 5265 7175          dataRequ
+00025c70: 6573 7420 3d20 7265 7175 6573 742e 746f  est = request.to
+00025c80: 5f64 6963 7428 290d 0a20 2020 2020 2020  _dict()..       
+00025c90: 2065 6c69 6620 222e 6a73 6f6e 2220 696e   elif ".json" in
+00025ca0: 2072 6571 7565 7374 3a0d 0a20 2020 2020   request:..     
+00025cb0: 2020 2020 2020 2077 6974 6820 6f70 656e         with open
+00025cc0: 2872 6571 7565 7374 2c20 2272 2229 2061  (request, "r") a
+00025cd0: 7320 663a 0d0a 2020 2020 2020 2020 2020  s f:..          
+00025ce0: 2020 2020 2020 6461 7461 5265 7175 6573        dataReques
+00025cf0: 7420 3d20 6a73 6f6e 2e6c 6f61 6428 6629  t = json.load(f)
+00025d00: 0d0a 2020 2020 2020 2020 656c 7365 3a0d  ..        else:.
+00025d10: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
+00025d20: 7365 2056 616c 7565 4572 726f 7228 2252  se ValueError("R
+00025d30: 6571 7569 7265 2061 204a 534f 4e20 6f72  equire a JSON or
+00025d40: 2044 6963 7469 6f6e 6172 7920 746f 2072   Dictionary to r
+00025d50: 6571 7565 7374 2064 6174 6122 290d 0a20  equest data").. 
+00025d60: 2020 2020 2020 2023 2323 2053 6574 7469         ### Setti
+00025d70: 6e67 730d 0a20 2020 2020 2020 2064 6174  ngs..        dat
+00025d80: 6152 6571 7565 7374 5b22 7365 7474 696e  aRequest["settin
+00025d90: 6773 225d 5b22 7061 6765 225d 203d 2030  gs"]["page"] = 0
+00025da0: 0d0a 2020 2020 2020 2020 6461 7461 5265  ..        dataRe
+00025db0: 7175 6573 745b 2273 6574 7469 6e67 7322  quest["settings"
+00025dc0: 5d5b 226c 696d 6974 225d 203d 206c 696d  ]["limit"] = lim
+00025dd0: 6974 0d0a 2020 2020 2020 2020 6966 2072  it..        if r
+00025de0: 6574 7572 6e73 4e6f 6e65 3a0d 0a20 2020  eturnsNone:..   
+00025df0: 2020 2020 2020 2020 2064 6174 6152 6571           dataReq
+00025e00: 7565 7374 5b22 7365 7474 696e 6773 225d  uest["settings"]
+00025e10: 5b22 6e6f 6e65 7342 6568 6176 696f 7222  ["nonesBehavior"
+00025e20: 5d20 3d20 2272 6574 7572 6e2d 6e6f 6e65  ] = "return-none
+00025e30: 7322 0d0a 2020 2020 2020 2020 656c 7365  s"..        else
+00025e40: 3a0d 0a20 2020 2020 2020 2020 2020 2064  :..            d
+00025e50: 6174 6152 6571 7565 7374 5b22 7365 7474  ataRequest["sett
+00025e60: 696e 6773 225d 5b22 6e6f 6e65 7342 6568  ings"]["nonesBeh
+00025e70: 6176 696f 7222 5d20 3d20 2265 7863 6c75  avior"] = "exclu
+00025e80: 6465 2d6e 6f6e 6573 220d 0a20 2020 2020  de-nones"..     
+00025e90: 2020 2069 6620 636f 756e 7452 6570 6561     if countRepea
+00025ea0: 7449 6e73 7461 6e63 6573 3a0d 0a20 2020  tInstances:..   
+00025eb0: 2020 2020 2020 2020 2064 6174 6152 6571           dataReq
+00025ec0: 7565 7374 5b22 7365 7474 696e 6773 225d  uest["settings"]
+00025ed0: 5b22 636f 756e 7452 6570 6561 7449 6e73  ["countRepeatIns
+00025ee0: 7461 6e63 6573 225d 203d 2054 7275 650d  tances"] = True.
+00025ef0: 0a20 2020 2020 2020 2065 6c73 653a 0d0a  .        else:..
+00025f00: 2020 2020 2020 2020 2020 2020 6461 7461              data
+00025f10: 5265 7175 6573 745b 2273 6574 7469 6e67  Request["setting
+00025f20: 7322 5d5b 2263 6f75 6e74 5265 7065 6174  s"]["countRepeat
+00025f30: 496e 7374 616e 6365 7322 5d20 3d20 4661  Instances"] = Fa
+00025f40: 6c73 650d 0a20 2020 2020 2020 2069 6620  lse..        if 
+00025f50: 7273 6964 2069 7320 6e6f 7420 4e6f 6e65  rsid is not None
+00025f60: 3a0d 0a20 2020 2020 2020 2020 2020 2064  :..            d
+00025f70: 6174 6152 6571 7565 7374 5b22 7273 6964  ataRequest["rsid
+00025f80: 225d 203d 2072 7369 640d 0a20 2020 2020  "] = rsid..     
+00025f90: 2020 2069 6620 6967 6e6f 7265 5a65 726f     if ignoreZero
+00025fa0: 6573 3a0d 0a20 2020 2020 2020 2020 2020  es:..           
+00025fb0: 2064 6174 6152 6571 7565 7374 2e67 6574   dataRequest.get
+00025fc0: 2822 7374 6174 6973 7469 6373 222c 7b27  ("statistics",{'
+00025fd0: 6967 6e6f 7265 5a65 726f 6573 273a 5472  ignoreZeroes':Tr
+00025fe0: 7565 7d29 5b22 6967 6e6f 7265 5a65 726f  ue})["ignoreZero
+00025ff0: 6573 225d 203d 2054 7275 650d 0a20 2020  es"] = True..   
+00026000: 2020 2020 2065 6c73 653a 0d0a 2020 2020       else:..    
+00026010: 2020 2020 2020 2020 6461 7461 5265 7175          dataRequ
+00026020: 6573 742e 6765 7428 2273 7461 7469 7374  est.get("statist
+00026030: 6963 7322 2c7b 2769 676e 6f72 655a 6572  ics",{'ignoreZer
+00026040: 6f65 7327 3a46 616c 7365 7d29 5b22 6967  oes':False})["ig
+00026050: 6e6f 7265 5a65 726f 6573 225d 203d 2046  noreZeroes"] = F
+00026060: 616c 7365 0d0a 2020 2020 2020 2020 2323  alse..        ##
+00026070: 2320 5265 7175 6573 7420 6461 7461 0d0a  # Request data..
+00026080: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
+00026090: 6c6f 6767 696e 6745 6e61 626c 6564 3a0d  loggingEnabled:.
+000260a0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+000260b0: 662e 6c6f 6767 6572 2e64 6562 7567 2866  f.logger.debug(f
+000260c0: 2267 6574 5265 706f 7274 2072 6571 7565  "getReport reque
+000260d0: 7374 3a20 7b6a 736f 6e2e 6475 6d70 7328  st: {json.dumps(
+000260e0: 6461 7461 5265 7175 6573 742c 696e 6465  dataRequest,inde
+000260f0: 6e74 3d34 297d 2229 0d0a 2020 2020 2020  nt=4)}")..      
+00026100: 2020 7265 7320 3d20 7365 6c66 2e63 6f6e    res = self.con
+00026110: 6e65 6374 6f72 2e70 6f73 7444 6174 6128  nector.postData(
+00026120: 0d0a 2020 2020 2020 2020 2020 2020 7365  ..            se
+00026130: 6c66 2e65 6e64 706f 696e 745f 636f 6d70  lf.endpoint_comp
+00026140: 616e 7920 2b20 7061 7468 2c20 6461 7461  any + path, data
+00026150: 3d64 6174 6152 6571 7565 7374 2c20 7061  =dataRequest, pa
+00026160: 7261 6d73 3d70 6172 616d 730d 0a20 2020  rams=params..   
+00026170: 2020 2020 2029 0d0a 2020 2020 2020 2020       )..        
+00026180: 6966 2022 726f 7773 2220 696e 2072 6573  if "rows" in res
+00026190: 2e6b 6579 7328 293a 0d0a 2020 2020 2020  .keys():..      
+000261a0: 2020 2020 2020 7265 706f 7274 5479 7065        reportType
+000261b0: 203d 2022 6e6f 726d 616c 220d 0a20 2020   = "normal"..   
+000261c0: 2020 2020 2020 2020 2069 6620 7365 6c66           if self
+000261d0: 2e6c 6f67 6769 6e67 456e 6162 6c65 643a  .loggingEnabled:
+000261e0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+000261f0: 2020 7365 6c66 2e6c 6f67 6765 722e 6465    self.logger.de
+00026200: 6275 6728 6622 7265 706f 7274 5479 7065  bug(f"reportType
+00026210: 3a20 7b72 6570 6f72 7454 7970 657d 2229  : {reportType}")
+00026220: 0d0a 2020 2020 2020 2020 2020 2020 6461  ..            da
+00026230: 7461 526f 7773 203d 2072 6573 2e67 6574  taRows = res.get
+00026240: 2822 726f 7773 2229 0d0a 2020 2020 2020  ("rows")..      
+00026250: 2020 2020 2020 636f 6c75 6d6e 7320 3d20        columns = 
+00026260: 7265 732e 6765 7428 2263 6f6c 756d 6e73  res.get("columns
+00026270: 2229 0d0a 2020 2020 2020 2020 2020 2020  ")..            
+00026280: 7375 6d6d 6172 7944 6174 6120 3d20 7265  summaryData = re
+00026290: 732e 6765 7428 2273 756d 6d61 7279 4461  s.get("summaryDa
+000262a0: 7461 2229 0d0a 2020 2020 2020 2020 2020  ta")..          
+000262b0: 2020 746f 7461 6c45 6c65 6d65 6e74 7320    totalElements 
+000262c0: 3d20 7265 732e 6765 7428 226e 756d 6265  = res.get("numbe
+000262d0: 724f 6645 6c65 6d65 6e74 7322 290d 0a20  rOfElements").. 
+000262e0: 2020 2020 2020 2020 2020 206c 6173 7450             lastP
+000262f0: 6167 6520 3d20 7265 732e 6765 7428 226c  age = res.get("l
+00026300: 6173 7450 6167 6522 2c20 5472 7565 290d  astPage", True).
+00026310: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+00026320: 666c 6f61 7428 6c65 6e28 6461 7461 526f  float(len(dataRo
+00026330: 7773 2929 203e 3d20 666c 6f61 7428 6e5f  ws)) >= float(n_
+00026340: 7265 7375 6c74 7329 3a0d 0a20 2020 2020  results):..     
+00026350: 2020 2020 2020 2020 2020 2023 2320 666f             ## fo
+00026360: 7263 6520 656e 6420 6f66 206c 6f6f 7020  rce end of loop 
+00026370: 7768 656e 2061 206c 696d 6974 2069 7320  when a limit is 
+00026380: 7365 7420 6f6e 206e 5f72 6573 756c 7473  set on n_results
 00026390: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-000263a0: 2020 6c61 7374 5061 6765 203d 2072 6573    lastPage = res
-000263b0: 2e67 6574 2822 6c61 7374 5061 6765 222c  .get("lastPage",
-000263c0: 2054 7275 6529 0d0a 2020 2020 2020 2020   True)..        
-000263d0: 2020 2020 2020 2020 746f 7461 6c45 6c65          totalEle
-000263e0: 6d65 6e74 7320 2b3d 2072 6573 2e67 6574  ments += res.get
-000263f0: 2822 6e75 6d62 6572 4f66 456c 656d 656e  ("numberOfElemen
-00026400: 7473 2229 0d0a 2020 2020 2020 2020 2020  ts")..          
-00026410: 2020 2020 2020 6966 2066 6c6f 6174 286c        if float(l
-00026420: 656e 2864 6174 6152 6f77 7329 2920 3e3d  en(dataRows)) >=
-00026430: 2066 6c6f 6174 286e 5f72 6573 756c 7473   float(n_results
-00026440: 293a 0d0a 2020 2020 2020 2020 2020 2020  ):..            
-00026450: 2020 2020 2020 2020 2323 2066 6f72 6365          ## force
-00026460: 2065 6e64 206f 6620 6c6f 6f70 2077 6865   end of loop whe
-00026470: 6e20 6120 6c69 6d69 7420 6973 2073 6574  n a limit is set
-00026480: 206f 6e20 6e5f 7265 7375 6c74 730d 0a20   on n_results.. 
-00026490: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000264a0: 2020 206c 6173 7450 6167 6520 3d20 5472     lastPage = Tr
-000264b0: 7565 0d0a 2020 2020 2020 2020 2020 2020  ue..            
-000264c0: 6966 2073 656c 662e 6c6f 6767 696e 6745  if self.loggingE
-000264d0: 6e61 626c 6564 3a0d 0a20 2020 2020 2020  nabled:..       
-000264e0: 2020 2020 2020 2020 2073 656c 662e 6c6f           self.lo
-000264f0: 6767 6572 2e64 6562 7567 2866 226c 6f6f  gger.debug(f"loo
-00026500: 7020 666f 7220 7265 706f 7274 206f 7665  p for report ove
-00026510: 723a 207b 6c65 6e28 6461 7461 526f 7773  r: {len(dataRows
-00026520: 297d 2072 6573 756c 7473 2229 0d0a 2020  )} results")..  
-00026530: 2020 2020 2020 2020 2020 6966 2072 6574            if ret
-00026540: 7572 6e43 6c61 7373 203d 3d20 4661 6c73  urnClass == Fals
-00026550: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
-00026560: 2020 2020 7265 7475 726e 2064 6174 6152      return dataR
-00026570: 6f77 730d 0a20 2020 2020 2020 2020 2020  ows..           
-00026580: 2023 2323 2063 7265 6174 6520 7265 6c61   ### create rela
-00026590: 7469 6f6e 2062 6574 7765 656e 206d 6574  tion between met
-000265a0: 7269 6373 2061 6e64 2066 696c 7465 7273  rics and filters
-000265b0: 2061 7070 6c69 6564 0d0a 2020 2020 2020   applied..      
-000265c0: 2020 2020 2020 636f 6c75 6d6e 4964 5265        columnIdRe
-000265d0: 6c61 7469 6f6e 7320 3d20 7b0d 0a20 2020  lations = {..   
-000265e0: 2020 2020 2020 2020 2020 2020 206f 626a               obj
-000265f0: 5b22 636f 6c75 6d6e 4964 225d 3a20 6f62  ["columnId"]: ob
-00026600: 6a5b 2269 6422 5d0d 0a20 2020 2020 2020  j["id"]..       
-00026610: 2020 2020 2020 2020 2066 6f72 206f 626a           for obj
-00026620: 2069 6e20 6461 7461 5265 7175 6573 745b   in dataRequest[
-00026630: 226d 6574 7269 6343 6f6e 7461 696e 6572  "metricContainer
-00026640: 225d 5b22 6d65 7472 6963 7322 5d0d 0a20  "]["metrics"].. 
-00026650: 2020 2020 2020 2020 2020 207d 0d0a 2020             }..  
-00026660: 2020 2020 2020 2020 2020 6669 6c74 6572            filter
-00026670: 5265 6c61 7469 6f6e 7320 3d20 7b0d 0a20  Relations = {.. 
-00026680: 2020 2020 2020 2020 2020 2020 2020 206f                 o
-00026690: 626a 5b22 636f 6c75 6d6e 4964 225d 3a20  bj["columnId"]: 
-000266a0: 6f62 6a5b 2266 696c 7465 7273 225d 0d0a  obj["filters"]..
-000266b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000266c0: 666f 7220 6f62 6a20 696e 2064 6174 6152  for obj in dataR
-000266d0: 6571 7565 7374 5b22 6d65 7472 6963 436f  equest["metricCo
-000266e0: 6e74 6169 6e65 7222 5d5b 226d 6574 7269  ntainer"]["metri
-000266f0: 6373 225d 0d0a 2020 2020 2020 2020 2020  cs"]..          
-00026700: 2020 2020 2020 6966 206c 656e 286f 626a        if len(obj
-00026710: 2e67 6574 2822 6669 6c74 6572 7322 2c20  .get("filters", 
-00026720: 5b5d 2929 203e 2030 0d0a 2020 2020 2020  [])) > 0..      
-00026730: 2020 2020 2020 7d0d 0a20 2020 2020 2020        }..       
-00026740: 2020 2020 206d 6574 7269 6346 696c 7465       metricFilte
-00026750: 7273 203d 207b 7d0d 0a20 2020 2020 2020  rs = {}..       
-00026760: 2020 2020 206d 6574 7269 6346 696c 7465       metricFilte
-00026770: 7254 7261 6e73 6c61 7469 6f6e 203d 207b  rTranslation = {
-00026780: 7d0d 0a20 2020 2020 2020 2020 2020 2066  }..            f
-00026790: 6f72 2066 696c 7465 7220 696e 2064 6174  or filter in dat
-000267a0: 6152 6571 7565 7374 5b22 6d65 7472 6963  aRequest["metric
-000267b0: 436f 6e74 6169 6e65 7222 5d2e 6765 7428  Container"].get(
-000267c0: 226d 6574 7269 6346 696c 7465 7273 222c  "metricFilters",
-000267d0: 205b 5d29 3a0d 0a20 2020 2020 2020 2020   []):..         
-000267e0: 2020 2020 2020 2066 696c 7465 7249 6420         filterId 
-000267f0: 3d20 6669 6c74 6572 5b22 6964 225d 0d0a  = filter["id"]..
-00026800: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00026810: 6966 2066 696c 7465 725b 2274 7970 6522  if filter["type"
-00026820: 5d20 3d3d 2022 6272 6561 6b64 6f77 6e22  ] == "breakdown"
-00026830: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-00026840: 2020 2020 2020 2066 696c 7465 7256 616c         filterVal
-00026850: 7565 203d 2066 227b 6669 6c74 6572 5b27  ue = f"{filter['
-00026860: 6469 6d65 6e73 696f 6e27 5d7d 3a7b 6669  dimension']}:{fi
-00026870: 6c74 6572 5b27 6974 656d 4964 275d 7d22  lter['itemId']}"
-00026880: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00026890: 2020 2020 2020 6d65 7472 6963 4669 6c74        metricFilt
-000268a0: 6572 735b 6669 6c74 6572 5b22 6469 6d65  ers[filter["dime
-000268b0: 6e73 696f 6e22 5d5d 203d 2066 696c 7465  nsion"]] = filte
-000268c0: 725b 2269 7465 6d49 6422 5d0d 0a20 2020  r["itemId"]..   
-000268d0: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-000268e0: 6669 6c74 6572 5b22 7479 7065 225d 203d  filter["type"] =
-000268f0: 3d20 2264 6174 6552 616e 6765 223a 0d0a  = "dateRange":..
-00026900: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00026910: 2020 2020 6669 6c74 6572 5661 6c75 6520      filterValue 
-00026920: 3d20 6622 7b66 696c 7465 725b 2764 6174  = f"{filter['dat
-00026930: 6552 616e 6765 275d 7d22 0d0a 2020 2020  eRange']}"..    
-00026940: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00026950: 6d65 7472 6963 4669 6c74 6572 735b 6669  metricFilters[fi
-00026960: 6c74 6572 5661 6c75 655d 203d 2066 696c  lterValue] = fil
-00026970: 7465 7256 616c 7565 0d0a 2020 2020 2020  terValue..      
-00026980: 2020 2020 2020 2020 2020 6966 2066 696c            if fil
-00026990: 7465 725b 2274 7970 6522 5d20 3d3d 2022  ter["type"] == "
-000269a0: 7365 676d 656e 7422 3a0d 0a20 2020 2020  segment":..     
-000269b0: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-000269c0: 696c 7465 7256 616c 7565 203d 2066 227b  ilterValue = f"{
-000269d0: 6669 6c74 6572 5b27 7365 676d 656e 7449  filter['segmentI
-000269e0: 6427 5d7d 220d 0a20 2020 2020 2020 2020  d']}"..         
-000269f0: 2020 2020 2020 2020 2020 2069 6620 6669             if fi
-00026a00: 6c74 6572 5661 6c75 652e 7374 6172 7473  lterValue.starts
-00026a10: 7769 7468 2822 7322 2920 616e 6420 2240  with("s") and "@
-00026a20: 4164 6f62 654f 7267 2220 696e 2066 696c  AdobeOrg" in fil
-00026a30: 7465 7256 616c 7565 3a0d 0a20 2020 2020  terValue:..     
+000263a0: 2020 6c61 7374 5061 6765 203d 2054 7275    lastPage = Tru
+000263b0: 650d 0a20 2020 2020 2020 2020 2020 2077  e..            w
+000263c0: 6869 6c65 206c 6173 7450 6167 6520 213d  hile lastPage !=
+000263d0: 2054 7275 653a 0d0a 2020 2020 2020 2020   True:..        
+000263e0: 2020 2020 2020 2020 6461 7461 5265 7175          dataRequ
+000263f0: 6573 745b 2273 6574 7469 6e67 7322 5d5b  est["settings"][
+00026400: 2270 6167 6522 5d20 2b3d 2031 0d0a 2020  "page"] += 1..  
+00026410: 2020 2020 2020 2020 2020 2020 2020 7265                re
+00026420: 7320 3d20 7365 6c66 2e63 6f6e 6e65 6374  s = self.connect
+00026430: 6f72 2e70 6f73 7444 6174 6128 0d0a 2020  or.postData(..  
+00026440: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00026450: 2020 7365 6c66 2e65 6e64 706f 696e 745f    self.endpoint_
+00026460: 636f 6d70 616e 7920 2b20 7061 7468 2c20  company + path, 
+00026470: 6461 7461 3d64 6174 6152 6571 7565 7374  data=dataRequest
+00026480: 2c20 7061 7261 6d73 3d70 6172 616d 730d  , params=params.
+00026490: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000264a0: 2029 0d0a 2020 2020 2020 2020 2020 2020   )..            
+000264b0: 2020 2020 6461 7461 526f 7773 202b 3d20      dataRows += 
+000264c0: 7265 732e 6765 7428 2272 6f77 7322 290d  res.get("rows").
+000264d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000264e0: 206c 6173 7450 6167 6520 3d20 7265 732e   lastPage = res.
+000264f0: 6765 7428 226c 6173 7450 6167 6522 2c20  get("lastPage", 
+00026500: 5472 7565 290d 0a20 2020 2020 2020 2020  True)..         
+00026510: 2020 2020 2020 2074 6f74 616c 456c 656d         totalElem
+00026520: 656e 7473 202b 3d20 7265 732e 6765 7428  ents += res.get(
+00026530: 226e 756d 6265 724f 6645 6c65 6d65 6e74  "numberOfElement
+00026540: 7322 290d 0a20 2020 2020 2020 2020 2020  s")..           
+00026550: 2020 2020 2069 6620 666c 6f61 7428 6c65       if float(le
+00026560: 6e28 6461 7461 526f 7773 2929 203e 3d20  n(dataRows)) >= 
+00026570: 666c 6f61 7428 6e5f 7265 7375 6c74 7329  float(n_results)
+00026580: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+00026590: 2020 2020 2020 2023 2320 666f 7263 6520         ## force 
+000265a0: 656e 6420 6f66 206c 6f6f 7020 7768 656e  end of loop when
+000265b0: 2061 206c 696d 6974 2069 7320 7365 7420   a limit is set 
+000265c0: 6f6e 206e 5f72 6573 756c 7473 0d0a 2020  on n_results..  
+000265d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000265e0: 2020 6c61 7374 5061 6765 203d 2054 7275    lastPage = Tru
+000265f0: 650d 0a20 2020 2020 2020 2020 2020 2069  e..            i
+00026600: 6620 7365 6c66 2e6c 6f67 6769 6e67 456e  f self.loggingEn
+00026610: 6162 6c65 643a 0d0a 2020 2020 2020 2020  abled:..        
+00026620: 2020 2020 2020 2020 7365 6c66 2e6c 6f67          self.log
+00026630: 6765 722e 6465 6275 6728 6622 6c6f 6f70  ger.debug(f"loop
+00026640: 2066 6f72 2072 6570 6f72 7420 6f76 6572   for report over
+00026650: 3a20 7b6c 656e 2864 6174 6152 6f77 7329  : {len(dataRows)
+00026660: 7d20 7265 7375 6c74 7322 290d 0a20 2020  } results")..   
+00026670: 2020 2020 2020 2020 2069 6620 7265 7475           if retu
+00026680: 726e 436c 6173 7320 3d3d 2046 616c 7365  rnClass == False
+00026690: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+000266a0: 2020 2072 6574 7572 6e20 6461 7461 526f     return dataRo
+000266b0: 7773 0d0a 2020 2020 2020 2020 2020 2020  ws..            
+000266c0: 2323 2320 6372 6561 7465 2072 656c 6174  ### create relat
+000266d0: 696f 6e20 6265 7477 6565 6e20 6d65 7472  ion between metr
+000266e0: 6963 7320 616e 6420 6669 6c74 6572 7320  ics and filters 
+000266f0: 6170 706c 6965 640d 0a20 2020 2020 2020  applied..       
+00026700: 2020 2020 2063 6f6c 756d 6e49 6452 656c       columnIdRel
+00026710: 6174 696f 6e73 203d 207b 0d0a 2020 2020  ations = {..    
+00026720: 2020 2020 2020 2020 2020 2020 6f62 6a5b              obj[
+00026730: 2263 6f6c 756d 6e49 6422 5d3a 206f 626a  "columnId"]: obj
+00026740: 5b22 6964 225d 0d0a 2020 2020 2020 2020  ["id"]..        
+00026750: 2020 2020 2020 2020 666f 7220 6f62 6a20          for obj 
+00026760: 696e 2064 6174 6152 6571 7565 7374 5b22  in dataRequest["
+00026770: 6d65 7472 6963 436f 6e74 6169 6e65 7222  metricContainer"
+00026780: 5d5b 226d 6574 7269 6373 225d 0d0a 2020  ]["metrics"]..  
+00026790: 2020 2020 2020 2020 2020 7d0d 0a20 2020            }..   
+000267a0: 2020 2020 2020 2020 2066 696c 7465 7252           filterR
+000267b0: 656c 6174 696f 6e73 203d 207b 0d0a 2020  elations = {..  
+000267c0: 2020 2020 2020 2020 2020 2020 2020 6f62                ob
+000267d0: 6a5b 2263 6f6c 756d 6e49 6422 5d3a 206f  j["columnId"]: o
+000267e0: 626a 5b22 6669 6c74 6572 7322 5d0d 0a20  bj["filters"].. 
+000267f0: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+00026800: 6f72 206f 626a 2069 6e20 6461 7461 5265  or obj in dataRe
+00026810: 7175 6573 745b 226d 6574 7269 6343 6f6e  quest["metricCon
+00026820: 7461 696e 6572 225d 5b22 6d65 7472 6963  tainer"]["metric
+00026830: 7322 5d0d 0a20 2020 2020 2020 2020 2020  s"]..           
+00026840: 2020 2020 2069 6620 6c65 6e28 6f62 6a2e       if len(obj.
+00026850: 6765 7428 2266 696c 7465 7273 222c 205b  get("filters", [
+00026860: 5d29 2920 3e20 300d 0a20 2020 2020 2020  ])) > 0..       
+00026870: 2020 2020 207d 0d0a 2020 2020 2020 2020       }..        
+00026880: 2020 2020 6d65 7472 6963 4669 6c74 6572      metricFilter
+00026890: 7320 3d20 7b7d 0d0a 2020 2020 2020 2020  s = {}..        
+000268a0: 2020 2020 6d65 7472 6963 4669 6c74 6572      metricFilter
+000268b0: 5472 616e 736c 6174 696f 6e20 3d20 7b7d  Translation = {}
+000268c0: 0d0a 2020 2020 2020 2020 2020 2020 666f  ..            fo
+000268d0: 7220 6669 6c74 6572 2069 6e20 6461 7461  r filter in data
+000268e0: 5265 7175 6573 745b 226d 6574 7269 6343  Request["metricC
+000268f0: 6f6e 7461 696e 6572 225d 2e67 6574 2822  ontainer"].get("
+00026900: 6d65 7472 6963 4669 6c74 6572 7322 2c20  metricFilters", 
+00026910: 5b5d 293a 0d0a 2020 2020 2020 2020 2020  []):..          
+00026920: 2020 2020 2020 6669 6c74 6572 4964 203d        filterId =
+00026930: 2066 696c 7465 725b 2269 6422 5d0d 0a20   filter["id"].. 
+00026940: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00026950: 6620 6669 6c74 6572 5b22 7479 7065 225d  f filter["type"]
+00026960: 203d 3d20 2262 7265 616b 646f 776e 223a   == "breakdown":
+00026970: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00026980: 2020 2020 2020 6669 6c74 6572 5661 6c75        filterValu
+00026990: 6520 3d20 6622 7b66 696c 7465 725b 2764  e = f"{filter['d
+000269a0: 696d 656e 7369 6f6e 275d 7d3a 7b66 696c  imension']}:{fil
+000269b0: 7465 725b 2769 7465 6d49 6427 5d7d 220d  ter['itemId']}".
+000269c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000269d0: 2020 2020 206d 6574 7269 6346 696c 7465       metricFilte
+000269e0: 7273 5b66 696c 7465 725b 2264 696d 656e  rs[filter["dimen
+000269f0: 7369 6f6e 225d 5d20 3d20 6669 6c74 6572  sion"]] = filter
+00026a00: 5b22 6974 656d 4964 225d 0d0a 2020 2020  ["itemId"]..    
+00026a10: 2020 2020 2020 2020 2020 2020 6966 2066              if f
+00026a20: 696c 7465 725b 2274 7970 6522 5d20 3d3d  ilter["type"] ==
+00026a30: 2022 6461 7465 5261 6e67 6522 3a0d 0a20   "dateRange":.. 
 00026a40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00026a50: 2020 2073 6567 203d 2073 656c 662e 6765     seg = self.ge
-00026a60: 7453 6567 6d65 6e74 2866 696c 7465 7256  tSegment(filterV
-00026a70: 616c 7565 290d 0a20 2020 2020 2020 2020  alue)..         
+00026a50: 2020 2066 696c 7465 7256 616c 7565 203d     filterValue =
+00026a60: 2066 227b 6669 6c74 6572 5b27 6461 7465   f"{filter['date
+00026a70: 5261 6e67 6527 5d7d 220d 0a20 2020 2020  Range']}"..     
 00026a80: 2020 2020 2020 2020 2020 2020 2020 206d                 m
 00026a90: 6574 7269 6346 696c 7465 7273 5b66 696c  etricFilters[fil
-00026aa0: 7465 7256 616c 7565 5d20 3d20 7365 675b  terValue] = seg[
-00026ab0: 226e 616d 6522 5d0d 0a20 2020 2020 2020  "name"]..       
-00026ac0: 2020 2020 2020 2020 206d 6574 7269 6346           metricF
-00026ad0: 696c 7465 7254 7261 6e73 6c61 7469 6f6e  ilterTranslation
-00026ae0: 5b66 696c 7465 7249 645d 203d 2066 696c  [filterId] = fil
-00026af0: 7465 7256 616c 7565 0d0a 2020 2020 2020  terValue..      
-00026b00: 2020 2020 2020 6d65 7472 6963 436f 6c75        metricColu
-00026b10: 6d6e 7320 3d20 7b7d 0d0a 2020 2020 2020  mns = {}..      
-00026b20: 2020 2020 2020 666f 7220 636f 6c49 6420        for colId 
-00026b30: 696e 2063 6f6c 756d 6e49 6452 656c 6174  in columnIdRelat
-00026b40: 696f 6e73 2e6b 6579 7328 293a 0d0a 2020  ions.keys():..  
-00026b50: 2020 2020 2020 2020 2020 2020 2020 6d65                me
-00026b60: 7472 6963 436f 6c75 6d6e 735b 636f 6c49  tricColumns[colI
-00026b70: 645d 203d 2063 6f6c 756d 6e49 6452 656c  d] = columnIdRel
-00026b80: 6174 696f 6e73 5b63 6f6c 4964 5d0d 0a20  ations[colId].. 
-00026b90: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-00026ba0: 6f72 2065 6c65 6d65 6e74 2069 6e20 6669  or element in fi
-00026bb0: 6c74 6572 5265 6c61 7469 6f6e 732e 6765  lterRelations.ge
-00026bc0: 7428 636f 6c49 642c 205b 5d29 3a0d 0a20  t(colId, []):.. 
-00026bd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00026be0: 2020 206d 6574 7269 6343 6f6c 756d 6e73     metricColumns
-00026bf0: 5b63 6f6c 4964 5d20 2b3d 2066 223a 3a3a  [colId] += f":::
-00026c00: 7b6d 6574 7269 6346 696c 7465 7254 7261  {metricFilterTra
-00026c10: 6e73 6c61 7469 6f6e 5b65 6c65 6d65 6e74  nslation[element
-00026c20: 5d7d 220d 0a20 2020 2020 2020 2065 6c73  ]}"..        els
-00026c30: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
-00026c40: 6966 2072 6574 7572 6e43 6c61 7373 203d  if returnClass =
-00026c50: 3d20 4661 6c73 653a 0d0a 2020 2020 2020  = False:..      
-00026c60: 2020 2020 2020 2020 2020 7265 7475 726e            return
-00026c70: 2072 6573 0d0a 2020 2020 2020 2020 2020   res..          
-00026c80: 2020 7265 706f 7274 5479 7065 203d 2022    reportType = "
-00026c90: 7374 6174 6963 220d 0a20 2020 2020 2020  static"..       
-00026ca0: 2020 2020 2069 6620 7365 6c66 2e6c 6f67       if self.log
-00026cb0: 6769 6e67 456e 6162 6c65 643a 0d0a 2020  gingEnabled:..  
-00026cc0: 2020 2020 2020 2020 2020 2020 2020 7365                se
-00026cd0: 6c66 2e6c 6f67 6765 722e 6465 6275 6728  lf.logger.debug(
-00026ce0: 6622 7265 706f 7274 5479 7065 3a20 7b72  f"reportType: {r
-00026cf0: 6570 6f72 7454 7970 657d 2229 0d0a 2020  eportType}")..  
-00026d00: 2020 2020 2020 2020 2020 636f 6c75 6d6e            column
-00026d10: 7320 3d20 4e6f 6e65 2020 2323 206e 6f20  s = None  ## no 
-00026d20: 2263 6f6c 756d 6e73 2220 6b65 7920 696e  "columns" key in
-00026d30: 2072 6573 706f 6e73 650d 0a20 2020 2020   response..     
-00026d40: 2020 2020 2020 2073 756d 6d61 7279 4461         summaryDa
-00026d50: 7461 203d 2072 6573 2e67 6574 2822 7375  ta = res.get("su
-00026d60: 6d6d 6172 7944 6174 6122 290d 0a20 2020  mmaryData")..   
-00026d70: 2020 2020 2020 2020 2028 0d0a 2020 2020           (..    
-00026d80: 2020 2020 2020 2020 2020 2020 6e62 5f63              nb_c
-00026d90: 6f6c 756d 6e73 2c0d 0a20 2020 2020 2020  olumns,..       
-00026da0: 2020 2020 2020 2020 2074 6162 6c65 436f           tableCo
-00026db0: 6c75 6d6e 4964 732c 0d0a 2020 2020 2020  lumnIds,..      
-00026dc0: 2020 2020 2020 2020 2020 7365 676d 656e            segmen
-00026dd0: 7441 7070 6c69 6564 2c0d 0a20 2020 2020  tApplied,..     
-00026de0: 2020 2020 2020 2020 2020 2066 696c 7465             filte
-00026df0: 7252 656c 6174 696f 6e73 2c0d 0a20 2020  rRelations,..   
-00026e00: 2020 2020 2020 2020 2020 2020 2064 6174               dat
-00026e10: 6152 6f77 732c 0d0a 2020 2020 2020 2020  aRows,..        
-00026e20: 2020 2020 2920 3d20 7365 6c66 2e5f 6465      ) = self._de
-00026e30: 6372 7970 7465 5374 6174 6963 4461 7461  crypteStaticData
-00026e40: 2864 6174 6152 6571 7565 7374 3d64 6174  (dataRequest=dat
-00026e50: 6152 6571 7565 7374 2c20 7265 7370 6f6e  aRequest, respon
-00026e60: 7365 3d72 6573 290d 0a20 2020 2020 2020  se=res)..       
-00026e70: 2020 2020 2023 2323 2046 696e 6469 6e67       ### Finding
-00026e80: 7320 6d65 7472 6963 730d 0a20 2020 2020  s metrics..     
-00026e90: 2020 2020 2020 206d 6574 7269 6346 696c         metricFil
-00026ea0: 7465 7273 203d 207b 7d0d 0a20 2020 2020  ters = {}..     
-00026eb0: 2020 2020 2020 206d 6574 7269 6343 6f6c         metricCol
-00026ec0: 756d 6e73 203d 205b 5d0d 0a20 2020 2020  umns = []..     
-00026ed0: 2020 2020 2020 2066 6f72 2069 2069 6e20         for i in 
-00026ee0: 7261 6e67 6528 6e62 5f63 6f6c 756d 6e73  range(nb_columns
-00026ef0: 293a 0d0a 2020 2020 2020 2020 2020 2020  ):..            
-00026f00: 2020 2020 6d65 7472 6963 3a20 7374 7220      metric: str 
-00026f10: 3d20 7265 735b 2263 6f6c 756d 6e73 225d  = res["columns"]
-00026f20: 5b22 636f 6c75 6d6e 4964 7322 5d5b 695d  ["columnIds"][i]
-00026f30: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00026f40: 2020 6d65 7472 6963 4e61 6d65 203d 206d    metricName = m
-00026f50: 6574 7269 632e 7370 6c69 7428 223a 3a3a  etric.split(":::
-00026f60: 2229 5b30 5d0d 0a20 2020 2020 2020 2020  ")[0]..         
-00026f70: 2020 2020 2020 2069 6620 6d65 7472 6963         if metric
-00026f80: 4e61 6d65 2e73 7461 7274 7377 6974 6828  Name.startswith(
-00026f90: 2263 6d22 293a 0d0a 2020 2020 2020 2020  "cm"):..        
-00026fa0: 2020 2020 2020 2020 2020 2020 6361 6c63              calc
-00026fb0: 4d65 7472 6963 203d 2073 656c 662e 6765  Metric = self.ge
-00026fc0: 7443 616c 6375 6c61 7465 644d 6574 7269  tCalculatedMetri
-00026fd0: 6328 6d65 7472 6963 4e61 6d65 290d 0a20  c(metricName).. 
-00026fe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00026ff0: 2020 206d 6574 7269 634e 616d 6520 3d20     metricName = 
-00027000: 6361 6c63 4d65 7472 6963 5b22 6e61 6d65  calcMetric["name
-00027010: 225d 0d0a 2020 2020 2020 2020 2020 2020  "]..            
-00027020: 2020 2020 636f 7272 6573 706f 6e64 696e      correspondin
-00027030: 6753 7461 7469 6320 3d20 7461 626c 6543  gStatic = tableC
-00027040: 6f6c 756d 6e49 6473 5b6d 6574 7269 635d  olumnIds[metric]
-00027050: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00027060: 2020 2323 2069 6620 7468 6520 7374 6174    ## if the stat
-00027070: 6963 2072 6f77 2068 6173 2061 2066 696c  ic row has a fil
-00027080: 7465 720d 0a20 2020 2020 2020 2020 2020  ter..           
-00027090: 2020 2020 2069 6620 636f 7272 6573 706f       if correspo
-000270a0: 6e64 696e 6753 7461 7469 6320 696e 206c  ndingStatic in l
-000270b0: 6973 7428 6669 6c74 6572 5265 6c61 7469  ist(filterRelati
-000270c0: 6f6e 732e 6b65 7973 2829 293a 0d0a 2020  ons.keys()):..  
-000270d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000270e0: 2020 2323 2066 696e 6469 6e67 2073 6567    ## finding seg
-000270f0: 6d65 6e74 2061 7070 6c69 6564 2074 6f20  ment applied to 
-00027100: 6d65 7472 6963 730d 0a20 2020 2020 2020  metrics..       
-00027110: 2020 2020 2020 2020 2020 2020 2066 6f72               for
-00027120: 2065 6c65 6d65 6e74 2069 6e20 6669 6c74   element in filt
-00027130: 6572 5265 6c61 7469 6f6e 735b 636f 7272  erRelations[corr
-00027140: 6573 706f 6e64 696e 6753 7461 7469 635d  espondingStatic]
-00027150: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-00027160: 2020 2020 2020 2020 2020 2073 6567 4964             segId
-00027170: 3a73 7472 203d 2073 6567 6d65 6e74 4170  :str = segmentAp
-00027180: 706c 6965 645b 656c 656d 656e 745d 0d0a  plied[element]..
-00027190: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000271a0: 2020 2020 2020 2020 6d65 7472 6963 4e61          metricNa
-000271b0: 6d65 202b 3d20 6622 3a3a 3a7b 7365 6749  me += f":::{segI
-000271c0: 647d 220d 0a20 2020 2020 2020 2020 2020  d}"..           
-000271d0: 2020 2020 2020 2020 2020 2020 206d 6574               met
-000271e0: 7269 6346 696c 7465 7273 5b73 6567 4964  ricFilters[segId
-000271f0: 5d20 3d20 7365 6749 640d 0a20 2020 2020  ] = segId..     
-00027200: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027210: 2020 2069 6620 7365 6749 642e 7374 6172     if segId.star
-00027220: 7473 7769 7468 2822 7322 2920 616e 6420  tswith("s") and 
-00027230: 2240 4164 6f62 654f 7267 2220 696e 2073  "@AdobeOrg" in s
-00027240: 6567 4964 3a0d 0a20 2020 2020 2020 2020  egId:..         
-00027250: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027260: 2020 2073 6567 203d 2073 656c 662e 6765     seg = self.ge
-00027270: 7453 6567 6d65 6e74 2873 6567 4964 290d  tSegment(segId).
-00027280: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00027290: 2020 2020 2020 2020 2020 2020 206d 6574               met
-000272a0: 7269 6346 696c 7465 7273 5b73 6567 4964  ricFilters[segId
-000272b0: 5d20 3d20 7365 675b 226e 616d 6522 5d0d  ] = seg["name"].
-000272c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000272d0: 206d 6574 7269 6343 6f6c 756d 6e73 2e61   metricColumns.a
-000272e0: 7070 656e 6428 6d65 7472 6963 4e61 6d65  ppend(metricName
-000272f0: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
-00027300: 2020 2023 2323 2065 6e64 696e 6720 7769     ### ending wi
-00027310: 7468 205b 276d 6574 7269 6331 272c 276d  th ['metric1','m
-00027320: 6574 7269 6332 202b 2073 6567 4964 272c  etric2 + segId',
-00027330: 2e2e 2e5d 0d0a 2020 2020 2020 2020 2323  ...]..        ##
-00027340: 2320 7072 6570 6172 696e 6720 6461 7461  # preparing data
-00027350: 2070 6f69 6e74 730d 0a20 2020 2020 2020   points..       
-00027360: 2069 6620 7365 6c66 2e6c 6f67 6769 6e67   if self.logging
-00027370: 456e 6162 6c65 643a 0d0a 2020 2020 2020  Enabled:..      
-00027380: 2020 2020 2020 7365 6c66 2e6c 6f67 6765        self.logge
-00027390: 722e 6465 6275 6728 6622 7072 6570 6172  r.debug(f"prepar
-000273a0: 696e 6720 6461 7461 2229 0d0a 2020 2020  ing data")..    
-000273b0: 2020 2020 7072 6570 6172 6564 4461 7461      preparedData
-000273c0: 203d 2073 656c 662e 5f70 7265 7061 7265   = self._prepare
-000273d0: 4461 7461 2864 6174 6152 6f77 732c 2072  Data(dataRows, r
-000273e0: 6570 6f72 7454 7970 653d 7265 706f 7274  eportType=report
-000273f0: 5479 7065 290d 0a20 2020 2020 2020 2069  Type)..        i
-00027400: 6620 7265 7475 726e 436c 6173 733a 0d0a  f returnClass:..
-00027410: 2020 2020 2020 2020 2020 2020 6966 2073              if s
-00027420: 656c 662e 6c6f 6767 696e 6745 6e61 626c  elf.loggingEnabl
-00027430: 6564 3a0d 0a20 2020 2020 2020 2020 2020  ed:..           
-00027440: 2020 2020 2073 656c 662e 6c6f 6767 6572       self.logger
-00027450: 2e64 6562 7567 2866 2272 6574 7572 6e69  .debug(f"returni
-00027460: 6e67 2057 6f72 6b73 7061 6365 2063 6c61  ng Workspace cla
-00027470: 7373 2229 0d0a 2020 2020 2020 2020 2020  ss")..          
-00027480: 2020 2323 2055 7369 6e67 2074 6865 2063    ## Using the c
-00027490: 6c61 7373 0d0a 2020 2020 2020 2020 2020  lass..          
-000274a0: 2020 6461 7461 203d 2057 6f72 6b73 7061    data = Workspa
-000274b0: 6365 280d 0a20 2020 2020 2020 2020 2020  ce(..           
-000274c0: 2020 2020 2072 6573 706f 6e73 6544 6174       responseDat
-000274d0: 613d 7072 6570 6172 6564 4461 7461 2c0d  a=preparedData,.
-000274e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000274f0: 2064 6174 6152 6571 7565 7374 3d64 6174   dataRequest=dat
-00027500: 6152 6571 7565 7374 2c0d 0a20 2020 2020  aRequest,..     
-00027510: 2020 2020 2020 2020 2020 2063 6f6c 756d             colum
-00027520: 6e73 3d63 6f6c 756d 6e73 2c0d 0a20 2020  ns=columns,..   
-00027530: 2020 2020 2020 2020 2020 2020 2073 756d               sum
-00027540: 6d61 7279 4461 7461 3d73 756d 6d61 7279  maryData=summary
-00027550: 4461 7461 2c0d 0a20 2020 2020 2020 2020  Data,..         
-00027560: 2020 2020 2020 2061 6e61 6c79 7469 6373         analytics
-00027570: 436f 6e6e 6563 746f 723d 7365 6c66 2c0d  Connector=self,.
-00027580: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00027590: 2072 6570 6f72 7454 7970 653d 7265 706f   reportType=repo
-000275a0: 7274 5479 7065 2c0d 0a20 2020 2020 2020  rtType,..       
-000275b0: 2020 2020 2020 2020 206d 6574 7269 6373           metrics
-000275c0: 3d6d 6574 7269 6343 6f6c 756d 6e73 2c20  =metricColumns, 
-000275d0: 2023 2320 666f 7220 6e6f 726d 616c 2074   ## for normal t
-000275e0: 7970 6520 2020 2323 2066 6f72 2073 7461  ype   ## for sta
-000275f0: 7469 6352 6570 6f72 740d 0a20 2020 2020  ticReport..     
-00027600: 2020 2020 2020 2020 2020 206d 6574 7269             metri
-00027610: 6346 696c 7465 7273 3d6d 6574 7269 6346  cFilters=metricF
-00027620: 696c 7465 7273 2c0d 0a20 2020 2020 2020  ilters,..       
-00027630: 2020 2020 2020 2020 2072 6573 6f6c 7665           resolve
-00027640: 436f 6c75 6d6e 733d 7265 736f 6c76 6543  Columns=resolveC
-00027650: 6f6c 756d 6e73 2c0d 0a20 2020 2020 2020  olumns,..       
-00027660: 2020 2020 2029 0d0a 2020 2020 2020 2020       )..        
-00027670: 2020 2020 6966 2073 6176 653a 0d0a 2020      if save:..  
-00027680: 2020 2020 2020 2020 2020 2020 2020 6461                da
-00027690: 7461 2e74 6f5f 6373 7628 290d 0a20 2020  ta.to_csv()..   
-000276a0: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-000276b0: 6461 7461 0d0a                           data..
+00026aa0: 7465 7256 616c 7565 5d20 3d20 6669 6c74  terValue] = filt
+00026ab0: 6572 5661 6c75 650d 0a20 2020 2020 2020  erValue..       
+00026ac0: 2020 2020 2020 2020 2069 6620 6669 6c74           if filt
+00026ad0: 6572 5b22 7479 7065 225d 203d 3d20 2273  er["type"] == "s
+00026ae0: 6567 6d65 6e74 223a 0d0a 2020 2020 2020  egment":..      
+00026af0: 2020 2020 2020 2020 2020 2020 2020 6669                fi
+00026b00: 6c74 6572 5661 6c75 6520 3d20 6622 7b66  lterValue = f"{f
+00026b10: 696c 7465 725b 2773 6567 6d65 6e74 4964  ilter['segmentId
+00026b20: 275d 7d22 0d0a 2020 2020 2020 2020 2020  ']}"..          
+00026b30: 2020 2020 2020 2020 2020 6966 2066 696c            if fil
+00026b40: 7465 7256 616c 7565 2e73 7461 7274 7377  terValue.startsw
+00026b50: 6974 6828 2273 2229 2061 6e64 2022 4041  ith("s") and "@A
+00026b60: 646f 6265 4f72 6722 2069 6e20 6669 6c74  dobeOrg" in filt
+00026b70: 6572 5661 6c75 653a 0d0a 2020 2020 2020  erValue:..      
+00026b80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00026b90: 2020 7365 6720 3d20 7365 6c66 2e67 6574    seg = self.get
+00026ba0: 5365 676d 656e 7428 6669 6c74 6572 5661  Segment(filterVa
+00026bb0: 6c75 6529 0d0a 2020 2020 2020 2020 2020  lue)..          
+00026bc0: 2020 2020 2020 2020 2020 2020 2020 6d65                me
+00026bd0: 7472 6963 4669 6c74 6572 735b 6669 6c74  tricFilters[filt
+00026be0: 6572 5661 6c75 655d 203d 2073 6567 5b22  erValue] = seg["
+00026bf0: 6e61 6d65 225d 0d0a 2020 2020 2020 2020  name"]..        
+00026c00: 2020 2020 2020 2020 6d65 7472 6963 4669          metricFi
+00026c10: 6c74 6572 5472 616e 736c 6174 696f 6e5b  lterTranslation[
+00026c20: 6669 6c74 6572 4964 5d20 3d20 6669 6c74  filterId] = filt
+00026c30: 6572 5661 6c75 650d 0a20 2020 2020 2020  erValue..       
+00026c40: 2020 2020 206d 6574 7269 6343 6f6c 756d       metricColum
+00026c50: 6e73 203d 207b 7d0d 0a20 2020 2020 2020  ns = {}..       
+00026c60: 2020 2020 2066 6f72 2063 6f6c 4964 2069       for colId i
+00026c70: 6e20 636f 6c75 6d6e 4964 5265 6c61 7469  n columnIdRelati
+00026c80: 6f6e 732e 6b65 7973 2829 3a0d 0a20 2020  ons.keys():..   
+00026c90: 2020 2020 2020 2020 2020 2020 206d 6574               met
+00026ca0: 7269 6343 6f6c 756d 6e73 5b63 6f6c 4964  ricColumns[colId
+00026cb0: 5d20 3d20 636f 6c75 6d6e 4964 5265 6c61  ] = columnIdRela
+00026cc0: 7469 6f6e 735b 636f 6c49 645d 0d0a 2020  tions[colId]..  
+00026cd0: 2020 2020 2020 2020 2020 2020 2020 666f                fo
+00026ce0: 7220 656c 656d 656e 7420 696e 2066 696c  r element in fil
+00026cf0: 7465 7252 656c 6174 696f 6e73 2e67 6574  terRelations.get
+00026d00: 2863 6f6c 4964 2c20 5b5d 293a 0d0a 2020  (colId, []):..  
+00026d10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00026d20: 2020 6d65 7472 6963 436f 6c75 6d6e 735b    metricColumns[
+00026d30: 636f 6c49 645d 202b 3d20 6622 3a3a 3a7b  colId] += f":::{
+00026d40: 6d65 7472 6963 4669 6c74 6572 5472 616e  metricFilterTran
+00026d50: 736c 6174 696f 6e5b 656c 656d 656e 745d  slation[element]
+00026d60: 7d22 0d0a 2020 2020 2020 2020 656c 7365  }"..        else
+00026d70: 3a0d 0a20 2020 2020 2020 2020 2020 2069  :..            i
+00026d80: 6620 7265 7475 726e 436c 6173 7320 3d3d  f returnClass ==
+00026d90: 2046 616c 7365 3a0d 0a20 2020 2020 2020   False:..       
+00026da0: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+00026db0: 7265 730d 0a20 2020 2020 2020 2020 2020  res..           
+00026dc0: 2072 6570 6f72 7454 7970 6520 3d20 2273   reportType = "s
+00026dd0: 7461 7469 6322 0d0a 2020 2020 2020 2020  tatic"..        
+00026de0: 2020 2020 6966 2073 656c 662e 6c6f 6767      if self.logg
+00026df0: 696e 6745 6e61 626c 6564 3a0d 0a20 2020  ingEnabled:..   
+00026e00: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+00026e10: 662e 6c6f 6767 6572 2e64 6562 7567 2866  f.logger.debug(f
+00026e20: 2272 6570 6f72 7454 7970 653a 207b 7265  "reportType: {re
+00026e30: 706f 7274 5479 7065 7d22 290d 0a20 2020  portType}")..   
+00026e40: 2020 2020 2020 2020 2063 6f6c 756d 6e73           columns
+00026e50: 203d 204e 6f6e 6520 2023 2320 6e6f 2022   = None  ## no "
+00026e60: 636f 6c75 6d6e 7322 206b 6579 2069 6e20  columns" key in 
+00026e70: 7265 7370 6f6e 7365 0d0a 2020 2020 2020  response..      
+00026e80: 2020 2020 2020 7375 6d6d 6172 7944 6174        summaryDat
+00026e90: 6120 3d20 7265 732e 6765 7428 2273 756d  a = res.get("sum
+00026ea0: 6d61 7279 4461 7461 2229 0d0a 2020 2020  maryData")..    
+00026eb0: 2020 2020 2020 2020 280d 0a20 2020 2020          (..     
+00026ec0: 2020 2020 2020 2020 2020 206e 625f 636f             nb_co
+00026ed0: 6c75 6d6e 732c 0d0a 2020 2020 2020 2020  lumns,..        
+00026ee0: 2020 2020 2020 2020 7461 626c 6543 6f6c          tableCol
+00026ef0: 756d 6e49 6473 2c0d 0a20 2020 2020 2020  umnIds,..       
+00026f00: 2020 2020 2020 2020 2073 6567 6d65 6e74           segment
+00026f10: 4170 706c 6965 642c 0d0a 2020 2020 2020  Applied,..      
+00026f20: 2020 2020 2020 2020 2020 6669 6c74 6572            filter
+00026f30: 5265 6c61 7469 6f6e 732c 0d0a 2020 2020  Relations,..    
+00026f40: 2020 2020 2020 2020 2020 2020 6461 7461              data
+00026f50: 526f 7773 2c0d 0a20 2020 2020 2020 2020  Rows,..         
+00026f60: 2020 2029 203d 2073 656c 662e 5f64 6563     ) = self._dec
+00026f70: 7279 7074 6553 7461 7469 6344 6174 6128  rypteStaticData(
+00026f80: 6461 7461 5265 7175 6573 743d 6461 7461  dataRequest=data
+00026f90: 5265 7175 6573 742c 2072 6573 706f 6e73  Request, respons
+00026fa0: 653d 7265 732c 7265 736f 6c76 6543 6f6c  e=res,resolveCol
+00026fb0: 756d 6e73 3d72 6573 6f6c 7665 436f 6c75  umns=resolveColu
+00026fc0: 6d6e 7329 0d0a 2020 2020 2020 2020 2020  mns)..          
+00026fd0: 2020 2323 2320 4669 6e64 696e 6773 206d    ### Findings m
+00026fe0: 6574 7269 6373 0d0a 2020 2020 2020 2020  etrics..        
+00026ff0: 2020 2020 6d65 7472 6963 4669 6c74 6572      metricFilter
+00027000: 7320 3d20 7b7d 0d0a 2020 2020 2020 2020  s = {}..        
+00027010: 2020 2020 6d65 7472 6963 436f 6c75 6d6e      metricColumn
+00027020: 7320 3d20 5b5d 0d0a 2020 2020 2020 2020  s = []..        
+00027030: 2020 2020 666f 7220 6920 696e 2072 616e      for i in ran
+00027040: 6765 286e 625f 636f 6c75 6d6e 7329 3a0d  ge(nb_columns):.
+00027050: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00027060: 206d 6574 7269 633a 2073 7472 203d 2072   metric: str = r
+00027070: 6573 5b22 636f 6c75 6d6e 7322 5d5b 2263  es["columns"]["c
+00027080: 6f6c 756d 6e49 6473 225d 5b69 5d0d 0a20  olumnIds"][i].. 
+00027090: 2020 2020 2020 2020 2020 2020 2020 206d                 m
+000270a0: 6574 7269 634e 616d 6520 3d20 6d65 7472  etricName = metr
+000270b0: 6963 2e73 706c 6974 2822 3a3a 3a22 295b  ic.split(":::")[
+000270c0: 305d 0d0a 2020 2020 2020 2020 2020 2020  0]..            
+000270d0: 2020 2020 6966 206d 6574 7269 634e 616d      if metricNam
+000270e0: 652e 7374 6172 7473 7769 7468 2822 636d  e.startswith("cm
+000270f0: 2229 3a0d 0a20 2020 2020 2020 2020 2020  "):..           
+00027100: 2020 2020 2020 2020 2063 616c 634d 6574           calcMet
+00027110: 7269 6320 3d20 7365 6c66 2e67 6574 4361  ric = self.getCa
+00027120: 6c63 756c 6174 6564 4d65 7472 6963 286d  lculatedMetric(m
+00027130: 6574 7269 634e 616d 6529 0d0a 2020 2020  etricName)..    
+00027140: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027150: 6d65 7472 6963 4e61 6d65 203d 2063 616c  metricName = cal
+00027160: 634d 6574 7269 635b 226e 616d 6522 5d0d  cMetric["name"].
+00027170: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00027180: 2063 6f72 7265 7370 6f6e 6469 6e67 5374   correspondingSt
+00027190: 6174 6963 203d 2074 6162 6c65 436f 6c75  atic = tableColu
+000271a0: 6d6e 4964 735b 6d65 7472 6963 5d0d 0a20  mnIds[metric].. 
+000271b0: 2020 2020 2020 2020 2020 2020 2020 2023                 #
+000271c0: 2320 6966 2074 6865 2073 7461 7469 6320  # if the static 
+000271d0: 726f 7720 6861 7320 6120 6669 6c74 6572  row has a filter
+000271e0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+000271f0: 2020 6966 2063 6f72 7265 7370 6f6e 6469    if correspondi
+00027200: 6e67 5374 6174 6963 2069 6e20 6c69 7374  ngStatic in list
+00027210: 2866 696c 7465 7252 656c 6174 696f 6e73  (filterRelations
+00027220: 2e6b 6579 7328 2929 3a0d 0a20 2020 2020  .keys()):..     
+00027230: 2020 2020 2020 2020 2020 2020 2020 2023                 #
+00027240: 2320 6669 6e64 696e 6720 7365 676d 656e  # finding segmen
+00027250: 7420 6170 706c 6965 6420 746f 206d 6574  t applied to met
+00027260: 7269 6373 0d0a 2020 2020 2020 2020 2020  rics..          
+00027270: 2020 2020 2020 2020 2020 666f 7220 656c            for el
+00027280: 656d 656e 7420 696e 2066 696c 7465 7252  ement in filterR
+00027290: 656c 6174 696f 6e73 5b63 6f72 7265 7370  elations[corresp
+000272a0: 6f6e 6469 6e67 5374 6174 6963 5d3a 0d0a  ondingStatic]:..
+000272b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000272c0: 2020 2020 2020 2020 7365 6749 643a 7374          segId:st
+000272d0: 7220 3d20 7365 676d 656e 7441 7070 6c69  r = segmentAppli
+000272e0: 6564 5b65 6c65 6d65 6e74 5d0d 0a20 2020  ed[element]..   
+000272f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027300: 2020 2020 206d 6574 7269 634e 616d 6520       metricName 
+00027310: 2b3d 2066 223a 3a3a 7b73 6567 4964 7d22  += f":::{segId}"
+00027320: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00027330: 2020 2020 2020 2020 2020 6d65 7472 6963            metric
+00027340: 4669 6c74 6572 735b 7365 6749 645d 203d  Filters[segId] =
+00027350: 2073 6567 4964 0d0a 2020 2020 2020 2020   segId..        
+00027360: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027370: 6966 2073 6567 4964 2e73 7461 7274 7377  if segId.startsw
+00027380: 6974 6828 2273 2229 2061 6e64 2022 4041  ith("s") and "@A
+00027390: 646f 6265 4f72 6722 2069 6e20 7365 6749  dobeOrg" in segI
+000273a0: 643a 0d0a 2020 2020 2020 2020 2020 2020  d:..            
+000273b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000273c0: 7365 6720 3d20 7365 6c66 2e67 6574 5365  seg = self.getSe
+000273d0: 676d 656e 7428 7365 6749 6429 0d0a 2020  gment(segId)..  
+000273e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000273f0: 2020 2020 2020 2020 2020 6d65 7472 6963            metric
+00027400: 4669 6c74 6572 735b 7365 6749 645d 203d  Filters[segId] =
+00027410: 2073 6567 5b22 6e61 6d65 225d 0d0a 2020   seg["name"]..  
+00027420: 2020 2020 2020 2020 2020 2020 2020 6d65                me
+00027430: 7472 6963 436f 6c75 6d6e 732e 6170 7065  tricColumns.appe
+00027440: 6e64 286d 6574 7269 634e 616d 6529 0d0a  nd(metricName)..
+00027450: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027460: 2323 2320 656e 6469 6e67 2077 6974 6820  ### ending with 
+00027470: 5b27 6d65 7472 6963 3127 2c27 6d65 7472  ['metric1','metr
+00027480: 6963 3220 2b20 7365 6749 6427 2c2e 2e2e  ic2 + segId',...
+00027490: 5d0d 0a20 2020 2020 2020 2023 2323 2070  ]..        ### p
+000274a0: 7265 7061 7269 6e67 2064 6174 6120 706f  reparing data po
+000274b0: 696e 7473 0d0a 2020 2020 2020 2020 6966  ints..        if
+000274c0: 2073 656c 662e 6c6f 6767 696e 6745 6e61   self.loggingEna
+000274d0: 626c 6564 3a0d 0a20 2020 2020 2020 2020  bled:..         
+000274e0: 2020 2073 656c 662e 6c6f 6767 6572 2e64     self.logger.d
+000274f0: 6562 7567 2866 2270 7265 7061 7269 6e67  ebug(f"preparing
+00027500: 2064 6174 6122 290d 0a20 2020 2020 2020   data")..       
+00027510: 2070 7265 7061 7265 6444 6174 6120 3d20   preparedData = 
+00027520: 7365 6c66 2e5f 7072 6570 6172 6544 6174  self._prepareDat
+00027530: 6128 6461 7461 526f 7773 2c20 7265 706f  a(dataRows, repo
+00027540: 7274 5479 7065 3d72 6570 6f72 7454 7970  rtType=reportTyp
+00027550: 6529 0d0a 2020 2020 2020 2020 6966 2072  e)..        if r
+00027560: 6574 7572 6e43 6c61 7373 3a0d 0a20 2020  eturnClass:..   
+00027570: 2020 2020 2020 2020 2069 6620 7365 6c66           if self
+00027580: 2e6c 6f67 6769 6e67 456e 6162 6c65 643a  .loggingEnabled:
+00027590: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+000275a0: 2020 7365 6c66 2e6c 6f67 6765 722e 6465    self.logger.de
+000275b0: 6275 6728 6622 7265 7475 726e 696e 6720  bug(f"returning 
+000275c0: 576f 726b 7370 6163 6520 636c 6173 7322  Workspace class"
+000275d0: 290d 0a20 2020 2020 2020 2020 2020 2023  )..            #
+000275e0: 2320 5573 696e 6720 7468 6520 636c 6173  # Using the clas
+000275f0: 730d 0a20 2020 2020 2020 2020 2020 2064  s..            d
+00027600: 6174 6120 3d20 576f 726b 7370 6163 6528  ata = Workspace(
+00027610: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00027620: 2020 7265 7370 6f6e 7365 4461 7461 3d70    responseData=p
+00027630: 7265 7061 7265 6444 6174 612c 0d0a 2020  reparedData,..  
+00027640: 2020 2020 2020 2020 2020 2020 2020 6461                da
+00027650: 7461 5265 7175 6573 743d 6461 7461 5265  taRequest=dataRe
+00027660: 7175 6573 742c 0d0a 2020 2020 2020 2020  quest,..        
+00027670: 2020 2020 2020 2020 636f 6c75 6d6e 733d          columns=
+00027680: 636f 6c75 6d6e 732c 0d0a 2020 2020 2020  columns,..      
+00027690: 2020 2020 2020 2020 2020 7375 6d6d 6172            summar
+000276a0: 7944 6174 613d 7375 6d6d 6172 7944 6174  yData=summaryDat
+000276b0: 612c 0d0a 2020 2020 2020 2020 2020 2020  a,..            
+000276c0: 2020 2020 616e 616c 7974 6963 7343 6f6e      analyticsCon
+000276d0: 6e65 6374 6f72 3d73 656c 662c 0d0a 2020  nector=self,..  
+000276e0: 2020 2020 2020 2020 2020 2020 2020 7265                re
+000276f0: 706f 7274 5479 7065 3d72 6570 6f72 7454  portType=reportT
+00027700: 7970 652c 0d0a 2020 2020 2020 2020 2020  ype,..          
+00027710: 2020 2020 2020 6d65 7472 6963 733d 6d65        metrics=me
+00027720: 7472 6963 436f 6c75 6d6e 732c 2020 2323  tricColumns,  ##
+00027730: 2066 6f72 206e 6f72 6d61 6c20 7479 7065   for normal type
+00027740: 2020 2023 2320 666f 7220 7374 6174 6963     ## for static
+00027750: 5265 706f 7274 0d0a 2020 2020 2020 2020  Report..        
+00027760: 2020 2020 2020 2020 6d65 7472 6963 4669          metricFi
+00027770: 6c74 6572 733d 6d65 7472 6963 4669 6c74  lters=metricFilt
+00027780: 6572 732c 0d0a 2020 2020 2020 2020 2020  ers,..          
+00027790: 2020 2020 2020 7265 736f 6c76 6543 6f6c        resolveCol
+000277a0: 756d 6e73 3d72 6573 6f6c 7665 436f 6c75  umns=resolveColu
+000277b0: 6d6e 732c 0d0a 2020 2020 2020 2020 2020  mns,..          
+000277c0: 2020 290d 0a20 2020 2020 2020 2020 2020    )..           
+000277d0: 2069 6620 7361 7665 3a0d 0a20 2020 2020   if save:..     
+000277e0: 2020 2020 2020 2020 2020 2064 6174 612e             data.
+000277f0: 746f 5f63 7376 2829 0d0a 2020 2020 2020  to_csv()..      
+00027800: 2020 2020 2020 7265 7475 726e 2064 6174        return dat
+00027810: 610d 0a                                  a..
```

### Comparing `aanalytics2-0.3.3.post1/aanalytics2/config.py` & `aanalytics2-0.3.3.post2/aanalytics2/config.py`

 * *Files identical despite different names*

### Comparing `aanalytics2-0.3.3.post1/aanalytics2/configs.py` & `aanalytics2-0.3.3.post2/aanalytics2/configs.py`

 * *Files identical despite different names*

### Comparing `aanalytics2-0.3.3.post1/aanalytics2/connector.py` & `aanalytics2-0.3.3.post2/aanalytics2/connector.py`

 * *Files identical despite different names*

### Comparing `aanalytics2-0.3.3.post1/aanalytics2/ingestion.py` & `aanalytics2-0.3.3.post2/aanalytics2/ingestion.py`

 * *Files identical despite different names*

### Comparing `aanalytics2-0.3.3.post1/aanalytics2/projects.py` & `aanalytics2-0.3.3.post2/aanalytics2/projects.py`

 * *Files identical despite different names*

### Comparing `aanalytics2-0.3.3.post1/aanalytics2/requestCreator.py` & `aanalytics2-0.3.3.post2/aanalytics2/requestCreator.py`

 * *Files 0% similar despite different names*

```diff
@@ -11,15 +11,14 @@
 
     template = {
         "globalFilters": [],
         "metricContainer": {
             "metrics": [],
             "metricFilters": [],
         },
-        "dimension": "",
         "settings": {
             "countRepeatInstances": True,
             "limit": 20000,
             "page": 0,
             "nonesBehavior": "exclude-nones",
         },
         "statistics": {"functions": ["col-max", "col-min"]},
```

### Comparing `aanalytics2-0.3.3.post1/aanalytics2/token_provider.py` & `aanalytics2-0.3.3.post2/aanalytics2/token_provider.py`

 * *Files identical despite different names*

### Comparing `aanalytics2-0.3.3.post1/aanalytics2/workspace.py` & `aanalytics2-0.3.3.post2/aanalytics2/workspace.py`

 * *Files 1% similar despite different names*

```diff
@@ -34,15 +34,15 @@
             dataRequest : REQUIRED : dataRequest containing the request
             columns : REQUIRED : the columns element of the response.
             summaryData : REQUIRED : summary data containing total calculated by CJA
             analyticsConnector : REQUIRED : analytics object connector.
             reportType : OPTIONAL : define type of report retrieved.(normal, static, multi)
             metrics : OPTIONAL : dictionary of the columns Id for normal report and list of columns name for Static report
             metricFilters : OPTIONAL : Filter name for the id of the filter
-            resolveColumns : OPTIONAL :
+            resolveColumns : OPTIONAL : If you want to resolve the column name and returning ID instead of name
         """
         for filter in dataRequest["globalFilters"]:
             if filter["type"] == "dateRange":
                 self.startDate = filter["dateRange"].split("/")[0]
                 self.endDate = filter["dateRange"].split("/")[1]
         self.dataRequest = RequestCreator(dataRequest)
         self.requestSize = dataRequest["settings"]["limit"]
@@ -73,15 +73,15 @@
             df_init = pd.DataFrame(responseData).T
             df_init = df_init.reset_index()
         elif reportType == "multi":
             df_init = responseData
         if reportType == "normal":
             columns_data = ["itemId"]
         elif reportType == "static":
-            columns_data = ["FilterName"]
+            columns_data = ["SegmentName"]
         ### adding dimensions & metrics in columns names when reportType is "normal"
         if "dimension" in dataRequest.keys() and reportType == "normal":
             columns_data.append(dataRequest["dimension"])
             ### adding metrics in columns names
             columnIds = columns["columnIds"]
             # To get readable names of template metrics and Success Events, we need to get the full list of metrics for the Report Suite first. 
             # But we won't do this if there are no such metrics in the report.
@@ -109,15 +109,15 @@
                             metricResolvedName.append(metric)
                     colName = ":::".join(metricResolvedName)
                     columns_data.append(colName)
                 else:
                     columns_data.append(metrics[col])
         elif reportType == "static":
             metrics: list = metrics  ## case when a list is used
-            columns_data.append("FilterId")
+            columns_data.append("SegmentId")
             columns_data += metrics
         if df_init.empty == False and (
             reportType == "static" or reportType == "normal"
         ):
             df_init.columns = columns_data
             self.columns = list(df_init.columns)
         elif reportType == "multi":
```

### Comparing `aanalytics2-0.3.3.post1/aanalytics2.egg-info/PKG-INFO` & `aanalytics2-0.3.3.post2/aanalytics2.egg-info/PKG-INFO`

 * *Files 1% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: aanalytics2
-Version: 0.3.3.post1
+Version: 0.3.3.post2
 Summary: Adobe Analytics API 2.0 python wrapper
 Home-page: https://github.com/pitchmuc/adobe-analytics-api-2.0
 Author: Julien Piccini
 Author-email: piccini.julien@gmail.com
 License: Apache License 2.0
 Keywords: adobe,analytics,API,python
 Classifier: Intended Audience :: Developers
```

### Comparing `aanalytics2-0.3.3.post1/aanalytics2.egg-info/SOURCES.txt` & `aanalytics2-0.3.3.post2/aanalytics2.egg-info/SOURCES.txt`

 * *Files identical despite different names*

### Comparing `aanalytics2-0.3.3.post1/setup.py` & `aanalytics2-0.3.3.post2/setup.py`

 * *Files identical despite different names*

### Comparing `aanalytics2-0.3.3.post1/test/test_configuration.py` & `aanalytics2-0.3.3.post2/test/test_configuration.py`

 * *Files identical despite different names*

### Comparing `aanalytics2-0.3.3.post1/test/test_core_analytics.py` & `aanalytics2-0.3.3.post2/test/test_core_analytics.py`

 * *Files identical despite different names*

